{
  HttpSession session=null;
  System.err.println("+**********************");
  System.err.println(cms.getRequestContext().currentUser());
  HttpServletRequest req=(HttpServletRequest)cmsReq.getOriginalRequest();
  session=req.getSession(false);
  if ((session != null)) {
    System.err.println("update session");
    if (!cms.getRequestContext().currentUser().getName().equals(C_USER_GUEST)) {
      m_sessionStorage.putUser(session.getId(),cms.getRequestContext().currentUser().getName(),cms.getRequestContext().currentGroup().getName(),new Integer(cms.getRequestContext().currentProject().getId()));
      OpenCmsServletNotify notify=null;
      Object sessionValue=session.getValue("NOTIFY");
      if (sessionValue instanceof OpenCmsServletNotify) {
        notify=(OpenCmsServletNotify)sessionValue;
        if (notify == null) {
          notify=new OpenCmsServletNotify(session.getId(),m_sessionStorage);
          session.putValue("NOTIFY",notify);
        }
      }
 else {
        notify=new OpenCmsServletNotify(session.getId(),m_sessionStorage);
        session.putValue("NOTIFY",notify);
      }
    }
  }
  System.err.println("-**********************");
}
