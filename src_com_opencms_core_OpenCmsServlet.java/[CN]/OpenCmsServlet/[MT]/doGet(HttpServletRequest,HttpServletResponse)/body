{
  long reqStartTime=System.currentTimeMillis();
  m_currentRequestAmount++;
  if (req.getRequestURI().indexOf("system/workplace/action/login.html") > 0) {
    HttpSession session=req.getSession(false);
    if (session != null)     session.invalidate();
  }
  CmsObject cms=null;
  CmsRequestHttpServlet cmsReq=new CmsRequestHttpServlet(req);
  CmsResponseHttpServlet cmsRes=new CmsResponseHttpServlet(req,res,m_clusterurl);
  try {
    cms=initUser(cmsReq,cmsRes);
    checkRelocation(cms);
    CmsFile file=m_opencms.initResource(cms);
    if (file != null) {
      m_opencms.setResponse(cms,file);
      m_opencms.showResource(cms,file);
      updateUser(cms,cmsReq,cmsRes);
    }
  }
 catch (  CmsException e) {
    errorHandling(cms,cmsReq,cmsRes,e);
  }
  m_currentRequestAmount--;
  long delta=System.currentTimeMillis() - reqStartTime;
  long total=Runtime.getRuntime().totalMemory() / 1024;
  long free=Runtime.getRuntime().freeMemory() / 1024;
  System.err.print("doGet()  reqAm:" + m_currentRequestAmount + " users:"+ m_sessionStorage.size()+ " "+ delta+ "ms");
  System.err.print((" [" + total + "/"+ free+ "/"+ (total - free)+ "] "));
  System.err.print("threads:" + Thread.activeCount() + " ");
  System.err.println(cmsReq.getRequestedResource());
}
