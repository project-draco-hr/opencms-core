{
  final Type oldType=m_type;
  boolean needsRestoration=false;
  if (mode != null) {
    if ((m_mode != null) && m_mode.equals(Mode.STICKY)) {
      needsRestoration=mode.equals(Mode.NORMAL);
      needsRestoration|=((mode.equals(Mode.STICKY) && !canBeReplacedBy(type)));
    }
    hide(true);
  }
  m_type=type;
  final String stickyMessage;
  if (mode == null) {
    stickyMessage=null;
  }
 else   if (!needsRestoration) {
    m_mode=mode;
    stickyMessage=null;
  }
 else {
    stickyMessage=m_message.getInnerHTML();
  }
  m_message.setInnerHTML(message);
  getElement().addClassName(classForType(type));
  getElement().getStyle().setVisibility(Visibility.HIDDEN);
  setVisible(true);
  Scheduler.get().scheduleDeferred(new ScheduledCommand(){
    /** 
 * @see com.google.gwt.core.client.Scheduler.ScheduledCommand#execute()
 */
    public void execute(){
      m_animation=getShowAnimation();
      m_animation.run();
      CmsDebugLog.getInstance().printLine("show: " + m_message.getInnerText());
    }
  }
);
  if ((mode != null) && ((mode != Mode.STICKY) || needsRestoration)) {
    m_timer=new Timer(){
      /** 
 * @see com.google.gwt.user.client.Timer#run()
 */
      @Override public void run(){
        hide();
        if (stickyMessage != null) {
          show(null,oldType,stickyMessage);
        }
      }
    }
;
    m_timer.schedule(type == Type.NORMAL ? 5000 : 10000);
  }
}
