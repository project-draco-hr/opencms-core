{
  CmsFile newFile=null;
  PreparedStatement stmt=null, stmt2=null;
  Connection conn=null;
  ResultSet res=null;
  if (!m_enableServerCopy || onlineProject.getId() < 0) {
    return super.publishFileContent(offlineProject,onlineProject,offlineFileHeader,publishedContentIds);
  }
  try {
    if (!offlineFileHeader.getContentId().isNullUUID() && !publishedContentIds.contains(offlineFileHeader.getContentId())) {
      newFile=new CmsFile(offlineFileHeader.getStructureId(),offlineFileHeader.getResourceId(),offlineFileHeader.getParentStructureId(),offlineFileHeader.getContentId(),offlineFileHeader.getName(),offlineFileHeader.getTypeId(),offlineFileHeader.getFlags(),offlineFileHeader.getProjectLastModified(),I_CmsConstants.C_STATE_UNCHANGED,offlineFileHeader.getLoaderId(),offlineFileHeader.getDateCreated(),offlineFileHeader.getUserCreated(),offlineFileHeader.getDateLastModified(),offlineFileHeader.getUserLastModified(),offlineFileHeader.getDateReleased(),offlineFileHeader.getDateExpired(),offlineFileHeader.getSiblingCount(),offlineFileHeader.getLength(),new byte[0]);
      newFile.setRootPath(offlineFileHeader.getRootPath());
      m_driverManager.getVfsDriver().createResource(onlineProject,newFile,newFile.getContents());
      conn=m_sqlManager.getConnection();
      stmt=m_sqlManager.getPreparedStatement(conn,"C_ORACLE_FILES_READCONTENT");
      stmt.setString(1,offlineFileHeader.getContentId().toString());
      res=stmt.executeQuery();
      if (res.next()) {
        Blob content=res.getBlob(1);
        stmt2=m_sqlManager.getPreparedStatement(conn,"C_ORACLE_FILES_PUBLISHCONTENT");
        stmt2.setBlob(1,content);
        stmt2.setString(2,offlineFileHeader.getContentId().toString());
        stmt2.executeUpdate();
        stmt2.close();
        stmt2=null;
      }
      publishedContentIds.add(offlineFileHeader.getContentId());
    }
 else {
      m_driverManager.getVfsDriver().createSibling(onlineProject,offlineFileHeader,offlineFileHeader.getName());
      newFile=m_driverManager.getVfsDriver().readFile(onlineProject.getId(),false,offlineFileHeader.getStructureId());
      newFile.setRootPath(offlineFileHeader.getRootPath());
    }
  }
 catch (  Exception e) {
    if (OpenCms.getLog(this).isErrorEnabled()) {
      OpenCms.getLog(this).error("Error creating file content " + offlineFileHeader.toString(),e);
    }
    throw e;
  }
 finally {
    m_sqlManager.closeAll(conn,stmt,res);
    m_sqlManager.closeAll(null,stmt2,null);
  }
  return newFile;
}
