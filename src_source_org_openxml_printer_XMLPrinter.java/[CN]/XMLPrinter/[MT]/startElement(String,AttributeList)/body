{
  int i;
  boolean preserveSpace;
  ElementState state;
  String name;
  String value;
  state=getElementState();
  if (state == null) {
    if (!_started)     startDocument(tagName);
    preserveSpace=_format.getPreserveSpace();
  }
 else {
    if (state.empty)     printText(">");
    preserveSpace=state.preserveSpace;
    if (_format.getIndenting() && !state.preserveSpace && (state.empty || state.afterElement))     breakLine();
  }
  printText('<' + tagName);
  indent();
  for (i=0; i < attrs.getLength(); ++i) {
    printSpace();
    name=attrs.getName(i);
    value=attrs.getValue(i);
    if (value == null)     value="";
    printText(name + "=\"" + escape(value)+ '"');
    if (name.equals("xml:space")) {
      if (value.equals("preserve"))       preserveSpace=true;
 else       preserveSpace=_format.getPreserveSpace();
    }
  }
  enterElementState(tagName,preserveSpace);
}
