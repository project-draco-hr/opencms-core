{
  m_XmlTemplateDocument=null;
  m_TemplateSection=null;
  if (m_Resource.isFile()) {
    m_TemplateSection="file";
  }
 else {
    m_TemplateSection="folder";
  }
  String resourceTitle=cms.readProperty(cms.getSitePath(m_Resource),I_CmsConstants.C_PROPERTY_TITLE);
  if (resourceTitle == null) {
    resourceTitle="";
  }
  m_XmlTemplateDocument=new CmsXmlWpTemplateFile(cms,theTemplateFile);
  CmsXmlLanguageFile lang=m_XmlTemplateDocument.getLanguageFile();
  String currentState="";
  if (cms.isInsideCurrentProject(m_Resource)) {
    int state=m_Resource.getState();
    currentState+=lang.getLanguageValue("explorer.state" + state);
  }
 else {
    currentState+=lang.getLanguageValue("explorer.statenip");
  }
  m_XmlTemplateDocument.setData("TITLE",CmsEncoder.escapeXml(resourceTitle));
  m_XmlTemplateDocument.setData("STATE",currentState);
  m_XmlTemplateDocument.setData("FILENAME",m_Resource.getName());
}
