{
  String className="";
  if (o != null) {
    className="[" + o.getClass().getName() + "] ";
  }
  if (rootCause != null) {
    StackTraceElement[] stackTraceElements=rootCause.getStackTrace();
    String stackTraceElement="";
    for (int i=0; i < stackTraceElements.length; i++) {
      String currentStackTraceElement=stackTraceElements[i].toString();
      if (currentStackTraceElement.indexOf(".opencms.") != -1) {
        stackTraceElement=currentStackTraceElement;
        break;
      }
    }
    if (message != null)     message="[" + message + "] ";
 else     message="";
    message+="where: " + stackTraceElement + ", ";
    message+="why: " + rootCause.toString();
  }
  message=className + message;
  if (!logSilent && OpenCms.isLogging(I_CmsLogChannels.C_OPENCMS_CRITICAL)) {
    OpenCms.log(I_CmsLogChannels.C_OPENCMS_CRITICAL,message);
  }
switch (exceptionType) {
case CmsException.C_NOT_FOUND:
    return new CmsResourceNotFoundException(message);
}
return new CmsException(message,exceptionType,rootCause);
}
