{
  checkOffline(userCms);
  checkInitialized();
  CmsObject rootCms=rootCms(userCms);
  String folderPath=getFolderPath(userCms);
  createFolder(m_cms,folderPath);
  String destination=CmsStringUtil.joinPaths(folderPath,getNamePattern(true));
  String creationPath=OpenCms.getResourceManager().getNameGenerator().getNewFileName(rootCms,destination,5);
  rootCms.getRequestContext().setAttribute(CmsRequestContext.ATTRIBUTE_NEW_RESOURCE_LOCALE,userCms.getRequestContext().getLocale());
  if (modelResource != null) {
    rootCms.getRequestContext().setAttribute(CmsRequestContext.ATTRIBUTE_MODEL,modelResource.getRootPath());
  }
  CmsResource createdResource=rootCms.createResource(creationPath,getType().getTypeId(),null,new ArrayList<CmsProperty>(0));
  return createdResource;
}
