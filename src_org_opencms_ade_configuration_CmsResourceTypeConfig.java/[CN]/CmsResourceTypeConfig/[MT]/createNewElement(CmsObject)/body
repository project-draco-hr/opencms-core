{
  checkOffline(userCms);
  checkInitialized();
  CmsObject cms=rootCms(userCms);
  String folderPath=getFolderPath(userCms);
  createFolder(m_owner.getCmsObject(),folderPath);
  String destination=CmsStringUtil.joinPaths(folderPath,getNamePattern(true));
  String creationPath=OpenCms.getResourceManager().getNameGenerator().getNewFileName(cms,destination,5);
  byte[] content=null;
  if (getType() instanceof CmsResourceTypeXmlContent) {
    String schema=((CmsResourceTypeXmlContent)getType()).getSchema();
    if (schema != null) {
      CmsObject newCms=OpenCms.initCmsObject(cms);
      newCms.getRequestContext().setUri(folderPath);
      CmsXmlContentDefinition contentDefinition=CmsXmlContentDefinition.unmarshal(cms,schema);
      CmsXmlContent xmlContent=CmsXmlContentFactory.createDocument(newCms,userCms.getRequestContext().getLocale(),OpenCms.getSystemInfo().getDefaultEncoding(),contentDefinition);
      content=xmlContent.marshal();
    }
  }
  CmsResource createdResource=cms.createResource(creationPath,getType().getTypeId(),content,new ArrayList<CmsProperty>(0));
  return createdResource;
}
