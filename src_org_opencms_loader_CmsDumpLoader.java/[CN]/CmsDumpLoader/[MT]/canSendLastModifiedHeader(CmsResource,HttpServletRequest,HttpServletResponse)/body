{
  boolean isWorkplaceUser=CmsWorkplaceManager.isWorkplaceUser(req);
  if (!isWorkplaceUser) {
    long lastModifiedHeader=req.getDateHeader(CmsRequestUtil.HEADER_IF_MODIFIED_SINCE);
    if (lastModifiedHeader > -1) {
      if ((resource.getState() == CmsResource.STATE_UNCHANGED) && (resource.getDateLastModified() == lastModifiedHeader)) {
        long now=System.currentTimeMillis();
        if ((resource.getDateReleased() < now) && (resource.getDateExpired() > now)) {
          CmsFlexController.setDateExpiresHeader(res,resource.getDateExpired(),m_clientCacheMaxAge);
          res.setStatus(HttpServletResponse.SC_NOT_MODIFIED);
          return true;
        }
      }
    }
  }
  return false;
}
