{
  File file=null;
  Document manifest=null;
  InputStream stream=null;
  ZipFile importZip=null;
  try {
    file=new File(filename);
    if (file.isFile()) {
      importZip=new ZipFile(filename);
      ZipEntry entry=importZip.getEntry("manifest.xml");
      stream=importZip.getInputStream(entry);
      manifest=parse(stream);
      return (Element)(manifest.getElementsByTagName("module").item(0));
    }
 else     if (file.isDirectory()) {
      file=new File(file,"manifest.xml");
      stream=new FileInputStream(file);
    }
    manifest=parse(stream);
    return (Element)(manifest.getElementsByTagName("module").item(0));
  }
 catch (  Exception exc) {
    return null;
  }
 finally {
    try {
      if (importZip != null) {
        importZip.close();
      }
      if (stream != null) {
        stream.close();
      }
    }
 catch (    Exception e) {
    }
  }
}
