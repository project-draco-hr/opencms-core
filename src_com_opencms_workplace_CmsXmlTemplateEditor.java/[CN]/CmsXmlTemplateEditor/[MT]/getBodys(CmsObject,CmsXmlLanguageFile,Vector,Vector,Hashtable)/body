{
  I_CmsSession session=cms.getRequestContext().getSession(true);
  String currentBodySection=(String)parameters.get("body");
  String bodyClassName=(String)parameters.get("bodyclass");
  String tempBodyFilename=(String)session.getValue("te_tempbodyfile");
  Object tempObj=CmsTemplateClassManager.getClassInstance(cms,bodyClassName);
  CmsXmlTemplate bodyElementClassObject=(CmsXmlTemplate)tempObj;
  CmsXmlTemplateFile bodyTemplateFile=bodyElementClassObject.getOwnTemplateFile(cms,tempBodyFilename,C_BODY_ELEMENT,parameters,null);
  Vector allBodys=bodyTemplateFile.getAllSections();
  int loop=0;
  int currentBodySectionIndex=0;
  int numBodys=allBodys.size();
  for (int i=0; i < numBodys; i++) {
    String bodyname=(String)allBodys.elementAt(i);
    if (bodyname.equals(currentBodySection)) {
      currentBodySectionIndex=loop;
    }
    values.addElement(bodyname);
    names.addElement(bodyname);
    loop++;
  }
  return new Integer(currentBodySectionIndex);
}
