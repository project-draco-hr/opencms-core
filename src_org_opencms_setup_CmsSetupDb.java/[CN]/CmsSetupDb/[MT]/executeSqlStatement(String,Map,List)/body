{
  PreparedStatement stmt=null;
  ResultSet resultSet=null;
  String queryToExecute=query;
  if (replacer != null) {
    queryToExecute=replaceTokens(query,replacer);
  }
  stmt=m_con.prepareStatement(queryToExecute);
  if (params != null) {
    for (int i=0; i < params.size(); i++) {
      Object item=params.get(i);
      if (item instanceof String) {
        stmt.setString(i + 1,(String)item);
      }
      if (item instanceof Integer) {
        Integer number=(Integer)item;
        stmt.setInt(i + 1,number.intValue());
      }
      if (item instanceof Long) {
        Long longNumber=(Long)item;
        stmt.setLong(i + 1,longNumber.longValue());
      }
      if (!(item instanceof Integer) && !(item instanceof String) && !(item instanceof Long)) {
        try {
          stmt.setBytes(i + 1,CmsDataTypeUtil.dataSerialize(item));
        }
 catch (        IOException e) {
          e.printStackTrace();
        }
      }
    }
  }
  resultSet=stmt.executeQuery();
  return resultSet;
}
