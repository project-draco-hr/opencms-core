{
  CmsClientSitemapChange change=new CmsClientSitemapChange(oldEntry.cloneEntry(),newEntry.cloneEntry(),changeType,position);
  if (!isDirty()) {
    startEdit();
  }
  if (!redo) {
    m_undone.clear();
  }
  m_changes.add(change);
switch (changeType) {
case DELETE:
    CmsSitemapEntryTree deleteParent=getTreeEntry(CmsResource.getParentFolder(oldEntry.getSitePath()));
  deleteParent.removeChild(oldEntry.getName());
break;
case EDIT:
CmsSitemapEntryTree editEntry=getTreeEntry(oldEntry.getSitePath());
editEntry.setEntry(newEntry);
break;
case MOVE:
CmsSitemapEntryTree sourceParent=getTreeEntry(CmsResource.getParentFolder(oldEntry.getSitePath()));
CmsSitemapEntryTree moved=sourceParent.removeChild(oldEntry.getName());
CmsSitemapEntryTree destParent=getTreeEntry(CmsResource.getParentFolder(newEntry.getSitePath()));
destParent.insertChild(moved,position);
break;
case NEW:
CmsSitemapEntryTree newParent=getTreeEntry(CmsResource.getParentFolder(newEntry.getSitePath()));
newParent.addChild(newEntry);
break;
default :
}
m_view.refresh(change);
}
