{
  CmsObject cms=getCmsObject();
  try {
    CmsResource resource=cms.readResource(uri);
    if (resource.getDateLastModified() != modification) {
      CmsUser user=cms.readUser(resource.getUserLastModified());
      return CmsLockInfo.forChangedResource(uri,user.getFullName());
    }
  }
 catch (  Throwable e) {
    error(e);
  }
  try {
    return getLock(uri);
  }
 catch (  CmsException e) {
    return CmsLockInfo.forError(uri,e.getLocalizedMessage());
  }
}
