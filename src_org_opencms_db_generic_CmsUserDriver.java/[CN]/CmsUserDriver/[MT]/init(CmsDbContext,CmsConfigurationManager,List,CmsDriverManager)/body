{
  Map configuration=configurationManager.getConfiguration();
  ExtendedProperties config;
  if (configuration instanceof ExtendedProperties) {
    config=(ExtendedProperties)configuration;
  }
 else {
    config=new ExtendedProperties();
    config.putAll(configuration);
  }
  String poolUrl=config.get("db.user.pool").toString();
  String classname=config.get("db.user.sqlmanager").toString();
  m_sqlManager=this.initSqlManager(classname);
  m_sqlManager.init(I_CmsUserDriver.C_DRIVER_TYPE_ID,poolUrl);
  m_driverManager=driverManager;
  if (LOG.isInfoEnabled()) {
    CmsMessageContainer message=Messages.get().container(Messages.INIT_ASSIGNED_POOL_1,poolUrl);
    LOG.info(message);
  }
  m_digestAlgorithm=config.getString(I_CmsConstants.C_CONFIGURATION_DB + ".user.digest.type","MD5");
  if (LOG.isInfoEnabled()) {
    CmsMessageContainer message=Messages.get().container(Messages.INIT_DIGEST_ALGORITHM_1,m_digestAlgorithm);
    LOG.info(message);
  }
  m_digestFileEncoding=config.getString(I_CmsConstants.C_CONFIGURATION_DB + ".user.digest.encoding",CmsEncoder.C_UTF8_ENCODING);
  if (LOG.isInfoEnabled()) {
    CmsMessageContainer message=Messages.get().container(Messages.INIT_DIGEST_ENCODING_1,m_digestFileEncoding);
    LOG.info(message);
  }
  try {
    m_digest=MessageDigest.getInstance(m_digestAlgorithm);
    if (OpenCms.getLog(CmsLog.CHANNEL_INIT).isInfoEnabled()) {
      OpenCms.getLog(CmsLog.CHANNEL_INIT).info(". Using digest encoding: " + m_digest.getAlgorithm() + " from "+ m_digest.getProvider().getName()+ " version "+ m_digest.getProvider().getVersion());
    }
  }
 catch (  NoSuchAlgorithmException e) {
    if (OpenCms.getLog(CmsLog.CHANNEL_INIT).isInfoEnabled()) {
      OpenCms.getLog(CmsLog.CHANNEL_INIT).info(". Error setting digest : using clear passwords - " + e.getMessage());
    }
  }
  try {
    if (!existsGroup(dbc,OpenCms.getDefaultUsers().getGroupAdministrators(),null)) {
      fillDefaults(dbc);
    }
  }
 catch (  CmsException e) {
    if (OpenCms.getLog(CmsLog.CHANNEL_INIT).isErrorEnabled()) {
      OpenCms.getLog(CmsLog.CHANNEL_INIT).error("Initialization of default users and groups failed",e);
    }
    throw new RuntimeException(e);
  }
  if (successiveDrivers != null && !successiveDrivers.isEmpty()) {
    if (LOG.isWarnEnabled()) {
      CmsMessageContainer message1=Messages.get().container(Messages.INIT_SUCCESSIVE_DRIVERS_UNSUPPORTED_1,getClass().toString());
      LOG.warn(message1);
    }
  }
}
