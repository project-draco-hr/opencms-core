{
  int oldProjectId=m_context.currentProject().getId();
  if (oldProjectId != C_PROJECT_ONLINE_ID) {
    int newProjectId=m_rb.createProject(m_context.currentUser(),m_context.currentProject(),"__forPublish","project for single resource publishing","Users","Projectmanager",I_CmsConstants.C_PROJECT_TYPE_TEMPORARY).getId();
    getRequestContext().setCurrentProject(newProjectId);
    CmsResource res=readFileHeader(resourcename);
    I_CmsResourceType rt=getResourceType(res.getType());
    rt.copyResourceToProject(this,resourcename);
    publishProject(newProjectId);
    getRequestContext().setCurrentProject(oldProjectId);
  }
 else {
    throw new CmsException("[CmsObject] cannot publish resource in online project",CmsException.C_NO_ACCESS);
  }
}
