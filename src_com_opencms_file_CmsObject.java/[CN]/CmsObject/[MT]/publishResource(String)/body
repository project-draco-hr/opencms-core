{
  int oldProjectId=m_context.currentProject().getId();
  CmsResource res=null;
  if (resourcename.endsWith("/")) {
    res=readFolder(resourcename,true);
  }
 else {
    res=readFileHeader(resourcename);
  }
  if (res.isLocked()) {
    throw new CmsException("[CmsObject] cannot publish locked resource",CmsException.C_NO_ACCESS);
  }
  if (oldProjectId != C_PROJECT_ONLINE_ID) {
    if (isAdmin() || isManagerOfProject()) {
      int newProjectId=m_rb.createProject(m_context.currentUser(),m_context.currentProject(),"Temporaeres Projekt","Projekt zum Veroeffentlichen einzelner Ressourcen","Users","Projectmanager",I_CmsConstants.C_PROJECT_TYPE_TEMPORARY).getId();
      getRequestContext().setCurrentProject(newProjectId);
      I_CmsResourceType rt=getResourceType(res.getType());
      rt.copyResourceToProject(this,resourcename);
      rt.changeLockedInProject(this,newProjectId,resourcename);
      publishProject(newProjectId);
      getRequestContext().setCurrentProject(oldProjectId);
    }
 else {
      throw new CmsException("[CmsObject] cannot publish resource in current project",CmsException.C_NO_ACCESS);
    }
  }
 else {
    throw new CmsException("[CmsObject] cannot publish resource in online project",CmsException.C_NO_ACCESS);
  }
}
