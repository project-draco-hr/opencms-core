{
  Hashtable oldProperties=null;
  try {
    oldProperties=this.readAllProperties(filename);
  }
 catch (  CmsException e) {
    oldProperties=new Hashtable();
  }
  if (newProperties != null) {
    oldProperties.putAll(newProperties);
  }
  try {
    this.deleteResource(filename);
    this.createResource(filename,type,oldProperties,newContent,null);
  }
 catch (  CmsException e1) {
    throw new CmsException(CmsException.C_FILESYSTEM_ERROR,e1);
  }
  this.joinLinksToTargets(new CmsShellReport());
}
