{
  int oldProjectType=m_context.currentProject().getType();
  CmsResource resource=resource=readFileHeader(resourcename,true);
  try {
    m_context.currentProject().setType(I_CmsConstants.C_PROJECT_TYPE_DIRECT_PUBLISH);
    publishProject(report,resource);
  }
 catch (  CmsException e) {
    throw e;
  }
 finally {
    m_context.currentProject().setType(oldProjectType);
    OpenCms.fireCmsEvent(new CmsEvent(this,I_CmsEventListener.EVENT_PUBLISH_RESOURCE,Collections.singletonMap("resource",resource)));
  }
}
