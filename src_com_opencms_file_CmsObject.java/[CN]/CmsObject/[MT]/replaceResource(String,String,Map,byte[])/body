{
  Map resProps=null;
  try {
    resProps=readAllProperties(resName);
  }
 catch (  CmsException e) {
    resProps=(Map)new HashMap();
  }
  if (newProps != null) {
    resProps.putAll(newProps);
  }
  I_CmsResourceType res=getResourceType(readFileHeader(resName,true).getType());
  res.replaceResource(this,resName,resProps,newResContent,newResType);
  joinLinksToTargets(new CmsShellReport());
}
