{
  CmsResource res=readFileHeader(resourceName);
  CmsAccessControlEntry acEntry=null;
  I_CmsPrincipal principal=null;
  if ("".equals(permissionString)) {
    m_driverManager.removeAccessControlEntry(m_context.currentUser(),m_context.currentProject(),res,principal.getId());
  }
  if ("group".equals(principalType.toLowerCase())) {
    principal=readGroup(principalName);
    acEntry=new CmsAccessControlEntry(res.getResourceAceId(),principal.getId(),permissionString);
    acEntry.setFlags(I_CmsConstants.C_ACCESSFLAGS_GROUP);
  }
 else   if ("user".equals(principalType.toLowerCase())) {
    principal=readUser(principalName);
    acEntry=new CmsAccessControlEntry(res.getResourceAceId(),principal.getId(),permissionString);
    acEntry.setFlags(I_CmsConstants.C_ACCESSFLAGS_USER);
  }
  m_driverManager.writeAccessControlEntry(m_context.currentUser(),m_context.currentProject(),res,acEntry);
}
