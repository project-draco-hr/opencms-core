{
  CmsResource res=readFileHeader(resourceName);
  I_CmsPrincipal principal=m_driverManager.lookupPrincipal(principalName);
  StringTokenizer tok=new StringTokenizer(permissions,"+-",true);
  int allowed=0, denied=0, flags=0;
  while (tok.hasMoreElements()) {
    String prefix=tok.nextToken();
    String suffix=tok.nextToken();
switch (suffix.charAt(0)) {
case 'R':
case 'r':
      if (prefix.charAt(0) == '+')       allowed|=I_CmsConstants.C_ACCESS_READ;
    if (prefix.charAt(0) == '-')     denied|=I_CmsConstants.C_ACCESS_READ;
  break;
case 'W':
case 'w':
if (prefix.charAt(0) == '+') allowed|=I_CmsConstants.C_ACCESS_WRITE;
if (prefix.charAt(0) == '-') denied|=I_CmsConstants.C_ACCESS_WRITE;
break;
case 'V':
case 'v':
if (prefix.charAt(0) == '+') allowed|=I_CmsConstants.C_ACCESS_VISIBLE;
if (prefix.charAt(0) == '-') denied|=I_CmsConstants.C_ACCESS_VISIBLE;
break;
}
}
m_driverManager.createAccessControlEntry(res,principal.getId(),allowed,denied,flags);
}
