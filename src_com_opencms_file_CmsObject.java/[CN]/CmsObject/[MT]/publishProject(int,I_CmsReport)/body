{
  clearcache();
  CmsPublishedResources allChanged=new CmsPublishedResources();
  Vector changedResources=null;
  Vector changedModuleMasters=null;
  boolean success=false;
  CmsProject theProject=readProject(id);
  try {
    Vector newRes=readProjectView(id,"new");
    updateOnlineProjectLinks(readProjectView(id,"deleted"),readProjectView(id,"changed"),null,this.getResourceType(C_TYPE_PAGE_NAME).getResourceType());
    Vector projectResources=readProjectView(id,"all");
    allChanged=m_rb.publishProject(this,m_context.currentUser(),m_context.currentProject(),id,report);
    updateOnlineProjectLinks(null,null,newRes,this.getResourceType(C_TYPE_PAGE_NAME).getResourceType());
    newRes=null;
    changedResources=allChanged.getChangedResources();
    changedModuleMasters=allChanged.getChangedModuleMasters();
    if (getOnlineElementCache() != null)     getOnlineElementCache().cleanupCache(changedResources,changedModuleMasters);
    clearcache();
    if (this.getStaticExportProperties().isStaticExportEnabled()) {
      try {
        int oldId=m_context.currentProject().getId();
        m_context.setCurrentProject(C_PROJECT_ONLINE_ID);
        Vector linkChanges=new Vector();
        Vector allExportedLinks=new Vector();
        this.exportStaticResources(this.getStaticExportProperties().getStartPoints(),linkChanges,allExportedLinks,allChanged,report);
        m_context.setCurrentProject(oldId);
        Utils.getModulPublishMethods(this,linkChanges);
        this.fireEvent(com.opencms.flex.I_CmsEventListener.EVENT_STATIC_EXPORT,allExportedLinks);
      }
 catch (      Exception ex) {
        System.err.println("Error while exporting static resources:");
        ex.printStackTrace();
      }
    }
 else {
      if ("false_ssl".equalsIgnoreCase(this.getStaticExportProperties().getStaticExportEnabledValue())) {
        int oldId=m_context.currentProject().getId();
        m_context.setCurrentProject(C_PROJECT_ONLINE_ID);
        new CmsStaticExport(this,null,false,null,null,null,null);
        m_context.setCurrentProject(oldId);
      }
    }
    success=true;
  }
 catch (  Exception e) {
    System.err.println("###################################");
    System.err.println("PublishProject " + id + " CmsObject Time:"+ new Date());
    System.err.println("currentUser:" + m_context.currentUser().toString());
    e.printStackTrace();
    System.err.println("Vector of changed resources:");
    if (changedResources != null) {
      for (int i=0; i < changedResources.size(); i++) {
        System.err.println("    -- " + i + " -->"+ (String)changedResources.elementAt(i)+ "<--");
      }
    }
  }
 finally {
    if (changedResources == null || changedResources.size() < 1) {
      System.err.println("###################################");
      System.err.println("PublishProject " + id + " CmsObject Time:"+ new Date());
      System.err.println("currentUser:" + m_context.currentUser().toString());
      System.err.println("Vector was null or empty");
      success=false;
    }
    if (!success) {
      if (getOnlineElementCache() != null)       getOnlineElementCache().clearCache();
    }
    if (theProject.getId() == m_context.currentProject().getId() && theProject.getType() == I_CmsConstants.C_PROJECT_TYPE_TEMPORARY) {
      m_context.setCurrentProject(C_PROJECT_ONLINE_ID);
    }
  }
  this.fireEvent(com.opencms.flex.I_CmsEventListener.EVENT_PUBLISH_PROJECT,theProject);
}
