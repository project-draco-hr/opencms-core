{
  return new Comparator(){
    /** 
 * @see java.util.Comparator#compare(java.lang.Object,java.lang.Object)
 */
    public int compare(    Object o1,    Object o2){
      CmsListItem li1=(CmsListItem)o1;
      CmsListItem li2=(CmsListItem)o2;
      CmsListColumnDefinition col=li1.getMetadata().getColumnDefinition(columnId);
      if (col.getDirectActions().size() > 0) {
        String i1=null;
        String i2=null;
        Iterator it=col.getDirectActions().iterator();
        while (it.hasNext()) {
          I_CmsListDirectAction action=(I_CmsListDirectAction)it.next();
          CmsListItem tmp=action.getItem();
          action.setItem(li1);
          if (action.isVisible()) {
            i1=action.getIconPath();
          }
          action.setItem(li2);
          if (action.isVisible()) {
            i2=action.getIconPath();
          }
          action.setItem(tmp);
        }
        if (i1 != null) {
          if (i2 == null) {
            return 1;
          }
          return i1.compareTo(i2);
        }
 else         if (i2 != null) {
          return -1;
        }
        return 0;
      }
 else {
        Comparable c1=(Comparable)((CmsListItem)o1).get(columnId);
        Comparable c2=(Comparable)((CmsListItem)o2).get(columnId);
        if (c1 != null) {
          if (c2 == null) {
            return 1;
          }
          return c1.compareTo(c2);
        }
 else         if (c2 != null) {
          return -1;
        }
        return 0;
      }
    }
  }
;
}
