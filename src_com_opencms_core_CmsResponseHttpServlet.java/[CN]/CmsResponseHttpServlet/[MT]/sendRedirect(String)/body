{
  if (DEBUG)   System.err.println("CmsResponse.sendRedirect(" + location + ")");
  String shortLocation=location;
  String hostName=m_req.getServerName() + ":" + m_req.getServerPort();
  if (shortLocation.startsWith(m_req.getScheme())) {
    shortLocation=shortLocation.substring(m_req.getScheme().length());
  }
  if (shortLocation.startsWith("://")) {
    shortLocation=shortLocation.substring(3);
  }
  if (shortLocation.startsWith(hostName)) {
    shortLocation=shortLocation.substring(hostName.length());
    String contextPath="";
    try {
      contextPath=m_req.getContextPath();
    }
 catch (    NoSuchMethodError err) {
    }
    if (shortLocation.startsWith(contextPath + m_req.getServletPath())) {
      shortLocation=shortLocation.substring((contextPath + m_req.getServletPath()).length());
    }
    sendCmsRedirect(shortLocation);
  }
 else {
    m_res.sendRedirect(location);
  }
}
