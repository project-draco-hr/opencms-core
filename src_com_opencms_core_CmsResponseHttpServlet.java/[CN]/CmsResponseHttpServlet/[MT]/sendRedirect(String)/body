{
  String shortLocation=location;
  String hostName=m_req.getHeader("HOST");
  if (shortLocation.startsWith(m_req.getScheme())) {
    shortLocation=shortLocation.substring(m_req.getScheme().length());
  }
  if (shortLocation.startsWith("://")) {
    shortLocation=shortLocation.substring(3);
  }
  if (shortLocation.startsWith(hostName)) {
    shortLocation=shortLocation.substring(hostName.length());
    if (shortLocation.startsWith(m_req.getServletPath())) {
      shortLocation=shortLocation.substring(m_req.getServletPath().length());
    }
    sendCmsRedirect(shortLocation);
  }
 else {
    m_res.sendRedirect(location);
  }
}
