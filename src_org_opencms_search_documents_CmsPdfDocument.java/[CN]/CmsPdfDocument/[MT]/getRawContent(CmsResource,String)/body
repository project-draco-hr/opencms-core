{
  PDDocument pdfDocument=null;
  String rawContent=null;
  try {
    CmsFile file=m_cms.readFile(m_cms.getRequestContext().removeSiteRoot(resource.getRootPath()));
    if (!(file.getLength() > 0)) {
      throw new CmsIndexException("Resource " + resource.getRootPath() + " has no content.");
    }
    PDFParser parser=new PDFParser(new ByteArrayInputStream(file.getContents()));
    parser.parse();
    pdfDocument=parser.getPDDocument();
    if (pdfDocument.isEncrypted()) {
      DecryptDocument decryptor=new DecryptDocument(pdfDocument);
      decryptor.decryptDocument("");
    }
    StringWriter writer=new StringWriter();
    PDFTextStripper stripper=new PDFTextStripper();
    stripper.writeText(pdfDocument.getDocument(),writer);
    rawContent=writer.toString();
    writer.close();
  }
 catch (  CryptographyException exc) {
    throw new CmsIndexException("Decrypting resource " + resource.getRootPath() + " failed.",exc);
  }
catch (  InvalidPasswordException exc) {
    throw new CmsIndexException("Resource " + resource.getRootPath() + " is password protected.",exc);
  }
catch (  IOException exc) {
    throw new CmsIndexException("Reading resource " + resource.getRootPath() + " failed.",exc);
  }
 finally {
    try {
      pdfDocument.close();
    }
 catch (    Exception exc) {
    }
  }
  return rawContent;
}
