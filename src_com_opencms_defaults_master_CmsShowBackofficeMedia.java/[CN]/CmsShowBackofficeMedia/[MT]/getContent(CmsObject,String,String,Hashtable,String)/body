{
  CmsRequestContext req=cms.getRequestContext();
  I_CmsSession session=CmsXmlTemplateLoader.getSession(req,true);
  byte[] picture=new byte[0];
  try {
    CmsMasterMedia selectedmediaCD=null;
    try {
      selectedmediaCD=(CmsMasterMedia)session.getValue("selectedmediaCD");
    }
 catch (    Exception e) {
      e.printStackTrace(System.err);
    }
    if (selectedmediaCD != null) {
      picture=selectedmediaCD.getMedia();
      String mType=selectedmediaCD.getMimetype();
      if (mType == null || mType.equals("")) {
        mType="application/octet-stream";
      }
      CmsXmlTemplateLoader.getResponse(req).setContentType(mType);
      if (picture == null) {
        picture=emptyGIF;
        CmsXmlTemplateLoader.getResponse(req).setContentType("images/gif");
      }
    }
 else {
      picture=emptyGIF;
      CmsXmlTemplateLoader.getResponse(req).setContentType("images/gif");
    }
  }
 catch (  Exception exx) {
    exx.printStackTrace(System.err);
  }
  return picture;
}
