{
  Map result=new HashMap(4);
  if (parameters == null) {
    return result;
  }
  if (parameters.charAt(0) == '?') {
    parameters=parameters.substring(1);
  }
  StringTokenizer tok=new StringTokenizer(parameters,"&");
  while (tok.hasMoreTokens()) {
    String param=tok.nextToken();
    int pos=param.indexOf('=');
    if (pos < 0) {
      LOG.error(Messages.get().key(Messages.LOG_INVALID_PARAM_1,param));
      continue;
    }
    String key=param.substring(0,pos);
    String value=param.substring(pos + 1);
    if (LOG.isDebugEnabled()) {
      LOG.debug(Messages.get().key(Messages.LOG_ADD_SE_PARAM_2,key,value));
    }
    String[] valueArray;
    Object current=result.get(key);
    if (current != null) {
      String[] oldValueArray=(String[])current;
      valueArray=new String[oldValueArray.length + 1];
      System.arraycopy(oldValueArray,0,valueArray,0,oldValueArray.length);
      valueArray[valueArray.length]=value;
    }
 else {
      valueArray=new String[]{value};
    }
    result.put(key,valueArray);
  }
  return result;
}
