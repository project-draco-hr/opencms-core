{
  StringBuffer buf=new StringBuffer();
  if (m_showExceptionStackTracke) {
    buf.append("<span class='throw'>");
    buf.append(m_messages.key("report.exception"));
    String exception=Encoder.escapeXml(Utils.getStackTrace(throwable));
    exception=CmsStringSubstitution.substitute(exception,"\\","\\\\");
    StringTokenizer tok=new StringTokenizer(exception,"\r\n");
    while (tok.hasMoreTokens()) {
      buf.append(tok.nextToken());
      buf.append(C_LINEBREAK);
    }
    buf.append("</span>");
  }
 else {
    buf.append("<span class='throw'>");
    buf.append(m_messages.key("report.exception"));
    buf.append(throwable.toString());
    buf.append("</span>");
    buf.append(C_LINEBREAK);
  }
  return buf;
}
