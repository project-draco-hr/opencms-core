{
  folder=CmsFile.getPath(folder);
  if (endlevel < startlevel)   return new ArrayList(0);
  int currentlevel=CmsResource.getPathLevel(folder);
  if (currentlevel < endlevel)   endlevel=currentlevel;
  if (startlevel == endlevel)   return getNavigationForFolder(cms,CmsResource.getPathPart(folder,startlevel),startlevel);
  ArrayList result=new ArrayList(0);
  Iterator it=null;
  float parentcount=0;
  for (int i=startlevel; i <= endlevel; i++) {
    String currentfolder=CmsResource.getPathPart(folder,i);
    ArrayList entries=getNavigationForFolder(cms,currentfolder);
    if (parentcount > 0) {
      it=entries.iterator();
      while (it.hasNext()) {
        CmsJspNavElement e=(CmsJspNavElement)it.next();
        e.setNavPosition(e.getNavPosition() + parentcount);
      }
    }
    result.addAll(entries);
    Collections.sort(result);
    float pos=0;
    int count=0;
    it=result.iterator();
    String nextfolder=CmsResource.getPathPart(folder,i + 1);
    parentcount=0;
    while (it.hasNext()) {
      pos=10000 * (++count);
      CmsJspNavElement e=(CmsJspNavElement)it.next();
      e.setNavPosition(pos);
      if (e.getResourceName().startsWith(nextfolder))       parentcount=pos;
    }
    if (parentcount == 0)     parentcount=pos;
  }
  return result;
}
