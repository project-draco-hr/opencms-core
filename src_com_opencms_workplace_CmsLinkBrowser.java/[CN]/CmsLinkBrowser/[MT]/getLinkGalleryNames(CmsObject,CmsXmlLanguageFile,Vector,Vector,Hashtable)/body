{
  int ret=-1;
  I_CmsSession session=cms.getRequestContext().getSession(true);
  String chosenFolder=(String)parameters.get(C_PARA_FOLDER);
  if (chosenFolder == null) {
    chosenFolder=(String)session.getValue(C_PARA_FOLDER);
  }
  if (chosenFolder == null) {
    chosenFolder="";
  }
  Vector folders=cms.getSubFolders(C_VFS_GALLERY_EXTERNALLINKS);
  int numFolders=folders.size();
  for (int i=0; i < numFolders; i++) {
    CmsResource currFolder=(CmsResource)folders.elementAt(i);
    String name=currFolder.getName();
    if (chosenFolder.equals(cms.readAbsolutePath(currFolder))) {
      ret=i;
    }
    values.addElement(cms.readAbsolutePath(currFolder));
    names.addElement(name);
  }
  return new Integer(ret);
}
