{
  String currentLanguage=null;
  I_CmsSession session=cms.getRequestContext().getSession(false);
  if (session != null) {
    currentLanguage=(String)session.getValue(I_CmsConstants.C_START_LANGUAGE);
  }
  if (currentLanguage == null) {
    Hashtable startSettings=(Hashtable)cms.getRequestContext().currentUser().getAdditionalInfo(I_CmsConstants.C_ADDITIONAL_INFO_STARTSETTINGS);
    if (startSettings != null) {
      currentLanguage=(String)startSettings.get(I_CmsConstants.C_START_LANGUAGE);
    }
    if (currentLanguage == null) {
      Vector language=(Vector)cms.getRequestContext().getAcceptedLanguages();
      int numlangs=language.size();
      for (int i=0; i < numlangs; i++) {
        String lang=(String)language.elementAt(i);
        try {
          cms.readFolder(I_CmsWpConstants.C_VFS_PATH_LOCALES + lang);
          currentLanguage=lang;
          break;
        }
 catch (        CmsException e) {
        }
      }
    }
    if (currentLanguage == null) {
      currentLanguage=I_CmsWpConstants.C_DEFAULT_LANGUAGE;
    }
    if (session != null) {
      session.putValue(I_CmsConstants.C_START_LANGUAGE,currentLanguage);
    }
  }
  return currentLanguage;
}
