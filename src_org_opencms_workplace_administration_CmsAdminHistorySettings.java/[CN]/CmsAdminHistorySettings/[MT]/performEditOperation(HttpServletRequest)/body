{
  String paramEnabled=request.getParameter("enable");
  String paramVersions=request.getParameter("versions");
  boolean enabled=Boolean.valueOf(paramEnabled).booleanValue();
  int versions=0;
  try {
    versions=Integer.parseInt(paramVersions);
  }
 catch (  NumberFormatException e) {
    throw new CmsException("No integer value entered",CmsException.C_BAD_NAME,e);
  }
  if (versions < 1) {
    throw new CmsException("The entered version value must not be smaller than 1",CmsException.C_BAD_NAME);
  }
  OpenCms.getSystemInfo().setVersionHistorySettings(enabled,versions);
  OpenCms.writeConfiguration(CmsSystemConfiguration.class);
  return true;
}
