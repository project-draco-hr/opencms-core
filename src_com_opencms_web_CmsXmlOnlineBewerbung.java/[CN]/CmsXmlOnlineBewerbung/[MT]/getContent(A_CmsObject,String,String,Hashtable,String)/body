{
  System.err.println("1:");
  String errorMessage="";
  String text=destroyCmsXmlTag((String)parameters.get(C_TEXT));
  String certificates=destroyCmsXmlTag((String)parameters.get(C_FILE1));
  String certificatesContent=destroyCmsXmlTag((String)parameters.get(C_FILE1_CONTENT));
  String oldPosition=destroyCmsXmlTag((String)parameters.get(C_OLDPOSITION));
  String newPosition=destroyCmsXmlTag((String)parameters.get(C_NEWPOSITION));
  String base=destroyCmsXmlTag((String)parameters.get(C_BASE));
  String entry=destroyCmsXmlTag((String)parameters.get(C_ENTRY));
  String salary=destroyCmsXmlTag((String)parameters.get(C_SALARY));
  String how=destroyCmsXmlTag((String)parameters.get(C_HOW));
  String anrede=destroyCmsXmlTag((String)parameters.get(C_ANREDE));
  String titel=destroyCmsXmlTag((String)parameters.get(C_TITEL));
  String firstname=destroyCmsXmlTag((String)parameters.get(C_FIRSTNAME));
  String surname=destroyCmsXmlTag((String)parameters.get(C_SURNAME));
  String birthdate=destroyCmsXmlTag((String)parameters.get(C_BIRTHDATE));
  String citizen=destroyCmsXmlTag((String)parameters.get(C_CITIZEN));
  String family=destroyCmsXmlTag((String)parameters.get(C_FAMILY));
  String co=destroyCmsXmlTag((String)parameters.get(C_CO));
  String street=destroyCmsXmlTag((String)parameters.get(C_STREET));
  String plz=destroyCmsXmlTag((String)parameters.get(C_PLZ));
  String city=destroyCmsXmlTag((String)parameters.get(C_CITY));
  String companyFon=destroyCmsXmlTag((String)parameters.get(C_COMPANYFON));
  String privateFon=destroyCmsXmlTag((String)parameters.get(C_PRIVATEFON));
  String mobileFon=destroyCmsXmlTag((String)parameters.get(C_MOBILEFON));
  String fax=destroyCmsXmlTag((String)parameters.get(C_FAX));
  String email=destroyCmsXmlTag((String)parameters.get(C_EMAIL));
  String url=destroyCmsXmlTag((String)parameters.get(C_URL));
  if (!certificates.toLowerCase().trim().equals("unknown")) {
    certificates="";
  }
  System.err.println("2:");
  String errorNumber=destroyCmsXmlTag((String)parameters.get(C_ERRORNUMBER));
  String action=destroyCmsXmlTag((String)parameters.get(C_ACTION));
  text=(text == null ? "" : text);
  certificates=(certificates == null ? "" : certificates);
  certificatesContent=(certificatesContent == null ? "" : certificatesContent);
  oldPosition=(oldPosition == null ? "" : oldPosition);
  newPosition=(newPosition == null ? "" : newPosition);
  base=(base == null ? "" : base);
  entry=(entry == null ? "" : entry);
  salary=(salary == null ? "" : salary);
  how=(how == null ? "" : how);
  anrede=(anrede == null ? "" : anrede);
  titel=(titel == null ? "" : titel);
  firstname=(firstname == null ? "" : firstname);
  surname=(surname == null ? "" : surname);
  birthdate=(birthdate == null ? "" : birthdate);
  citizen=(citizen == null ? "" : citizen);
  family=(family == null ? "" : family);
  co=(co == null ? "" : co);
  street=(street == null ? "" : street);
  plz=(plz == null ? "" : plz);
  city=(city == null ? "" : city);
  companyFon=(companyFon == null ? "" : companyFon);
  privateFon=(privateFon == null ? "" : privateFon);
  mobileFon=(mobileFon == null ? "" : mobileFon);
  fax=(fax == null ? "" : fax);
  email=(email == null ? "" : email);
  url=(url == null ? "" : url);
  errorNumber=(errorNumber == null ? "" : errorNumber);
  action=(action == null ? "" : action);
  System.err.println("3:");
  CmsXmlOnlineBewerbungContentDefinition datablock=null;
  System.err.println("4:");
  if (newPosition.equals("")) {
    newPosition=decodeField(datablock.getNewPosition(1));
  }
  System.err.println("5:");
  for (int i=1; i < 41; i++) {
    if (newPosition.equals(decodeField(datablock.getNewPosition(i)))) {
      datablock.setSelected(i,"selected");
    }
 else {
      datablock.setSelected(i,"");
    }
  }
  System.err.println("6:");
  if (base.equals("")) {
    base=decodeField(datablock.getBase(1));
  }
  System.err.println("7:");
  for (int i=1; i < 41; i++) {
    if (base.equals(decodeField(datablock.getBase(i)))) {
      datablock.setSelected(i,"selected");
    }
 else {
      datablock.setSelected(i,"");
    }
  }
  System.err.println("8:");
  if (how.equals("")) {
    how=decodeField(datablock.getHow(1));
  }
  System.err.println("9:");
  for (int i=1; i < 41; i++) {
    if (how.equals(decodeField(datablock.getHow(i)))) {
      datablock.setSelected(i,"selected");
    }
 else {
      datablock.setSelected(i,"");
    }
  }
  System.err.println("10:");
  if (anrede.equals("")) {
    anrede=decodeField(datablock.getAnrede(1));
  }
  System.err.println("11:");
  for (int i=1; i < 41; i++) {
    if (anrede.equals(decodeField(datablock.getAnrede(i)))) {
      datablock.setSelected(i,"selected");
    }
 else {
      datablock.setSelected(i,"");
    }
  }
  System.err.println("12:");
  if (family.equals("")) {
    family=decodeField(datablock.getFamily(1));
  }
  System.err.println("13:");
  for (int i=1; i < 41; i++) {
    if (family.equals(decodeField(datablock.getFamily(i)))) {
      datablock.setSelected(i,"selected");
    }
 else {
      datablock.setSelected(i,"");
    }
  }
  System.err.println("14:");
  datablock.setText(text);
  datablock.setCertificates(certificates);
  datablock.setOldPosition(oldPosition);
  datablock.setEntry(entry);
  datablock.setSalary(salary);
  datablock.setTitel(titel);
  datablock.setFirstname(firstname);
  datablock.setSurname(surname);
  datablock.setBirthdate(birthdate);
  datablock.setCitizen(citizen);
  datablock.setCo(co);
  datablock.setStreet(street);
  datablock.setPlz(plz);
  datablock.setCity(city);
  datablock.setCompanyFon(companyFon);
  datablock.setPrivateFon(privateFon);
  datablock.setMobileFon(mobileFon);
  datablock.setFax(fax);
  datablock.setEmail(email);
  datablock.setUrl(url);
  datablock.setAction(action);
  datablock.setErrorNumber(errorNumber);
  datablock.setErrorMessage(errorMessage);
  System.err.println("15:");
  CmsXmlTemplateFile xmlTemplateDocument=(CmsXmlTemplateFile)getOwnTemplateFile(cms,templateFile,elementName,parameters,templateSelector);
  System.err.println("16:");
  if (action.equals("sendMail")) {
    errorMessage=formIsCorrect(parameters);
    if (!errorMessage.equals("")) {
      errorNumber=new Integer((new Integer(errorNumber).intValue()) - 1).toString();
      datablock.setErrorNumber(errorNumber);
      datablock.setErrorMessage(datablock.getError(errorMessage));
      return startProcessing(cms,xmlTemplateDocument,elementName,parameters,null);
    }
 else {
      certificates=saveFile(certificates,certificatesContent);
      HttpServletRequest req=(HttpServletRequest)cms.getRequestContext().getRequest().getOriginalRequest();
      Hashtable mailInfo=null;
      mailInfo.put(C_HASH_TEXT,(text.equals("") ? "nicht angegeben" : text));
      mailInfo.put(C_HASH_CERTIFICATES,(certificates.equals("") ? "nicht angegeben" : certificates));
      mailInfo.put(C_HASH_OLDPOSITION,(oldPosition.equals("") ? "nicht angegeben" : oldPosition));
      mailInfo.put(C_HASH_NEWPOSITION,((newPosition.equals("") || newPosition.equals("Bitte ausw?hlen")) ? "nicht angegeben" : newPosition));
      mailInfo.put(C_HASH_BASE,((base.equals("") || base.equals("Bitte ausw?hlen")) ? "nicht angegeben" : base));
      mailInfo.put(C_HASH_ENTRY,(entry.equals("") ? "nicht angegeben" : entry));
      mailInfo.put(C_HASH_SALARY,(salary.equals("") ? "nicht angegeben" : salary));
      mailInfo.put(C_HASH_HOW,((how.equals("") || how.equals("Bitte ausw?hlen")) ? "nicht angegeben" : how));
      mailInfo.put(C_HASH_ANREDE,((anrede.equals("") || anrede.equals("Bitte ausw?hlen")) ? "nicht angegeben" : anrede));
      mailInfo.put(C_HASH_TITEL,(titel.equals("") ? "nicht angegeben" : titel));
      mailInfo.put(C_HASH_FIRSTNAME,(firstname.equals("") ? "nicht angegeben" : firstname));
      mailInfo.put(C_HASH_SURNAME,(surname.equals("") ? "nicht angegeben" : surname));
      mailInfo.put(C_HASH_BIRTHDATE,(birthdate.equals("") ? "nicht angegeben" : birthdate));
      mailInfo.put(C_HASH_CITIZEN,(citizen.equals("") ? "nicht angegeben" : citizen));
      mailInfo.put(C_HASH_FAMILY,((family.equals("") || family.equals("Bitte ausw?hlen")) ? "nicht angegeben" : family));
      mailInfo.put(C_HASH_CO,(co.equals("") ? "nicht angegeben" : co));
      mailInfo.put(C_HASH_STREET,(street.equals("") ? "nicht angegeben" : street));
      mailInfo.put(C_HASH_PLZ,(plz.equals("") ? "nicht angegeben" : plz));
      mailInfo.put(C_HASH_CITY,(city.equals("") ? "nicht angegeben" : city));
      mailInfo.put(C_HASH_COMPANYFON,(companyFon.equals("") ? "nicht angegeben" : companyFon));
      mailInfo.put(C_HASH_PRIVATEFON,(privateFon.equals("") ? "nicht angegeben" : privateFon));
      mailInfo.put(C_HASH_MOBILEFON,(mobileFon.equals("") ? "nicht angegeben" : mobileFon));
      mailInfo.put(C_HASH_FAX,(fax.equals("") ? "nicht angegeben" : fax));
      mailInfo.put(C_HASH_EMAIL,(email.equals("") ? "nicht angegeben" : email));
      mailInfo.put(C_HASH_URL,(url.equals("") ? "nicht angegeben" : url));
      mailInfo.put(C_HASH_IP,req.getRemoteAddr());
      datablock.setText((String)mailInfo.get(C_HASH_TEXT));
      datablock.setCertificates((String)mailInfo.get(C_HASH_CERTIFICATES));
      datablock.setOldPosition((String)mailInfo.get(C_HASH_OLDPOSITION));
      datablock.setNewPosition((String)mailInfo.get(C_HASH_NEWPOSITION));
      datablock.setBase((String)mailInfo.get(C_HASH_BASE));
      datablock.setEntry((String)mailInfo.get(C_HASH_ENTRY));
      datablock.setHow((String)mailInfo.get(C_HASH_HOW));
      datablock.setSalary((String)mailInfo.get(C_HASH_SALARY));
      datablock.setAnrede((String)mailInfo.get(C_HASH_ANREDE));
      datablock.setTitel((String)mailInfo.get(C_HASH_TITEL));
      datablock.setFirstname((String)mailInfo.get(C_HASH_FIRSTNAME));
      datablock.setSurname((String)mailInfo.get(C_HASH_SURNAME));
      datablock.setBirthdate((String)mailInfo.get(C_HASH_BIRTHDATE));
      datablock.setCitizen((String)mailInfo.get(C_HASH_CITIZEN));
      datablock.setFamily((String)mailInfo.get(C_HASH_FAMILY));
      datablock.setCo((String)mailInfo.get(C_HASH_CO));
      datablock.setStreet((String)mailInfo.get(C_HASH_STREET));
      datablock.setPlz((String)mailInfo.get(C_HASH_PLZ));
      datablock.setCity((String)mailInfo.get(C_HASH_CITY));
      datablock.setCompanyFon((String)mailInfo.get(C_HASH_COMPANYFON));
      datablock.setPrivateFon((String)mailInfo.get(C_HASH_PRIVATEFON));
      datablock.setMobileFon((String)mailInfo.get(C_HASH_MOBILEFON));
      datablock.setFax((String)mailInfo.get(C_HASH_FAX));
      datablock.setEmail((String)mailInfo.get(C_HASH_EMAIL));
      datablock.setUrl((String)mailInfo.get(C_HASH_URL));
      Hashtable mailTable=null;
      String from=(String)datablock.getFrom();
      String an=(String)datablock.getTo();
      String cc=(String)datablock.getCc();
      String bcc=(String)datablock.getBcc();
      String host=(String)datablock.getMailserver();
      String subject=(String)datablock.getSubject();
      String content=(String)datablock.getBewerbungsText(mailInfo);
      mailTable.put(C_HASH_CERTIFICATES,certificates);
      mailTable.put(C_HASH_FROM,from);
      mailTable.put(C_HASH_AN,an);
      mailTable.put(C_HASH_CC,cc);
      mailTable.put(C_HASH_BCC,bcc);
      mailTable.put(C_HASH_HOST,host);
      mailTable.put(C_HASH_SUBJECT,subject);
      mailTable.put(C_HASH_CONTENT,content);
      writeInDatabase(mailInfo);
      CmsXmlMailThread mail=new CmsXmlMailThread(mailTable);
      mail.start();
      return startProcessing(cms,xmlTemplateDocument,elementName,parameters,"Answer");
    }
  }
  System.err.println("17:");
  datablock.setErrorNumber("-2");
  datablock.setAction("sendMail");
  datablock.setErrorMessage("");
  return startProcessing(cms,xmlTemplateDocument,elementName,parameters,null);
}
