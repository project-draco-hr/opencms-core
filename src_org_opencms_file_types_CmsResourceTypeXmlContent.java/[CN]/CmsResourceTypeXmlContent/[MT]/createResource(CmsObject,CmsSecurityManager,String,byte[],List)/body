{
  if ((m_schema != null) && ((content == null) || (content.length == 0))) {
    CmsXmlContentDefinition contentDefinition=CmsXmlContentDefinition.unmarshal(cms,m_schema);
    Locale locale=(Locale)OpenCms.getLocaleManager().getDefaultLocales(cms,CmsResource.getParentFolder(resourcename)).get(0);
    CmsXmlContent newContent=CmsXmlContentFactory.createDocument(cms,locale,OpenCms.getSystemInfo().getDefaultEncoding(),contentDefinition);
    content=newContent.marshal();
  }
  CmsResource resource=securityManager.createResource(cms.getRequestContext(),cms.getRequestContext().addSiteRoot(resourcename),getTypeId(),content,properties);
  return resource;
}
