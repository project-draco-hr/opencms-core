{
  driverManager.checkPermissions(cms.getRequestContext(),resource,CmsPermissionSet.ACCESS_WRITE,true,CmsResourceFilter.ALL);
  CmsXmlContent xmlContent=CmsXmlContentFactory.unmarshal(cms,resource,false);
  xmlContent.validateXmlStructure(new CmsXmlEntityResolver(cms));
  String contentConversion=CmsHtmlConverter.getConversionSettings(cms,resource);
  xmlContent.setConversion(contentConversion);
  resource=xmlContent.correctXmlStructure(cms);
  xmlContent.resolveElementMappings(cms);
  return super.writeFile(cms,driverManager,resource);
}
