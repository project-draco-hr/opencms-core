{
  try {
    if (DEBUG)     System.err.println("CmsAdminModuleImportThread() started");
    String moduleName=m_moduleName.replace('\\','/');
    CmsProject currentProject=m_cms.getRequestContext().currentProject();
    CmsProject project=m_cms.createProject("ImportModule","A System generated project to import the module " + moduleName,I_CmsConstants.C_GROUP_ADMIN,I_CmsConstants.C_GROUP_ADMIN,I_CmsConstants.C_PROJECT_TYPE_TEMPORARY);
    m_cms.getRequestContext().setCurrentProject(project.getId());
    m_report.print(m_report.key("report.import_module_begin"),I_CmsReport.C_FORMAT_HEADLINE);
    m_report.println(" <i>" + moduleName + "</i>",I_CmsReport.C_FORMAT_HEADLINE);
    for (int i=0; i < m_projectFiles.size(); i++) {
      m_cms.copyResourceToProject((String)m_projectFiles.elementAt(i));
    }
    m_registry.importModule(m_zipName,m_conflictFiles,m_report);
    m_report.println(m_report.key("report.publish_project_begin"),I_CmsReport.C_FORMAT_HEADLINE);
    m_cms.unlockProject(project.getId());
    m_cms.publishProject(project.getId(),m_report);
    m_report.println(m_report.key("report.publish_project_end"),I_CmsReport.C_FORMAT_HEADLINE);
    m_report.println(m_report.key("report.import_module_end"),I_CmsReport.C_FORMAT_HEADLINE);
    if (DEBUG)     System.err.println("CmsAdminModuleImportThread() finished");
    m_cms.joinLinksToTargets(currentProject,m_report);
  }
 catch (  CmsException e) {
    m_report.println(e);
    if (I_CmsLogChannels.C_LOGGING && A_OpenCms.isLogging(I_CmsLogChannels.C_OPENCMS_CRITICAL)) {
      A_OpenCms.log(I_CmsLogChannels.C_OPENCMS_CRITICAL,e.getMessage());
    }
    if (DEBUG)     System.err.println("CmsAdminModuleImportThread() Exception:" + e.getMessage());
  }
}
