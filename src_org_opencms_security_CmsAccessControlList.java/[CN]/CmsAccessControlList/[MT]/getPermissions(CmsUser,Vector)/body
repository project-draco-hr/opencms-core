{
  CmsPermissionSet sum=new CmsPermissionSet();
  ListIterator pIterator=null;
  if (groups != null) {
    pIterator=groups.listIterator();
  }
  I_CmsPrincipal principal=user;
  do {
    CmsPermissionSet permissions=(CmsPermissionSet)m_permissions.get(principal.getId());
    if (permissions != null) {
      sum.addPermissions(permissions);
    }
    if (pIterator != null && pIterator.hasNext()) {
      principal=(I_CmsPrincipal)pIterator.next();
    }
 else {
      principal=null;
    }
  }
 while (principal != null);
  return sum;
}
