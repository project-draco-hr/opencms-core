{
  List<CmsSite> sites=OpenCms.getSiteManager().getAvailableSites(cms,true,true,cms.getRequestContext().getOuFqn());
  IndexedContainer availableSites=new IndexedContainer();
  availableSites.addContainerProperty(captionPropertyName,String.class,null);
  Locale locale=A_CmsUI.get().getLocale();
  for (  CmsSite site : sites) {
    Item siteItem=availableSites.addItem(site.getSiteRoot());
    String title=CmsWorkplace.substituteSiteTitleStatic(site.getTitle(),locale);
    if (CmsStringUtil.isEmptyOrWhitespaceOnly(title)) {
      title=site.getSiteRoot();
    }
    siteItem.getItemProperty(captionPropertyName).setValue(title);
  }
  String currentSiteRoot=cms.getRequestContext().getSiteRoot();
  if (!availableSites.containsId(currentSiteRoot)) {
    availableSites.addItem(currentSiteRoot).getItemProperty(captionPropertyName).setValue(currentSiteRoot);
  }
  return availableSites;
}
