{
  PreparedStatement stmt=null;
  Connection conn=null;
  try {
    conn=m_sqlManager.getConnection();
    stmt=m_sqlManager.getPreparedStatement(conn,"C_ORACLE_USERS_WRITE");
    stmt.setString(1,m_sqlManager.validateEmpty(user.getDescription()));
    stmt.setString(2,m_sqlManager.validateEmpty(user.getFirstname()));
    stmt.setString(3,m_sqlManager.validateEmpty(user.getLastname()));
    stmt.setString(4,m_sqlManager.validateEmpty(user.getEmail()));
    stmt.setTimestamp(5,new Timestamp(user.getLastlogin()));
    stmt.setTimestamp(6,new Timestamp(0));
    stmt.setInt(7,user.getFlags());
    stmt.setString(8,user.getDefaultGroupId().toString());
    stmt.setString(9,m_sqlManager.validateEmpty(user.getAddress()));
    stmt.setString(10,m_sqlManager.validateEmpty(user.getSection()));
    stmt.setInt(11,user.getType());
    stmt.setString(12,user.getId().toString());
    stmt.executeUpdate();
    stmt.close();
    stmt=null;
    internalWriteUserInfo(user.getId(),user.getAdditionalInfo(),null);
  }
 catch (  SQLException e) {
    throw m_sqlManager.getCmsException(this,"writeUser name=" + user.getName() + " id="+ user.getId().toString(),CmsException.C_SQL_ERROR,e,false);
  }
 finally {
    m_sqlManager.closeAll(conn,stmt,null);
  }
}
