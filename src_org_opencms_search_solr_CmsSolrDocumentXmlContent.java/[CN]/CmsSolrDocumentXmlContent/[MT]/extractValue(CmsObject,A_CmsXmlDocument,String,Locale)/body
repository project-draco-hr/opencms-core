{
  StringBuffer valueExtraction=new StringBuffer();
  List<I_CmsXmlContentValue> values=xmlContent.getValues(xpath,locale);
  Iterator<I_CmsXmlContentValue> it=values.iterator();
  while (it.hasNext()) {
    I_CmsXmlContentValue value=it.next();
    try {
      String extracted=value.getPlainText(cms);
      if (value.isSimpleType()) {
        if (CmsStringUtil.isEmptyOrWhitespaceOnly(extracted)) {
          extracted=value.getStringValue(cms);
        }
        if (CmsStringUtil.isNotEmptyOrWhitespaceOnly(extracted)) {
          valueExtraction.append(extracted);
          if (it.hasNext()) {
            valueExtraction.append('\n');
          }
        }
      }
    }
 catch (    Exception e) {
      throw new CmsException(Messages.get().container(Messages.ERR_TEXT_EXTRACTION_1,xmlContent.getFile()),e);
    }
  }
  return valueExtraction.toString();
}
