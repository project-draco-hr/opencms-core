{
  FormPanel form=new FormPanel();
  form.setAction(getUploadUri());
  form.setEncoding(FormPanel.ENCODING_MULTIPART);
  form.setMethod(FormPanel.METHOD_POST);
  FlowPanel inputFieldsPanel=new FlowPanel();
  int count=0;
  for (  CmsFileInput input : m_inputsToUpload.values()) {
    String filename=input.getFiles()[0].getFileName();
    String fieldName="file_" + count++;
    input.setName(fieldName);
    if (getFilesToUpload().containsKey(filename)) {
      inputFieldsPanel.add(input);
    }
    addHiddenField(inputFieldsPanel,fieldName + I_CmsUploadConstants.UPLOAD_FILENAME_ENCODED_SUFFIX,URL.encode(filename));
  }
  for (  String filename : getFilesToUnzip(false)) {
    addHiddenField(inputFieldsPanel,I_CmsUploadConstants.UPLOAD_UNZIP_FILES_FIELD_NAME,URL.encode(filename));
  }
  addHiddenField(inputFieldsPanel,I_CmsUploadConstants.UPLOAD_TARGET_FOLDER_FIELD_NAME,getTargetFolder());
  form.setWidget(inputFieldsPanel);
  return form;
}
