{
  try {
    CmsObject cms=getCmsObject();
    if (CmsStringUtil.isNotEmptyOrWhitespaceOnly(siteRoot)) {
      cms=OpenCms.initCmsObject(cms);
      cms.getRequestContext().setSiteRoot(siteRoot);
    }
    if (CmsStringUtil.isEmptyOrWhitespaceOnly(path)) {
      path="/";
    }
    CmsJspNavBuilder navBuilder=new CmsJspNavBuilder(cms);
    List<CmsSitemapEntryBean> result=new ArrayList<CmsSitemapEntryBean>();
    for (    CmsJspNavElement navElement : navBuilder.getNavigationForFolder(path,Visibility.all,CmsResourceFilter.ONLY_VISIBLE)) {
      if (navElement.isInNavigation()) {
        result.add(prepareSitemapEntry(cms,navElement,false));
      }
    }
    if (isRoot) {
      CmsJspNavElement navElement=navBuilder.getNavigationForResource(path,CmsResourceFilter.ONLY_VISIBLE);
      CmsSitemapEntryBean root=prepareSitemapEntry(cms,navElement,isRoot);
      root.setChildren(result);
      return Collections.singletonList(root);
    }
    return result;
  }
 catch (  Throwable e) {
    error(e);
  }
  return null;
}
