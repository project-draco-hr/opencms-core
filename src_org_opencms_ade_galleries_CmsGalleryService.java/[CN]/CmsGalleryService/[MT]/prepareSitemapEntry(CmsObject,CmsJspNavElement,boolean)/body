{
  CmsResource ownResource=navElement.getResource();
  CmsResource defaultFileResource=null;
  if (ownResource.isFolder() && !navElement.isNavigationLevel()) {
    defaultFileResource=cms.readDefaultFile(ownResource,CmsResourceFilter.ONLY_VISIBLE);
  }
  String type;
  if (defaultFileResource != null) {
    type=OpenCms.getResourceManager().getResourceType(defaultFileResource.getTypeId()).getTypeName();
  }
 else {
    type=OpenCms.getResourceManager().getResourceType(ownResource.getTypeId()).getTypeName();
  }
  String title=null;
  if (CmsStringUtil.isNotEmptyOrWhitespaceOnly(navElement.getProperty(CmsPropertyDefinition.PROPERTY_NAVTEXT))) {
    title=navElement.getProperty(CmsPropertyDefinition.PROPERTY_NAVTEXT);
  }
 else   if (CmsStringUtil.isNotEmptyOrWhitespaceOnly(navElement.getProperty(CmsPropertyDefinition.PROPERTY_TITLE))) {
    title=navElement.getProperty(CmsPropertyDefinition.PROPERTY_TITLE);
  }
 else {
    title=navElement.getFileName();
    if (title.contains("/")) {
      title=title.substring(0,title.indexOf("/"));
    }
  }
  CmsSitemapEntryBean result=new CmsSitemapEntryBean(navElement.getResource().getRootPath(),navElement.getResourceName(),ownResource.getStructureId(),title,type,ownResource.isFolder(),isRoot,navElement.isHiddenNavigationEntry());
  result.setSiteRoot(OpenCms.getSiteManager().getSiteRoot(ownResource.getRootPath()));
  return result;
}
