{
  if (OpenCms.getRunLevel() > 1) {
    if ((cms == null) || !cms.isAdmin()) {
      throw new CmsSecurityException(CmsSecurityException.C_SECURITY_ADMIN_PRIVILEGES_REQUIRED);
    }
  }
  m_jobCount++;
  JobDetail jobDetail=new JobDetail("cmsJob" + m_jobCount,Scheduler.DEFAULT_GROUP,CmsScheduledJob.class);
  CronTrigger trigger=new CronTrigger("cmsTrigger" + m_jobCount,Scheduler.DEFAULT_GROUP);
  try {
    Class.forName(entry.getClassName());
  }
 catch (  ClassNotFoundException e) {
    OpenCms.getLog(this).error("Scheduler: Class not found '" + entry.getClassName() + "'",e);
    return;
  }
  try {
    trigger.setCronExpression(entry.getCronExpression());
  }
 catch (  ParseException e) {
    OpenCms.getLog(this).error("Scheduler: Bad cron expression '" + entry.getCronExpression() + "'",e);
    return;
  }
  JobDataMap jobData=new JobDataMap();
  jobData.put(CmsScheduledJob.C_SCHEDULER_JOB_ENTRY,entry);
  jobDetail.setJobDataMap(jobData);
  try {
    m_scheduler.scheduleJob(jobDetail,trigger);
  }
 catch (  SchedulerException e) {
    OpenCms.getLog(this).error("Scheduler: Could not schedule job for class '" + entry.getClassName() + "'",e);
    return;
  }
  m_jobEntries.add(entry);
  if (OpenCms.getLog(this).isInfoEnabled()) {
    OpenCms.getLog(this).info("Scheduled job " + m_jobEntries.size() + " for class '"+ entry.getClassName()+ "' with user '"+ entry.getUserName());
  }
}
