{
  OpenCms.getRoleManager().checkRole(cms,CmsRole.WORKPLACE_MANAGER);
  try {
    m_adminCms=OpenCms.initCmsObject(cms);
  }
 catch (  CmsException e) {
  }
  m_adminCms.getRequestContext().setSiteRoot("/");
  m_extractionResultCache=new CmsExtractionResultCache(OpenCms.getSystemInfo().getAbsoluteRfsPathRelativeToWebInf(getDirectory()),"/extractCache");
  if (m_solrConfig != null) {
    try {
      DetectorFactory.loadProfile(m_solrConfig.getLanguageProfileFolder());
    }
 catch (    LangDetectException e) {
      LOG.error(Messages.get().getBundle().key(Messages.LOG_LANGUAGE_DETECTION_INIT_FAILED_1,m_solrConfig.getLanguageProfileFolder()),e);
    }
  }
  initializeIndexes();
  initOfflineIndexes();
  Similarity.setDefault(new CmsSearchSimilarity());
  OpenCms.addCmsEventListener(this,new int[]{I_CmsEventListener.EVENT_CLEAR_CACHES,I_CmsEventListener.EVENT_PUBLISH_PROJECT,I_CmsEventListener.EVENT_REBUILD_SEARCHINDEXES});
}
