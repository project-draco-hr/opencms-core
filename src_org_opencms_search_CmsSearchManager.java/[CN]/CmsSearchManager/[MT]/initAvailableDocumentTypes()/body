{
  CmsSearchDocumentType documenttype=null;
  String className=null;
  String name=null;
  I_CmsDocumentFactory documentFactory=null;
  List resourceTypes=null;
  List mimeTypes=null;
  Class c=null;
  String resourceType=null;
  String resourceTypeId=null;
  m_documentTypes=new HashMap();
  List keys=new ArrayList(m_documentTypeConfigs.keySet());
  for (int i=0, n=keys.size(); i < n; i++) {
    documenttype=(CmsSearchDocumentType)(m_documentTypeConfigs.get(keys.get(i)));
    name=documenttype.getName();
    try {
      className=documenttype.getClassName();
      resourceTypes=documenttype.getResourceTypes();
      mimeTypes=documenttype.getMimeTypes();
      if (name == null) {
        throw new CmsIndexException("[" + this.getClass().getName() + "] "+ "No name defined for documenttype");
      }
      if (className == null) {
        throw new CmsIndexException("[" + this.getClass().getName() + "] "+ "No class defined for documenttype");
      }
      if (resourceTypes.size() == 0) {
        throw new CmsIndexException("[" + this.getClass().getName() + "] "+ "No resourcetype/moduletype defined for documenttype");
      }
      try {
        c=Class.forName(className);
        documentFactory=(I_CmsDocumentFactory)c.getConstructor(new Class[]{m_cms.getClass(),String.class}).newInstance(new Object[]{m_cms,name});
      }
 catch (      ClassNotFoundException exc) {
        throw new CmsIndexException("[" + this.getClass().getName() + "] "+ "Documentclass "+ className+ " not found",exc);
      }
catch (      Exception exc) {
        throw new CmsIndexException("[" + this.getClass().getName() + "] "+ "Instanciation of documentclass "+ className+ " failed",exc);
      }
      for (int j=0, m=resourceTypes.size(); j < m; j++) {
        resourceType=(String)resourceTypes.get(j);
        resourceTypeId=null;
        try {
          resourceTypeId=documentFactory.getDocumentKey(resourceType);
        }
 catch (        Exception exc) {
          throw new CmsIndexException("[" + this.getClass().getName() + "] "+ "Instanciation of resource type '"+ resourceType+ "' failed",exc);
        }
        if (mimeTypes.size() > 0) {
          for (int k=0, l=mimeTypes.size(); k < l; k++) {
            String mimeType=(String)mimeTypes.get(k);
            if (OpenCms.getLog(this).isDebugEnabled()) {
              OpenCms.getLog(this).debug("Configured document class: " + className + " for "+ resourceType+ ":"+ mimeType);
            }
            m_documentTypes.put(resourceTypeId + ":" + mimeType,documentFactory);
          }
        }
 else {
          m_documentTypes.put(resourceTypeId + "",documentFactory);
        }
      }
    }
 catch (    CmsException e) {
      if (OpenCms.getLog(this).isWarnEnabled()) {
        OpenCms.getLog(this).warn("Configuration of documenttype " + name + " failed",e);
      }
    }
  }
}
