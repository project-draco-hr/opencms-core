{
  Analyzer analyzer=null;
  String className=null;
  CmsSearchAnalyzer analyzerConf=m_analyzers.get(locale);
  if (analyzerConf == null) {
    throw new CmsSearchException(Messages.get().container(Messages.ERR_ANALYZER_NOT_FOUND_1,locale));
  }
  try {
    className=analyzerConf.getClassName();
    Class<?> analyzerClass=Class.forName(className);
    if (StandardAnalyzer.class.equals(analyzerClass)) {
      analyzer=new StandardAnalyzer(Version.LUCENE_CURRENT);
    }
 else     if (CmsGallerySearchAnalyzer.class.equals(analyzerClass)) {
      analyzer=new CmsGallerySearchAnalyzer(Version.LUCENE_CURRENT);
    }
 else     if (SnowballAnalyzer.class.equals(analyzerClass)) {
      analyzer=new SnowballAnalyzer(Version.LUCENE_CURRENT,analyzerConf.getStemmerAlgorithm());
    }
 else {
      boolean hasEmpty=false;
      boolean hasVersion=false;
      Constructor<?>[] constructors=analyzerClass.getConstructors();
      for (int i=0; i < constructors.length; i++) {
        Constructor<?> c=constructors[i];
        Class<?>[] parameters=c.getParameterTypes();
        if (parameters.length == 0) {
          hasEmpty=true;
        }
        if ((parameters.length == 1) && parameters[0].equals(Version.class)) {
          hasVersion=true;
        }
        if (hasVersion) {
          analyzer=(Analyzer)analyzerClass.getDeclaredConstructor(new Class[]{Version.class}).newInstance(Version.LUCENE_CURRENT);
        }
 else         if (hasEmpty) {
          analyzer=(Analyzer)analyzerClass.newInstance();
        }
      }
    }
  }
 catch (  Exception e) {
    throw new CmsSearchException(Messages.get().container(Messages.ERR_LOAD_ANALYZER_1,className),e);
  }
  return analyzer;
}
