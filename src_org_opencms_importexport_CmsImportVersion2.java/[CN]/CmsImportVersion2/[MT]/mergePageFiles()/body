{
  try {
    m_cms.readPropertydefinition(I_CmsConstants.C_PROPERTY_TEMPLATE);
  }
 catch (  CmsException e) {
    m_cms.createPropertydefinition(I_CmsConstants.C_PROPERTY_TEMPLATE);
  }
  List definitions=m_cms.readAllPropertydefinitions();
  Iterator j=definitions.iterator();
  while (j.hasNext()) {
    CmsPropertydefinition definition=(CmsPropertydefinition)j.next();
    try {
      m_cms.readPropertydefinition(definition.getName());
    }
 catch (    Exception e) {
      m_cms.createPropertydefinition(definition.getName());
    }
  }
  int size=m_pageStorage.size();
  m_report.println(m_report.key("report.merge_start"),I_CmsReport.C_FORMAT_HEADLINE);
  Iterator i=m_pageStorage.iterator();
  int counter=1;
  while (i.hasNext()) {
    String resname=(String)i.next();
    if (!resname.startsWith("/")) {
      resname="/" + resname;
    }
    m_report.print("( " + counter + " / "+ size+ " ) ",I_CmsReport.C_FORMAT_NOTE);
    m_report.print(m_report.key("report.merge") + " ",I_CmsReport.C_FORMAT_NOTE);
    m_report.print(resname,I_CmsReport.C_FORMAT_DEFAULT);
    try {
      mergePageFile(resname);
    }
 catch (    Exception e) {
      m_report.println(e);
    }
    counter++;
  }
  m_pageStorage.clear();
}
