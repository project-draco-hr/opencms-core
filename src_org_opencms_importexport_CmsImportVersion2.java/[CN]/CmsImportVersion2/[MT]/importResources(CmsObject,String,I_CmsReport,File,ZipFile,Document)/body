{
  initialize();
  m_cms=cms;
  m_importPath=importPath;
  m_report=report;
  m_importResource=importResource;
  m_importZip=importZip;
  m_docXml=docXml;
  m_importingChannelData=false;
  m_folderStorage=new ArrayList();
  m_pageStorage=new ArrayList();
  m_linkStorage=new HashMap();
  m_linkPropertyStorage=new HashMap();
  if (OpenCms.getRunLevel() >= OpenCms.RUNLEVEL_3_SHELL_ACCESS) {
    if ((OpenCms.getMemoryMonitor() != null) && OpenCms.getMemoryMonitor().enabled()) {
      OpenCms.getMemoryMonitor().register(this.getClass().getName() + ".m_folderStorage",m_folderStorage);
      OpenCms.getMemoryMonitor().register(this.getClass().getName() + ".m_pageStorage",m_pageStorage);
      OpenCms.getMemoryMonitor().register(this.getClass().getName() + ".m_linkStorage",m_linkStorage);
      OpenCms.getMemoryMonitor().register(this.getClass().getName() + ".m_linkPropertyStorage",m_linkPropertyStorage);
    }
  }
  try {
    if (cms.hasRole(CmsRole.ACCOUNT_MANAGER)) {
      importGroups();
      importUsers();
    }
    importAllResources();
    convertPointerToSiblings();
  }
  finally {
    cleanUp();
  }
}
