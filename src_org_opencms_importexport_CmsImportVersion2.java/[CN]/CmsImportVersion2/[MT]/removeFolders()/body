{
  try {
    int size=m_folderStorage.size();
    m_report.println(m_report.key("report.delfolder_start"),I_CmsReport.C_FORMAT_HEADLINE);
    int counter=1;
    for (int j=(size - 1); j >= 0; j--) {
      String resname=(String)m_folderStorage.get(j);
      resname=(resname.startsWith("/") ? "" : "/") + resname + (resname.endsWith("/") ? "" : "/");
      List files=m_cms.getFilesInFolder(resname,CmsResourceFilter.IGNORE_EXPIRATION);
      if (files.size() == 0) {
        List folders=m_cms.getSubFolders(resname,CmsResourceFilter.IGNORE_EXPIRATION);
        if (folders.size() == 0) {
          m_report.print("( " + counter + " / "+ size+ " ) ",I_CmsReport.C_FORMAT_NOTE);
          m_report.print(m_report.key("report.delfolder") + " ",I_CmsReport.C_FORMAT_NOTE);
          m_report.print(resname,I_CmsReport.C_FORMAT_DEFAULT);
          m_cms.lockResource(resname);
          m_cms.deleteResource(resname,I_CmsConstants.C_DELETE_OPTION_PRESERVE_SIBLINGS);
          m_report.println(m_report.key("report.ok"),I_CmsReport.C_FORMAT_OK);
          counter++;
        }
      }
    }
  }
 catch (  CmsException e) {
    CmsMessageContainer message=Messages.get().container(Messages.ERR_IMPORTEXPORT_ERROR_REMOVING_FOLDERS_OF_IMPORTED_BODY_FILES_0);
    if (LOG.isDebugEnabled()) {
      LOG.debug(message.key(),e);
    }
    throw new CmsImportExportException(message,e);
  }
}
