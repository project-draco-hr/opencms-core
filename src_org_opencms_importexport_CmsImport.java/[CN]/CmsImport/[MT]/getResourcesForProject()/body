{
  List fileNodes;
  Element currentElement;
  String destination;
  Vector resources=new Vector();
  try {
    if (m_importingChannelData) {
      m_cms.getRequestContext().saveSiteRoot();
      m_cms.getRequestContext().setSiteRoot(I_CmsConstants.VFS_FOLDER_COS);
    }
    fileNodes=m_docXml.selectNodes("//" + I_CmsConstants.C_EXPORT_TAG_FILE);
    for (int i=0; i < fileNodes.size(); i++) {
      currentElement=(Element)fileNodes.get(i);
      destination=CmsImport.getChildElementTextValue(currentElement,I_CmsConstants.C_EXPORT_TAG_DESTINATION);
      try {
        String resource=destination.substring(0,destination.indexOf("/",1) + 1);
        resource=m_importPath + resource;
        if ((!resources.contains(resource)) && (!resource.equals(m_importPath))) {
          try {
            m_cms.readFolder(resource,CmsResourceFilter.IGNORE_EXPIRATION);
            resources.addElement(resource);
          }
 catch (          CmsException exc) {
            resources.addElement(I_CmsConstants.C_ROOT);
          }
        }
      }
 catch (      StringIndexOutOfBoundsException exc) {
      }
    }
  }
 catch (  Exception exc) {
    m_report.println(exc);
    throw new CmsException(CmsException.C_UNKNOWN_EXCEPTION,exc);
  }
 finally {
    if (m_importingChannelData) {
      m_cms.getRequestContext().restoreSiteRoot();
    }
  }
  if (m_importZip != null) {
    try {
      m_importZip.close();
    }
 catch (    IOException exc) {
      m_report.println(exc);
      throw new CmsException(CmsException.C_UNKNOWN_EXCEPTION,exc);
    }
  }
  if (resources.contains(I_CmsConstants.C_ROOT)) {
    resources.removeAllElements();
    resources.addElement(I_CmsConstants.C_ROOT);
  }
  return resources;
}
