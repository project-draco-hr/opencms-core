{
  String content="<img src=\"" + iconPath + "\" />";
  if (resUtil != null) {
    if (resUtil.getResource().isFolder() && !iconPath.endsWith(CmsIconUtil.ICON_NAV_LEVEL_BIG) && !(OpenCms.getResourceManager().getResourceType(resUtil.getResource()) instanceof CmsResourceTypeFolderExtended)) {
      try {
        CmsResource defaultFile=resUtil.getCms().readDefaultFile(resUtil.getResource(),CmsResourceFilter.ONLY_VISIBLE_NO_DELETED);
        if (defaultFile != null) {
          String defaultFileIcon=null;
          if (OpenCms.getADEManager().isDetailPage(resUtil.getCms(),defaultFile)) {
            List<CmsDetailPageInfo> detailPages=OpenCms.getADEManager().getAllDetailPages(resUtil.getCms());
            for (            CmsDetailPageInfo info : detailPages) {
              if (info.getId().equals(defaultFile.getStructureId()) || info.getId().equals(resUtil.getResource().getStructureId())) {
                String type=info.getType();
                if (type.startsWith(CmsDetailPageInfo.FUNCTION_PREFIX)) {
                  type=CmsXmlDynamicFunctionHandler.TYPE_FUNCTION;
                }
                defaultFileIcon=CmsWorkplace.getResourceUri(CmsWorkplace.RES_PATH_FILETYPES + OpenCms.getWorkplaceManager().getExplorerTypeSetting(type).getIcon());
                break;
              }
            }
          }
          if (defaultFileIcon == null) {
            defaultFileIcon=CmsWorkplace.getResourceUri((new CmsResourceUtil(resUtil.getCms(),defaultFile)).getIconPathResourceType());
          }
          content+="<img src=\"" + defaultFileIcon + "\" class=\"o-icon-overlay\" />";
        }
      }
 catch (      CmsSecurityException e) {
      }
    }
    if (showLocks) {
      String lockIcon;
      String message=null;
      if (resUtil.getLock().getSystemLock().isPublish()) {
        lockIcon=OpenCmsTheme.LOCK_PUBLISH;
        message=CmsVaadinUtils.getMessageText(org.opencms.workplace.explorer.Messages.GUI_PUBLISH_TOOLTIP_0);
      }
 else {
switch (resUtil.getLockState()) {
case 1:
          lockIcon=OpenCmsTheme.LOCK_OTHER;
        break;
case 2:
      lockIcon=OpenCmsTheme.LOCK_SHARED;
    break;
case 3:
  lockIcon=OpenCmsTheme.LOCK_USER;
break;
default :
lockIcon=null;
}
if (lockIcon != null) {
message=CmsVaadinUtils.getMessageText(Messages.GUI_EXPLORER_LIST_ACTION_LOCK_NAME_2,resUtil.getLockedByName(),resUtil.getLockedInProjectName());
}
}
if (lockIcon != null) {
content+=getOverlaySpan(lockIcon,message);
}
}
}
if (state != null) {
String title=resUtil != null ? CmsVaadinUtils.getMessageText(org.opencms.workplace.commons.Messages.GUI_LABEL_USER_LAST_MODIFIED_0) + " " + resUtil.getUserLastModified() : null;
if (state.isChanged() || state.isDeleted()) {
content+=getOverlaySpan(OpenCmsTheme.STATE_CHANGED,title);
}
 else if (state.isNew()) {
content+=getOverlaySpan(OpenCmsTheme.STATE_NEW,title);
}
}
if ((resUtil != null) && (resUtil.getLinkType() == 1)) {
content+=getOverlaySpan(OpenCmsTheme.SIBLING,null);
}
return content;
}
