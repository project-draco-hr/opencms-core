{
  I_CmsSession session=CmsXmlTemplateLoader.getSession(cms.getRequestContext(),true);
  String ident="";
  int ret=-1;
  String chosenFolder=(String)parameters.get(C_PARA_FOLDER);
  if (chosenFolder == null) {
    chosenFolder=(String)session.getValue(C_PARA_FOLDER);
  }
  if (chosenFolder == null) {
    chosenFolder="";
  }
  List folders=getGallerySubFolders(cms,new ArrayList(),galleryPath);
  int numFolders=folders.size();
  for (int i=0; i < numFolders; i++) {
    CmsResource currFolder=(CmsResource)folders.get(i);
    ident="";
    String name=currFolder.getName();
    if (chosenFolder.equals(currFolder.getRootPath())) {
      ret=i;
    }
    StringTokenizer tokenizer=new StringTokenizer(currFolder.getRootPath(),"/");
    for (int j=0; j < (tokenizer.countTokens() - 4); j++) {
      ident=ident + "-";
    }
    values.addElement(currFolder.getRootPath());
    names.addElement(ident + name);
  }
  return new Integer(ret);
}
