{
  if (!(target instanceof CmsTree<?>)) {
    handler.cancel();
    return;
  }
  if (draggable instanceof CmsClipboardDeletedItem) {
    CmsClientSitemapEntry entry=((CmsClipboardDeletedItem)draggable).getEntry();
    entry.updateSitePath(m_insertPath + entry.getName() + "/");
    entry.setPosition(m_insertIndex);
    m_controller.create(entry);
  }
  if (draggable instanceof CmsSitemapTreeItem) {
    if (isChangedPosition(draggable,target,true)) {
      CmsClientSitemapEntry entry=m_controller.getEntry(((CmsSitemapTreeItem)draggable).getSitePath());
      CmsDebugLog.getInstance().printLine("inserting at " + m_insertPath + entry.getName()+ "/ and index "+ m_insertIndex);
      m_controller.move(entry,m_insertPath + entry.getName() + "/",m_insertIndex);
    }
 else {
      ((CmsSitemapTreeItem)draggable).resetEntry();
    }
  }
  if (draggable instanceof CmsResultListItem) {
    CmsResultListItem galleryItem=(CmsResultListItem)draggable;
    CmsClientSitemapEntry entry=new CmsClientSitemapEntry();
    entry.setName(galleryItem.getName());
    entry.setSitePath(m_insertPath + galleryItem.getName() + "/");
    entry.setTitle(galleryItem.getListItemWidget().getTitleLabel());
    entry.setVfsPath(galleryItem.getVfsPath());
    entry.setPosition(m_insertIndex);
    m_controller.create(entry);
  }
  DeferredCommand.addCommand(new Command(){
    /** 
 * @see com.google.gwt.user.client.Command#execute()
 */
    public void execute(){
      CmsSitemapView.getInstance().getTree().closeAllEmpty();
    }
  }
);
}
