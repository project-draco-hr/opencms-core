{
  StringBuffer retValue=new StringBuffer(1024);
  String activeTab=getActiveTabName();
  String structurePanelName=key(PANEL_STRUCTURE);
  String disabled="";
  boolean isEditable=true;
  if (!isEditable()) {
    disabled=" disabled=\"disabled\"";
    isEditable=false;
  }
  Vector propertyDef=new Vector();
  try {
    propertyDef=getPropertyDefinitions();
  }
 catch (  CmsException e) {
  }
  boolean present=false;
  if (propertyDef.size() > 0) {
    present=true;
  }
  if (present) {
    retValue.append("<table border=\"0\">\n");
    retValue.append("<tr>\n");
    retValue.append("\t<td class=\"textbold\">" + key("input.property") + "</td>\n");
    retValue.append("\t<td class=\"textbold\">" + key("label.value") + "</td>\n");
    retValue.append("\t<td class=\"textbold\" style=\"white-space: nowrap;\">" + key("input.usedproperty") + "</td>\n");
    retValue.append("</tr>\n");
    retValue.append("<tr><td colspan=\"3\"><span style=\"height: 6px;\"></span></td></tr>\n");
    Map activeProperties=null;
    if (!m_tabSwitched) {
      try {
        activeProperties=CmsPropertyAdvanced.getPropertyMap(getCms().readPropertyObjects(getParamResource(),false));
      }
 catch (      CmsException e) {
        activeProperties=new HashMap();
      }
    }
    for (int i=0; i < propertyDef.size(); i++) {
      CmsPropertydefinition currentPropertyDef=(CmsPropertydefinition)propertyDef.elementAt(i);
      String propName=CmsEncoder.escapeXml(currentPropertyDef.getName());
      String propValue="";
      String valueStructure="";
      String valueResource="";
      if (m_tabSwitched) {
        if (structurePanelName.equals(activeTab)) {
          propValue=getJsp().getRequest().getParameter(PREFIX_STRUCTURE + propName);
          valueStructure=getJsp().getRequest().getParameter(PREFIX_STRUCTURE + propName);
          if (!isEditable) {
            valueResource=getJsp().getRequest().getParameter(PREFIX_RESOURCE + propName);
          }
 else {
            valueResource=getJsp().getRequest().getParameter(PREFIX_VALUE + propName);
          }
        }
 else {
          propValue=getJsp().getRequest().getParameter(PREFIX_RESOURCE + propName);
          if (!isEditable) {
            valueStructure=getJsp().getRequest().getParameter(PREFIX_STRUCTURE + propName);
          }
 else {
            valueStructure=getJsp().getRequest().getParameter(PREFIX_VALUE + propName);
          }
          valueResource=getJsp().getRequest().getParameter(PREFIX_RESOURCE + propName);
          if (valueStructure != null && !"".equals(valueStructure.trim()) && valueStructure.equals(valueResource)) {
            valueStructure="";
          }
        }
      }
 else {
        CmsProperty currentProperty=(CmsProperty)activeProperties.get(propName);
        if (currentProperty == null) {
          currentProperty=new CmsProperty();
        }
        if (structurePanelName.equals(activeTab)) {
          propValue=currentProperty.getStructureValue();
        }
 else {
          propValue=currentProperty.getResourceValue();
        }
        valueStructure=currentProperty.getStructureValue();
        valueResource=currentProperty.getResourceValue();
        if (propValue == null) {
          propValue="";
        }
        if (valueStructure == null) {
          valueStructure="";
        }
        if (valueResource == null) {
          valueResource="";
        }
      }
      propValue=propValue.trim();
      valueStructure=valueStructure.trim();
      valueResource=valueResource.trim();
      retValue.append(buildPropertyRow(propName,CmsEncoder.escapeXml(propValue),CmsEncoder.escapeXml(valueStructure),CmsEncoder.escapeXml(valueResource),disabled,activeTab));
    }
    retValue.append("</table>");
  }
 else {
    retValue.append("No properties defined!");
  }
  return retValue.toString();
}
