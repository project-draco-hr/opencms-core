{
  CmsObject cms=getCmsObject();
  echo("Testing element mappings fom XML content to a property list");
  CmsXmlEntityResolver resolver=new CmsXmlEntityResolver(cms);
  String content;
  CmsXmlContent xmlcontent;
  content=CmsFileUtil.readFile("org/opencms/xml/content/xmlcontent-8.xml",CmsEncoder.ENCODING_ISO_8859_1);
  xmlcontent=CmsXmlContentFactory.unmarshal(content,CmsEncoder.ENCODING_ISO_8859_1,resolver);
  xmlcontent.validateXmlStructure(resolver);
  String resourcename="/mappinglist.html";
  cms.createResource(resourcename,OpenCms.getResourceManager().getResourceType("xmlcontent").getTypeId(),content.getBytes(CmsEncoder.ENCODING_ISO_8859_1),Collections.EMPTY_LIST);
  CmsFile file=cms.readFile(resourcename);
  xmlcontent=CmsXmlContentFactory.unmarshal(cms,file);
  CmsProperty prop;
  prop=cms.readPropertyObject(resourcename,CmsPropertyDefinition.PROPERTY_DESCRIPTION,false);
  assertSame(prop,CmsProperty.getNullProperty());
  I_CmsXmlContentValue value;
  CmsXmlContentValueSequence seq=xmlcontent.getValueSequence("VfsFile",Locale.ENGLISH);
  assertEquals(0,seq.getElementCount());
  String res1="/index.html";
  String res2="/xmlcontent/";
  String res3="/xmlcontent/article_0001.html";
  String res4="/folder1/index.html";
  String sr=cms.getRequestContext().getSiteRoot();
  String propValue=sr + res1 + "|"+ sr+ res2+ "|"+ sr+ res3+ "|"+ sr+ res4;
  value=seq.addValue(cms,0);
  value.setStringValue(cms,res1);
  value=seq.addValue(cms,1);
  value.setStringValue(cms,res2);
  value=seq.addValue(cms,2);
  value.setStringValue(cms,res3);
  value=seq.addValue(cms,3);
  value.setStringValue(cms,res4);
  assertEquals(4,seq.getElementCount());
  xmlcontent.validateXmlStructure(resolver);
  file.setContents(xmlcontent.toString().getBytes(CmsEncoder.ENCODING_ISO_8859_1));
  cms.writeFile(file);
  prop=cms.readPropertyObject(resourcename,CmsPropertyDefinition.PROPERTY_DESCRIPTION,false);
  List list=prop.getValueList();
  assertNotNull(list);
  assertEquals(4,list.size());
  assertEquals(sr + res1,list.get(0));
  assertEquals(sr + res2,list.get(1));
  assertEquals(sr + res3,list.get(2));
  assertEquals(sr + res4,list.get(3));
  assertEquals(propValue,prop.getValue());
}
