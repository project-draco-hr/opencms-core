{
  CmsObject cms=getCmsObject();
  echo("Testing for nested XML content schemas");
  CmsXmlEntityResolver resolver=new CmsXmlEntityResolver(cms);
  String content;
  content=CmsFileUtil.readFile("org/opencms/xml/content/xmlcontent-definition-4.xsd",CmsEncoder.C_UTF8_ENCODING);
  CmsXmlContentDefinition definition=CmsXmlContentDefinition.unmarshal(content,C_SCHEMA_SYSTEM_ID_4,resolver);
  CmsXmlEntityResolver.cacheSystemId(C_SCHEMA_SYSTEM_ID_4,content.getBytes(CmsEncoder.C_UTF8_ENCODING));
  content=CmsFileUtil.readFile("org/opencms/xml/content/xmlcontent-4.xml",CmsEncoder.C_UTF8_ENCODING);
  CmsXmlContent xmlcontent=CmsXmlContentFactory.unmarshal(content,CmsEncoder.C_UTF8_ENCODING,resolver);
  assertTrue(xmlcontent.hasValue("Title",Locale.ENGLISH));
  assertTrue(xmlcontent.hasValue("Title[0]",Locale.ENGLISH));
  assertTrue(xmlcontent.hasValue("Cascade[0]/Html[0]",Locale.ENGLISH));
  assertTrue(xmlcontent.hasValue("Cascade[0]/VfsLink[0]",Locale.ENGLISH));
  assertTrue(xmlcontent.hasValue("Cascade[0]/VfsLink[1]",Locale.ENGLISH));
  assertTrue(xmlcontent.hasValue("Cascade[1]/Html[0]",Locale.ENGLISH));
  assertTrue(xmlcontent.hasValue("Cascade[1]/VfsLink[0]",Locale.ENGLISH));
  assertTrue(xmlcontent.hasValue("Cascade[1]/Html",Locale.ENGLISH));
  assertTrue(xmlcontent.hasValue("Cascade[1]/VfsLink",Locale.ENGLISH));
  assertTrue(xmlcontent.hasValue("Cascade",Locale.ENGLISH));
  assertTrue(xmlcontent.hasValue("Cascade[0]",Locale.ENGLISH));
  assertTrue(xmlcontent.hasValue("Cascade[1]",Locale.ENGLISH));
  assertTrue(xmlcontent.hasValue("Cascade/Html",Locale.ENGLISH));
  assertTrue(xmlcontent.hasValue("Cascade/Html[0]",Locale.ENGLISH));
  assertTrue(xmlcontent.hasValue("Cascade/VfsLink",Locale.ENGLISH));
  assertTrue(xmlcontent.hasValue("Cascade/VfsLink[0]",Locale.ENGLISH));
  assertTrue(xmlcontent.hasValue("Cascade/VfsLink[1]",Locale.ENGLISH));
  assertSame(definition.getContentHandler().getClass().getName(),TestXmlContentHandler.class.getName());
}
