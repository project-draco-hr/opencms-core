{
  CmsObject cms=getCmsObject();
  echo("Testing mapping of values in the XML content");
  CmsXmlEntityResolver resolver=new CmsXmlEntityResolver(cms);
  String content;
  CmsXmlContent xmlcontent;
  content=CmsFileUtil.readFile("org/opencms/xml/content/xmlcontent-definition-8.xsd",CmsEncoder.C_UTF8_ENCODING);
  CmsXmlEntityResolver.cacheSystemId(C_SCHEMA_SYSTEM_ID_8,content.getBytes(CmsEncoder.ENCODING_ISO_8859_1));
  content=CmsFileUtil.readFile("org/opencms/xml/content/xmlcontent-8.xml",CmsEncoder.ENCODING_ISO_8859_1);
  xmlcontent=CmsXmlContentFactory.unmarshal(content,CmsEncoder.ENCODING_ISO_8859_1,resolver);
  xmlcontent.validateXmlStructure(resolver);
  String resourcename="/mappingtext.html";
  cms.createResource(resourcename,OpenCms.getResourceManager().getResourceType("xmlcontent").getTypeId(),content.getBytes(CmsEncoder.ENCODING_ISO_8859_1),Collections.EMPTY_LIST);
  CmsFile file=cms.readFile(resourcename);
  xmlcontent=CmsXmlContentFactory.unmarshal(cms,file);
  CmsProperty titleProperty;
  titleProperty=cms.readPropertyObject(resourcename,CmsPropertyDefinition.PROPERTY_TITLE,false);
  assertSame(titleProperty,CmsProperty.getNullProperty());
  String titleStr="This must be the Title";
  I_CmsXmlContentValue value;
  value=xmlcontent.addValue(cms,"String",Locale.ENGLISH,0);
  value.setStringValue(cms,titleStr);
  file.setContents(xmlcontent.toString().getBytes(CmsEncoder.ENCODING_ISO_8859_1));
  cms.writeFile(file);
  titleProperty=cms.readPropertyObject(resourcename,CmsPropertyDefinition.PROPERTY_TITLE,false);
  assertEquals(titleStr,titleProperty.getValue());
}
