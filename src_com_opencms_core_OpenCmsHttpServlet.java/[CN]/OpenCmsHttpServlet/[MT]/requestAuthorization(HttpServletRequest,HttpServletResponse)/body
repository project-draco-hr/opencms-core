{
  String servletPath=null;
  String redirectURL=null;
  if (this.m_useBasicAuthentication) {
    res.setHeader("WWW-Authenticate","BASIC realm=\"OpenCms\"");
    res.setStatus(401);
  }
 else {
    servletPath=req.getContextPath() + req.getServletPath();
    redirectURL=servletPath + m_authenticationFormURI + "?requestedResource="+ req.getPathInfo();
    res.sendRedirect(redirectURL);
  }
}
