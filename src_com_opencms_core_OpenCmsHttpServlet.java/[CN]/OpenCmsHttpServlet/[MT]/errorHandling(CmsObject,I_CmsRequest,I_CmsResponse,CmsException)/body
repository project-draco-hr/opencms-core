{
  int errorType=e.getType();
  HttpServletRequest req=(HttpServletRequest)cmsReq.getOriginalRequest();
  HttpServletResponse res=(HttpServletResponse)cmsRes.getOriginalResponse();
  boolean canWrite=((!cmsRes.isRedirected()) && (!cmsRes.isOutputWritten()));
  try {
switch (errorType) {
case CmsException.C_ACCESS_DENIED:
      if (canWrite) {
        if (C_LOGGING && A_OpenCms.isLogging(C_OPENCMS_INFO)) {
          A_OpenCms.log(C_OPENCMS_INFO,"[OpenCmsServlet] Access denied. " + e.getMessage());
        }
        requestAuthorization(req,res);
      }
    break;
case CmsException.C_NOT_FOUND:
  if (canWrite) {
    res.setContentType("text/HTML");
    res.sendError(HttpServletResponse.SC_NOT_FOUND);
  }
break;
case CmsException.C_SERVICE_UNAVAILABLE:
if (canWrite) {
res.sendError(HttpServletResponse.SC_SERVICE_UNAVAILABLE,e.toString());
}
break;
case CmsException.C_HTTPS_PAGE_ERROR:
if (canWrite) {
if (C_LOGGING && A_OpenCms.isLogging(C_OPENCMS_INFO)) {
A_OpenCms.log(C_OPENCMS_INFO,"[OpenCmsServlet] Trying to get a http page with a https request. " + e.getMessage());
}
res.setContentType("text/HTML");
res.sendError(HttpServletResponse.SC_NOT_FOUND);
}
break;
case CmsException.C_HTTPS_REQUEST_ERROR:
if (C_LOGGING && A_OpenCms.isLogging(C_OPENCMS_INFO)) {
A_OpenCms.log(C_OPENCMS_INFO,"[OpenCmsServlet] Trying to get a https page with a http request. " + e.getMessage());
}
if (canWrite) {
res.setContentType("text/HTML");
res.sendError(HttpServletResponse.SC_NOT_FOUND);
}
break;
default :
if (canWrite) {
res.setContentType("text/HTML");
res.setHeader("Cache-Control","no-cache");
res.setHeader("Pragma","no-cache");
res.getWriter().print(createErrorBox(e,cms));
}
}
}
 catch (IOException ex) {
}
}
