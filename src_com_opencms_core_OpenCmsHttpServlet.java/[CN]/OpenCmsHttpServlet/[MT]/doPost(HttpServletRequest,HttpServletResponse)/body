{
  if (C_DEBUG) {
    long reqStartTime=System.currentTimeMillis();
  }
  String type=req.getHeader("content-type");
  CmsObject cms=null;
  if ((type != null) && type.startsWith("multipart/form-data")) {
  }
  CmsRequestHttpServlet cmsReq=new CmsRequestHttpServlet(req);
  CmsResponseHttpServlet cmsRes=new CmsResponseHttpServlet(req,res,m_clusterurl);
  try {
    cms=initUser(cmsReq,cmsRes);
    if (!checkRelocation(cms)) {
      CmsFile file=m_opencms.initResource(cms);
      if (file != null) {
        m_opencms.setResponse(cms,file);
        m_opencms.showResource(cms,file);
        updateUser(cms,cmsReq,cmsRes);
      }
    }
  }
 catch (  CmsException e) {
    errorHandling(cms,cmsReq,cmsRes,e);
  }
  if (C_DEBUG) {
    long total=Runtime.getRuntime().totalMemory() / 1024;
    long free=Runtime.getRuntime().freeMemory() / 1024;
    System.err.print(new Date() + " doPost() reqAm:" + m_currentRequestAmount+ " users:"+ m_sessionStorage.size());
    System.err.print((" [" + total + "/"+ free+ "/"+ (total - free)+ "] "));
    System.err.print("threads:" + Thread.activeCount() + " ");
    System.err.println(cmsReq.getRequestedResource() + " " + cms.getRequestContext().currentUser().getName());
  }
}
