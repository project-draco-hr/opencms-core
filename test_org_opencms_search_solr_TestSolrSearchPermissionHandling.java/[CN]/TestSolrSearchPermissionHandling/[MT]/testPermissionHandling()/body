{
  echo("Testing search for permission check by comparing result counts");
  echo("ID Admin: " + getCmsObject().getRequestContext().getCurrentUser().getId().toString());
  echo("ID test1: " + getCmsObject().readUser("test1").getId().toString());
  echo("ID test2: " + getCmsObject().readUser("test2").getId().toString());
  I_CmsReport report=new CmsShellReport(Locale.ENGLISH);
  OpenCms.getSearchManager().rebuildIndex(AllSolrTests.SOLR_OFFLINE,report);
  CmsSolrIndex index=OpenCms.getSearchManager().getIndexSolr(AllSolrTests.SOLR_OFFLINE);
  CmsSolrQuery squery=new CmsSolrQuery(getCmsObject());
  squery.setSearchRoots("/sites/default/");
  CmsSolrResultList results=index.search(getCmsObject(),squery);
  AllSolrTests.printResults(getCmsObject(),results,true);
  CmsObject cms=OpenCms.initCmsObject(getCmsObject(),new CmsContextInfo("test1"));
  results=index.search(cms,squery);
  AllSolrTests.printResults(cms,results,true);
  cms=OpenCms.initCmsObject(getCmsObject(),new CmsContextInfo("test2"));
  results=index.search(cms,squery);
  AllSolrTests.printResults(cms,results,true);
}
