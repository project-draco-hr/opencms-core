{
  CmsRequestContext reqCont=cms.getRequestContext();
  HttpServletRequest orgReq=(HttpServletRequest)reqCont.getRequest().getOriginalRequest();
  String servletPath=orgReq.getServletPath();
  Hashtable parameters=(Hashtable)userObj;
  String elementName=(String)parameters.get("_ELEMENT_");
  CmsXmlTemplateFile newsTemplateFile=(CmsXmlTemplateFile)doc;
  String newsFolder=getNewsFolder(elementName,parameters);
  Vector v=CmsNewsContentFile.getAllArticles(cms,newsFolder);
  String result="";
  for (int i=0; i < v.size(); i++) {
    Object o=v.elementAt(i);
    CmsNewsContentFile doc2=(CmsNewsContentFile)o;
    newsTemplateFile.setData("date",Utils.getNiceShortDate(doc2.getNewsDate()));
    newsTemplateFile.setData("headline",Encoder.escapeXml(doc2.getNewsHeadline()));
    newsTemplateFile.setData("author",Encoder.escapeXml(doc2.getNewsAuthor()));
    newsTemplateFile.setData("shorttext",Encoder.escapeXml(doc2.getNewsShortText()));
    newsTemplateFile.setData("link",servletPath + C_NEWS_FOLDER_PAGE + doc2.getFilename()+ "/index.html");
    newsTemplateFile.setData("path",servletPath);
    newsTemplateFile.setData("index","" + i);
    result=result + newsTemplateFile.getProcessedDataValue(C_TAG_NEWSLISTENTRY);
  }
  return result;
}
