{
  I_CmsXmlConfiguration configuration=getConfiguration(clazz);
  if (configuration == null) {
    throw new CmsConfigurationException("Configuration manager write requested for unknown class '" + clazz.getName() + "'",CmsConfigurationException.C_CONFIGURATION_ERROR);
  }
  File file=new File(m_baseFolder,configuration.getXmlFileName());
  if (OpenCms.getLog(this).isDebugEnabled()) {
    OpenCms.getLog(this).debug("XML output file URL is " + file.getAbsolutePath());
  }
  Document config=generateXml(configuration);
  XMLWriter writer=null;
  OutputFormat format=OutputFormat.createPrettyPrint();
  format.setIndentSize(4);
  format.setTrimText(false);
  format.setEncoding("UTF-8");
  try {
    OutputStream out=new FileOutputStream(file);
    writer=new XMLWriter(out,format);
    writer.write(config);
    writer.flush();
  }
  finally {
    if (writer != null) {
      writer.close();
    }
  }
  if (OpenCms.getLog(this).isInfoEnabled()) {
    OpenCms.getLog(this).info("Successfully updated XML configuration file " + file.getAbsolutePath() + " for class '"+ configuration.getClass().getName()+ "'");
  }
}
