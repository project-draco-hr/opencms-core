{
  CmsObject cms=getCmsObject();
  String navigationUri=cms.getRequestContext().getUri();
  boolean toolbarVisible=getSessionCache().isToolbarVisible();
  boolean isShowHelp=OpenCms.getADEManager().isShowEditorHelp(cms);
  CmsUUID structureId=null;
  try {
    CmsResource requestedResource=cms.readResource(cms.getRequestContext().getUri());
    structureId=requestedResource.getStructureId();
  }
 catch (  CmsException e) {
    throw new CmsRuntimeException(e.getMessageContainer(),e);
  }
  String loginUrl=DEFAULT_LOGIN_URL;
  try {
    loginUrl=cms.readPropertyObject(cms.getRequestContext().getUri(),CmsPropertyDefinition.PROPERTY_LOGIN_FORM,true).getValue(DEFAULT_LOGIN_URL);
  }
 catch (  CmsException e) {
    log(e.getLocalizedMessage(),e);
  }
  String defaultWorkplaceLink=CmsExplorer.getWorkplaceExplorerLink(cms,cms.getRequestContext().getSiteRoot());
  CmsRoleManager roleManager=OpenCms.getRoleManager();
  boolean isAdmin=roleManager.hasRole(cms,CmsRole.ADMINISTRATOR);
  boolean isDeveloper=roleManager.hasRole(cms,CmsRole.DEVELOPER);
  boolean isCategoryManager=roleManager.hasRole(cms,CmsRole.CATEGORY_EDITOR);
  UserInfo userInfo=new UserInfo(cms.getRequestContext().getCurrentUser().getName(),isAdmin,isDeveloper,isCategoryManager);
  String aboutLink=OpenCms.getLinkManager().substituteLink(getCmsObject(),"/system/modules/org.opencms.gwt/about.jsp");
  CmsCoreData data=new CmsCoreData(EDITOR_URI,EDITOR_BACKLINK_URI,EDITOR_DELETE_URI,loginUrl,OpenCms.getStaticExportManager().getVfsPrefix(),cms.getRequestContext().getSiteRoot(),cms.getRequestContext().getLocale().toString(),OpenCms.getWorkplaceManager().getWorkplaceLocale(cms).toString(),cms.getRequestContext().getUri(),navigationUri,structureId,new HashMap<String,String>(OpenCms.getResourceManager().getExtensionMapping()),System.currentTimeMillis(),isShowHelp,toolbarVisible,defaultWorkplaceLink,aboutLink,userInfo,OpenCms.getWorkplaceManager().getFileBytesMaxUploadSize(getCmsObject()),OpenCms.getWorkplaceManager().isKeepAlive(),OpenCms.getADEManager().getParameters(getCmsObject()));
  return data;
}
