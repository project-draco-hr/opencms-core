{
  CmsObject cms=getCmsObject();
  String navigationUri=cms.getRequestContext().getUri();
  boolean toolbarVisible=getSessionCache().isToolbarVisible();
  CmsUUID structureId=null;
  try {
    CmsResource requestedResource=cms.readResource(cms.getRequestContext().getUri());
    structureId=requestedResource.getStructureId();
  }
 catch (  CmsException e) {
    throw new CmsRuntimeException(e.getMessageContainer(),e);
  }
  String loginUrl=DEFAULT_LOGIN_URL;
  try {
    loginUrl=cms.readPropertyObject(cms.getRequestContext().getUri(),CmsPropertyDefinition.PROPERTY_LOGIN_FORM,true).getValue(DEFAULT_LOGIN_URL);
  }
 catch (  CmsException e) {
    log(e.getLocalizedMessage(),e);
  }
  CmsCoreData data=new CmsCoreData(EDITOR_URI,EDITOR_BACKLINK_URI,EDITOR_DELETE_URI,loginUrl,OpenCms.getStaticExportManager().getVfsPrefix(),cms.getRequestContext().getSiteRoot(),cms.getRequestContext().getLocale().toString(),OpenCms.getWorkplaceManager().getWorkplaceLocale(cms).toString(),cms.getRequestContext().getUri(),navigationUri,structureId,new HashMap<String,String>(OpenCms.getResourceManager().getExtensionMapping()),System.currentTimeMillis(),toolbarVisible);
  return data;
}
