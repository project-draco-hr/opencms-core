{
  CmsResource importedResource=null;
  CmsResource existingResource=null;
  try {
    importedResource=cms.doImportResource(resource,content,properties,destination);
    cms.lockResource(destination);
  }
 catch (  CmsException e) {
    if (e.getType() == CmsException.C_FILE_EXISTS) {
      existingResource=cms.readFileHeader(destination);
      if (OpenCms.getImportExportManager().overwriteCollidingResources() || existingResource.getResourceId().equals(resource.getResourceId())) {
        cms.lockResource(destination);
        cms.doImportUpdateResource(destination,properties,content);
        importedResource=cms.readFileHeader(destination);
        cms.touch(destination,resource.getDateLastModified(),I_CmsConstants.C_DATE_UNCHANGED,I_CmsConstants.C_DATE_UNCHANGED,false,resource.getUserLastModified());
      }
 else {
        String target=copyToLostAndFound(cms,destination,false);
        CmsResource newRes=new CmsResource(resource.getStructureId(),resource.getResourceId(),resource.getParentStructureId(),resource.getFileId(),CmsResource.getName(target),resource.getType(),resource.getFlags(),resource.getProjectLastModified(),resource.getState(),resource.getLoaderId(),resource.getDateLastModified(),resource.getUserLastModified(),resource.getDateCreated(),resource.getUserCreated(),resource.getDateReleased(),resource.getDateExpired(),1,resource.getLength());
        importedResource=cms.doImportResource(newRes,content,properties,target);
      }
    }
  }
  return importedResource;
}
