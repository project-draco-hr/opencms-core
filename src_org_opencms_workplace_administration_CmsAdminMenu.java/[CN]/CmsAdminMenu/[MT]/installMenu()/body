{
  m_groupContainer.clear();
  CmsAdminMenuGroup helpMenu=new CmsAdminMenuGroup("help",Messages.get().key(getLocale(),Messages.GUI_ADMIN_MENU_HELP_GROUP_0,null));
  helpMenu.addMenuItem(new CmsAdminContextHelpMenuItem());
  addGroup(helpMenu);
  Iterator itElems=getToolManager().getToolHandlers().iterator();
  while (itElems.hasNext()) {
    CmsTool tool=(CmsTool)itElems.next();
    if (!getCms().existsResource(tool.getHandler().getLink()) || !tool.getHandler().isVisible(getCms())) {
      continue;
    }
    if (!tool.getHandler().getPath().startsWith(getToolManager().getRootToolPath(this))) {
      continue;
    }
    String path=tool.getHandler().getPath().substring(getToolManager().getRootToolPath(this).length());
    if (CmsStringUtil.isEmpty(path)) {
      continue;
    }
    int pos=tool.getHandler().getPath().indexOf(CmsToolManager.C_TOOLPATH_SEPARATOR);
    if (path.indexOf(CmsToolManager.C_TOOLPATH_SEPARATOR,pos + 1) < 0) {
      String groupName=resolveMacros(tool.getHandler().getGroup());
      CmsAdminMenuGroup group=getGroup(groupName);
      if (group == null) {
        String gid="group" + m_groupContainer.elementList().size();
        group=new CmsAdminMenuGroup(gid,groupName);
        addGroup(group,tool.getHandler().getPosition());
      }
      String id="item" + group.getMenuItems().size();
      CmsAdminMenuItem item=new CmsAdminMenuItem(id,tool.getHandler().getName(),tool.getHandler().getSmallIconPath(),getToolManager().linkForPath(tool.getHandler().getPath(),null),tool.getHandler().getHelpText(),tool.getHandler().isEnabled(getCms()),CmsAdminMenu.DEFAULT_TARGET);
      group.addMenuItem(item,tool.getHandler().getPosition());
    }
  }
}
