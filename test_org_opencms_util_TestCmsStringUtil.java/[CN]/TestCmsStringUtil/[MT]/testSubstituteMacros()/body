{
  I_CmsStringMapper substitution=new I_CmsStringMapper(){
    public String getValue(    String key){
      if ("test".equals(key)) {
        return "REPLACED";
      }
 else {
        return null;
      }
    }
  }
;
  String content, result;
  content="<<This is a prefix >>${test}<<This is a suffix>>";
  result=CmsStringUtil.substituteMacros(content,substitution);
  assertEquals("<<This is a prefix >>REPLACED<<This is a suffix>>",result);
  content="${test}<<This is a suffix>>";
  result=CmsStringUtil.substituteMacros(content,substitution);
  assertEquals("REPLACED<<This is a suffix>>",result);
  content="<<This is a prefix >>${test}";
  result=CmsStringUtil.substituteMacros(content,substitution);
  assertEquals("<<This is a prefix >>REPLACED",result);
  content="<<This is a prefix >>$<<This is a suffix>>";
  result=CmsStringUtil.substituteMacros(content,substitution);
  assertEquals("<<This is a prefix >>$<<This is a suffix>>",result);
  content="$<<This is a suffix>>";
  result=CmsStringUtil.substituteMacros(content,substitution);
  assertEquals("$<<This is a suffix>>",result);
  content="<<This is a prefix >>$";
  result=CmsStringUtil.substituteMacros(content,substitution);
  assertEquals("<<This is a prefix >>$",result);
  content="<<This is a prefix >>${}<<This is a suffix>>";
  result=CmsStringUtil.substituteMacros(content,substitution);
  assertEquals("<<This is a prefix >><<This is a suffix>>",result);
  content="<<This is a prefix >>${unknown}<<This is a suffix>>";
  result=CmsStringUtil.substituteMacros(content,substitution);
  assertEquals("<<This is a prefix >><<This is a suffix>>",result);
  content="<<This is a prefix >>${test<<This is a suffix>>";
  result=CmsStringUtil.substituteMacros(content,substitution);
  assertEquals("<<This is a prefix >>${test<<This is a suffix>>",result);
  content="<<This is a prefix >>${unknown}<<This is a suffix>>";
  result=CmsStringUtil.substituteMacros(content,substitution,true);
  assertEquals("<<This is a prefix >>${unknown}<<This is a suffix>>",result);
  content="<<This is a prefix >>${unknown}";
  result=CmsStringUtil.substituteMacros(content,substitution,true);
  assertEquals("<<This is a prefix >>${unknown}",result);
  content="${unknown}<<This is a suffix>>";
  result=CmsStringUtil.substituteMacros(content,substitution,true);
  assertEquals("${unknown}<<This is a suffix>>",result);
  content="${test}<<This is a prefix >>${test}${unknown}${test}<<This is a suffix>>${test}";
  result=CmsStringUtil.substituteMacros(content,substitution,true);
  assertEquals("REPLACED<<This is a prefix >>REPLACED${unknown}REPLACED<<This is a suffix>>REPLACED",result);
}
