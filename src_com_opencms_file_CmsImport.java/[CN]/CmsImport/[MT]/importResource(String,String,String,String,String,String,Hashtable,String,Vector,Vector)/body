{
  m_report.addString("Importing " + destination + " ");
  boolean success=true;
  byte[] content=null;
  String fullname=null;
  try {
    String path=m_importPath + destination.substring(0,destination.lastIndexOf("/") + 1);
    String name=destination.substring((destination.lastIndexOf("/") + 1),destination.length());
    if (source != null) {
      content=getFileBytes(source);
    }
    type=fitFileType(path,name,content,type,properties);
    CmsResource res=m_cms.importResource(source,destination,type,user,group,access,properties,launcherStartClass,content,m_importPath);
    if (res != null) {
      fullname=res.getAbsolutePath();
      if (C_TYPE_PAGE_NAME.equals(type)) {
        m_importedPages.add(fullname);
      }
    }
    m_report.addString("OK");
    m_report.addSeperator(0);
  }
 catch (  Exception exc) {
    success=false;
    m_report.addString("Error: " + exc.toString());
    m_report.addSeperator(0);
  }
  byte[] digestContent={0};
  if (content != null) {
    digestContent=m_digest.digest(content);
  }
  if (success && (fullname != null)) {
    if (writtenFilenames != null) {
      writtenFilenames.addElement(fullname);
    }
    if (fileCodes != null) {
      fileCodes.addElement(new String(digestContent));
    }
  }
}
