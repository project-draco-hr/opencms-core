{
  NodeList fileNodes;
  Element currentElement;
  String destination;
  Vector resources=new Vector();
  try {
    if (m_importingChannelData)     m_cms.setContextToCos();
    fileNodes=m_docXml.getElementsByTagName(C_EXPORT_TAG_FILE);
    for (int i=0; i < fileNodes.getLength(); i++) {
      currentElement=(Element)fileNodes.item(i);
      destination=getTextNodeValue(currentElement,C_EXPORT_TAG_DESTINATION);
      try {
        String resource=destination.substring(0,destination.indexOf("/",1) + 1);
        resource=m_importPath + resource;
        if ((!resources.contains(resource)) && (!resource.equals(m_importPath))) {
          try {
            m_cms.readFolder(resource);
            resources.addElement(resource);
          }
 catch (          CmsException exc) {
            resources.addElement(C_ROOT);
          }
        }
      }
 catch (      StringIndexOutOfBoundsException exc) {
      }
    }
  }
 catch (  Exception exc) {
    m_report.println(exc);
    throw new CmsException(CmsException.C_UNKNOWN_EXCEPTION,exc);
  }
 finally {
    if (m_importingChannelData)     m_cms.setContextToVfs();
  }
  if (m_importZip != null) {
    try {
      m_importZip.close();
    }
 catch (    IOException exc) {
      m_report.println(exc);
      throw new CmsException(CmsException.C_UNKNOWN_EXCEPTION,exc);
    }
  }
  if (resources.contains(C_ROOT)) {
    resources.removeAllElements();
    resources.addElement(C_ROOT);
  }
  return resources;
}
