{
  byte[] returnValue=byteContent;
  if (!filename.startsWith("/")) {
    filename="/" + filename;
  }
  String fileContent=new String(byteContent);
  String encoding=getEncoding(fileContent);
  if (!"".equals(encoding)) {
    try {
      fileContent=new String(byteContent,encoding);
    }
 catch (    UnsupportedEncodingException e) {
    }
  }
 else {
    encoding=OpenCms.getDefaultEncoding();
    fileContent=setEncoding(fileContent,encoding);
  }
  if (filename.indexOf("frametemplates") != -1) {
    fileContent=scanFrameTemplate(fileContent);
  }
  fileContent=setDirectories(fileContent,type);
  if (filename.indexOf(C_VFS_PATH_OLD_BODIES) != -1 || filename.indexOf(I_CmsWpConstants.C_VFS_PATH_BODIES) != -1) {
    fileContent=convertPageBody(fileContent,filename);
  }
  try {
    returnValue=fileContent.getBytes(encoding);
  }
 catch (  UnsupportedEncodingException e) {
    returnValue=fileContent.getBytes();
  }
  return returnValue;
}
