{
  NodeList fileNodes, propertyNodes;
  Element currentElement, currentProperty;
  String source, destination, type, user, group, access, launcherStartClass;
  Hashtable properties;
  Vector types=new Vector();
  try {
    fileNodes=m_docXml.getElementsByTagName(C_EXPORT_TAG_FILE);
    int importSize=fileNodes.getLength();
    for (int i=0; i < fileNodes.getLength(); i++) {
      m_report.addString(" ( " + (i + 1) + " / "+ importSize+ " )  ");
      currentElement=(Element)fileNodes.item(i);
      source=getTextNodeValue(currentElement,C_EXPORT_TAG_SOURCE);
      destination=getTextNodeValue(currentElement,C_EXPORT_TAG_DESTINATION);
      type=getTextNodeValue(currentElement,C_EXPORT_TAG_TYPE);
      user=getTextNodeValue(currentElement,C_EXPORT_TAG_USER);
      group=getTextNodeValue(currentElement,C_EXPORT_TAG_GROUP);
      access=getTextNodeValue(currentElement,C_EXPORT_TAG_ACCESS);
      launcherStartClass=getTextNodeValue(currentElement,C_EXPORT_TAG_LAUNCHER_START_CLASS);
      if ("script".equals(type)) {
        type=C_TYPE_PLAIN_NAME;
      }
      if (!inExcludeList(excludeList,m_importPath + destination)) {
        propertyNodes=currentElement.getElementsByTagName(C_EXPORT_TAG_PROPERTY);
        properties=new Hashtable();
        if (propertyName != null && propertyValue != null && !"".equals(propertyName)) {
          if (!types.contains(type)) {
            types.addElement(type);
            createPropertydefinition(propertyName,type);
          }
          properties.put(propertyName,propertyValue);
        }
        for (int j=0; j < propertyNodes.getLength(); j++) {
          currentProperty=(Element)propertyNodes.item(j);
          String name=getTextNodeValue(currentProperty,C_EXPORT_TAG_NAME);
          String value=getTextNodeValue(currentProperty,C_EXPORT_TAG_VALUE);
          if (value == null) {
            value="";
          }
          if ((name != null) && (value != null)) {
            properties.put(name,value);
            createPropertydefinition(name,type);
          }
        }
        importResource(source,destination,type,user,group,access,properties,launcherStartClass,writtenFilenames,fileCodes);
      }
 else {
        m_report.addString("skipping " + destination);
      }
    }
    m_report.addSeperator(1);
    updatePageLinks();
  }
 catch (  Exception exc) {
    throw new CmsException(CmsException.C_UNKNOWN_EXCEPTION,exc);
  }
  if (m_importZip != null) {
    try {
      m_importZip.close();
    }
 catch (    IOException exc) {
      throw new CmsException(CmsException.C_UNKNOWN_EXCEPTION,exc);
    }
  }
}
