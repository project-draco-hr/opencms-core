{
  String rootFolder=m_mountpoint.getMountpoint();
  Vector allFiles=new Vector();
  Vector allFolders=new Vector();
  Vector resources=new Vector();
  getAllResources(rootFolder,project,allFiles,allFolders);
  for (int i=0; i < allFolders.size(); i++) {
    CmsFolder offlineFolder=(CmsFolder)allFolders.elementAt(i);
    if ((offlineFolder.getState() == C_STATE_CHANGED) || (offlineFolder.getState() == C_STATE_NEW)) {
      CmsFolder onlineFolder=new CmsFolder(offlineFolder.getAbsolutePath(),offlineFolder.getType(),offlineFolder.getFlags(),offlineFolder.getOwnerId(),offlineFolder.getGroupId(),onlineProject.getId(),offlineFolder.getAccessFlags(),offlineFolder.getState(),offlineFolder.isLockedBy(),offlineFolder.getDateCreated(),offlineFolder.getDateLastModified());
      onlineFolder.setLocked(C_UNKNOWN_ID);
      if (onlineFolder.getState() == C_STATE_CHANGED) {
        onlineFolder.setState(C_STATE_UNCHANGED);
        writeFolder(onlineProject,onlineFolder,false);
      }
 else {
        onlineFolder=createFolder(onlineProject,onlineFolder,onlineFolder.getAbsolutePath());
        onlineFolder.setState(C_STATE_UNCHANGED);
        writeFolder(onlineProject,onlineFolder,false);
      }
      resources.addElement(onlineFolder.getAbsolutePath());
    }
  }
  for (int i=0; i < allFiles.size(); i++) {
    CmsFile offlineFile=(CmsFile)allFiles.elementAt(i);
    if ((offlineFile.getState() == C_STATE_CHANGED) || (offlineFile.getState() == C_STATE_NEW)) {
      CmsFile onlineFile=new CmsFile(offlineFile.getAbsolutePath(),offlineFile.getType(),offlineFile.getFlags(),offlineFile.getOwnerId(),offlineFile.getGroupId(),onlineProject.getId(),offlineFile.getAccessFlags(),offlineFile.getState(),offlineFile.isLockedBy(),offlineFile.getLauncherType(),offlineFile.getLauncherClassname(),offlineFile.getDateCreated(),offlineFile.getDateLastModified(),readFile(project,onlineProject,offlineFile.getAbsolutePath()).getContents(),offlineFile.getLength());
      onlineFile.setLocked(C_UNKNOWN_ID);
      if (onlineFile.getState() == C_STATE_CHANGED) {
        onlineFile.setState(C_STATE_UNCHANGED);
        writeFile(onlineProject,onlineProject,onlineFile,false);
      }
 else {
        onlineFile=createFile(onlineProject,onlineProject,onlineFile,onlineFile.getAbsolutePath());
        onlineFile.setState(C_STATE_UNCHANGED);
        writeFileHeader(onlineProject,onlineProject,onlineFile,false);
      }
      resources.addElement(onlineFile.getAbsolutePath());
    }
  }
  for (int i=0; i < allFiles.size(); i++) {
    CmsFile offlineFile=(CmsFile)allFiles.elementAt(i);
    if ((offlineFile.getState() == C_STATE_DELETED)) {
      CmsFile onlineFile=new CmsFile(offlineFile.getAbsolutePath(),offlineFile.getType(),offlineFile.getFlags(),offlineFile.getOwnerId(),offlineFile.getGroupId(),onlineProject.getId(),offlineFile.getAccessFlags(),offlineFile.getState(),offlineFile.isLockedBy(),offlineFile.getLauncherType(),offlineFile.getLauncherClassname(),offlineFile.getDateCreated(),offlineFile.getDateLastModified(),readFile(project,onlineProject,offlineFile.getAbsolutePath()).getContents(),offlineFile.getLength());
      onlineFile.setLocked(C_UNKNOWN_ID);
      removeFile(onlineProject,onlineFile.getAbsolutePath());
      resources.addElement(onlineFile.getAbsolutePath());
    }
  }
  for (int i=0; i < allFolders.size(); i++) {
    CmsFolder offlineFolder=(CmsFolder)allFolders.elementAt(allFolders.size() - i - 1);
    if ((offlineFolder.getState() == C_STATE_DELETED)) {
      CmsFolder onlineFolder=new CmsFolder(offlineFolder.getAbsolutePath(),offlineFolder.getType(),offlineFolder.getFlags(),offlineFolder.getOwnerId(),offlineFolder.getGroupId(),onlineProject.getId(),offlineFolder.getAccessFlags(),offlineFolder.getState(),offlineFolder.isLockedBy(),offlineFolder.getDateCreated(),offlineFolder.getDateLastModified());
      onlineFolder.setLocked(C_UNKNOWN_ID);
      removeFolder(onlineProject,onlineFolder.getAbsolutePath());
      resources.addElement(onlineFolder.getAbsolutePath());
    }
  }
  return resources;
}
