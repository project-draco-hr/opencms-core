{
  if (OpenCms.isLogging(CmsLog.C_OPENCMS_DEBUG,CmsLog.LEVEL_WARN) && C_DEBUG) {
    OpenCms.log(CmsLog.C_OPENCMS_DEBUG,CmsLog.LEVEL_WARN,"[CmsDumpTemplate] Now dumping contents of file " + templateFile);
  }
  byte[] s=null;
  try {
    CmsFile file=cms.readFile(templateFile);
    if (CmsResourceTypePlain.C_RESOURCE_TYPE_ID == file.getType()) {
      s=Encoder.changeEncoding(file.getContents(),OpenCms.getDefaultEncoding(),cms.getRequestContext().getEncoding());
    }
 else {
      s=file.getContents();
    }
  }
 catch (  Exception e) {
    String errorMessage="Error while reading file " + templateFile + ": "+ e;
    if (OpenCms.isLogging(CmsLog.C_OPENCMS_CRITICAL,CmsLog.LEVEL_ERROR)) {
      OpenCms.log(CmsLog.C_OPENCMS_CRITICAL,CmsLog.LEVEL_ERROR,"[CmsDumpTemplate] " + errorMessage);
    }
    if (e instanceof CmsException) {
      throw (CmsException)e;
    }
 else {
      throw new CmsException(errorMessage,CmsException.C_UNKNOWN_EXCEPTION);
    }
  }
  return s;
}
