{
  String absolutePath=cms.getSitePath(resource);
  CmsXmlPage page=(CmsXmlPage)req.getAttribute(absolutePath);
  if (page == null) {
    page=CmsXmlPageFactory.unmarshal(cms,CmsFile.upgrade(resource,cms));
    req.setAttribute(absolutePath,page);
  }
  List locales=page.getLocales(element);
  Locale loc=OpenCms.getLocaleManager().getBestMatchingLocale(locale,OpenCms.getLocaleManager().getDefaultLocales(cms,absolutePath),locales);
  String value=page.getStringValue(cms,element,loc);
  if (value != null) {
    return value.getBytes(page.getEncoding());
  }
  return new byte[0];
}
