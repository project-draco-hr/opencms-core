{
  String rootPath=resource.getRootPath();
  if (!(OpenCms.getResourceManager().getLoader(resource) instanceof CmsXmlContentLoader)) {
    throw new CmsXmlException("Resource '" + cms.getSitePath(resource) + "' is not of required type XML content");
  }
  CmsXmlContent content=(CmsXmlContent)req.getAttribute(rootPath);
  if (content == null) {
    content=unmarshal(cms,CmsFile.upgrade(resource,cms));
    req.setAttribute(rootPath,content);
  }
  return content;
}
