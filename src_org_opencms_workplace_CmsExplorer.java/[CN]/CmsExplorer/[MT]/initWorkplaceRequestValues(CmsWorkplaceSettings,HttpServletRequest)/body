{
  String currentResource=request.getParameter("resource");
  String mode=request.getParameter("mode");
  if (mode != null) {
    settings.setExplorerMode(mode);
  }
 else {
    if (!("projectview".equals(settings.getExplorerMode()) || "galleryview".equals(settings.getExplorerMode()))) {
      settings.setExplorerMode("explorerview");
    }
  }
  String filter=request.getParameter("filter");
  if (filter == null || "".equals(filter)) {
    settings.setExplorerProjectFilter("all");
  }
 else {
    settings.setExplorerProjectFilter(filter);
  }
  String projectIdString=request.getParameter("projectid");
  int projectId=getCms().getRequestContext().currentProject().getId();
  if (projectIdString != null && !"".equals(projectIdString)) {
    projectId=Integer.parseInt(projectIdString);
  }
  settings.setExplorerProjectId(projectId);
  boolean showLinks="true".equals(request.getParameter("showlinks"));
  if (showLinks) {
    settings.setExplorerResource(currentResource);
  }
 else {
    if (currentResource != null && currentResource.startsWith("vfslink:")) {
      showLinks=true;
      settings.setExplorerResource(currentResource.substring(8));
    }
 else {
      if ((currentResource != null) && (!"".equals(currentResource)) && folderExists(getCms(),currentResource)) {
        settings.setExplorerResource(currentResource);
      }
 else {
        showLinks=settings.getExplorerShowLinks();
        currentResource=settings.getExplorerResource();
        if ((currentResource == null) || (!resourceExists(getCms(),currentResource))) {
          currentResource="/";
          settings.setExplorerResource(currentResource);
          showLinks=false;
        }
      }
    }
  }
  settings.setExplorerShowLinks(showLinks);
  String selectedPage=request.getParameter("page");
  if (selectedPage != null) {
    int page=1;
    try {
      page=Integer.parseInt(selectedPage);
    }
 catch (    NumberFormatException e) {
    }
    settings.setExplorerPage(page);
  }
  settings.setExplorerFlaturl(request.getParameter("flaturl"));
}
