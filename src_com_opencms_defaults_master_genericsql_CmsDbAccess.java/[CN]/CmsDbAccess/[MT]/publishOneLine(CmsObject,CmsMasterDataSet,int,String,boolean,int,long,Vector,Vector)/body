{
  if (enableHistory) {
    publishBackupData(cms,dataset,subId,versionId,publishingDate);
  }
  publishDeleteData(dataset.m_masterId,subId,"online");
  if (dataset.m_state == I_CmsConstants.C_STATE_DELETED) {
    publishDeleteData(dataset.m_masterId,subId,"offline");
  }
 else {
    publishCopyData(dataset,subId);
  }
  PreparedStatement stmnt=null;
  Connection con=null;
  try {
    con=DriverManager.getConnection(m_poolName);
    stmnt=sqlPrepare(con,"update_state_offline");
    stmnt.setInt(1,I_CmsConstants.C_STATE_UNCHANGED);
    stmnt.setInt(2,I_CmsConstants.C_UNKNOWN_ID);
    stmnt.setInt(3,dataset.m_masterId);
    stmnt.setInt(4,subId);
    stmnt.executeUpdate();
  }
 catch (  SQLException exc) {
    throw new CmsException(CmsException.C_SQL_ERROR,exc);
  }
 finally {
    sqlClose(con,stmnt,null);
  }
  changedModuleData.add(cms.getSiteName() + cms.C_ROOTNAME_COS + "/"+ contentDefinitionName+ "/"+ dataset.m_masterId);
}
