{
  PreparedStatement stmt=null;
  Connection conn=null;
  try {
    conn=m_sqlManager.getConnection();
    stmt=m_sqlManager.getPreparedStatement(conn,"insert_channel_offline");
    for (int i=0; i < channelToAdd.size(); i++) {
      try {
        stmt.setString(1,masterId.toString());
        cms.setContextToCos();
        stmt.setInt(2,Integer.parseInt(cms.readProperty(channelToAdd.get(i) + "",I_CmsConstants.C_PROPERTY_CHANNELID)));
        cms.setContextToVfs();
        stmt.executeUpdate();
      }
 catch (      CmsException exc) {
        if (CmsBase.isLogging()) {
          CmsBase.log(CmsBase.C_MODULE_DEBUG,"[CmsProjectDriver] Couldn't find channel " + channelToAdd.get(i) + " errormessage: "+ exc.getMessage());
        }
      }
    }
  }
  finally {
    m_sqlManager.closeAll(conn,stmt,null);
  }
  stmt=null;
  conn=null;
  try {
    conn=m_sqlManager.getConnection();
    stmt=m_sqlManager.getPreparedStatement(conn,"delete_channel_offline");
    for (int i=0; i < channelToDelete.size(); i++) {
      try {
        stmt.setString(1,masterId.toString());
        cms.setContextToCos();
        stmt.setInt(2,Integer.parseInt(cms.readProperty(channelToDelete.get(i) + "",I_CmsConstants.C_PROPERTY_CHANNELID)));
        cms.setContextToVfs();
        stmt.executeUpdate();
      }
 catch (      CmsException exc) {
        if (CmsBase.isLogging()) {
          CmsBase.log(CmsBase.C_MODULE_DEBUG,"[CmsProjectDriver] Couldn't find channel " + channelToAdd.get(i) + " errormessage: "+ exc.getMessage());
        }
      }
    }
  }
  finally {
    m_sqlManager.closeAll(conn,stmt,null);
  }
}
