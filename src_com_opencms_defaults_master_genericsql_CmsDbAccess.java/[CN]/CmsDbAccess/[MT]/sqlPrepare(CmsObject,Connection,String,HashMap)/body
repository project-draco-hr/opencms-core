{
  String statement=null;
  String moduleMaster=null;
  String channelRel=null;
  String media=null;
  statement=m_queries.getProperty(queryKey,"");
  if (isOnlineProject(cms)) {
    moduleMaster="CMS_MODULE_ONLINE_MASTER";
    channelRel="CMS_MODULE_ONLINE_CHANNEL_REL";
    media="CMS_MODULE_ONLINE_MEDIA";
  }
 else {
    moduleMaster="CMS_MODULE_MASTER";
    channelRel="CMS_MODULE_CHANNEL_REL";
    media="CMS_MODULE_MEDIA";
  }
  statement=Utils.replace(statement,"$CMS_MODULE_MASTER",moduleMaster);
  statement=Utils.replace(statement,"$CMS_MODULE_CHANNEL_REL",channelRel);
  statement=Utils.replace(statement,"$CMS_MODULE_MEDIA",media);
  if (optionalSqlTokens != null) {
    Iterator optionalSqlKeys=optionalSqlTokens.keySet().iterator();
    while (optionalSqlKeys.hasNext()) {
      String currentKey=(String)optionalSqlKeys.next();
      String currentValue=(String)optionalSqlTokens.get(currentKey);
      statement=Utils.replace(statement,currentKey,currentValue);
    }
  }
  return con.prepareStatement(statement);
}
