{
  PreparedStatement stmnt=null;
  Connection con=null;
  try {
    con=DriverManager.getConnection(m_poolName);
    stmnt=sqlPrepare(con,"insert_media_offline");
    for (int i=0; i < mediaToAdd.size(); i++) {
      CmsMasterMedia media=(CmsMasterMedia)mediaToAdd.get(i);
      media.setId(CmsIdGenerator.nextId(m_interimOfflinePoolUrl,"CMS_MODULE_MEDIA"));
      media.setMasterId(masterId);
      sqlFillValues(stmnt,media);
      stmnt.executeUpdate();
    }
  }
  finally {
    sqlClose(con,stmnt,null);
  }
  stmnt=null;
  con=null;
  try {
    con=DriverManager.getConnection(m_poolName);
    stmnt=sqlPrepare(con,"update_media_offline");
    for (int i=0; i < mediaToUpdate.size(); i++) {
      CmsMasterMedia media=(CmsMasterMedia)mediaToUpdate.get(i);
      media.setMasterId(masterId);
      int rowCounter=sqlFillValues(stmnt,media);
      stmnt.setInt(rowCounter++,media.getId());
      stmnt.setString(rowCounter++,masterId.toString());
      stmnt.executeUpdate();
    }
  }
  finally {
    sqlClose(con,stmnt,null);
  }
  stmnt=null;
  con=null;
  try {
    con=DriverManager.getConnection(m_poolName);
    stmnt=sqlPrepare(con,"delete_media_offline");
    for (int i=0; i < mediaToDelete.size(); i++) {
      CmsMasterMedia media=(CmsMasterMedia)mediaToDelete.get(i);
      stmnt.setInt(1,media.getId());
      stmnt.setString(2,masterId.toString());
      stmnt.executeUpdate();
    }
  }
  finally {
    sqlClose(con,stmnt,null);
  }
}
