{
  CmsObject cms=getCmsObject();
  echo("Testing rename a new folder with content");
  cms.getRequestContext().setSiteRoot("/");
  String source="/sites/default/folder1";
  String newFolder="/sites/default/newfolder";
  String destination=newFolder + "/folder1";
  String newFolder2="/sites/default/testfolder";
  cms.createResource(newFolder,CmsResourceTypeFolder.getStaticTypeId());
  cms.lockResource(source);
  cms.moveResource(source,destination);
  cms.moveResource(newFolder,newFolder2);
  try {
    cms.readResource(newFolder2,CmsResourceFilter.ALL);
  }
 catch (  CmsVfsResourceNotFoundException e) {
    echo("ERROR: folder not found, try to create it.");
    cms.createResource(newFolder2,CmsResourceTypeFolder.getStaticTypeId());
  }
  assertState(cms,newFolder2,CmsResource.STATE_NEW);
  cms.undoChanges(source,false);
}
