{
  CmsCroppingParamBean param;
switch (galleryMode) {
case widget:
    param=getInitialCroppingParameter(galleryMode,resourcePath);
  if (CmsPreviewUtil.isAdvancedWidget()) {
    CmsPreviewUtil.setVfsImage(resourcePath,param.getScaleParam(),param.getFormatName(),((double)param.getTargetWidth() / param.getTargetHeight()) + "");
  }
 else {
    CmsPreviewUtil.setResourcePath(resourcePath + ((param.isCropped() || param.isScaled()) ? "?" + param.toString() : ""));
  }
break;
case editor:
Map<String,String> attributes=new HashMap<String,String>();
attributes.put("title",title);
param=getInitialCroppingParameter(galleryMode,resourcePath);
attributes.put("width",String.valueOf(param.getResultingWidth()));
attributes.put("height",String.valueOf(param.getResultingHeight()));
CmsPreviewUtil.setImage(CmsCoreProvider.get().link(resourcePath),attributes);
CmsPreviewUtil.closeDialog();
break;
case ade:
case view:
default :
break;
}
}
