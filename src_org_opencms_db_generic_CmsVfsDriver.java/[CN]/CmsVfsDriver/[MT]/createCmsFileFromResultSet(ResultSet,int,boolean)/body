{
  byte[] content=null;
  int resProjectId=I_CmsConstants.C_UNKNOWN_ID;
  CmsUUID structureId=new CmsUUID(res.getString(m_sqlManager.get("C_RESOURCES_STRUCTURE_ID")));
  CmsUUID resourceId=new CmsUUID(res.getString(m_sqlManager.get("C_RESOURCES_RESOURCE_ID")));
  CmsUUID parentId=new CmsUUID(res.getString(m_sqlManager.get("C_RESOURCES_PARENT_ID")));
  String resourceName=res.getString(m_sqlManager.get("C_RESOURCES_RESOURCE_NAME"));
  int resourceType=res.getInt(m_sqlManager.get("C_RESOURCES_RESOURCE_TYPE"));
  int resourceFlags=res.getInt(m_sqlManager.get("C_RESOURCES_RESOURCE_FLAGS"));
  CmsUUID fileId=new CmsUUID(res.getString(m_sqlManager.get("C_RESOURCES_FILE_ID")));
  int resourceState=res.getInt(m_sqlManager.get("C_RESOURCES_STATE"));
  int structureState=res.getInt(m_sqlManager.get("C_RESOURCES_STRUCTURE_STATE"));
  CmsUUID lockedBy=new CmsUUID(res.getString(m_sqlManager.get("C_RESOURCES_LOCKED_BY")));
  int launcherType=res.getInt(m_sqlManager.get("C_RESOURCES_LAUNCHER_TYPE"));
  String launcherClass=m_driverManager.getResourceType(resourceType).getLauncherClass();
  long dateCreated=SqlHelper.getTimestamp(res,m_sqlManager.get("C_RESOURCES_DATE_CREATED")).getTime();
  long dateLastModified=SqlHelper.getTimestamp(res,m_sqlManager.get("C_RESOURCES_DATE_LASTMODIFIED")).getTime();
  long structureDateLastModified=SqlHelper.getTimestamp(res,m_sqlManager.get("C_RESOURCES_STRUCTURE_DATE_LASTMODIFIED")).getTime();
  int resourceSize=res.getInt(m_sqlManager.get("C_RESOURCES_SIZE"));
  CmsUUID userCreated=new CmsUUID(res.getString(m_sqlManager.get("C_RESOURCES_USER_CREATED")));
  CmsUUID userLastModified=new CmsUUID(res.getString(m_sqlManager.get("C_RESOURCES_USER_LASTMODIFIED")));
  CmsUUID structureUserLastModified=new CmsUUID(res.getString(m_sqlManager.get("C_RESOURCES_STRUCTURE_USER_LASTMODIFIED")));
  int lockedInProject=res.getInt("LOCKED_IN_PROJECT");
  int vfsLinkType=res.getInt(m_sqlManager.get("C_RESOURCES_LINK_TYPE"));
  if (hasFileContentInResultSet) {
    content=m_sqlManager.getBytes(res,m_sqlManager.get("C_RESOURCES_FILE_CONTENT"));
  }
 else {
    content=new byte[0];
  }
  if (!lockedBy.equals(CmsUUID.getNullUUID())) {
    resProjectId=lockedInProject;
  }
 else {
    resProjectId=projectId;
    lockedInProject=projectId;
  }
  if (org.opencms.db.generic.CmsProjectDriver.C_USE_TARGET_DATE && resourceType == org.opencms.db.generic.CmsProjectDriver.C_RESTYPE_LINK_ID && resourceFlags > 0) {
    dateLastModified=fetchDateFromResource(projectId,resourceFlags,dateLastModified);
  }
  int newState=(structureState > resourceState) ? structureState : resourceState;
  long newDateLastModified=(structureDateLastModified > dateLastModified) ? structureDateLastModified : dateLastModified;
  CmsUUID newUserLastModified=(structureDateLastModified > dateLastModified) ? structureUserLastModified : userLastModified;
  return new CmsFile(structureId,resourceId,parentId,fileId,resourceName,resourceType,resourceFlags,resProjectId,0,newState,lockedBy,launcherType,launcherClass,dateCreated,userCreated,newDateLastModified,newUserLastModified,content,resourceSize,lockedInProject,vfsLinkType);
}
