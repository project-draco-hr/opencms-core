{
  List files=readChildResources(currentProject,resource,false,true);
  files=internalFilterUndeletedResources(files);
  if (files.size() == 0) {
    List folders=readChildResources(currentProject,resource,true,false);
    folders=internalFilterUndeletedResources(folders);
    if (folders.size() == 0) {
      internalRemoveFolder(currentProject,resource);
    }
 else {
      String errorResNames="";
      for (int i=0, n=folders.size(); i < n; i++) {
        CmsResource errorRes=(CmsResource)folders.get(i);
        errorResNames+="[" + errorRes.getName() + "]";
      }
      throw new CmsException("[" + this.getClass().getName() + "] "+ resource.getName()+ errorResNames,CmsException.C_NOT_EMPTY);
    }
  }
 else {
    String errorResNames="";
    for (int i=0, n=files.size(); i < n; i++) {
      CmsResource errorRes=(CmsResource)files.get(i);
      errorResNames+="[" + errorRes.getName() + "]";
    }
    throw new CmsException("[" + this.getClass().getName() + "] "+ resource.getName()+ errorResNames,CmsException.C_NOT_EMPTY);
  }
}
