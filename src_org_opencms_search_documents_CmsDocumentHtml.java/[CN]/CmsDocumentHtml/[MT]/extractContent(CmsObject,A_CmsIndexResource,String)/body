{
  CmsResource resource=(CmsResource)indexResource.getData();
  CmsFile file=readFile(cms,resource);
  try {
    String path=cms.getRequestContext().removeSiteRoot(resource.getRootPath());
    CmsProperty encProp=cms.readPropertyObject(path,I_CmsConstants.C_PROPERTY_CONTENT_ENCODING,true);
    String encoding=encProp.getValue(OpenCms.getSystemInfo().getDefaultEncoding());
    return CmsExtractorHtml.getExtractor().extractText(file.getContents(),encoding);
  }
 catch (  Exception e) {
    throw new CmsIndexException("Extracting text from resource " + resource.getRootPath() + " failed: "+ e.getMessage(),e);
  }
}
