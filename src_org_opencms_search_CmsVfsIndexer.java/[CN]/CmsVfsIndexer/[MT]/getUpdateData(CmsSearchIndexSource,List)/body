{
  CmsSearchIndexUpdateData result=new CmsSearchIndexUpdateData(source,this);
  Iterator i=publishedResources.iterator();
  while (i.hasNext()) {
    CmsPublishedResource resource=(CmsPublishedResource)i.next();
    if (!resource.getStructureId().isNullUUID()) {
      if (CmsProject.isInsideProject(source.getResourcesNames(),resource.getRootPath())) {
        if (resource.getState().isNew()) {
          if (isResourceInTimeWindow(resource)) {
            result.addResourceToUpdate(resource);
          }
        }
 else         if (resource.getState().isDeleted()) {
          result.addResourceToDelete(resource);
        }
 else         if (resource.getState().isChanged() || resource.getState().isUnchanged()) {
          result.addResourceToDelete(resource);
          if (isResourceInTimeWindow(resource)) {
            result.addResourceToUpdate(resource);
          }
        }
      }
    }
  }
  return result;
}
