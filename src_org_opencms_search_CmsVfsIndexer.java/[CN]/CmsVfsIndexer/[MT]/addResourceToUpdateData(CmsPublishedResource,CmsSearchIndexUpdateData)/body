{
  if (pubRes.getState().isNew()) {
    if (pubRes.getPublishTag() < 0) {
      if (isResourceInTimeWindow(pubRes)) {
        updateData.addResourceToUpdate(pubRes);
      }
 else {
        pubRes.setState(CmsResourceState.STATE_DELETED);
        updateData.addResourceToDelete(pubRes);
      }
    }
 else {
      updateData.addResourceToUpdate(pubRes);
    }
  }
 else   if (pubRes.getState().isDeleted()) {
    updateData.addResourceToDelete(pubRes);
  }
 else   if (pubRes.getState().isChanged() || pubRes.getState().isUnchanged()) {
    if (pubRes.getPublishTag() < 0) {
      if (isResourceInTimeWindow(pubRes)) {
        updateData.addResourceToUpdate(pubRes);
      }
 else {
        pubRes.setState(CmsResourceState.STATE_DELETED);
        updateData.addResourceToDelete(pubRes);
      }
    }
 else {
      updateData.addResourceToUpdate(pubRes);
    }
  }
}
