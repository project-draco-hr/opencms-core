{
  if (pubRes.getState().isNew()) {
    if (pubRes.getPublishTag() < 0) {
      updateData.addResourceToDelete(pubRes);
    }
    if (isResourceInTimeWindow(pubRes)) {
      updateData.addResourceToUpdate(pubRes);
    }
 else     if (pubRes.getPublishTag() < 0) {
      pubRes.setState(CmsResourceState.STATE_DELETED);
    }
  }
 else   if (pubRes.getState().isDeleted()) {
    updateData.addResourceToDelete(pubRes);
  }
 else   if (pubRes.getState().isChanged() || pubRes.getState().isUnchanged()) {
    updateData.addResourceToDelete(pubRes);
    if (isResourceInTimeWindow(pubRes)) {
      updateData.addResourceToUpdate(pubRes);
    }
 else     if (pubRes.getPublishTag() < 0) {
      pubRes.setState(CmsResourceState.STATE_DELETED);
    }
  }
}
