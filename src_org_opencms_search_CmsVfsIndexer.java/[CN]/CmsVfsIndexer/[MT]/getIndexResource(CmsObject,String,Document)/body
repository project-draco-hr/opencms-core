{
  Field f=null;
  String path=null;
  CmsResource resource=null;
  A_CmsIndexResource result=null;
  if ((f=doc.getField(I_CmsDocumentFactory.DOC_PATH)) != null) {
    path=cms.getRequestContext().removeSiteRoot(f.stringValue());
    resource=cms.readResource(path);
    if (cms.hasPermissions(resource,I_CmsConstants.C_READ_ACCESS) && resource.getRootPath().startsWith(searchRoot)) {
      result=new CmsVfsIndexResource(resource);
    }
  }
  return result;
}
