{
  CmsXmlWpTemplateFile xmlTemplateDocument=new CmsXmlWpTemplateFile(cms,templateFile);
  if (parameters.get("message") != null) {
    OpenCms.getSessionInfoManager().sendBroadcastMessage(cms,(String)parameters.get("message"));
  }
  List sessionInfos=OpenCms.getSessionInfoManager().getSessionInfos();
  Collections.sort(sessionInfos);
  StringBuffer ret=new StringBuffer();
  Iterator i=sessionInfos.iterator();
  int count=1;
  PrintfFormat format=new PrintfFormat("%3.3d");
  while (i.hasNext()) {
    try {
      CmsSessionInfo info=(CmsSessionInfo)i.next();
      CmsUser cmsUser=info.getUser();
      CmsProject cmsProject=cms.readProject(info.getProject().intValue());
      xmlTemplateDocument.setData("username",cmsUser.getName());
      xmlTemplateDocument.setData("firstname",cmsUser.getFirstname());
      xmlTemplateDocument.setData("lastname",cmsUser.getLastname());
      xmlTemplateDocument.setData("email",cmsUser.getEmail());
      xmlTemplateDocument.setData("currentgroup",format.sprintf(count) + " - " + CmsDateUtil.getDateTimeShort(info.getTimeCreated())+ " - "+ CmsStringUtil.formatRuntime(System.currentTimeMillis() - info.getTimeUpdated()));
      xmlTemplateDocument.setData("messagepending",String.valueOf(info.getBroadcastMessageQueue().hasBroadcastMessagesPending()));
      xmlTemplateDocument.setData("currentproject",cmsProject.getName());
      ret.append(xmlTemplateDocument.getProcessedDataValue("line"));
      count++;
    }
 catch (    Exception exc) {
    }
  }
  xmlTemplateDocument.setData("all_lines",ret.toString());
  return startProcessing(cms,xmlTemplateDocument,elementName,parameters,templateSelector);
}
