{
  CmsUserSettings settings=new CmsUserSettings(m_cms.getRequestContext().currentUser());
  CmsMessages messages=CmsXmlContentDefinition.getContentHandlerForResource(m_cms,element.getElement()).getMessages(settings.getLocale());
  JSONObject result=new JSONObject();
  JSONObject jSONProperties=new JSONObject();
  Map<String,CmsXmlContentProperty> propertiesConf=CmsContainerElementBean.getPropertyConfiguration(m_cms,element.getElement());
  Map<String,CmsProperty> properties=element.getProperties();
  Iterator<String> itProperties=propertiesConf.keySet().iterator();
  while (itProperties.hasNext()) {
    JSONObject jSONProperty=new JSONObject();
    String propertyName=itProperties.next();
    CmsXmlContentProperty conf=propertiesConf.get(propertyName);
    CmsMacroResolver.resolveMacros(conf.getWidgetConfiguration(),m_cms,Messages.get().getBundle());
    jSONProperty.put(P_PROPERTY_VALUE,properties.get(propertyName).getStructureValue());
    jSONProperty.put(P_PROPERTY_DEFAULT_VALUE,conf.getDefault());
    jSONProperty.put(P_PROPERTY_TYPE,conf.getPropertyType());
    jSONProperty.put(P_PROPERTY_WIDGET,conf.getWidget());
    jSONProperty.put(P_PROPERTY_WIDGET_CONF,CmsMacroResolver.resolveMacros(conf.getWidgetConfiguration(),m_cms,messages));
    jSONProperty.put(P_PROPERTY_RULE_TYPE,conf.getRuleType());
    jSONProperty.put(P_PROPERTY_RULE_REGEX,conf.getRuleRegex());
    jSONProperty.put(P_PROPERTY_NICE_NAME,CmsMacroResolver.resolveMacros(conf.getNiceName(),m_cms,messages));
    jSONProperty.put(P_PROPERTY_DESCRIPTION,CmsMacroResolver.resolveMacros(conf.getDescription(),m_cms,messages));
    jSONProperty.put(P_PROPERTY_ERROR,CmsMacroResolver.resolveMacros(conf.getError(),m_cms,messages));
    jSONProperties.put(propertyName,jSONProperty);
  }
  result.put(P_PROPERTY_PROPERTIES,jSONProperties);
  return result;
}
