{
  JSONObject resElement=new JSONObject();
  CmsResource resource=m_cms.readResource(element.getElementId());
  CmsResourceUtil resUtil=new CmsResourceUtil(m_cms,resource);
  resElement.put(JsonElement.objtype.name(),TYPE_ELEMENT);
  resElement.put(JsonElement.id.name(),element.getClientId());
  resElement.put(JsonElement.file.name(),resUtil.getFullPath());
  resElement.put(JsonElement.date.name(),resource.getDateLastModified());
  resElement.put(JsonElement.user.name(),m_cms.readUser(resource.getUserLastModified()).getName());
  resElement.put(JsonElement.navText.name(),resUtil.getNavText());
  resElement.put(JsonElement.title.name(),resUtil.getTitle());
  resElement.put(JsonElement.noEditReason.name(),CmsEncoder.escapeHtml(resUtil.getNoEditReason(OpenCms.getWorkplaceManager().getWorkplaceLocale(m_cms))));
  resElement.put(JsonElement.status.name(),"" + resUtil.getStateAbbreviation());
  JSONObject resContents=new JSONObject();
  resElement.put(JsonElement.contents.name(),resContents);
  JSONObject formatters=new JSONObject();
  resElement.put(JsonElement.formatters.name(),formatters);
  if (resource.getTypeId() == CmsResourceTypeXmlContainerPage.SUB_CONTAINER_TYPE_ID) {
    I_CmsResourceType resType=OpenCms.getResourceManager().getResourceType(resource);
    CmsXmlSubContainer xmlSubContainer=CmsXmlSubContainerFactory.unmarshal(m_cms,resource,m_req);
    CmsSubContainerBean subContainer=xmlSubContainer.getSubContainer(m_cms,m_cms.getRequestContext().getLocale());
    resElement.put(JsonElement.description.name(),subContainer.getDescription());
    JSONArray jTypes=new JSONArray();
    resElement.put(JsonElement.types.name(),jTypes);
    if (subContainer.getTypes().isEmpty()) {
      if (subContainer.getElements().isEmpty()) {
        String emptySub="<div>NEW AND EMPTY</div>";
        for (        String type : types) {
          String formatter=OpenCms.getADEManager().getFormatterForContainerTypeAndWidth(m_cms,resource,type,-1);
          formatters.put(type,formatter);
          resContents.put(type,emptySub);
        }
      }
 else {
        return null;
      }
    }
 else {
      for (      String type : subContainer.getTypes()) {
        jTypes.put(type);
        if (types.contains(type)) {
          formatters.put(type,resType.getFormatterForContainerTypeAndWidth(m_cms,resource,type,-1));
          resContents.put(type,"<div>should not be used</div>");
        }
      }
    }
    String jspResult;
    String defaultFormatter=OpenCms.getResourceManager().getResourceType(resource).getFormatterForContainerTypeAndWidth(m_cms,resource,CmsDefaultXmlContentHandler.DEFAULT_FORMATTER_TYPE,-1);
    try {
      jspResult=getElementContent(element,m_cms.readResource(defaultFormatter));
      formatters.put(CmsDefaultXmlContentHandler.DEFAULT_FORMATTER_TYPE,defaultFormatter);
      resContents.put(CmsDefaultXmlContentHandler.DEFAULT_FORMATTER_TYPE,jspResult);
    }
 catch (    Exception e) {
      LOG.error(Messages.get().getBundle().key(Messages.ERR_GENERATE_FORMATTED_ELEMENT_3,m_cms.getSitePath(resource),defaultFormatter,CmsDefaultXmlContentHandler.DEFAULT_FORMATTER_TYPE),e);
    }
    JSONArray subitems=new JSONArray();
    resElement.put(JsonElement.subItems.name(),subitems);
    for (    CmsContainerElementBean subElement : subContainer.getElements()) {
      subitems.put(subElement.getClientId());
    }
  }
 else {
    Iterator<String> it=types.iterator();
    I_CmsResourceType resType=OpenCms.getResourceManager().getResourceType(resource);
    while (it.hasNext()) {
      String type=it.next();
      String formatterUri=resType.getFormatterForContainerTypeAndWidth(m_cms,resource,type,-1);
      if (CmsStringUtil.isEmptyOrWhitespaceOnly(formatterUri)) {
        continue;
      }
      formatters.put(type,formatterUri);
      try {
        String jspResult=getElementContent(element,m_cms.readResource(formatterUri));
        resContents.put(type,jspResult);
      }
 catch (      Exception e) {
        LOG.error(Messages.get().getBundle().key(Messages.ERR_GENERATE_FORMATTED_ELEMENT_3,m_cms.getSitePath(resource),formatterUri,type),e);
      }
    }
    String defaultFormatter=OpenCms.getResourceManager().getResourceType(resource).getFormatterForContainerTypeAndWidth(m_cms,resource,CmsDefaultXmlContentHandler.DEFAULT_FORMATTER_TYPE,-1);
    String jspResult;
    try {
      jspResult=getElementContent(element,m_cms.readResource(defaultFormatter));
      formatters.put(CmsDefaultXmlContentHandler.DEFAULT_FORMATTER_TYPE,defaultFormatter);
      resContents.put(CmsDefaultXmlContentHandler.DEFAULT_FORMATTER_TYPE,jspResult);
    }
 catch (    Exception e) {
      LOG.error(Messages.get().getBundle().key(Messages.ERR_GENERATE_FORMATTED_ELEMENT_3,m_cms.getSitePath(resource),defaultFormatter,CmsDefaultXmlContentHandler.DEFAULT_FORMATTER_TYPE),e);
    }
  }
  return resElement;
}
