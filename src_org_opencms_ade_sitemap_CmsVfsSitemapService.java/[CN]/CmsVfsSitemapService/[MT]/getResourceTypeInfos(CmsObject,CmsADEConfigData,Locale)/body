{
  List<CmsNewResourceInfo> result=new ArrayList<CmsNewResourceInfo>();
  for (  CmsResourceTypeConfig typeConfig : configData.getResourceTypes()) {
    if (typeConfig.getDetailPagesDisabled()) {
      continue;
    }
    String typeName=typeConfig.getTypeName();
    try {
      I_CmsResourceType resourceType=OpenCms.getResourceManager().getResourceType(typeName);
      result.add(createResourceTypeInfo(resourceType,configData.getDefaultModelPage().getResource()));
    }
 catch (    CmsLoaderException e) {
      LOG.error(e.getLocalizedMessage(),e);
    }
  }
  List<CmsFunctionReference> functionRefs=configData.getFunctionReferences();
  for (  CmsFunctionReference functionRef : functionRefs) {
    try {
      CmsResource functionRes=cms.readResource(functionRef.getStructureId());
      String description=cms.readPropertyObject(functionRes,CmsPropertyDefinition.PROPERTY_DESCRIPTION,false).getValue();
      String subtitle=description;
      try {
        CmsGallerySearch search=new CmsGallerySearch();
        search.init(cms);
        search.setIndex(CmsGallerySearchIndex.GALLERY_INDEX_NAME);
        CmsGallerySearchResult searchResult=search.searchById(functionRef.getStructureId(),locale);
        subtitle=searchResult.getDescription();
      }
 catch (      CmsException e) {
        LOG.warn(e.getLocalizedMessage(),e);
      }
      CmsNewResourceInfo info=new CmsNewResourceInfo(configData.getDefaultModelPage().getResource().getTypeId(),CmsDetailPageInfo.FUNCTION_PREFIX + functionRef.getName(),functionRef.getName(),description,configData.getDefaultModelPage().getResource().getStructureId(),subtitle);
      info.setAdditionalData(functionRef.getStructureId().toString());
      info.setIsFunction(true);
      result.add(info);
    }
 catch (    CmsVfsResourceNotFoundException e) {
      LOG.warn(e.getLocalizedMessage(),e);
    }
catch (    CmsException e) {
      LOG.error(e.getLocalizedMessage(),e);
    }
  }
  return result;
}
