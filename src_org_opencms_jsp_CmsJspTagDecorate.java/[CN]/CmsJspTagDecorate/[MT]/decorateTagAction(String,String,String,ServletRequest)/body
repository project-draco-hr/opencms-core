{
  try {
    Locale loc=null;
    CmsFlexController controller=CmsFlexController.getController(req);
    if (CmsStringUtil.isEmpty(locale)) {
      loc=controller.getCmsObject().getRequestContext().getLocale();
    }
 else {
      loc=new Locale(locale);
    }
    String encoding=controller.getCmsObject().getRequestContext().getEncoding();
    CmsDecoratorConfiguration config=new CmsDecoratorConfiguration(controller.getCmsObject(),configFile,loc);
    return CmsHtmlDecorator.doDecoration(content,config,encoding);
  }
 catch (  Exception e) {
    if (LOG.isErrorEnabled()) {
      LOG.error(Messages.get().getBundle().key(Messages.ERR_PROCESS_TAG_1,"decoration"),e);
    }
    return content;
  }
}
