{
  if (errorHandler == null) {
    errorHandler=new CmsXmlContentErrorHandler();
  }
  String valueStr=null;
  String regex=(String)m_validationErrorRules.get(value.getElementName());
  if (regex != null) {
    Pattern pattern;
    boolean matchResult=true;
    if (regex.charAt(0) == '!') {
      matchResult=false;
      regex=regex.substring(1);
    }
    try {
      valueStr=value.getStringValue(cms);
      pattern=Pattern.compile(regex,Pattern.CASE_INSENSITIVE);
    }
 catch (    Exception e) {
      errorHandler.addError(value,e.getMessage());
      return errorHandler;
    }
    if (matchResult != pattern.matcher(valueStr).matches()) {
      errorHandler.addError(value,"Invalid value '" + valueStr + "' according to regex '"+ (matchResult ? "" : "!")+ regex+ "'");
    }
  }
  regex=(String)m_validationWarningRules.get(value.getElementName());
  if (regex != null) {
    Pattern pattern;
    boolean matchResult=true;
    if (regex.charAt(0) == '!') {
      matchResult=false;
      regex=regex.substring(1);
    }
    try {
      valueStr=value.getStringValue(cms);
      pattern=Pattern.compile(regex,Pattern.CASE_INSENSITIVE);
    }
 catch (    Exception e) {
      errorHandler.addError(value,e.getMessage());
      return errorHandler;
    }
    if (matchResult != pattern.matcher(valueStr).matches()) {
      errorHandler.addWarning(value,"Bad value '" + valueStr + "' according to regex '"+ (matchResult ? "" : "!")+ regex+ "'");
    }
  }
  return errorHandler;
}
