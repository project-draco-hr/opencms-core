{
  Hashtable site=null;
  Hashtable category_map=new Hashtable();
  Hashtable country_map=new Hashtable();
  Vector country_names=new Vector();
  String country_key=null;
  int category_place=0, country_place=0, country_count=0;
  for (int i=0; i < categories.size(); i++)   category_map.put(new Integer(((CmsCategory)categories.elementAt(i)).getId()),new Integer(i));
  country_count=0;
  for (int i=0; i < sites.size(); i++) {
    site=(Hashtable)sites.elementAt(i);
    country_key=site.get("countryid").toString() + "x" + site.get("langid").toString();
    if (!country_map.containsKey(country_key)) {
      country_place=country_count++;
      country_map.put(country_key,new Integer(country_place));
      country_names.addElement((String)site.get("countryname") + "/" + (String)site.get("langname"));
    }
  }
  Hashtable matrix[][]=new Hashtable[categories.size()][country_names.size()];
  for (int i=0; i < sites.size(); i++) {
    site=(Hashtable)sites.elementAt(i);
    country_key=site.get("countryid").toString() + "x" + site.get("langid").toString();
    category_place=((Integer)category_map.get((Integer)site.get("categoryid"))).intValue();
    country_place=((Integer)country_map.get(country_key)).intValue();
    matrix[category_place][country_place]=site;
  }
  Object result[]={country_names,matrix};
  return result;
}
