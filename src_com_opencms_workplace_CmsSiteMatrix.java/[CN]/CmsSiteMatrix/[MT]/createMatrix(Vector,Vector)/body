{
  Hashtable site=null;
  Hashtable category_map=new Hashtable();
  Hashtable country_map=new Hashtable();
  String country_key=null;
  int category_place, country_place, country_count;
  for (int i=0; i < categories.size(); i++)   category_map.put(new Integer(((CmsCategory)categories.elementAt(i)).getId()),new Integer(i + 1));
  country_count=0;
  Object matrix[][]=new Object[categories.size() + 1][country_map.size()];
  for (int i=0; i < sites.size(); i++) {
    site=(Hashtable)sites.elementAt(i);
    country_key=site.get("countryid").toString() + "x" + site.get("langid").toString();
    if (country_map.containsKey(country_key)) {
      country_place=((Integer)country_map.get(country_key)).intValue();
    }
 else {
      country_place=country_count++;
      matrix[0][country_place]=(String)site.get("countryname") + "/" + (String)site.get("langname");
      country_map.put(country_key,new Integer(country_place));
    }
    category_place=((Integer)category_map.get((Integer)site.get("categoryid"))).intValue();
    matrix[category_place][country_place]=site;
  }
  return matrix;
}
