{
  if (systemId.equals(CmsXmlPage.C_XMLPAGE_DTD_SYSTEM_ID) || systemId.endsWith(C_XMLPAGE_DTD_OLD_SYSTEM_ID)) {
    try {
      return new InputSource(getClass().getClassLoader().getResourceAsStream(C_XMLPAGE_DTD_LOCATION));
    }
 catch (    Throwable t) {
      OpenCms.getLog(this).error("Did not find CmsXmlPage DTD at " + C_XMLPAGE_DTD_LOCATION);
    }
  }
 else   if (systemId.startsWith(C_OPENCMS_SCHEME)) {
    String uri=systemId.substring(C_OPENCMS_SCHEME.length() - 1);
    try {
      byte[] content=(byte[])m_cache.get(uri);
      if (content == null) {
        CmsFile file=m_cms.readFile(uri);
        content=file.getContents();
        m_cache.put(uri,content);
      }
      return new InputSource(new ByteArrayInputStream(content));
    }
 catch (    Throwable t) {
      OpenCms.getLog(this).error("Could not resolve OpenCms xml entity reference '" + systemId + "'",t);
    }
  }
  return null;
}
