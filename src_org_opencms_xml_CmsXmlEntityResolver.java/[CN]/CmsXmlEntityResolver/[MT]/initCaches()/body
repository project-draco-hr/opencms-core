{
  if (m_cacheTemporary == null) {
    Map<String,byte[]> cacheTemporary=CmsCollectionsGenericWrapper.createLRUMap(1024);
    m_cacheTemporary=Collections.synchronizedMap(cacheTemporary);
    Map<String,byte[]> cachePermanent=new HashMap<String,byte[]>(32);
    m_cachePermanent=Collections.synchronizedMap(cachePermanent);
    Map<String,CmsXmlContentDefinition> cacheContentDefinitions=CmsCollectionsGenericWrapper.createLRUMap(CONTENT_DEFINITION_CACHE_SIZE);
    m_cacheContentDefinitions=Collections.synchronizedMap(cacheContentDefinitions);
  }
  if (OpenCms.getRunLevel() > OpenCms.RUNLEVEL_1_CORE_OBJECT) {
    if ((OpenCms.getMemoryMonitor() != null) && !OpenCms.getMemoryMonitor().isMonitoring(CmsXmlEntityResolver.class.getName() + ".cacheTemporary")) {
      Map<String,byte[]> cacheTemporary=CmsCollectionsGenericWrapper.createLRUMap(128);
      cacheTemporary.putAll(m_cacheTemporary);
      m_cacheTemporary=Collections.synchronizedMap(cacheTemporary);
      OpenCms.getMemoryMonitor().register(CmsXmlEntityResolver.class.getName() + ".cacheTemporary",cacheTemporary);
      Map<String,byte[]> cachePermanent=new HashMap<String,byte[]>(32);
      cachePermanent.putAll(m_cachePermanent);
      m_cachePermanent=Collections.synchronizedMap(cachePermanent);
      OpenCms.getMemoryMonitor().register(CmsXmlEntityResolver.class.getName() + ".cachePermanent",cachePermanent);
      Map<String,CmsXmlContentDefinition> cacheContentDefinitions=CmsCollectionsGenericWrapper.createLRUMap(CONTENT_DEFINITION_CACHE_SIZE);
      cacheContentDefinitions.putAll(m_cacheContentDefinitions);
      m_cacheContentDefinitions=Collections.synchronizedMap(cacheContentDefinitions);
      OpenCms.getMemoryMonitor().register(CmsXmlEntityResolver.class.getName() + ".cacheContentDefinitions",cacheContentDefinitions);
    }
  }
}
