{
  CmsPermissionSet permissions=null;
  int denied=0;
  if ((checks & C_CHECK_PROJECT) > 0 && this.getProject().isOnlineProject())   denied|=C_PERMISSION_WRITE;
  if ((checks & C_CHECK_RESTYPE) > 0) {
    I_CmsResourceType resType=getResourceType(getUser(),getProject(),resource.getType());
    if (("XMLTemplate".equals(resType.getResourceTypeName()) || "jsp".equals(resType.getResourceTypeName())) && !isAdmin(getUser(),getProject()))     denied|=C_PERMISSION_WRITE;
  }
  if ((checks & C_CHECK_LOCKSTATE) > 0 && resource.isLocked()) {
    if (!this.getUser().getId().equals(resource.isLockedBy()))     denied|=C_PERMISSION_WRITE;
    if ((this.getProject().getId() != resource.getLockedInProject()) && !isTempfileProject(readProject(resource.getLockedInProject()))) {
      if (isTempfileProject(this.getProject())) {
        denied|=C_PERMISSION_WRITE;
      }
 else {
        denied|=C_PERMISSION_WRITE;
      }
    }
  }
  if (isAdmin(getUser(),getProject())) {
    permissions=new CmsPermissionSet(~0);
  }
 else {
    CmsAccessControlList acl=getAccessControlList(getUser(),getProject(),resource);
    permissions=acl.getPermissions(getUser(),getGroupsOfUser(getUser(),getProject(),getUser().getName()));
  }
  permissions.denyPermissions(denied);
  return permissions;
}
