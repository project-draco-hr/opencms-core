{
  if (!userInGroup(context,username,groupname)) {
    if (isAdmin(context)) {
      CmsUser user;
      CmsGroup group;
      try {
        user=readUser(username);
      }
 catch (      CmsException e) {
        if (e.getType() == CmsException.C_NO_USER) {
          user=readWebUser(context,username);
        }
 else {
          throw e;
        }
      }
      if (user != null) {
        group=readGroup(context,groupname);
        if (group != null) {
          m_userDriver.addUserToGroup(user.getId(),group.getId());
          m_userGroupsCache.clear();
        }
 else {
          throw new CmsException("[" + getClass().getName() + "]"+ groupname,CmsException.C_NO_GROUP);
        }
      }
 else {
        throw new CmsException("[" + getClass().getName() + "]"+ username,CmsException.C_NO_USER);
      }
    }
 else {
      throw new CmsException("[" + this.getClass().getName() + "] "+ username,CmsException.C_NO_ACCESS);
    }
  }
}
