{
  if (user.isGuestUser()) {
    return Collections.EMPTY_LIST;
  }
  String key=user.getId().toString();
  List result=m_monitor.getCachedRoleList(key);
  if (result != null) {
    return result;
  }
  result=new ArrayList();
  List roles=new ArrayList(getGroupsOfUser(dbc,user.getName(),"",true,true,false,dbc.getRequestContext().getRemoteAddress()));
  Iterator it=roles.iterator();
  while (it.hasNext()) {
    CmsGroup group=(CmsGroup)it.next();
    CmsRole givenRole=CmsRole.valueOf(group);
    givenRole=givenRole.forOrgUnit(null);
    if (!result.contains(givenRole)) {
      result.add(givenRole);
    }
  }
  result=Collections.unmodifiableList(result);
  m_monitor.cacheRoleList(key,result);
  return result;
}
