{
  CmsFolder cmsFolder=null;
  try {
    cmsFolder=readFolder(currentUser,currentProject,foldername,includeDeleted);
  }
 catch (  CmsException exc) {
    if (exc.getType() == CmsException.C_NOT_FOUND) {
      return new Vector();
    }
 else {
      throw exc;
    }
  }
  if ((cmsFolder.getState() == I_CmsConstants.C_STATE_DELETED) && (!includeDeleted)) {
    return null;
  }
  Vector _files=m_vfsDriver.getFilesInFolder(currentProject.getId(),cmsFolder);
  Vector files=new Vector(_files.size());
  for (Enumeration e=_files.elements(); e.hasMoreElements(); ) {
    CmsFile file=(CmsFile)e.nextElement();
    if (hasPermissions(currentUser,currentProject,file,I_CmsConstants.C_READ_ACCESS,false)) {
      files.addElement(file);
    }
  }
  return files;
}
