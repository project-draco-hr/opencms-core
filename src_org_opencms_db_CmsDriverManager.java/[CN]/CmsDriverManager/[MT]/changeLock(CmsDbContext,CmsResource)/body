{
  if (getLock(dbc,resource).isNullLock()) {
    throw new CmsLockException(Messages.get().container(Messages.ERR_CHANGE_LOCK_UNLOCKED_RESOURCE_1,dbc.getRequestContext().getSitePath(resource)));
  }
  CmsLock exclusiveLock=m_lockManager.getExclusiveLockedSibling(this,dbc,resource);
  m_lockManager.removeResource(this,dbc,resource,true);
  m_securityManager.clearPermissionCache();
  try {
    lockResource(dbc,resource,CmsLock.C_MODE_COMMON);
  }
 catch (  CmsSecurityException e) {
    m_lockManager.addResource(this,dbc,resource,exclusiveLock.getUserId(),exclusiveLock.getProjectId(),CmsLock.C_MODE_COMMON);
    throw e;
  }
}
