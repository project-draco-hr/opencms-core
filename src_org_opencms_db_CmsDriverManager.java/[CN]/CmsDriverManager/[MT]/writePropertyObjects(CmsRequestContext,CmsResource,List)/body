{
  if ((properties == null) || (properties.size() == 0)) {
    return;
  }
  try {
    checkPermissions(context,resource,I_CmsConstants.C_WRITE_ACCESS,true,CmsResourceFilter.IGNORE_EXPIRATION);
    internalWritePropertyObjects(context,resource,properties);
    resource.setUserLastModified(context.currentUser().getId());
    m_vfsDriver.writeResource(context.currentProject(),resource,C_UPDATE_RESOURCE_STATE);
  }
  finally {
    clearResourceCache();
    m_propertyCache.clear();
    OpenCms.fireCmsEvent(new CmsEvent(I_CmsEventListener.EVENT_RESOURCE_AND_PROPERTIES_MODIFIED,Collections.singletonMap("resource",resource)));
  }
}
