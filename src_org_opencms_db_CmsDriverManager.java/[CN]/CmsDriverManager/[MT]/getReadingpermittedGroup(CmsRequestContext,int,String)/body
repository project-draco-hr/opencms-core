{
  CmsResource res=readFileHeader(context,resource);
  CmsAccessControlList acList=getAccessControlList(context,res);
  String rpgroupName=null;
  CmsGroup g=readGroup(context,I_CmsConstants.C_GROUP_GUEST);
  if ((acList.getPermissions(g).getPermissions() & I_CmsConstants.C_PERMISSION_READ) > 0)   return g.getName();
  Enumeration groups=getGroupsOfUser(context,context.currentUser().getName()).elements();
  while (rpgroupName == null && groups.hasMoreElements()) {
    g=(CmsGroup)groups.nextElement();
    if ((acList.getPermissions(g).getPermissions() & I_CmsConstants.C_PERMISSION_READ) > 0)     rpgroupName=g.getName();
  }
  return (rpgroupName != null) ? rpgroupName : I_CmsConstants.C_GROUP_ADMIN;
}
