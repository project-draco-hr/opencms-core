{
  CmsProject project=readProject(dbc,projectId);
  if ((isAdmin(dbc) || isManagerOfProject(dbc)) && (project.getFlags() == I_CmsConstants.C_PROJECT_STATE_UNLOCKED)) {
    m_lockManager.removeResourcesInProject(projectId);
    clearResourceCache();
    m_projectCache.clear();
    m_securityManager.clearPermissionCache();
  }
 else   if (!isAdmin(dbc) && !isManagerOfProject(dbc)) {
    throw new CmsSecurityException("[" + this.getClass().getName() + "] unlockProject() "+ projectId,CmsSecurityException.C_SECURITY_PROJECTMANAGER_PRIVILEGES_REQUIRED);
  }
 else {
    throw new CmsSecurityException("[" + this.getClass().getName() + "] unlockProject() "+ projectId,CmsSecurityException.C_SECURITY_NO_PERMISSIONS);
  }
}
