{
  if (!userInGroup(dbc,username,groupname)) {
    if (isAdmin(dbc)) {
      CmsUser user;
      CmsGroup group;
      try {
        user=readUser(dbc,username);
      }
 catch (      CmsException e) {
        if (e.getType() == CmsException.C_NO_USER) {
          user=readWebUser(dbc,username);
        }
 else {
          throw e;
        }
      }
      if (user != null) {
        group=readGroup(dbc,groupname);
        if (group != null) {
          m_userDriver.createUserInGroup(dbc,user.getId(),group.getId(),null);
          m_userGroupsCache.clear();
        }
 else {
          throw new CmsException("[" + getClass().getName() + "]"+ groupname,CmsException.C_NO_GROUP);
        }
      }
 else {
        throw new CmsException("[" + getClass().getName() + "]"+ username,CmsException.C_NO_USER);
      }
    }
 else {
      throw new CmsSecurityException("[" + this.getClass().getName() + "] addUserToGroup() "+ username+ " "+ groupname,CmsSecurityException.C_SECURITY_ADMIN_PRIVILEGES_REQUIRED);
    }
  }
}
