{
  CmsResource targetResource=null;
  CmsFile linkResource=null;
  String parentFolderName=null;
  CmsFolder parentFolder=null;
  String resourceName=null;
  parentFolderName=linkName.substring(0,linkName.lastIndexOf(I_CmsConstants.C_FOLDER_SEPARATOR) + 1);
  resourceName=linkName.substring(linkName.lastIndexOf(I_CmsConstants.C_FOLDER_SEPARATOR) + 1,linkName.length());
  targetResource=this.readFileHeader(currentUser,currentProject,targetName);
  parentFolder=this.readFolder(currentUser,currentProject,parentFolderName,false);
  checkPermissions(currentUser,currentProject,parentFolder,I_CmsConstants.C_WRITE_ACCESS);
  linkResource=new CmsFile(new CmsUUID(),targetResource.getResourceId(),parentFolder.getId(),CmsUUID.getNullUUID(),resourceName,targetResource.getType(),targetResource.getFlags(),currentUser.getId(),currentUser.getDefaultGroupId(),currentProject.getId(),com.opencms.core.I_CmsConstants.C_ACCESS_DEFAULT_FLAGS,com.opencms.core.I_CmsConstants.C_STATE_NEW,CmsUUID.getNullUUID(),targetResource.getLauncherType(),targetResource.getLauncherClassname(),System.currentTimeMillis(),System.currentTimeMillis(),currentUser.getId(),new byte[0],0,currentProject.getId(),I_CmsConstants.C_VFS_LINK_TYPE_SLAVE);
  linkResource=m_vfsDriver.createFile(currentProject,linkResource,currentUser.getId(),parentFolder.getId(),resourceName,true);
  m_vfsDriver.writeProperties(linkProperties,currentProject.getId(),(CmsResource)linkResource,linkResource.getType());
  clearResourceCache();
  return linkResource;
}
