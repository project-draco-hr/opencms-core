{
  String cacheKey=getCacheKey(inheritedOnly + "_",context.currentProject(),resource.getStructureId().toString());
  CmsAccessControlList acl=(CmsAccessControlList)m_accessControlListCache.get(cacheKey);
  if (acl != null) {
    return acl;
  }
  String parentPath=CmsResource.getParentFolder(resource.getRootPath());
  if (parentPath != null) {
    CmsResource parentResource=m_vfsDriver.readFolder(context.currentProject().getId(),parentPath);
    acl=(CmsAccessControlList)getAccessControlList(context,parentResource,true).clone();
  }
 else {
    acl=new CmsAccessControlList();
  }
  ListIterator ace=m_userDriver.readAccessControlEntries(context.currentProject(),resource.getResourceId(),inheritedOnly).listIterator();
  while (ace.hasNext()) {
    CmsAccessControlEntry acEntry=(CmsAccessControlEntry)ace.next();
    acl.add(acEntry);
    if ((acEntry.getFlags() & I_CmsConstants.C_ACCESSFLAGS_OVERWRITE) > 0) {
      acl.setAllowedPermissions(acEntry);
    }
  }
  m_accessControlListCache.put(cacheKey,acl);
  return acl;
}
