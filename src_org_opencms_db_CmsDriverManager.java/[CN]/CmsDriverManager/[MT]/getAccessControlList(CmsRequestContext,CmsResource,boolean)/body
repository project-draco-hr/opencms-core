{
  CmsResource res=resource;
  CmsAccessControlList acList=(CmsAccessControlList)m_accessControlListCache.get(getCacheKey(inheritedOnly + "_",null,context.currentProject(),resource.getStructureId().toString()));
  ListIterator acEntries=null;
  CmsUUID resourceId=null;
  if (acList != null)   return acList;
  if (!(resourceId=res.getParentStructureId()).isNullUUID()) {
    res=m_vfsDriver.readFolder(context.currentProject().getId(),resourceId);
    acList=(CmsAccessControlList)getAccessControlList(context,res,true).clone();
  }
 else {
    acList=new CmsAccessControlList();
  }
  acEntries=m_userDriver.readAccessControlEntries(context.currentProject(),resource.getResourceId(),inheritedOnly).listIterator();
  while (acEntries.hasNext()) {
    CmsAccessControlEntry acEntry=(CmsAccessControlEntry)acEntries.next();
    if ((acEntry.getFlags() & I_CmsConstants.C_ACCESSFLAGS_OVERWRITE) > 0)     acList.setAllowedPermissions(acEntry);
 else     acList.add(acEntry);
  }
  m_accessControlListCache.put(getCacheKey(inheritedOnly + "_",null,context.currentProject(),resource.getStructureId().toString()),acList);
  return acList;
}
