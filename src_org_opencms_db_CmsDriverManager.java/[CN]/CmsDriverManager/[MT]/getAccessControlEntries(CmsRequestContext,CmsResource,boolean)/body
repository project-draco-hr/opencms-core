{
  CmsResource res=resource;
  CmsUUID resourceId=res.getResourceId();
  Vector acEntries=m_userDriver.getAccessControlEntries(context.currentProject(),resourceId,false);
  CmsUUID structureId;
  while (getInherited && !(structureId=res.getParentStructureId()).isNullUUID()) {
    res=m_vfsDriver.readFolder(res.getProjectLastModified(),structureId);
    acEntries.addAll(m_userDriver.getAccessControlEntries(context.currentProject(),res.getResourceId(),getInherited));
  }
  return acEntries;
}
