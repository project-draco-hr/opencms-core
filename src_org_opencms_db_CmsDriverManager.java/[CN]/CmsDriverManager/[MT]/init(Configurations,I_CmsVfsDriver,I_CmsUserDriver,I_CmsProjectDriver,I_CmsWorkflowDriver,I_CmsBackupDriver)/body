{
  m_limitedWorkplacePort=config.getInteger("workplace.limited.port",-1);
  if (OpenCms.getLog(CmsLog.CHANNEL_INIT).isInfoEnabled()) {
    OpenCms.getLog(CmsLog.CHANNEL_INIT).info(". Driver manager init  : phase 4 - connecting to the database");
  }
  m_vfsDriver=vfsDriver;
  m_userDriver=userDriver;
  m_projectDriver=projectDriver;
  m_workflowDriver=workflowDriver;
  m_backupDriver=backupDriver;
  m_configuration=config;
  m_keyGenerator=(I_CmsCacheKey)Class.forName(config.getString(I_CmsConstants.C_CONFIGURATION_CACHE + ".keygenerator")).newInstance();
  CmsLruHashMap hashMap;
  m_userCache=Collections.synchronizedMap(hashMap=new CmsLruHashMap(config.getInteger(I_CmsConstants.C_CONFIGURATION_CACHE + ".user",50)));
  if (OpenCms.getMemoryMonitor().enabled())   OpenCms.getMemoryMonitor().register(this.getClass().getName() + "." + "m_userCache",hashMap);
  m_groupCache=Collections.synchronizedMap(hashMap=new CmsLruHashMap(config.getInteger(I_CmsConstants.C_CONFIGURATION_CACHE + ".group",50)));
  if (OpenCms.getMemoryMonitor().enabled())   OpenCms.getMemoryMonitor().register(this.getClass().getName() + "." + "m_groupCache",hashMap);
  m_userGroupsCache=Collections.synchronizedMap(hashMap=new CmsLruHashMap(config.getInteger(I_CmsConstants.C_CONFIGURATION_CACHE + ".usergroups",50)));
  if (OpenCms.getMemoryMonitor().enabled())   OpenCms.getMemoryMonitor().register(this.getClass().getName() + "." + "m_userGroupsCache",hashMap);
  m_projectCache=Collections.synchronizedMap(hashMap=new CmsLruHashMap(config.getInteger(I_CmsConstants.C_CONFIGURATION_CACHE + ".project",50)));
  if (OpenCms.getMemoryMonitor().enabled())   OpenCms.getMemoryMonitor().register(this.getClass().getName() + "." + "m_projectCache",hashMap);
  m_resourceCache=Collections.synchronizedMap(hashMap=new CmsLruHashMap(config.getInteger(I_CmsConstants.C_CONFIGURATION_CACHE + ".resource",2500)));
  if (OpenCms.getMemoryMonitor().enabled())   OpenCms.getMemoryMonitor().register(this.getClass().getName() + "." + "m_resourceCache",hashMap);
  m_resourceListCache=Collections.synchronizedMap(hashMap=new CmsLruHashMap(config.getInteger(I_CmsConstants.C_CONFIGURATION_CACHE + ".subres",100)));
  if (OpenCms.getMemoryMonitor().enabled())   OpenCms.getMemoryMonitor().register(this.getClass().getName() + "." + "m_resourceListCache",hashMap);
  m_propertyCache=Collections.synchronizedMap(hashMap=new CmsLruHashMap(config.getInteger(I_CmsConstants.C_CONFIGURATION_CACHE + ".property",5000)));
  if (OpenCms.getMemoryMonitor().enabled())   OpenCms.getMemoryMonitor().register(this.getClass().getName() + "." + "m_propertyCache",hashMap);
  m_propertyDefCache=Collections.synchronizedMap(hashMap=new CmsLruHashMap(config.getInteger(I_CmsConstants.C_CONFIGURATION_CACHE + ".propertydef",100)));
  if (OpenCms.getMemoryMonitor().enabled())   OpenCms.getMemoryMonitor().register(this.getClass().getName() + "." + "m_propertyDefCache",hashMap);
  m_propertyDefVectorCache=Collections.synchronizedMap(hashMap=new CmsLruHashMap(config.getInteger(I_CmsConstants.C_CONFIGURATION_CACHE + ".propertyvectordef",100)));
  if (OpenCms.getMemoryMonitor().enabled())   OpenCms.getMemoryMonitor().register(this.getClass().getName() + "." + "m_propertyDefVectorCache",hashMap);
  m_accessCache=Collections.synchronizedMap(hashMap=new CmsLruHashMap(config.getInteger(I_CmsConstants.C_CONFIGURATION_CACHE + ".access",1000)));
  if (OpenCms.getMemoryMonitor().enabled())   OpenCms.getMemoryMonitor().register(this.getClass().getName() + "." + "m_accessCache",hashMap);
  m_accessControlListCache=Collections.synchronizedMap(hashMap=new CmsLruHashMap(config.getInteger(I_CmsConstants.C_CONFIGURATION_CACHE + ".access",1000)));
  if (OpenCms.getMemoryMonitor().enabled())   OpenCms.getMemoryMonitor().register(this.getClass().getName() + "." + "m_accessControlListCache",hashMap);
  m_permissionCache=Collections.synchronizedMap(hashMap=new CmsLruHashMap(config.getInteger(I_CmsConstants.C_CONFIGURATION_CACHE + ".access",1000)));
  if (OpenCms.getMemoryMonitor().enabled())   OpenCms.getMemoryMonitor().register(this.getClass().getName() + "." + "m_permissionCache",hashMap);
  m_cachelimit=config.getInteger(I_CmsConstants.C_CONFIGURATION_CACHE + ".maxsize",20000);
  m_refresh=config.getString(I_CmsConstants.C_CONFIGURATION_CACHE + ".refresh","");
  if (OpenCms.getLog(CmsLog.CHANNEL_INIT).isInfoEnabled()) {
    OpenCms.getLog(CmsLog.CHANNEL_INIT).info(". Initializing registry: starting");
  }
  try {
    m_registry=new CmsRegistry(CmsBase.getAbsolutePath(config.getString(I_CmsConstants.C_CONFIGURATION_REGISTRY)));
  }
 catch (  CmsException ex) {
    throw ex;
  }
catch (  Exception ex) {
    if (OpenCms.getLog(this).isErrorEnabled())     OpenCms.getLog(this).error(OpenCmsCore.C_MSG_CRITICAL_ERROR + "4",ex);
    throw new CmsException("Init of registry failed",CmsException.C_REGISTRY_ERROR,ex);
  }
  if (OpenCms.getLog(CmsLog.CHANNEL_INIT).isInfoEnabled()) {
    OpenCms.getLog(CmsLog.CHANNEL_INIT).info(". Initializing registry: finished");
  }
  getProjectDriver().fillDefaults();
}
