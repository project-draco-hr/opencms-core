{
  if (dbc.currentProject().isOnlineProject()) {
    throw new CmsSecurityException(org.opencms.security.Messages.get().container(org.opencms.security.Messages.ERR_MODIFY_ONLINE_1,dbc.currentProject().getName()));
  }
  if (dbc.currentProject().getFlags() != I_CmsConstants.C_PROJECT_STATE_UNLOCKED) {
    throw new CmsLockException(org.opencms.lock.Messages.get().container(org.opencms.lock.Messages.ERR_RESOURCE_LOCKED_1,dbc.currentProject().getName()));
  }
  if (!isInsideCurrentProject(dbc,resource.getRootPath())) {
    if (resource.isFolder()) {
      List projectResources=m_projectDriver.readProjectResources(dbc,dbc.currentProject());
      for (int i=0; i < projectResources.size(); i++) {
        String resname=(String)projectResources.get(i);
        if (resname.startsWith(resource.getRootPath())) {
          m_projectDriver.deleteProjectResource(dbc,dbc.currentProject().getId(),resname);
        }
      }
    }
    try {
      m_projectDriver.createProjectResource(dbc,dbc.currentProject().getId(),resource.getRootPath(),null);
    }
 catch (    CmsException exc) {
    }
 finally {
      OpenCms.fireCmsEvent(new CmsEvent(I_CmsEventListener.EVENT_PROJECT_MODIFIED,Collections.singletonMap("project",dbc.currentProject())));
    }
  }
}
