{
  CmsResource resource=readFileHeader(context,filename,true);
  if (resource.getState() == I_CmsConstants.C_STATE_DELETED) {
    undoChanges(context,filename);
  }
 else {
    throw new CmsException("Resource already exists. Remove the existing blue resource before undeleting.",CmsException.C_FILE_EXISTS);
  }
}
