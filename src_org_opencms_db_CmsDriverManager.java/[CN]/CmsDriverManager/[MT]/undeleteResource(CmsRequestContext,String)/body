{
  CmsResource resource=readFileHeader(context,filename,true);
  if (resource.isFile()) {
    resource=(CmsFile)resource;
  }
 else {
    resource=readFolder(context,filename,true);
  }
  checkPermissions(context,resource,I_CmsConstants.C_WRITE_ACCESS);
  resource.setState(I_CmsConstants.C_STATE_CHANGED);
  resource.setLocked(context.currentUser().getId());
  m_vfsDriver.updateResourceState(context.currentProject(),resource,C_UPDATE_STRUCTURE_STATE);
  clearResourceCache();
  undeleteAllAccessControlEntries(context,resource);
  fileSystemChanged(resource.isFolder());
}
