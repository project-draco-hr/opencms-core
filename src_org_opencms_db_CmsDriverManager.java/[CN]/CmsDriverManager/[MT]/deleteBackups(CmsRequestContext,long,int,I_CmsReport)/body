{
  if (isAdmin(context)) {
    List allBackupFiles=m_backupDriver.readBackupFileHeaders();
    int counter=1;
    int size=allBackupFiles.size();
    int maxTag=m_backupDriver.readBackupProjectTag(timestamp);
    Iterator i=allBackupFiles.iterator();
    while (i.hasNext()) {
      CmsBackupResource res=(CmsBackupResource)i.next();
      if (!res.hasFullResourceName()) {
        res.setFullResourceName(readPath(context,res,CmsResourceFilter.ALL));
      }
      report.print("( " + counter + " / "+ size+ " ) ",I_CmsReport.C_FORMAT_NOTE);
      report.print(report.key("report.history.checking"),I_CmsReport.C_FORMAT_NOTE);
      report.print(res.getRootPath() + " ");
      int resVersions=m_backupDriver.readBackupMaxVersion(res.getResourceId());
      int versionsToDelete=resVersions - versions;
      if (versionsToDelete > 0) {
        report.print(report.key("report.history.deleting") + report.key("report.dots"));
        m_backupDriver.deleteBackup(res,maxTag,versionsToDelete);
      }
 else {
        report.print(report.key("report.history.nothing") + report.key("report.dots"));
      }
      report.println(report.key("report.ok"),I_CmsReport.C_FORMAT_OK);
      counter++;
      m_projectDriver.deletePublishHistory(context.currentProject().getId(),maxTag);
    }
  }
}
