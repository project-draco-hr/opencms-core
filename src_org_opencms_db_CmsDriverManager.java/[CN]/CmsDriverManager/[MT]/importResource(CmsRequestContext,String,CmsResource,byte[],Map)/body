{
  String folderName=null;
  String resourceName=null;
  if (resource.isFolder()) {
    if (!newResourceName.endsWith(I_CmsConstants.C_FOLDER_SEPARATOR))     newResourceName+=I_CmsConstants.C_FOLDER_SEPARATOR;
    folderName=newResourceName.substring(0,newResourceName.lastIndexOf(I_CmsConstants.C_FOLDER_SEPARATOR,newResourceName.length() - 2) + 1);
    resourceName=newResourceName.substring(folderName.length(),newResourceName.length() - 1);
  }
 else {
    folderName=newResourceName.substring(0,newResourceName.lastIndexOf(I_CmsConstants.C_FOLDER_SEPARATOR,newResourceName.length()) + 1);
    resourceName=newResourceName.substring(folderName.length(),newResourceName.length());
  }
  validFilename(resourceName);
  CmsFolder parentFolder=readFolder(context,folderName);
  checkPermissions(context,parentFolder,I_CmsConstants.C_WRITE_ACCESS);
  if (filecontent == null) {
    filecontent=new byte[0];
  }
  resource.setParentId(parentFolder.getId());
  CmsResource newResource=m_vfsDriver.importResource(context.currentProject(),parentFolder.getId(),resource,filecontent,context.currentUser().getId(),resource.isFolder());
  clearResourceCache();
  readPath(context,newResource,true);
  m_vfsDriver.writeProperties(propertyinfos,context.currentProject().getId(),newResource,newResource.getType(),true);
  return newResource;
}
