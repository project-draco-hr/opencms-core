{
  if ((properties == null) || (properties.size() == 0)) {
    return;
  }
  try {
    for (int i=0, n=properties.size(); i < n; i++) {
      Set keyValidationSet=new HashSet();
      CmsProperty property=(CmsProperty)properties.get(i);
      if (!keyValidationSet.contains(property.getName())) {
        keyValidationSet.add(property.getName());
      }
 else {
        throw new CmsVfsException("Invalid multiple occurence of property named '" + property.getName() + "' detected.",CmsVfsException.C_VFS_INVALID_PROPERTY_LIST);
      }
    }
    for (int i=0; i < properties.size(); i++) {
      CmsProperty property=(CmsProperty)properties.get(i);
      m_vfsDriver.writePropertyObject(dbc,dbc.currentProject(),resource,property);
    }
  }
  finally {
    clearResourceCache();
    m_propertyCache.clear();
    OpenCms.fireCmsEvent(new CmsEvent(I_CmsEventListener.EVENT_RESOURCE_AND_PROPERTIES_MODIFIED,Collections.singletonMap("resource",resource)));
  }
}
