{
  if (isAdmin(dbc) || isProjectManager(dbc)) {
    if (I_CmsConstants.C_PROJECT_ONLINE.equals(name)) {
      throw new CmsException("[" + this.getClass().getName() + "] "+ name,CmsException.C_BAD_NAME);
    }
    CmsGroup group=readGroup(dbc,groupname);
    CmsGroup managergroup=readGroup(dbc,managergroupname);
    CmsTask task=createProject(dbc,name,group.getName(),System.currentTimeMillis(),I_CmsConstants.C_TASK_PRIORITY_NORMAL);
    return m_projectDriver.createProject(dbc,dbc.currentUser(),group,managergroup,task,name,description,I_CmsConstants.C_PROJECT_STATE_UNLOCKED,projecttype,null);
  }
 else {
    throw new CmsSecurityException("[" + this.getClass().getName() + "] createProject()",CmsSecurityException.C_SECURITY_PROJECTMANAGER_PRIVILEGES_REQUIRED);
  }
}
