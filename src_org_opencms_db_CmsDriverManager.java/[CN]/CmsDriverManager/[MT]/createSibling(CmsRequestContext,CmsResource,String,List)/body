{
  if (source.isFolder()) {
    throw new CmsVfsException(CmsVfsException.C_VFS_FOLDERS_DONT_SUPPORT_SIBLINGS);
  }
  String destinationFoldername=CmsResource.getParentFolder(destination);
  String destinationResourceName=destination.substring(destinationFoldername.length());
  CmsFolder destinationFolder=readFolder(context,destinationFoldername,CmsResourceFilter.IGNORE_EXPIRATION);
  int flags=source.getFlags();
  if (labelResource(context,source,destination,1)) {
    flags|=I_CmsConstants.C_RESOURCEFLAG_LABELLINK;
  }
  CmsResource newResource=new CmsResource(new CmsUUID(),source.getResourceId(),destinationFolder.getParentStructureId(),destinationResourceName,source.getTypeId(),flags,context.currentProject().getId(),I_CmsConstants.C_STATE_KEEP,source.getLoaderId(),source.getDateCreated(),source.getUserCreated(),source.getDateLastModified(),source.getUserLastModified(),source.getDateReleased(),source.getDateExpired(),source.getSiblingCount() + 1,source.getLength());
  newResource.setRootPath(destination);
  newResource.setDateLastModified(newResource.getDateLastModified());
  newResource=createResource(context,destination,newResource,null,properties,false);
  clearAccessControlListCache();
  List modifiedResources=new ArrayList();
  modifiedResources.add(source);
  modifiedResources.add(newResource);
  modifiedResources.add(destinationFolder);
  OpenCms.fireCmsEvent(new CmsEvent(I_CmsEventListener.EVENT_RESOURCES_AND_PROPERTIES_MODIFIED,Collections.singletonMap("resources",modifiedResources)));
}
