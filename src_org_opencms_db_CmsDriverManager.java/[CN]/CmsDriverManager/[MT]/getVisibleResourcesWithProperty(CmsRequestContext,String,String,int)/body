{
  Vector visibleResources=new Vector();
  Vector allResources=new Vector();
  allResources=m_vfsDriver.readResources(context.currentProject().getId(),propertyDefinition,propertyValue,resourceType);
  Enumeration e=allResources.elements();
  String lastcheck="#";
  while (e.hasMoreElements()) {
    CmsResource res=(CmsResource)e.nextElement();
    if (!context.removeSiteRoot(readPath(context,res,CmsResourceFilter.DEFAULT)).equals(lastcheck)) {
      if (PERM_ALLOWED == hasPermissions(context,res,I_CmsConstants.C_VIEW_ACCESS,CmsResourceFilter.DEFAULT,false)) {
        visibleResources.addElement(res);
        lastcheck=context.removeSiteRoot(readPath(context,res,CmsResourceFilter.DEFAULT));
      }
    }
  }
  return visibleResources;
}
