{
  String siteRoot=context.getSiteRoot();
  Stack storage=new Stack();
  context.setSiteRoot("/");
  String destination=I_CmsConstants.C_VFS_LOST_AND_FOUND + resourcename;
  String des=destination;
  try {
    while (des.indexOf("/") == 0) {
      des=des.substring(0,des.lastIndexOf("/"));
      storage.push(des + "/");
    }
    while (storage.size() != 0) {
      des=(String)storage.pop();
      try {
        readFolder(context,des);
      }
 catch (      Exception e1) {
        createFolder(context,des,new HashMap());
      }
    }
    des=destination;
    int postfix=1;
    boolean found=true;
    while (found) {
      try {
        found=true;
        readFileHeader(context,des);
        des=destination.substring(0,destination.lastIndexOf("."));
        des+="_" + postfix;
        des+=destination.substring(destination.lastIndexOf("."),destination.length());
        postfix++;
      }
 catch (      CmsException e3) {
        found=false;
      }
    }
    destination=des;
    copyFile(context,resourcename,destination,false,false,I_CmsConstants.C_COPY_PRESERVE_LINK);
  }
 catch (  CmsException e2) {
    throw e2;
  }
 finally {
    context.setSiteRoot(siteRoot);
  }
  return destination;
}
