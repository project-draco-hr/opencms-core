{
  CmsResource targetResource=null;
  CmsResource siblingResource=null;
  String parentFolderName=null;
  CmsFolder parentFolder=null;
  String resourceName=null;
  parentFolderName=siblingName.substring(0,siblingName.lastIndexOf(I_CmsConstants.C_FOLDER_SEPARATOR) + 1);
  resourceName=siblingName.substring(siblingName.lastIndexOf(I_CmsConstants.C_FOLDER_SEPARATOR) + 1,siblingName.length());
  targetResource=this.readFileHeader(context,targetName,CmsResourceFilter.IGNORE_EXPIRATION);
  if (targetResource.isFolder()) {
    throw new CmsException("Creating siblings of folders is not supported");
  }
  parentFolder=this.readFolder(context,parentFolderName,CmsResourceFilter.IGNORE_EXPIRATION);
  checkPermissions(context,parentFolder,I_CmsConstants.C_WRITE_ACCESS,CmsResourceFilter.ALL,-1);
  siblingResource=new CmsResource(new CmsUUID(),targetResource.getResourceId(),parentFolder.getStructureId(),CmsUUID.getNullUUID(),resourceName,targetResource.getTypeId(),targetResource.getFlags(),context.currentProject().getId(),I_CmsConstants.C_STATE_NEW,targetResource.getLoaderId(),System.currentTimeMillis(),context.currentUser().getId(),System.currentTimeMillis(),context.currentUser().getId(),targetResource.getDateReleased(),targetResource.getDateExpired(),targetResource.getSiblingCount() + 1,0);
  if (labelResource(context,targetResource,siblingName,1)) {
    int flags=siblingResource.getFlags();
    flags|=I_CmsConstants.C_RESOURCEFLAG_LABELLINK;
    siblingResource.setFlags(flags);
  }
  siblingResource.setFullResourceName(siblingName);
  siblingResource=m_vfsDriver.createSibling(context.currentProject(),siblingResource,context.currentUser().getId(),parentFolder.getStructureId(),resourceName);
  siblingResource.setFullResourceName(siblingName);
  m_vfsDriver.writeLastModifiedProjectId(context.currentProject(),context.currentProject().getId(),siblingResource);
  if (siblingProperties == null) {
    siblingProperties=Collections.EMPTY_LIST;
  }
  CmsProperty.setAutoCreatePropertyDefinitions(siblingProperties,true);
  m_vfsDriver.writePropertyObjects(context.currentProject(),siblingResource,siblingProperties);
  clearAccessControlListCache();
  m_propertyCache.clear();
  OpenCms.fireCmsEvent(new CmsEvent(new CmsObject(),I_CmsEventListener.EVENT_RESOURCE_AND_PROPERTIES_MODIFIED,Collections.singletonMap("resource",parentFolder)));
  if (lockResource) {
    lockResource(context,siblingName);
  }
  return siblingResource;
}
