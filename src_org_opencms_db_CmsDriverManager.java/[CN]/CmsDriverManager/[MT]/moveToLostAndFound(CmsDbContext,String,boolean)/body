{
  CmsRequestContext context=dbc.getRequestContext();
  String siteRoot=context.getSiteRoot();
  Stack storage=new Stack();
  context.setSiteRoot("/");
  String destination=I_CmsConstants.C_VFS_LOST_AND_FOUND + resourcename;
  String des=destination;
  try {
    while (des.indexOf('/') == 0) {
      des=des.substring(0,des.lastIndexOf('/'));
      storage.push(des.concat("/"));
    }
    while (storage.size() != 0) {
      des=(String)storage.pop();
      try {
        readFolder(dbc,des,CmsResourceFilter.IGNORE_EXPIRATION);
      }
 catch (      Exception e1) {
        createResource(dbc,des,CmsResourceTypeFolder.C_RESOURCE_TYPE_ID,null,Collections.EMPTY_LIST);
      }
    }
    des=destination;
    int postfix=1;
    boolean found=true;
    while (found) {
      try {
        found=true;
        readResource(dbc,des,CmsResourceFilter.ALL);
        String path=destination.substring(0,destination.lastIndexOf('/') + 1);
        String filename=destination.substring(destination.lastIndexOf('/') + 1,destination.length());
        des=path;
        if (filename.lastIndexOf('.') > 0) {
          des+=filename.substring(0,filename.lastIndexOf('.'));
        }
 else {
          des+=filename;
        }
        des+="_" + postfix;
        if (filename.lastIndexOf('.') > 0) {
          des+=filename.substring(filename.lastIndexOf('.'),filename.length());
        }
        postfix++;
      }
 catch (      CmsException e3) {
        found=false;
      }
    }
    destination=des;
    if (!returnNameOnly) {
      CmsResource resource=readResource(dbc,resourcename,CmsResourceFilter.ALL);
      copyResource(dbc,resource,destination,I_CmsConstants.C_COPY_AS_SIBLING);
      deleteResource(dbc,resource,I_CmsConstants.C_DELETE_OPTION_PRESERVE_SIBLINGS);
    }
  }
 catch (  CmsException e2) {
    throw e2;
  }
 finally {
    context.setSiteRoot(siteRoot);
  }
  return destination;
}
