{
  try {
    Set exportPoints=new HashSet();
    exportPoints.addAll(OpenCms.getExportPoints());
    exportPoints.addAll(OpenCms.getModuleManager().getExportPoints());
    if (exportPoints.size() == 0) {
      if (LOG.isWarnEnabled()) {
        LOG.warn(Messages.get().key(Messages.LOG_NO_EXPORT_POINTS_CONFIGURED_0));
      }
      return;
    }
    CmsExportPointDriver exportPointDriver=new CmsExportPointDriver(exportPoints);
    if (report == null) {
      report=new CmsLogReport();
    }
    Iterator i=exportPointDriver.getExportPointPaths().iterator();
    while (i.hasNext()) {
      String currentExportPoint=(String)i.next();
      if (LOG.isInfoEnabled()) {
        LOG.info(Messages.get().key(Messages.LOG_WRITE_EXPORT_POINT_1,currentExportPoint));
      }
      try {
        CmsResourceFilter filter=CmsResourceFilter.DEFAULT;
        List resources=m_vfsDriver.readResourceTree(dbc,I_CmsConstants.C_PROJECT_ONLINE_ID,currentExportPoint,filter.getType(),filter.getState(),filter.getModifiedAfter(),filter.getModifiedBefore(),I_CmsConstants.C_READMODE_INCLUDE_TREE | (filter.excludeType() ? I_CmsConstants.C_READMODE_EXCLUDE_TYPE : 0) | (filter.excludeState() ? I_CmsConstants.C_READMODE_EXCLUDE_STATE : 0));
        Iterator j=resources.iterator();
        while (j.hasNext()) {
          CmsResource currentResource=(CmsResource)j.next();
          if (currentResource.isFolder()) {
            exportPointDriver.createFolder(currentResource.getRootPath(),currentExportPoint);
          }
 else {
            exportPointDriver.createFolder(currentExportPoint,currentExportPoint);
            CmsFile file=getVfsDriver().readFile(dbc,I_CmsConstants.C_PROJECT_ONLINE_ID,false,currentResource.getStructureId());
            exportPointDriver.writeFile(file.getRootPath(),currentExportPoint,file.getContents());
          }
        }
      }
 catch (      CmsException e) {
        if (e instanceof CmsVfsResourceNotFoundException) {
          if (LOG.isErrorEnabled()) {
            LOG.error(Messages.get().key(Messages.LOG_UPDATE_EXORT_POINTS_ERROR_0),e);
          }
        }
      }
    }
  }
 catch (  Exception e) {
    if (LOG.isErrorEnabled()) {
      LOG.error(Messages.get().key(Messages.LOG_UPDATE_EXORT_POINTS_ERROR_0),e);
    }
  }
}
