{
  CmsResource resource=readResource(context,null,resourceName,CmsResourceFilter.ALL);
  checkPermissions(context,resource,CmsPermissionSet.ACCESS_READ,true,CmsResourceFilter.ALL);
  search=search && (siteRoot != null);
  String cacheKey=getCacheKey(C_CACHE_ALL_PROPERTIES + search,context.currentProject().getId(),resource.getRootPath());
  List properties=(List)m_propertyCache.get(cacheKey);
  if (properties == null) {
    if (search) {
      boolean cont;
      siteRoot+=I_CmsConstants.C_FOLDER_SEPARATOR;
      properties=new ArrayList();
      List parentProperties=null;
      do {
        try {
          parentProperties=readPropertyObjects(context,resourceName,siteRoot,false);
          parentProperties.removeAll(properties);
          parentProperties.addAll(properties);
          properties.clear();
          properties.addAll(parentProperties);
          resourceName=CmsResource.getParentFolder(resourceName);
          cont=(!I_CmsConstants.C_FOLDER_SEPARATOR.equals(resourceName));
        }
 catch (        CmsSecurityException e) {
          cont=false;
        }
      }
 while (cont);
    }
 else {
      properties=m_vfsDriver.readPropertyObjects(context.currentProject(),resource);
    }
    m_propertyCache.put(cacheKey,properties);
  }
  return new ArrayList(properties);
}
