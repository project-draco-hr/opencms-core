{
  if (!filter.isValid(context,resource)) {
    throw new CmsResourceNotFoundException("[" + this.getClass().getName() + "] not found "+ resource.getName());
  }
  if ((requiredPermissions.getPermissions() & I_CmsConstants.C_ACCESS_VISIBLE) > 0) {
    if (!filter.includeVisiblePermission()) {
      int allowed=requiredPermissions.getAllowedPermissions();
      int denied=requiredPermissions.getDeniedPermissions();
      allowed|=I_CmsConstants.C_ACCESS_VISIBLE;
      requiredPermissions.setPermissions(allowed,denied);
    }
  }
  if (!hasPermissions(context,resource,requiredPermissions,false)) {
    throw new CmsSecurityException("[" + this.getClass().getName() + "] denied access to resource "+ resource.getName()+ ", required permissions are "+ requiredPermissions.getPermissionString()+ " (required one)",CmsSecurityException.C_SECURITY_NO_PERMISSIONS);
  }
}
