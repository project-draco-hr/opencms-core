{
  CmsResource resource=null;
  try {
    resource=readFileHeader(context,resourceName,CmsResourceFilter.ALL);
    checkPermissions(context,resource,I_CmsConstants.C_WRITE_ACCESS,CmsResourceFilter.ALL);
    m_vfsDriver.writePropertyObject(context.currentProject(),resource,property);
    if (resource.isFile()) {
      m_vfsDriver.writeFileHeader(context.currentProject(),(CmsFile)resource,C_UPDATE_RESOURCE_STATE,context.currentUser().getId());
    }
 else {
      m_vfsDriver.writeFolder(context.currentProject(),(CmsFolder)resource,C_UPDATE_RESOURCE_STATE,context.currentUser().getId());
    }
  }
  finally {
    clearResourceCache();
    m_propertyCache.clear();
    Map data=new HashMap();
    data.put("resource",resource);
    data.put("property",property);
    OpenCms.fireCmsEvent(new CmsEvent(new CmsObject(),I_CmsEventListener.EVENT_PROPERTY_MODIFIED,data));
  }
}
