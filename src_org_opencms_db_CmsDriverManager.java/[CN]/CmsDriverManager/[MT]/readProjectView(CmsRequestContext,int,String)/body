{
  Vector retValue=new Vector();
  List resources=null;
  CmsResource currentResource=null;
  CmsLock currentLock=null;
  int state=-1;
  if (criteria.equals("new")) {
    state=I_CmsConstants.C_STATE_NEW;
  }
 else   if (criteria.equals("changed")) {
    state=I_CmsConstants.C_STATE_CHANGED;
  }
 else   if (criteria.equals("deleted")) {
    state=I_CmsConstants.C_STATE_DELETED;
  }
 else   if (criteria.equals("all")) {
    state=I_CmsConstants.C_STATE_UNCHANGED;
  }
 else {
    state=I_CmsConstants.C_STATE_UNCHANGED;
  }
  if (criteria.equals("locked")) {
    resources=m_vfsDriver.readResources(projectId,state,I_CmsConstants.C_READMODE_IGNORESTATE);
  }
 else {
    if ((state == I_CmsConstants.C_STATE_NEW) || (state == I_CmsConstants.C_STATE_CHANGED) || (state == I_CmsConstants.C_STATE_DELETED)) {
      resources=m_vfsDriver.readResources(projectId,state,I_CmsConstants.C_READMODE_MATCHSTATE);
    }
 else     if (state == I_CmsConstants.C_STATE_UNCHANGED) {
      resources=m_vfsDriver.readResources(projectId,state,I_CmsConstants.C_READMODE_UNMATCHSTATE);
    }
  }
  Iterator i=resources.iterator();
  while (i.hasNext()) {
    currentResource=(CmsResource)i.next();
    if (PERM_ALLOWED == hasPermissions(context,currentResource,I_CmsConstants.C_READ_ACCESS,true,CmsResourceFilter.ALL)) {
      if (criteria.equals("locked")) {
        currentLock=getLock(context,currentResource);
        if (!currentLock.isNullLock()) {
          retValue.addElement(currentResource);
        }
      }
 else {
        retValue.addElement(currentResource);
      }
    }
  }
  resources.clear();
  resources=null;
  setFullResourceNames(context,retValue);
  return retValue;
}
