{
  if (isAdmin(context)) {
    name=name.trim();
    validFilename(name);
    validatePassword(password);
    if (name.length() > 0) {
      CmsGroup defaultGroup=readGroup(group);
      CmsUser newUser=m_userDriver.createUser(name,password,description," "," "," ",0,I_CmsConstants.C_FLAG_ENABLED,additionalInfos," ",I_CmsConstants.C_USER_TYPE_SYSTEMUSER);
      addUserToGroup(context,newUser.getName(),defaultGroup.getName());
      return newUser;
    }
 else {
      throw new CmsException("[" + this.getClass().getName() + "] "+ name,CmsException.C_INVALID_PASSWORD);
    }
  }
 else {
    throw new CmsSecurityException("[" + this.getClass().getName() + "] addUser() "+ name,CmsSecurityException.C_SECURITY_ADMIN_PRIVILEGES_REQUIRED);
  }
}
