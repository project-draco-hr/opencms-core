{
  List result=new ArrayList();
  List folders=getFolderTree(currentUser,currentProject,readFolder(currentUser,currentProject,folder));
  HashMap storage=new HashMap();
  Iterator j=folders.iterator();
  while (j.hasNext()) {
    CmsResource fold=(CmsResource)j.next();
    if (fold.getState() != I_CmsConstants.C_STATE_DELETED) {
      if (hasPermissions(currentUser,currentProject,fold,I_CmsConstants.C_READ_ACCESS,false)) {
        CmsUUID id=fold.getId();
        storage.put(id,id);
      }
    }
  }
  Vector resources=m_vfsDriver.getResourcesWithProperty(currentProject.getId(),propertyDefinition);
  for (int i=0; i < resources.size(); i++) {
    CmsResource res=(CmsResource)resources.elementAt(i);
    if (storage.containsKey(res.getParentId())) {
      if (res.getState() != I_CmsConstants.C_STATE_DELETED) {
        if (hasPermissions(currentUser,currentProject,res,I_CmsConstants.C_READ_ACCESS,false)) {
          result.add(res);
        }
      }
    }
  }
  return result;
}
