{
  CmsProject project=readProject(context,id);
  if (isAdmin(context) || isManagerOfProject(context) || (project.getFlags() == I_CmsConstants.C_PROJECT_STATE_UNLOCKED)) {
    return m_lockDispatcher.countExclusiveLocksInProject(project);
  }
 else   if (!isAdmin(context) && !isManagerOfProject(context)) {
    throw new CmsSecurityException("[" + this.getClass().getName() + "] countLockedResources()",CmsSecurityException.C_SECURITY_PROJECTMANAGER_PRIVILEGES_REQUIRED);
  }
 else {
    throw new CmsSecurityException("[" + this.getClass().getName() + "] countLockedResources()",CmsSecurityException.C_SECURITY_NO_PERMISSIONS);
  }
}
