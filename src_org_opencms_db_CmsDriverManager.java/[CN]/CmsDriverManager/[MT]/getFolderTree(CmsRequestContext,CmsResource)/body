{
  String cacheKey=getCacheKey(context.currentUser().getName() + "_tree",context.currentUser(),context.currentProject(),parentResource.getFullResourceName());
  List retValue=(List)m_resourceListCache.get(cacheKey);
  if (retValue == null || retValue.size() == 0) {
    List resources=m_vfsDriver.getFolderTree(context.currentProject(),parentResource);
    retValue=(List)new ArrayList();
    String lastcheck="#";
    for (Iterator e=resources.iterator(); e.hasNext(); ) {
      CmsResource res=(CmsResource)e.next();
      if (!context.removeSiteRoot(readPath(context.currentUser(),context.currentProject(),res,true)).startsWith(lastcheck)) {
        if (hasPermissions(context.currentUser(),context.currentProject(),res,I_CmsConstants.C_VIEW_ACCESS,false)) {
          retValue.add(res);
        }
 else {
          lastcheck=context.removeSiteRoot(readPath(context.currentUser(),context.currentProject(),res,false));
        }
      }
    }
    m_resourceListCache.put(cacheKey,retValue);
  }
  return retValue;
}
