{
  byte[] contents=null;
  String encoding=null;
  CmsProperty property=null;
  try {
    int warning=0;
    contents=file.getContents();
    property=getVfsDriver().readPropertyObject(I_CmsConstants.C_PROPERTY_CONTENT_ENCODING,context.currentProject(),file);
    encoding=(property != null) ? property.getValue() : null;
    encoding=CmsEncoder.lookupEncoding(encoding,null);
    if (encoding != null) {
      try {
        contents=(new String(contents,encoding)).getBytes();
      }
 catch (      UnsupportedEncodingException e) {
        if (OpenCms.getLog(this).isErrorEnabled()) {
          OpenCms.getLog(this).error("Unsupported encoding of " + file.toString(),e);
        }
        throw new CmsException("Unsupported encoding of " + file.toString(),e);
      }
    }
    discAccess.writeFile(file.getRootPath(),exportKey,contents);
  }
 catch (  Exception e) {
    if (OpenCms.getLog(this).isErrorEnabled()) {
      OpenCms.getLog(this).error("Error writing export point of " + file.toString(),e);
    }
    throw new CmsException("Error writing export point of " + file.toString(),e);
  }
  contents=null;
}
