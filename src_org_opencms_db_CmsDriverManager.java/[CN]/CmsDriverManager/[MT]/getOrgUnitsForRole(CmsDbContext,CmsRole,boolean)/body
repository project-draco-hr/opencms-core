{
  String ouFqn=role.getOuFqn();
  if (ouFqn == null) {
    ouFqn="";
    role=role.forOrgUnit("");
  }
  CmsOrganizationalUnit ou=readOrganizationalUnit(dbc,ouFqn);
  List orgUnits=new ArrayList();
  if (m_securityManager.hasRole(dbc,dbc.currentUser(),role)) {
    orgUnits.add(ou);
  }
  if (includeSubOus) {
    Iterator it=getOrganizationalUnits(dbc,ou,true).iterator();
    while (it.hasNext()) {
      CmsOrganizationalUnit orgUnit=(CmsOrganizationalUnit)it.next();
      if (m_securityManager.hasRole(dbc,dbc.currentUser(),role.forOrgUnit(orgUnit.getName()))) {
        orgUnits.add(orgUnit);
      }
    }
  }
  return orgUnits;
}
