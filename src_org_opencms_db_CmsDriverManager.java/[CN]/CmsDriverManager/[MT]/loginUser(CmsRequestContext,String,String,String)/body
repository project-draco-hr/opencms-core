{
  CmsUser newUser=m_userDriver.readUser(username,password,remoteAddress,I_CmsConstants.C_USER_TYPE_SYSTEMUSER);
  if (newUser.getFlags() == I_CmsConstants.C_FLAG_ENABLED) {
    newUser.setLastlogin(new Date().getTime());
    m_userDriver.writeUser(newUser);
    m_userCache.put(new CacheId(newUser),newUser);
    m_accessControlListCache.clear();
    m_groupCache.clear();
    m_userGroupsCache.clear();
    m_resourceListCache.clear();
    return (newUser);
  }
 else {
    throw new CmsSecurityException("[" + this.getClass().getName() + "] loginUser() "+ username,CmsSecurityException.C_SECURITY_NO_PERMISSIONS);
  }
}
