{
  List result=(List)new ArrayList();
  Vector unvisited=new Vector();
  CmsFolder currentFolder=null;
  Enumeration unvisitedFolders=null;
  CmsResource resource=readFileHeader(context,resourcename);
  if (resource.isFile()) {
    if (resourceType != CmsResourceTypeFolder.C_RESOURCE_TYPE_ID) {
      result.add(resource);
    }
    return result;
  }
  currentFolder=readFolder(context,resourcename);
  unvisited.add(currentFolder);
  while (unvisited.size() > 0) {
    unvisitedFolders=unvisited.elements();
    while (unvisitedFolders.hasMoreElements()) {
      currentFolder=(CmsFolder)unvisitedFolders.nextElement();
      unvisited.remove(currentFolder);
      if (resourceType <= CmsResourceTypeFolder.C_RESOURCE_TYPE_ID) {
        result.add(currentFolder);
      }
      if (resourceType != CmsResourceTypeFolder.C_RESOURCE_TYPE_ID) {
        result.addAll(getSubFiles(context,currentFolder.getFullResourceName(),true));
      }
      unvisited.addAll(getSubFolders(context,currentFolder.getFullResourceName(),true));
    }
  }
  return result;
}
