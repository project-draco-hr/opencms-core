{
  CmsResource res=readFileHeader(context,resource);
  checkPermissions(context,res,I_CmsConstants.C_WRITE_ACCESS);
  m_vfsDriver.writeProperties(propertyinfos,context.currentProject().getId(),res,res.getType());
  m_propertyCache.clear();
  if (res.isFile()) {
    m_vfsDriver.writeFileHeader(context.currentProject(),(CmsFile)res,C_UPDATE_RESOURCE_STATE,context.currentUser().getId());
  }
 else {
    m_vfsDriver.writeFolder(context.currentProject(),readFolder(context,resource),C_UPDATE_RESOURCE_STATE,context.currentUser().getId());
  }
  if (res.getState() == I_CmsConstants.C_STATE_UNCHANGED) {
    res.setState(I_CmsConstants.C_STATE_CHANGED);
  }
  Map data=(Map)new HashMap();
  data.put("resource",res);
  data.put("properties",propertyinfos);
  OpenCms.fireCmsEvent(new CmsEvent(new CmsObject(),I_CmsEventListener.EVENT_PROPERTY_MAP_MODIFIED,data));
  clearResourceCache();
}
