{
  CmsResource res=readFileHeader(context,resource);
  readPath(context,res,true);
  checkPermissions(context,res,I_CmsConstants.C_READ_OR_VIEW_ACCESS);
  search=search && (siteRoot != null);
  String cacheKey=getCacheKey(property + search,null,new CmsProject(context.currentProject().getId(),-1),res.getFullResourceName());
  String value=(String)m_propertyCache.get(cacheKey);
  if (value == null) {
    String cacheKey2=getCacheKey(C_CACHE_ALL_PROPERTIES + search,null,new CmsProject(context.currentProject().getId(),-1),res.getFullResourceName());
    Map allProperties=(HashMap)m_propertyCache.get(cacheKey2);
    if (allProperties != null) {
      value=(String)allProperties.get(property);
      if (value == null) {
        Iterator i=allProperties.keySet().iterator();
        while (i.hasNext()) {
          String key=(String)i.next();
          if (key.equalsIgnoreCase(property)) {
            value=(String)allProperties.get(key);
            break;
          }
        }
      }
    }
 else     if (search) {
      String cacheKey3=getCacheKey(property + false,null,new CmsProject(context.currentProject().getId(),-1),res.getFullResourceName());
      value=(String)m_propertyCache.get(cacheKey3);
      if ((value == null) || (value == C_CACHE_NULL_PROPERTY_VALUE)) {
        boolean cont;
        siteRoot+="/";
        do {
          try {
            value=readProperty(context,resource,siteRoot,property,false);
            cont=((value == null) && (!"/".equals(resource)));
          }
 catch (          CmsSecurityException se) {
            cont=false;
          }
          if (cont)           resource=CmsResource.getParent(resource);
        }
 while (cont);
      }
    }
 else {
      value=m_vfsDriver.readProperty(property,context.currentProject().getId(),res,res.getType());
    }
    if (value == null) {
      value=C_CACHE_NULL_PROPERTY_VALUE;
    }
    m_propertyCache.put(cacheKey,value);
  }
  return (value == C_CACHE_NULL_PROPERTY_VALUE) ? null : value;
}
