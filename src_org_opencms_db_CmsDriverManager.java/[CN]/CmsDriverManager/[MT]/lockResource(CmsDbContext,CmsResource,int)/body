{
  clearResourceCache();
  m_lockManager.addResource(this,dbc,resource,dbc.currentUser().getId(),dbc.currentProject().getId(),mode);
  if ((resource.getState() != CmsResource.STATE_UNCHANGED) && (resource.getState() != CmsResource.STATE_KEEP)) {
    m_vfsDriver.writeLastModifiedProjectId(dbc,dbc.currentProject(),dbc.currentProject().getId(),resource);
  }
  m_securityManager.clearPermissionCache();
  OpenCms.fireCmsEvent(new CmsEvent(I_CmsEventListener.EVENT_RESOURCE_MODIFIED,Collections.singletonMap("resource",resource)));
}
