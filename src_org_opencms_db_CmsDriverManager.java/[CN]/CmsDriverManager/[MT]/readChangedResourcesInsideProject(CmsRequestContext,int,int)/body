{
  List projectResources=readProjectResources(readProject(projectId));
  List result=new ArrayList();
  String currentProjectResource=null;
  List resources=new ArrayList();
  CmsResource currentResource=null;
  CmsLock currentLock=null;
  for (int i=0; i < projectResources.size(); i++) {
    currentProjectResource=(String)projectResources.get(i);
    try {
      currentResource=readResource(context,CmsRuntimeInfoFactory.getNullRuntimeInfo(),currentProjectResource,CmsResourceFilter.ALL);
      if (currentResource.isFolder()) {
        resources.addAll(readResources(context,currentResource,CmsResourceFilter.ALL,true));
      }
 else {
        resources.add(currentResource);
      }
    }
 catch (    CmsException e) {
      if (e.getType() != CmsException.C_NOT_FOUND) {
        throw e;
      }
    }
  }
  for (int j=0; j < resources.size(); j++) {
    currentResource=(CmsResource)resources.get(j);
    currentLock=getLock(context,CmsRuntimeInfoFactory.getNullRuntimeInfo(),currentResource.getRootPath());
    if (currentResource.getState() != I_CmsConstants.C_STATE_UNCHANGED) {
      if ((currentLock.isNullLock() && currentResource.getProjectLastModified() == projectId) || (currentLock.getUserId().equals(context.currentUser().getId()) && currentLock.getProjectId() == projectId)) {
        if ((currentResource.isFolder() && resourceType <= 0) || (currentResource.isFile() && resourceType != 0)) {
          result.add(currentResource);
        }
      }
    }
  }
  resources.clear();
  resources=null;
  return result;
}
