{
  CmsFolder folderRes=null;
  Vector resources=new Vector();
  Vector retValue=new Vector();
  try {
    folderRes=readFolder(context,folder);
    if (folderRes.getState() == I_CmsConstants.C_STATE_DELETED) {
      folderRes=null;
    }
  }
 catch (  CmsException exc) {
  }
  if (folderRes == null) {
    throw new CmsException("[" + this.getClass().getName() + "] "+ folder,CmsException.C_NOT_FOUND);
  }
 else {
    String cacheKey=getCacheKey(context.currentUser().getName() + "_resources",context.currentProject(),folderRes.getRootPath());
    retValue=(Vector)m_resourceListCache.get(cacheKey);
    if (retValue == null || retValue.size() == 0) {
      List subFolders=m_vfsDriver.readChildResources(context.currentProject(),folderRes,true);
      List subFiles=m_vfsDriver.readChildResources(context.currentProject(),folderRes,false);
      resources.addAll(subFolders);
      resources.addAll(subFiles);
      setFullResourceNames(context,resources);
      retValue=new Vector(resources.size());
      Iterator i=resources.iterator();
      while (i.hasNext()) {
        CmsResource res=(CmsResource)i.next();
        if (hasPermissions(context,res,I_CmsConstants.C_VIEW_ACCESS,false)) {
          if (res.isFolder() && !CmsResource.isFolder(res.getName())) {
            res.setFullResourceName(folderRes.getRootPath() + res.getName().concat("/"));
          }
 else {
            res.setFullResourceName(folderRes.getRootPath() + res.getName());
          }
          retValue.addElement(res);
          updateContextDates(context,res);
        }
      }
      m_resourceListCache.put(cacheKey,retValue);
    }
  }
  return (retValue == null) ? null : (Vector)retValue.clone();
}
