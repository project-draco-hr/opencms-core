{
  CmsResource onlineFile=null;
  CmsResource offlineFile=null;
  try {
    List onlinePath=readPathInProject(context,I_CmsConstants.C_PROJECT_ONLINE_ID,filename,false);
    onlineFile=(CmsResource)onlinePath.get(onlinePath.size() - 1);
  }
 catch (  CmsException exc) {
    onlineFile=null;
  }
  List offlinePath=readPath(context,filename,false);
  offlineFile=(CmsResource)offlinePath.get(offlinePath.size() - 1);
  checkPermissions(context,offlineFile,I_CmsConstants.C_WRITE_ACCESS);
  if (onlineFile == null) {
    deleteAllProperties(context,filename);
    m_vfsDriver.removeFile(context.currentProject(),offlineFile);
    m_userDriver.removeAllAccessControlEntries(context.currentProject(),offlineFile.getResourceAceId());
  }
 else {
    m_vfsDriver.deleteFile(context.currentProject(),offlineFile.getResourceId());
    deleteAllAccessControlEntries(context,offlineFile);
  }
  clearAccessControlListCache();
  clearResourceCache();
  m_accessCache.clear();
  m_lockDispatcher.removeResource(filename);
  fileSystemChanged(false);
}
