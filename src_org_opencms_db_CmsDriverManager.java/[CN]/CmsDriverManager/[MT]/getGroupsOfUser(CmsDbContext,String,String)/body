{
  CmsUser user=readUser(dbc,username);
  String cacheKey=m_keyGenerator.getCacheKeyForUserGroups(remoteAddress,dbc,user);
  Vector allGroups=(Vector)m_userGroupsCache.get(cacheKey);
  if ((allGroups == null) || (allGroups.size() == 0)) {
    CmsGroup subGroup;
    CmsGroup group;
    List groups=m_userDriver.readGroupsOfUser(dbc,user.getId(),remoteAddress);
    allGroups=new Vector();
    Iterator it=groups.iterator();
    while (it.hasNext()) {
      group=(CmsGroup)it.next();
      subGroup=getParent(dbc,group.getName());
      while ((subGroup != null) && (!allGroups.contains(subGroup))) {
        allGroups.addElement(subGroup);
        subGroup=getParent(dbc,subGroup.getName());
      }
      if (!allGroups.contains(group)) {
        allGroups.add(group);
      }
    }
    m_userGroupsCache.put(cacheKey,allGroups);
  }
  return allGroups;
}
