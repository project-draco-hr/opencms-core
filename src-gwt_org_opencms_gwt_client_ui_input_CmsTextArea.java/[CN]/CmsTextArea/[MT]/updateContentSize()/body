{
  int width=m_textArea.getOffsetWidth();
  if (width > 10) {
    String string=m_textArea.getText();
    String searchString="\n";
    int occurences=0;
    if (0 != searchString.length()) {
      for (int index=string.indexOf(searchString,0); index != -1; index=string.indexOf(searchString,index + 1)) {
        occurences++;
      }
    }
    String[] splittext=string.split("\\n");
    for (int i=0; i < splittext.length; i++) {
      occurences+=(splittext[i].length() * 6.77) / width;
    }
    int height=occurences + 1;
    if (m_defaultRows > height) {
      height=m_defaultRows;
    }
    m_textArea.setVisibleLines(height);
    int j=0;
    int maxIterations=200;
    while ((m_textArea.getOffsetHeight() < m_textArea.getElement().getScrollHeight()) && (j < maxIterations)) {
      m_textArea.setVisibleLines(m_textArea.getVisibleLines() + 1);
      j+=1;
    }
    m_textAreaContainer.onResizeDescendant();
  }
}
