{
  String blockname;
  String bestFit=null;
  String parentname=null;
  Node parent=n.getParentNode();
  while (parent != null && parent.getNodeType() == Node.ELEMENT_NODE) {
    if (parent.getNodeName().equals("DATA")) {
      blockname=((Element)parent).getAttribute("name");
    }
 else {
      blockname=parent.getNodeName();
      String secondName=((Element)parent).getAttribute("name");
      if (!"".equals(secondName)) {
        blockname=blockname + "." + secondName;
      }
    }
    blockname=blockname.toLowerCase();
    if (parentname == null) {
      parentname=blockname;
    }
 else {
      parentname=blockname + "." + parentname;
    }
    if (m_blocks.containsKey(parentname)) {
      bestFit=parentname;
    }
    parent=parent.getParentNode();
  }
  if (n.getNodeName().equals("DATA")) {
    blockname=n.getAttribute("name");
  }
 else {
    blockname=n.getNodeName();
    String secondName=n.getAttribute("name");
    if (!"".equals(secondName)) {
      blockname=blockname + "." + secondName;
    }
  }
  blockname=blockname.toLowerCase();
  if (bestFit != null) {
    blockname=bestFit + "." + blockname;
  }
  if (C_DEBUG && A_OpenCms.isLogging()) {
    A_OpenCms.log(C_OPENCMS_DEBUG,"Reading datablock " + blockname);
  }
  m_blocks.put(blockname,n);
}
