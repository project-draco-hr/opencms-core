{
  Document parsedDoc=null;
  try {
    parsedDoc=parser.parse(content);
  }
 catch (  Exception e) {
    String errorMessage="Cannot parse XML file \"" + getAbsoluteFilename() + "\". "+ e;
    throwException(errorMessage,CmsException.C_XML_PARSING_ERROR);
  }
  if (parsedDoc == null) {
    String errorMessage="Unknown error. Parsed DOM document is null.";
    throwException(errorMessage,CmsException.C_XML_PARSING_ERROR);
  }
  try {
    Class elementClass=Class.forName("org.w3c.dom.Element");
    Method normalizeMethod=elementClass.getMethod("normalize",new Class[]{});
    normalizeMethod.invoke(parsedDoc.getDocumentElement(),new Object[]{});
  }
 catch (  Exception e) {
    throwException("Normalizing the XML document failed. Possibly you are using concurrent versions of " + "the XML parser with different DOM levels. ",e,CmsException.C_XML_PARSING_ERROR);
  }
  Node loop=parsedDoc.getDocumentElement();
  while (loop != null) {
    Node next=treeWalker(parsedDoc.getDocumentElement(),loop);
    if (loop.getNodeType() == loop.TEXT_NODE) {
      Node leftSibling=loop.getPreviousSibling();
      Node rightSibling=loop.getNextSibling();
      if (leftSibling == null || rightSibling == null || (leftSibling.getNodeType() == loop.ELEMENT_NODE && rightSibling.getNodeType() == loop.ELEMENT_NODE)) {
        if ("".equals(loop.getNodeValue().trim())) {
          loop.getParentNode().removeChild(loop);
        }
      }
    }
    loop=next;
  }
  return parsedDoc;
}
