{
  super.removeEmptyMappings(cms,content);
  String rootPath=null;
  List siblings=null;
  if (rootPath == null) {
    rootPath=content.getFile().getRootPath();
  }
  try {
    cms.getRequestContext().saveSiteRoot();
    cms.getRequestContext().setSiteRoot("/");
    if (siblings == null) {
      siblings=cms.readSiblings(rootPath,CmsResourceFilter.IGNORE_EXPIRATION);
    }
    for (int i=0; i < siblings.size(); i++) {
      String filename=((CmsResource)siblings.get(i)).getRootPath();
      Locale locale=OpenCms.getLocaleManager().getDefaultLocale(cms,filename);
      if (!content.hasLocale(locale)) {
        continue;
      }
      List nestedItems=content.getValues(ELEMENT_LAYOUT,locale);
      int deleteIndex=nestedItems.size() + 1;
      CmsMacroResolver resolver=CmsMacroResolver.newInstance();
      resolver.addMacro(CmsTemplateContentListItem.MACRO_LISTINDEX,"" + deleteIndex);
      List properties=new ArrayList(4);
      CmsProperty p=new CmsProperty(resolver.resolveMacros(CmsTemplateContentListItem.PROPERTY_LAYOUT_TYPE),CmsProperty.DELETE_VALUE,null);
      properties.add(p);
      p=new CmsProperty(resolver.resolveMacros(CmsTemplateContentListItem.PROPERTY_LAYOUT_FOLDER),CmsProperty.DELETE_VALUE,null);
      properties.add(p);
      p=new CmsProperty(resolver.resolveMacros(CmsTemplateContentListItem.PROPERTY_LAYOUT_COUNT),CmsProperty.DELETE_VALUE,null);
      properties.add(p);
      p=new CmsProperty(resolver.resolveMacros(CmsTemplateContentListItem.PROPERTY_LAYOUT_COLLECTOR),CmsProperty.DELETE_VALUE,null);
      properties.add(p);
      cms.writePropertyObjects(filename,properties);
    }
  }
  finally {
    cms.getRequestContext().restoreSiteRoot();
  }
}
