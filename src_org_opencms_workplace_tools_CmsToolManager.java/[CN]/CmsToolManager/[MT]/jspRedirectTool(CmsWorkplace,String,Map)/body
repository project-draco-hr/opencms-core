{
  Map myParams=new HashMap(wp.getJsp().getRequest().getParameterMap());
  if (params != null) {
    Iterator it=params.keySet().iterator();
    while (it.hasNext()) {
      String key=(String)it.next();
      if (myParams.containsKey(key)) {
        myParams.remove(key);
      }
      myParams.put(key,params.get(key));
    }
  }
  if (myParams.containsKey(CmsToolDialog.PARAM_PATH)) {
    myParams.remove(CmsToolDialog.PARAM_PATH);
  }
  myParams.put(CmsToolDialog.PARAM_PATH,toolPath);
  if (myParams.containsKey(CmsDialog.PARAM_CLOSELINK)) {
    myParams.remove(CmsDialog.PARAM_CLOSELINK);
  }
  myParams.put(CmsDialog.PARAM_CLOSELINK,cmsLinkForPath(wp.getJsp(),getCurrentToolPath(wp),null));
  wp.getJsp().getResponse().sendRedirect(cmsLinkForPath(wp.getJsp(),toolPath,myParams));
}
