{
  try {
    m_report.println(m_report.key("report.check_links_begin"),I_CmsReport.C_FORMAT_HEADLINE);
    (new LinkChecker()).checkProject(m_cms,m_projectId,m_report);
    m_report.println(m_report.key("report.check_links_end"),I_CmsReport.C_FORMAT_HEADLINE);
  }
 catch (  CmsException e) {
    m_report.println(e);
    if (I_CmsLogChannels.C_LOGGING && A_OpenCms.isLogging(I_CmsLogChannels.C_OPENCMS_CRITICAL)) {
      A_OpenCms.log(I_CmsLogChannels.C_OPENCMS_CRITICAL,e.getMessage());
    }
  }
 finally {
    if (m_directPublishResourceName != null) {
      try {
        m_cms.changeLockedInProject(m_oldProjectId,m_directPublishResourceName);
        m_cms.deleteProject(m_projectId);
      }
 catch (      Exception e) {
        if (I_CmsLogChannels.C_LOGGING && A_OpenCms.isLogging(I_CmsLogChannels.C_OPENCMS_CRITICAL)) {
          A_OpenCms.log(I_CmsLogChannels.C_OPENCMS_CRITICAL,e.getMessage());
        }
      }
    }
  }
}
