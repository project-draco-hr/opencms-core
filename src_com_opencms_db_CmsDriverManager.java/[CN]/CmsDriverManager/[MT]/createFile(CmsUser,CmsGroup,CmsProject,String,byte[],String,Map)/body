{
  String folderName=newFileName.substring(0,newFileName.lastIndexOf(C_FOLDER_SEPARATOR,newFileName.length()) + 1);
  String resourceName=newFileName.substring(folderName.length(),newFileName.length());
  validFilename(resourceName);
  CmsFolder cmsFolder=readFolder(currentUser,currentProject,folderName);
  getVfsAccessGuard(currentUser,currentProject).check(cmsFolder,C_WRITE_ACCESS);
  CmsFile file=m_vfsDriver.createFile(currentUser,currentProject,newFileName,0,cmsFolder.getResourceId(),contents,getResourceType(currentUser,currentProject,type));
  file.setState(C_STATE_NEW);
  m_vfsDriver.writeFileHeader(currentProject,file,false);
  this.clearResourceCache(newFileName,currentProject,currentUser);
  m_vfsDriver.writeProperties(propertyinfos,currentProject.getId(),file,file.getType());
  fileSystemChanged(false);
  return file;
}
