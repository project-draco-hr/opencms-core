{
  CmsFolder cmsFolder=null;
  try {
    cmsFolder=m_vfsDriver.readFolder(currentProject.getId(),foldername);
  }
 catch (  CmsException exc) {
    if (exc.getType() == CmsException.C_NOT_FOUND) {
      return new Vector();
    }
 else {
      throw exc;
    }
  }
  if ((cmsFolder.getState() == I_CmsConstants.C_STATE_DELETED) && (!includeDeleted)) {
    return null;
  }
  Vector _files=m_vfsDriver.getFilesInFolder(currentProject.getId(),cmsFolder);
  Vector files=new Vector(_files.size());
  for (Enumeration e=_files.elements(); e.hasMoreElements(); ) {
    CmsFile file=(CmsFile)e.nextElement();
    if (checkPermissions(currentUser,(CmsResource)file,C_PERMISSION_READ)) {
      files.addElement(file);
    }
  }
  return files;
}
