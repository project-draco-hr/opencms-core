{
  int lastVersion=1;
  Hashtable histproperties=cms.getRegistry().getSystemValues(C_REGISTRY_HISTORY);
  String delete=(String)histproperties.get(C_DELETE_HISTORY);
  if ("true".equalsIgnoreCase(delete)) {
    if (isAdmin(currentUser,currentProject)) {
      long oneWeek=604800000;
      long maxDate=System.currentTimeMillis() - ((long)weeks * oneWeek);
      lastVersion=m_dbAccess.deleteBackups(maxDate);
    }
 else {
      throw new CmsException("No access to delete the backup versions",CmsException.C_NO_ACCESS);
    }
  }
  return lastVersion;
}
