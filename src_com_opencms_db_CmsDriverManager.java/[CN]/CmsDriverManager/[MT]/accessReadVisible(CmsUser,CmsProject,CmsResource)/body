{
  if ((resource == null) || !accessProject(currentUser,currentProject,resource.getProjectId()) || (!accessOther(resource,C_ACCESS_PUBLIC_READ + C_ACCESS_PUBLIC_VISIBLE) && !accessOwner(currentUser,currentProject,resource,C_ACCESS_PUBLIC_READ + C_ACCESS_PUBLIC_VISIBLE) && !accessGroup(currentUser,currentProject,resource,C_ACCESS_PUBLIC_READ + C_ACCESS_PUBLIC_VISIBLE))) {
    return false;
  }
  CmsResource res=resource;
  while (res.getParent() != null) {
    res=m_VfsAccess.readFolder(currentProject.getId(),res.getRootName() + res.getParent());
    if (res == null) {
      if (I_CmsLogChannels.C_PREPROCESSOR_IS_LOGGING && A_OpenCms.isLogging()) {
        A_OpenCms.log(A_OpenCms.C_OPENCMS_DEBUG,"Resource has no parent: " + resource.getAbsolutePath());
      }
      throw new CmsException(getClass().getName() + ".accessRead(): Cannot find \'" + resource.getName(),CmsException.C_NOT_FOUND);
    }
    if (!accessOther(res,C_ACCESS_PUBLIC_READ + C_ACCESS_PUBLIC_VISIBLE) && !accessOwner(currentUser,currentProject,res,C_ACCESS_PUBLIC_READ + C_ACCESS_PUBLIC_VISIBLE) && !accessGroup(currentUser,currentProject,res,C_ACCESS_PUBLIC_READ + C_ACCESS_PUBLIC_VISIBLE)) {
      return false;
    }
  }
  return true;
}
