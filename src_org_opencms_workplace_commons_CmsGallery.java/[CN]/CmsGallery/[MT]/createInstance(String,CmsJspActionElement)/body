{
  String className=OpenCms.getWorkplaceManager().getGalleryClassName(galleryTypeName);
  if (className == null) {
    String message="Unknown gallery type '" + galleryTypeName + "' requested"+ (jsp != null ? " on JSP " + jsp.info("opencms.request.element.uri") : "");
    OpenCms.getLog(CmsGallery.class).error(message);
    throw new RuntimeException(message);
  }
  try {
    Class galleryClass=Class.forName(className);
    CmsGallery galleryInstance=(CmsGallery)galleryClass.newInstance();
    galleryInstance.initWorkplaceMembers(jsp);
    galleryInstance.m_galleryTypeName=galleryTypeName;
    galleryInstance.m_galleryTypeId=OpenCms.getResourceManager().getResourceType(galleryTypeName).getTypeId();
    return galleryInstance;
  }
 catch (  Exception e) {
    String message="Unable to create class instance '" + className + "' for gallery type '"+ galleryTypeName+ "'"+ (jsp != null ? " on JSP " + jsp.info("opencms.request.element.uri") : "");
    OpenCms.getLog(CmsGallery.class).error(message);
    throw new RuntimeException(message,e);
  }
}
