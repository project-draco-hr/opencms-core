{
  CmsResource res=readFileHeader(currentUser,currentProject,resource);
  if (!accessWrite(currentUser,currentProject,res)) {
    throw new CmsException("[" + this.getClass().getName() + "] "+ resource,CmsException.C_NO_ACCESS);
  }
  m_dbAccess.writeProperties(propertyinfos,res.getResourceId(),res.getType());
  m_propertyCache.clear();
  if (res.getState() == C_STATE_UNCHANGED) {
    res.setState(C_STATE_CHANGED);
  }
  if (res.isFile()) {
    m_dbAccess.writeFileHeader(currentProject,(CmsFile)res,false);
    m_resourceCache.put(C_FILE + currentProject.getId() + resource,res);
  }
 else {
    m_dbAccess.writeFolder(currentProject,readFolder(currentUser,currentProject,resource),false);
    m_resourceCache.put(C_FOLDER + currentProject.getId() + resource,(CmsFolder)res);
  }
  m_subresCache.clear();
}
