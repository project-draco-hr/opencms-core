{
  CmsProject online=onlineProject(currentUser,currentProject);
  if ((!currentProject.equals(online)) && (currentProject.getOwnerId() == currentUser.getId()) && (currentProject.getFlags() == C_PROJECT_STATE_UNLOCKED)) {
    CmsResource onlineRes=readFileHeader(currentUser,online,resource);
    CmsResource offlineRes=null;
    String parent=onlineRes.getParent();
    Stack resources=new Stack();
    while (parent != null) {
      onlineRes=readFileHeader(currentUser,online,parent);
      resources.push(onlineRes);
      parent=onlineRes.getParent();
    }
    while (resources.size() > 0) {
      onlineRes=(CmsResource)resources.pop();
      parent=onlineRes.getAbsolutePath();
      try {
        m_dbAccess.copyResourceToProject(currentProject,online,onlineRes);
        offlineRes=readFileHeader(currentUser,currentProject,parent);
        writeProperties(currentUser,currentProject,offlineRes.getAbsolutePath(),readAllProperties(currentUser,currentProject,onlineRes.getAbsolutePath()));
      }
 catch (      CmsException exc) {
      }
    }
    helperCopyResourceToProject(currentUser,online,currentProject,resource);
  }
 else {
    throw new CmsException("[" + this.getClass().getName() + "] "+ currentProject.getName(),CmsException.C_NO_ACCESS);
  }
}
