{
  CmsResource res=readFileHeader(currentUser,currentProject,resource);
  if (!accessRead(currentUser,currentProject,res)) {
    throw new CmsException("[" + this.getClass().getName() + "] "+ resource,CmsException.C_NO_ACCESS);
  }
  search=search && (siteRoot != null);
  String cacheKey=getCacheKey(property + search,null,new CmsProject(currentProject.getId(),-1),res.getResourceName());
  String value=(String)m_propertyCache.get(cacheKey);
  if (value == null) {
    if (search) {
      String cacheKey2=getCacheKey(property + false,null,new CmsProject(currentProject.getId(),-1),res.getResourceName());
      value=(String)m_propertyCache.get(cacheKey2);
      if (value == null) {
        boolean cont;
        siteRoot+="/";
        do {
          value=readProperty(currentUser,currentProject,resource,siteRoot,property,false);
          cont=!((value != null) || siteRoot.equals(resource));
          resource=CmsResource.getParent(resource);
        }
 while (cont);
      }
    }
 else {
      value=m_dbAccess.readProperty(property,currentProject.getId(),res,res.getType());
    }
    m_propertyCache.put(cacheKey,value);
  }
  return value;
}
