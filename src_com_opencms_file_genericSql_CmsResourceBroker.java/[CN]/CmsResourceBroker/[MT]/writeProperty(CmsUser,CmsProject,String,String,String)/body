{
  CmsResource res=readFileHeader(currentUser,currentProject,resource);
  if (!accessWrite(currentUser,currentProject,res)) {
    throw new CmsException("[" + getClass().getName() + "] "+ resource,CmsException.C_NO_ACCESS);
  }
  m_VfsAccess.writeProperty(property,currentProject.getId(),value,res,res.getType(),false);
  m_propertyCache.clear();
  if (res.isFile()) {
    m_VfsAccess.writeFileHeader(currentProject,(CmsFile)res,true,currentUser.getId());
    if (res.getState() == C_STATE_UNCHANGED) {
      res.setState(C_STATE_CHANGED);
    }
  }
 else {
    if (res.getState() == C_STATE_UNCHANGED) {
      res.setState(C_STATE_CHANGED);
    }
    m_VfsAccess.writeFolder(currentProject,readFolder(currentUser,currentProject,resource),true,currentUser.getId());
  }
  this.clearResourceCache(resource,currentProject,currentUser);
}
