{
  if (newPassword.length() < C_PASSWORD_MINIMUMSIZE) {
    throw new CmsException("[" + this.getClass().getName() + "] "+ username,CmsException.C_SHORT_PASSWORD);
  }
  CmsUser user;
  try {
    user=readUser(currentUser,currentProject,username,oldPassword);
  }
 catch (  CmsException exc) {
    try {
      user=readWebUser(currentUser,currentProject,username,oldPassword);
    }
 catch (    CmsException e) {
      throw exc;
    }
  }
  if (!anonymousUser(currentUser,currentProject).equals(currentUser) && (isAdmin(user,currentProject) || user.equals(currentUser))) {
    m_dbAccess.setPassword(username,newPassword);
  }
 else {
    throw new CmsException("[" + this.getClass().getName() + "] "+ username,CmsException.C_NO_ACCESS);
  }
}
