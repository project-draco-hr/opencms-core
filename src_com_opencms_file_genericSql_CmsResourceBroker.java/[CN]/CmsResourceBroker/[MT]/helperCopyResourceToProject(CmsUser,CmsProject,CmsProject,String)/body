{
  try {
    CmsResource onlineRes=readFileHeader(currentUser,onlineProject,resource);
    m_dbAccess.copyResourceToProject(offlineProject,onlineProject,onlineRes);
    CmsResource offlineRes=readFileHeader(currentUser,offlineProject,resource);
    writeProperties(currentUser,offlineProject,offlineRes.getAbsolutePath(),readAllProperties(currentUser,onlineProject,onlineRes.getAbsolutePath()));
    if (onlineRes.isFolder()) {
      Vector files=getFilesInFolder(currentUser,onlineProject,resource);
      Vector folders=getSubFolders(currentUser,onlineProject,resource);
      for (int i=0; i < folders.size(); i++) {
        helperCopyResourceToProject(currentUser,onlineProject,offlineProject,((CmsResource)folders.elementAt(i)).getAbsolutePath());
      }
      for (int i=0; i < files.size(); i++) {
        helperCopyResourceToProject(currentUser,onlineProject,offlineProject,((CmsResource)files.elementAt(i)).getAbsolutePath());
      }
    }
  }
 catch (  CmsException exc) {
    exc.printStackTrace();
  }
}
