{
  CmsProject onlineProject=readProject(currentUser,currentProject,C_PROJECT_ONLINE_ID);
  CmsFile onlineFile=readFile(currentUser,onlineProject,resourceName);
  CmsFile offlineFile=readFile(currentUser,currentProject,resourceName);
  CmsFile restoredFile=new CmsFile(offlineFile.getResourceId(),offlineFile.getParentId(),offlineFile.getFileId(),offlineFile.getAbsolutePath(),onlineFile.getType(),onlineFile.getFlags(),onlineFile.getOwnerId(),onlineFile.getGroupId(),currentProject.getId(),onlineFile.getAccessFlags(),C_STATE_CHANGED,offlineFile.isLockedBy(),onlineFile.getLauncherType(),onlineFile.getLauncherClassname(),offlineFile.getDateCreated(),offlineFile.getDateLastModified(),currentUser.getId(),onlineFile.getContents(),onlineFile.getLength());
  writeFile(currentUser,currentProject,restoredFile);
  deleteAllProperties(currentUser,currentProject,resourceName);
  Hashtable propertyInfos=readAllProperties(currentUser,onlineProject,resourceName);
  writeProperties(currentUser,currentProject,resourceName,propertyInfos);
}
