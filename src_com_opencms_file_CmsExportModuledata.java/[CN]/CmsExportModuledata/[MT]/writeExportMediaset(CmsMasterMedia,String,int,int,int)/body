{
  Document xmlDoc=null;
  try {
    xmlDoc=A_CmsXmlContent.getXmlParser().createEmptyDocument(C_EXPORT_TAG_MODULEXPORT);
  }
 catch (  Exception exc) {
    throw new CmsException(CmsException.C_UNKNOWN_EXCEPTION,exc);
  }
  Element elementMedia=xmlDoc.createElement("media");
  xmlDoc.getDocumentElement().appendChild(elementMedia);
  addElement(xmlDoc,elementMedia,this.C_EXPORT_TAG_MEDIA_POSITION,"" + media.getPosition());
  addElement(xmlDoc,elementMedia,this.C_EXPORT_TAG_MEDIA_WIDTH,"" + media.getWidth());
  addElement(xmlDoc,elementMedia,this.C_EXPORT_TAG_MEDIA_HEIGHT,"" + media.getHeight());
  addElement(xmlDoc,elementMedia,this.C_EXPORT_TAG_MEDIA_SIZE,"" + media.getSize());
  addElement(xmlDoc,elementMedia,this.C_EXPORT_TAG_MEDIA_MIMETYPE,media.getMimetype());
  addElement(xmlDoc,elementMedia,this.C_EXPORT_TAG_MEDIA_TYPE,"" + media.getType());
  addElement(xmlDoc,elementMedia,this.C_EXPORT_TAG_MEDIA_TITLE,media.getTitle());
  addElement(xmlDoc,elementMedia,this.C_EXPORT_TAG_MEDIA_NAME,media.getName());
  addElement(xmlDoc,elementMedia,this.C_EXPORT_TAG_MEDIA_DESCRIPTION,media.getDescription());
  String contentFilename="mediacontent_" + subId + "_"+ masterNr+ "_"+ mediaId+ ".dat";
  addElement(xmlDoc,elementMedia,this.C_EXPORT_TAG_MEDIA_CONTENT,contentFilename);
  writeExportContentFile(contentFilename,media.getMedia());
  try {
    ZipEntry entry=new ZipEntry(filename);
    m_exportZipStream.putNextEntry(entry);
    A_CmsXmlContent.getXmlParser().getXmlText(xmlDoc,m_exportZipStream);
    m_exportZipStream.closeEntry();
  }
 catch (  Exception exc) {
    throw new CmsException(CmsException.C_UNKNOWN_EXCEPTION,exc);
  }
}
