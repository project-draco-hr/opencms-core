{
  if (!hasAccess()) {
    throw new CmsException("No access to perform the action 'importModule'",CmsException.C_REGISTRY_ERROR);
  }
  Element newModule=getModuleElementFromImport(moduleZip);
  String newModuleName=newModule.getElementsByTagName("name").item(0).getFirstChild().getNodeValue();
  if (moduleExists(newModuleName)) {
    throw new CmsException("The module " + newModuleName + " exists already",CmsException.C_REGISTRY_ERROR);
  }
  Vector dependencies=checkDependencies(newModule);
  if (dependencies.size() != 0) {
    throw new CmsException("the dependencies for the module are not fulfilled.",CmsException.C_REGISTRY_ERROR);
  }
  Element regModules=(Element)(m_xmlReg.getElementsByTagName("modules").item(0));
  Node uploadDate=newModule.getOwnerDocument().createElement("uploaddate");
  uploadDate.appendChild(newModule.getOwnerDocument().createTextNode(System.currentTimeMillis() + ""));
  newModule.appendChild(uploadDate);
  Node uploadBy=newModule.getOwnerDocument().createElement("uploadedby");
  uploadBy.appendChild(newModule.getOwnerDocument().createTextNode("U.Nknown"));
  newModule.appendChild(uploadBy);
  Node newNode=getXmlParser().importNode(m_xmlReg,newModule);
  regModules.appendChild(newNode);
  saveRegistry();
  try {
    init();
  }
 catch (  Exception exc) {
    throw new CmsException("couldn't init registry",CmsException.C_REGISTRY_ERROR,exc);
  }
}
