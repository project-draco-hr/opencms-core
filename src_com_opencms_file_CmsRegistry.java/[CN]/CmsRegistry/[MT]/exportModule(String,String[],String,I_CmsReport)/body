{
  if (!hasAccess()) {
    throw new CmsSecurityException(CmsSecurityException.C_SECURITY_NO_REGISTRY_PERMISSIONS);
  }
  Element module=getModuleElement(modulename);
  Element moduleCopy=(Element)module.cloneNode(true);
  NodeList list=moduleCopy.getChildNodes();
  for (int i=(list.getLength() - 1); i >= 0; i--) {
    Element e=(Element)list.item(i);
    if ("uploaddate".equals(e.getNodeName()) || "uploadedby".equals(e.getNodeName())) {
      moduleCopy.removeChild(e);
    }
  }
  Document moduleDoc;
  try {
    moduleDoc=A_CmsXmlContent.getXmlParser().createEmptyDocument("root");
  }
 catch (  Throwable t) {
    throw new CmsException(CmsException.C_UNKNOWN_EXCEPTION,t);
  }
  moduleDoc.getFirstChild().appendChild(A_CmsXmlContent.getXmlParser().importNode(moduleDoc,moduleCopy));
  org.dom4j.Document doc=(new org.dom4j.io.DOMReader()).read(moduleDoc);
  org.dom4j.Element moduleElement=doc.getRootElement().element("module");
  moduleElement.detach();
  new CmsExport(m_cms,filename,resources,false,false,moduleElement,false,0,report);
}
