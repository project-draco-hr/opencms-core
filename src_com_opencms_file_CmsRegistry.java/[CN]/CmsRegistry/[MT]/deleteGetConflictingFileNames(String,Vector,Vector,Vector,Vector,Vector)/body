{
  if (this.getModuleType(modulename).equals(CmsRegistry.C_MODULE_TYPE_SIMPLE))   return;
  Vector moduleFiles=new Vector();
  Vector moduleChecksums=new Vector();
  Vector otherFiles=new Vector();
  Vector otherChecksums=new Vector();
  getModuleFiles(modulename,moduleFiles,moduleChecksums);
  Enumeration modules=getModuleNames();
  while (modules.hasMoreElements()) {
    String module=(String)modules.nextElement();
    if (!module.equals(modulename)) {
      getModuleFiles(module,otherFiles,otherChecksums);
    }
  }
  for (int i=0; i < moduleFiles.size(); i++) {
    String currentFile=(String)moduleFiles.elementAt(i);
    String currentChecksum=(String)moduleChecksums.elementAt(i);
    CmsFile file=null;
    try {
      String resource=currentFile.substring(0,currentFile.indexOf("/",1) + 1);
      if (!resourcesForProject.contains(resource)) {
        resourcesForProject.addElement(resource);
      }
    }
 catch (    StringIndexOutOfBoundsException exc) {
    }
    if (!currentFile.endsWith("/")) {
      try {
        file=m_cms.readFile(currentFile);
      }
 catch (      CmsException exc) {
        missingFiles.addElement(currentFile);
      }
      if (otherFiles.contains(currentFile)) {
        filesInUse.addElement(currentFile);
      }
      if (file != null) {
        String digestContent;
        try {
          digestContent=com.opencms.util.Encoder.escape(new String(m_digest.digest(file.getContents()),m_cms.getRequestContext().getEncoding()),m_cms.getRequestContext().getEncoding());
        }
 catch (        UnsupportedEncodingException e) {
          digestContent=com.opencms.util.Encoder.escape(new String(m_digest.digest(file.getContents())),m_cms.getRequestContext().getEncoding());
        }
        if (!currentChecksum.equals(digestContent)) {
          wrongChecksum.addElement(currentFile);
        }
      }
    }
  }
  Vector files=m_cms.getFilesWithProperty("module",modulename + "_" + getModuleVersion(modulename));
  int fileCount=files.size();
  for (int i=0; i < fileCount; i++) {
    String currentFile=(String)files.elementAt(i);
    if (!moduleFiles.contains(currentFile)) {
      if (!otherFiles.contains(currentFile)) {
        filesWithProperty.addElement(currentFile);
        try {
          String resource=currentFile.substring(0,currentFile.indexOf("/",1) + 1);
          if (!resourcesForProject.contains(resource)) {
            resourcesForProject.addElement(resource);
          }
        }
 catch (        StringIndexOutOfBoundsException exc) {
        }
      }
    }
  }
}
