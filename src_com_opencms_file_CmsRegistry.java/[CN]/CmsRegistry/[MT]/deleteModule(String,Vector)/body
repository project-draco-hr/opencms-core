{
  if (!hasAccess()) {
    throw new CmsException("No access to perform the action 'importModule'",CmsException.C_REGISTRY_ERROR);
  }
  Vector resourceNames=new Vector();
  Vector resourceCodes=new Vector();
  getModuleFiles(module,resourceNames,resourceCodes);
  for (int i=resourceNames.size() - 1; i >= 0; i--) {
    try {
      String currentResource=(String)resourceNames.elementAt(i);
      if (!exclusion.contains(currentResource)) {
        m_cms.lockResource(currentResource,true);
        if (currentResource.endsWith("/")) {
          m_cms.deleteFolder(currentResource);
        }
 else {
          m_cms.deleteFile(currentResource);
        }
      }
    }
 catch (    CmsException exc) {
      exc.printStackTrace();
    }
  }
  Element moduleElement=getModuleElement(module);
  moduleElement.getParentNode().removeChild(moduleElement);
  saveRegistry();
  try {
    init();
  }
 catch (  Exception exc) {
    throw new CmsException("couldn't init registry",CmsException.C_REGISTRY_ERROR,exc);
  }
}
