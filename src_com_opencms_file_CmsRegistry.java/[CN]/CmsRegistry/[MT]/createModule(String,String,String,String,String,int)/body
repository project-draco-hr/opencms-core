{
  if (moduleExists(modulename)) {
    throw new CmsException("Module exists already " + modulename,CmsException.C_REGISTRY_ERROR);
  }
  if (!hasAccess()) {
    throw new CmsException("No access to perform the action 'createModule'",CmsException.C_REGISTRY_ERROR);
  }
  String moduleString=C_EMPTY_MODULE[0] + modulename;
  moduleString+=C_EMPTY_MODULE[1] + niceModulename;
  moduleString+=C_EMPTY_MODULE[2] + version;
  moduleString+=C_EMPTY_MODULE[3] + description;
  moduleString+=C_EMPTY_MODULE[4] + author;
  moduleString+=C_EMPTY_MODULE[5] + createDate;
  moduleString+=C_EMPTY_MODULE[6];
  Document doc;
  try {
    doc=parse(moduleString.getBytes(I_CmsXmlParser.C_XML_ENCODING));
  }
 catch (  UnsupportedEncodingException uee) {
    doc=parse(moduleString.getBytes());
  }
  m_xmlReg.getElementsByTagName("modules").item(0).appendChild(getXmlParser().importNode(m_xmlReg,doc.getFirstChild()));
  saveRegistry();
}
