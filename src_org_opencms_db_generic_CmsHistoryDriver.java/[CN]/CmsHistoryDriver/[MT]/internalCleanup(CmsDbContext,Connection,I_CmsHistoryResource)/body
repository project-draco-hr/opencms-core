{
  PreparedStatement stmt=null;
  ResultSet res=null;
  Map<CmsUUID,Integer> tmpSubResources=new HashMap<CmsUUID,Integer>();
  boolean isFolderAndNoVersionLeft=resource.getRootPath().endsWith("/") && (internalReadLastVersion(dbc,conn,resource.getStructureId()) == 0);
  if (isFolderAndNoVersionLeft) {
    stmt=m_sqlManager.getPreparedStatement(conn,"C_STRUCTURE_HISTORY_READ_SUBRESOURCES");
    stmt.setString(1,resource.getStructureId().toString());
    res=stmt.executeQuery();
    while (res.next()) {
      CmsUUID structureId=new CmsUUID(res.getString(1));
      int version=res.getInt(2);
      tmpSubResources.put(structureId,Integer.valueOf(version));
    }
    m_sqlManager.closeAll(dbc,null,stmt,res);
  }
  for (  Map.Entry<CmsUUID,Integer> entry : tmpSubResources.entrySet()) {
    I_CmsHistoryResource histResource=internalReadResource(dbc,conn,entry.getKey(),entry.getValue().intValue());
    internalDeleteEntries(dbc,conn,histResource,0,-1);
  }
}
