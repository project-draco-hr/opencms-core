{
  I_CmsHistoryResource resource=null;
  PreparedStatement stmt=null;
  ResultSet res=null;
  stmt=m_sqlManager.getPreparedStatement(conn,"C_RESOURCES_HISTORY_READ_VERSION");
  stmt.setString(1,structureId.toString());
  stmt.setInt(2,version);
  res=stmt.executeQuery();
  if (res.next()) {
    resource=internalCreateResource(res);
    while (res.next()) {
    }
    m_sqlManager.closeAll(dbc,null,stmt,res);
  }
 else {
    throw new CmsVfsResourceNotFoundException(Messages.get().container(Messages.ERR_HISTORY_FILE_NOT_FOUND_1,structureId));
  }
  return resource;
}
