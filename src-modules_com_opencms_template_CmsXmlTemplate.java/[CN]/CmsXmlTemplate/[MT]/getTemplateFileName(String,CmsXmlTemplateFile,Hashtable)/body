{
  String result=null;
  if (parameters.containsKey(elementName + "._TEMPLATE_")) {
    result=(String)parameters.get(elementName + "._TEMPLATE_");
  }
 else {
    if (doc.hasSubtemplateFilename(elementName)) {
      result=doc.getSubtemplateFilename(elementName);
    }
 else {
      if (parameters.containsKey("body._TEMPLATE_")) {
        result=(String)parameters.get("body._TEMPLATE_");
      }
    }
  }
  if (result == null) {
    CmsElementDefinitionCollection elDefs=(CmsElementDefinitionCollection)parameters.get("_ELDEFS_");
    if (elDefs != null) {
      CmsElementDefinition elDef=elDefs.get(elementName);
      if (elDef != null) {
        result=elDef.getTemplateName();
      }
    }
  }
  return result;
}
