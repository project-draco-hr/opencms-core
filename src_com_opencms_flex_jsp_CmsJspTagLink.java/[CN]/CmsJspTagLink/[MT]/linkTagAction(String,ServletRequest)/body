{
  CmsFlexController controller=(CmsFlexController)req.getAttribute(CmsFlexController.ATTRIBUTE_NAME);
  if (link.indexOf(':') >= 0) {
    return OpenCms.getLinkManager().substituteLink(controller.getCmsObject(),link);
  }
 else {
    return OpenCms.getLinkManager().substituteLink(controller.getCmsObject(),CmsLinkManager.getAbsoluteUri(link,controller.getCurrentRequest().getElementUri()));
  }
}
