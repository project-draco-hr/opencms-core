{
  String currentEntryPoint=entryPoint;
  entry.setRuntimeInfo(currentEntryPoint,entryPos,properties);
  entry.setRootEntry(isRootEntry);
  Map<CmsUUID,CmsInternalSitemapEntry> byId=m_byId;
  Map<String,CmsInternalSitemapEntry> byPath=m_byUri;
  byId.put(entry.getId(),entry);
  byPath.put(locale.toString() + entry.getRootPath(),entry);
  m_pathSet.add(entry.getRootPath());
  properties.putAll(entry.getProperties());
  addEntryForStructureId(entry.getStructureId(),locale,entry);
  List<CmsInternalSitemapEntry> subEntries=getSubEntries(cms,locale,entry);
  String sitemapUuid=properties.get(CmsSitemapManager.Property.sitemap.name());
  try {
    if (sitemapUuid != null) {
      CmsResource sitemapResource=internalReadResource(cms,sitemapUuid);
      active.put(locale.toString() + entry.getRootPath(),sitemapResource.getRootPath());
      properties.remove(CmsSitemapManager.Property.sitemap.name());
      currentEntryPoint=entry.getRootPath();
    }
  }
 catch (  CmsException e) {
    LOG.error("Can't read sub-sitemap: ");
    LOG.error(e.getLocalizedMessage(),e);
  }
  int size=subEntries.size();
  for (int position=0; position < size; position++) {
    CmsInternalSitemapEntry subEntry=subEntries.get(position);
    visitEntry(cms,active,subEntry,locale,currentEntryPoint,false,position,properties);
  }
}
