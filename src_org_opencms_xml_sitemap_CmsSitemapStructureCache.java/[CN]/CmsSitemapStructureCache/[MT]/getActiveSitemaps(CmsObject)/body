{
  CmsObject adminCms=internalCreateCmsObject(cms);
  if (m_active != null) {
    return m_active;
  }
  long t=System.currentTimeMillis();
  m_active=Collections.synchronizedMap(new HashMap<String,String>());
  m_entryPoints=Collections.synchronizedMap(new HashMap<String,String>());
  register("sitemapActive",m_active);
  m_byId.clear();
  m_byUri.clear();
  m_pathSet.clear();
  m_byStructureId.clear();
  m_siteRoots.clear();
  m_entryPoints.clear();
  m_exportNames.clear();
  m_exportNamesReverse.clear();
  m_propDefsBySite.clear();
  List<CmsResource> entryPoints=internalGetEntryPointResources(adminCms);
  for (  CmsResource entryPoint : entryPoints) {
    String siteRoot=OpenCms.getSiteManager().getSiteRoot(entryPoint.getRootPath());
    m_siteRoots.add(siteRoot);
    String sitemapPath=internalReadSitemapProperty(adminCms,entryPoint);
    try {
      CmsFile sitemapFile=internalReadSitemapFile(adminCms,entryPoint,sitemapPath);
      CmsXmlSitemap xmlSitemap=internalUnmarshalSitemapFile(adminCms,sitemapFile);
      visitRootSitemap(adminCms,entryPoint,sitemapFile,xmlSitemap);
    }
 catch (    CmsException e) {
      LOG.error("Can't read root sitemap: ");
      LOG.error(e.getLocalizedMessage(),e);
    }
  }
  LOG.debug(Messages.get().getBundle().key(Messages.LOG_DEBUG_NAMED_CACHE_SITEMAP_2,getName(),new Long(System.currentTimeMillis() - t)));
  return m_active;
}
