{
  CmsObject adminCms=internalCreateCmsObject(cms);
  Map<String,String> active=m_active;
  if (active != null) {
    return active;
  }
  long t=System.currentTimeMillis();
  m_active=Collections.synchronizedMap(new HashMap<String,String>());
  active=m_active;
  register("sitemapActive",m_active);
  m_byId.clear();
  m_byUri.clear();
  m_pathSet.clear();
  m_byStructureId.clear();
  List<CmsResource> entryPoints=internalGetEntryPointResources(adminCms);
  for (  CmsResource entryPoint : entryPoints) {
    String sitemapPath=internalReadSitemapProperty(adminCms,entryPoint);
    try {
      CmsFile sitemapFile=internalReadSitemapFile(adminCms,entryPoint,sitemapPath);
      CmsXmlSitemap xmlSitemap=internalUnmarshalSitemapFile(adminCms,sitemapFile);
      visitRootSitemap(adminCms,active,entryPoint,sitemapFile,xmlSitemap);
    }
 catch (    CmsException e) {
      LOG.error("Can't read root sitemap: ");
      LOG.error(e.getLocalizedMessage(),e);
    }
  }
  LOG.debug(Messages.get().getBundle().key(Messages.LOG_DEBUG_NAMED_CACHE_SITEMAP_2,getName(),new Long(System.currentTimeMillis() - t)));
  return active;
}
