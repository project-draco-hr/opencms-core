{
  ListIterator pIterator=groups.listIterator();
  int allowed=0, denied=0;
  I_CmsPrincipal principal=(I_CmsPrincipal)user;
  do {
    PrincipalPermissions permissions=(PrincipalPermissions)m_permissions.get(principal.getId());
    if (permissions != null) {
      allowed|=permissions.m_allowed;
      denied|=permissions.m_denied;
    }
    if (pIterator.hasNext()) {
      principal=(I_CmsPrincipal)pIterator.next();
    }
 else {
      principal=null;
    }
  }
 while (principal != null);
  return allowed & ~denied;
}
