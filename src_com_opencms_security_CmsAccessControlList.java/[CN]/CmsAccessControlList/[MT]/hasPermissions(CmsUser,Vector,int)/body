{
  ListIterator pIterator=groups.listIterator();
  int allowed=0, denied=0;
  I_CmsPrincipal principal=(I_CmsPrincipal)user;
  do {
    PrincipalPermissions pp=(PrincipalPermissions)m_permissions.get(principal.getId());
    if (pp != null) {
      allowed|=pp.m_allowed;
      denied|=pp.m_denied;
    }
    if (pIterator.hasNext()) {
      principal=(I_CmsPrincipal)pIterator.next();
    }
 else {
      principal=null;
    }
  }
 while (principal != null);
  return (permissions & (allowed & ~denied)) == permissions;
}
