{
  super(GalleryTabId.cms_tab_search.name());
  m_tab=uiBinder.createAndBindUi(this);
  initWidget(m_tab);
  addStyleName(I_CmsInputLayoutBundle.INSTANCE.inputCss().highTextBoxes());
  m_tabHandler=tabHandler;
  m_autoHideParent=autoHideParent;
  m_currentLocale=currentLocale;
  m_availableLocales=availableLocales;
  m_scope=scope;
  String scopeLabelText=Messages.get().key(Messages.GUI_SEARCH_SCOPE_0);
  m_scopeLabel.setText(scopeLabelText);
  for (  CmsGallerySearchScope choice : CmsGallerySearchScope.values()) {
    String name=Messages.get().key(choice.getKey());
    m_scopeSelection.addOption(choice.name(),name);
  }
  m_scopeSelection.setFormValueAsString(m_scope.name());
  m_scopeSelection.addValueChangeHandler(new ScopeChangeHandler());
  m_localeLabel.setText(Messages.get().key(Messages.GUI_TAB_SEARCH_LANGUAGE_LABEL_TEXT_0));
  CmsLabelSelectCell notSelectedCell=new CmsLabelSelectCell(NOT_SET_OPTION_VALUE,Messages.get().key(Messages.GUI_TAB_SEARCH_LANGUAGE_NOT_SEL_0));
  notSelectedCell.setVisible(false);
  m_localeSelection.addOption(notSelectedCell);
  for (  Map.Entry<String,String> entry : availableLocales.entrySet()) {
    m_localeSelection.addOption(entry.getKey(),entry.getValue());
  }
  m_localeSelection.addValueChangeHandler(new LanguageChangeHandler());
  if (availableLocales.size() <= 1) {
    m_localeRow.getElement().getStyle().setDisplay(Display.NONE);
  }
  m_searchLabel.setText(Messages.get().key(Messages.GUI_TAB_SEARCH_LABEL_TEXT_0));
  QueryChangedHandler queryHandler=new QueryChangedHandler();
  m_searchInput.addValueChangeHandler(queryHandler);
  m_searchInput.addKeyPressHandler(queryHandler);
  m_includeExpiredCheckBox.setChecked(false);
  m_includeExpiredCheckBox.setText(Messages.get().key(Messages.GUI_TAB_SEARCH_LABEL_INCLUDE_EXPIRED_0));
  m_includeExpiredCheckBox.addValueChangeHandler(new IncludeExpiredChangeHandler());
  m_dateCreatedStartLabel.setText(Messages.get().key(Messages.GUI_TAB_SEARCH_LABEL_CREATED_SINCE_0));
  m_dateCreatedEndLabel.setText(Messages.get().key(Messages.GUI_TAB_SEARCH_LABEL_CREATED_UNTIL_0));
  m_dateModifiedStartLabel.setText(Messages.get().key(Messages.GUI_TAB_SEARCH_LABEL_MODIFIED_SINCE_0));
  m_dateModifiedEndLabel.setText(Messages.get().key(Messages.GUI_TAB_SEARCH_LABEL_MODIFIED_UNTIL_0));
  if (m_autoHideParent != null) {
    m_dateCreatedEndDateBox.setAutoHideParent(m_autoHideParent);
    m_dateCreatedStartDateBox.setAutoHideParent(m_autoHideParent);
    m_dateModifiedEndDateBox.setAutoHideParent(m_autoHideParent);
    m_dateModifiedStartDateBox.setAutoHideParent(m_autoHideParent);
  }
  DateBoxChangeHandler handler=new DateBoxChangeHandler();
  m_dateCreatedStartDateBox.addValueChangeHandler(handler);
  m_dateCreatedStartDateBox.addKeyPressHandler(handler);
  m_dateCreatedEndDateBox.addValueChangeHandler(handler);
  m_dateCreatedEndDateBox.addKeyPressHandler(handler);
  m_dateModifiedStartDateBox.addValueChangeHandler(handler);
  m_dateModifiedStartDateBox.addKeyPressHandler(handler);
  Date initialStartDate=new Date();
  initialStartDate.setHours(0);
  initialStartDate.setMinutes(0);
  m_dateModifiedStartDateBox.setInitialDate(initialStartDate);
  m_dateModifiedEndDateBox.addValueChangeHandler(handler);
  m_dateModifiedEndDateBox.addKeyPressHandler(handler);
  Date initialEndDate=new Date();
  initialEndDate.setHours(23);
  initialEndDate.setMinutes(59);
  m_dateModifiedEndDateBox.setInitialDate(initialEndDate);
  m_clearButton.setText(Messages.get().key(Messages.GUI_TAB_SEARCH_BUTTON_CLEAR_0));
  m_clearButton.setUseMinWidth(true);
  ClearButtonClickHandler clearHandler=new ClearButtonClickHandler();
  m_clearButton.addClickHandler(clearHandler);
}
