{
  Locale currentLocale=cms.getRequestContext().getLocale();
  Locale defaultLocale=CmsLocaleManager.getDefaultLocale();
  Locale locale=null;
  if (content.hasLocale(currentLocale)) {
    locale=currentLocale;
  }
 else   if (content.hasLocale(defaultLocale)) {
    locale=defaultLocale;
  }
 else {
    List<Locale> locales=content.getLocales();
    if (locales.size() == 0) {
      throw new CmsException(Messages.get().container(Messages.ERR_NO_TYPE_CONFIG_1,content.getFile().getRootPath()));
    }
    locale=locales.get(0);
  }
  Iterator<I_CmsXmlContentValue> itTypes=content.getValues(N_ADE_TYPE,locale).iterator();
  while (itTypes.hasNext()) {
    I_CmsXmlContentValue xmlType=itTypes.next();
    String typePath=xmlType.getPath();
    String source=content.getValue(CmsXmlUtils.concatXpath(typePath,N_SOURCE),locale).getStringValue(cms);
    String folder=content.getValue(CmsXmlUtils.concatXpath(typePath,CmsXmlUtils.concatXpath(N_DESTINATION,N_FOLDER)),locale).getStringValue(cms);
    String pattern=content.getValue(CmsXmlUtils.concatXpath(typePath,CmsXmlUtils.concatXpath(N_DESTINATION,N_PATTERN)),locale).getStringValue(cms);
    CmsTypeConfigurationItem configItem=new CmsTypeConfigurationItem(source,folder,pattern);
    CmsResource resource=cms.readResource(source);
    String type=getTypeName(resource.getTypeId());
    m_configuration.put(type,configItem);
  }
}
