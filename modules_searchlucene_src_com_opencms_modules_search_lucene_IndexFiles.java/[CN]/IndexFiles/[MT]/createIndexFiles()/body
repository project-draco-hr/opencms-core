{
  IndexWriter writer=null;
  deleteIndexFiles();
  Document doc=null;
  InputStream con=null;
  try {
    StandardAnalyzer ga=new StandardAnalyzer();
    if (m_analyzer.equalsIgnoreCase("stopanalyzer")) {
      writer=new IndexWriter(m_indexPath,new StopAnalyzer(),m_newIndex);
    }
 else     if (m_analyzer.equalsIgnoreCase("german")) {
      writer=new IndexWriter(m_indexPath,new GermanAnalyzer(),m_newIndex);
    }
    String completeContent="";
    String keywords="";
    String description="";
    String title="";
    String parsedContent="";
    String published="";
    InputStream is=null;
    I_ContentParser parser=null;
    for (int i=0; i < m_files.size(); i++) {
      if (debug) {
        System.err.println("Indexing file " + m_files.elementAt(i));
      }
      doc=new Document();
      con=connectUrl((String)m_files.elementAt(i));
      if (con == null)       continue;
      if (m_contentType != null && m_contentType.equals("text/html")) {
        parser=m_convHtml;
      }
 else       if (m_contentType != null && m_contentType.equals("application/pdf")) {
        parser=m_convPdf;
      }
 else {
        continue;
      }
      parser.parse(con);
      completeContent=parser.getContents();
      if (parser.getKeywords() != null) {
        keywords=parser.getKeywords();
      }
      if (parser.getDescription() != null) {
        description=parser.getDescription();
      }
      if (parser.getTitle() != null) {
        title=parser.getTitle();
      }
      if (parser.getContents() != null) {
        parsedContent=parser.getContents();
      }
      published=DateField.timeToString(m_publishDate);
      doc.add(Field.Keyword("path",(String)m_files.elementAt(i)));
      doc.add(Field.Keyword("length",m_contentLength + ""));
      doc.add(Field.Keyword("keywords",keywords));
      doc.add(Field.Keyword("description",description));
      doc.add(Field.Keyword("modified",published));
      doc.add(Field.Keyword("title",title));
      doc.add(Field.Keyword("content",parsedContent));
      is=new ByteArrayInputStream(parsedContent.getBytes());
      doc.add(Field.Text("body",(Reader)new InputStreamReader(is)));
      writer.addDocument(doc);
      is.close();
    }
    writer.optimize();
    if (debug) {
      System.err.println("Docs in Index " + writer.docCount());
    }
    writer.close();
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
}
