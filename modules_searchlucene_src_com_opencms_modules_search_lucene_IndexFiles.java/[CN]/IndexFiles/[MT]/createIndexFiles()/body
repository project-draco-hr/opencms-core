{
  IndexWriter writer=null;
  deleteIndexFiles();
  Document doc=null;
  InputStream con=null;
  try {
    StandardAnalyzer ga=new StandardAnalyzer();
    writer=new IndexWriter(m_indexPath,ga,m_newIndex);
    String completeContent="";
    String keywords="";
    String description="";
    String title="";
    String parsedContent="";
    String published="";
    InputStream is=null;
    I_ContentParser parser=null;
    for (int i=0; i < m_files.size(); i++) {
      if (debug) {
        System.out.println("Indexing file " + m_files.elementAt(i));
      }
      doc=new Document();
      con=connectUrl((String)m_files.elementAt(i));
      if (m_contentType.equals("text/html")) {
        parser=convHtml;
      }
 else       if (m_contentType.equals("application/pdf")) {
        parser=convPdf;
      }
 else {
        continue;
      }
      parser.parse(con);
      completeContent=parser.getContents();
      if (completeContent.indexOf("Not Found (404)") != -1 || completeContent.indexOf("HTTP Status 404") != -1 || completeContent.indexOf("Error 404") != -1) {
        if (debug) {
          System.out.println("Servermessage: Not Found (404)");
        }
        continue;
      }
      if (parser.getKeywords() != null) {
        keywords=parser.getKeywords();
      }
      if (parser.getDescription() != null) {
        description=parser.getDescription();
      }
      if (parser.getTitle() != null) {
        title=parser.getTitle();
      }
      if (parser.getContents() != null) {
        parsedContent=parser.getContents();
      }
      if (parser.getPublished() != null) {
        published=parser.getPublished();
      }
      doc.add(Field.Keyword("path",(String)m_files.elementAt(i)));
      doc.add(Field.Keyword("length",m_contentLenth + ""));
      doc.add(Field.Keyword("keywords",keywords));
      doc.add(Field.Keyword("description",description));
      doc.add(Field.Keyword("modified",published));
      doc.add(Field.Keyword("title",title));
      doc.add(Field.Keyword("content",parsedContent));
      is=new ByteArrayInputStream(parsedContent.getBytes());
      if (debug) {
        File output=new File("D:/Programme/Apache Group/Apache/htdocs/lucineTest/" + ((String)m_files.elementAt(i)).substring(((String)m_files.elementAt(i)).lastIndexOf("/"),((String)m_files.elementAt(i)).lastIndexOf(".")) + ".txt");
        FileOutputStream os=new FileOutputStream(output);
        os.write(completeContent.getBytes());
        os.close();
      }
      doc.add(Field.Text("body",(Reader)new InputStreamReader(is)));
      writer.addDocument(doc);
      is.close();
    }
    writer.optimize();
    if (debug) {
      System.out.println("Docs in Index " + writer.docCount());
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
 finally {
    writer.close();
  }
}
