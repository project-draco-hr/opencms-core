{
  CmsHtmlMail theMail=new CmsHtmlMail();
  theMail.setSubject(key("letter.mail.subject.prefix") + getPageTitle());
  theMail.setHtmlMsg(getContent("letter_mail.html","html",getRequestContext().getLocale()));
  theMail.setTextMsg(getContent("letter_mail.html","text",getRequestContext().getLocale()));
  try {
    String uri=getRequestContext().getUri();
    try {
      CmsTemplateImprint imprint=new CmsTemplateImprint(getJspContext(),getRequest(),getResponse());
      String receiver=imprint.getEmail(null);
      theMail.addTo(receiver);
    }
  finally {
      getRequestContext().setUri(uri);
    }
    String sender=OpenCms.getSystemInfo().getMailSettings().getMailFromDefault();
    String contactMail=getContactEmail();
    if (contactMail == null || "".equals(contactMail.trim())) {
      contactMail=sender;
    }
    theMail.setFrom(sender);
    theMail.addReplyTo(contactMail);
    if (!"".equals(getCopy())) {
      theMail.addCc(contactMail);
    }
    theMail.send();
  }
 catch (  Exception e) {
    if (OpenCms.getLog(this).isWarnEnabled()) {
      OpenCms.getLog(this).warn(e);
    }
 else     if (OpenCms.getLog(this).isErrorEnabled()) {
      OpenCms.getLog(this).error("Could not send contact form data from page " + getRequestContext().getUri());
    }
    return false;
  }
  return true;
}
