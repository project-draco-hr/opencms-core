{
  boolean access=false;
  int accessflags=res.getAccessFlags();
  boolean groupAccess=false;
  Enumeration allGroups=cms.getGroupsOfUser(cms.getRequestContext().currentUser().getName()).elements();
  while ((!groupAccess) && allGroups.hasMoreElements()) {
    groupAccess=cms.readGroup(res).equals((CmsGroup)allGroups.nextElement());
  }
  if (((accessflags & I_CmsConstants.C_ACCESS_PUBLIC_VISIBLE) > 0) || (cms.readOwner(res).equals(cms.getRequestContext().currentUser()) && (accessflags & I_CmsConstants.C_ACCESS_OWNER_VISIBLE) > 0) || (groupAccess && (accessflags & I_CmsConstants.C_ACCESS_GROUP_VISIBLE) > 0)|| (cms.getRequestContext().currentUser().getName().equals(I_CmsConstants.C_USER_ADMIN))) {
    access=true;
  }
  return access;
}
