{
  if (resourcename.equals("")) {
    resourcename="/";
  }
  String name=CmsResource.getName(resourcename);
  String[] tokens=name.split("\\.");
  String suffix=null;
  if (tokens.length > 2) {
    if (getExtension().equalsIgnoreCase(tokens[tokens.length - 1])) {
      suffix="." + getExtension();
      if (tokens.length > 3) {
        try {
          int index=Integer.valueOf(tokens[tokens.length - 2]).intValue();
          suffix="." + index + suffix;
        }
 catch (        NumberFormatException ex) {
        }
      }
    }
  }
 else   if (tokens.length == 2) {
    if ((cms.existsResource(CmsResource.getFolderPath(resourcename) + tokens[0])) && (getExtension().equals(tokens[1]))) {
      suffix="." + tokens[1];
    }
  }
  if (suffix != null) {
    String path=resourcename.substring(0,resourcename.length() - suffix.length());
    if (LOG.isDebugEnabled()) {
      LOG.debug(Messages.get().getBundle().key(Messages.LOG_CHANGED_FILE_EXTENSION_2,resourcename,path));
    }
    return path;
  }
  return resourcename;
}
