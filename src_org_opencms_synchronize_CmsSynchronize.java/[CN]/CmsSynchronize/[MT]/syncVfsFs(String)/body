{
  int action=0;
  Vector resources=m_cms.getResourcesInFolder(folder);
  for (int i=0; i < resources.size(); i++) {
    CmsResource res=(CmsResource)resources.elementAt(i);
    if (res.getState() != I_CmsConstants.C_STATE_DELETED) {
      if (res.isFolder()) {
        action=testSyncVFS(res);
        if (action == C_EXPORT_VFS) {
          exportToFS(res);
        }
 else         if (action != C_DELETE_VFS) {
          skipResource(res);
        }
        syncVfsFs(m_cms.readAbsolutePath(res));
        if (action == C_DELETE_VFS) {
          deleteFromVfs(res);
        }
      }
 else {
        action=testSyncVFS(res);
switch (action) {
case C_EXPORT_VFS:
          exportToFS(res);
        break;
case C_UPDATE_VFS:
      updateFromFs(res);
    break;
case C_DELETE_VFS:
  deleteFromVfs(res);
break;
default :
skipResource(res);
}
}
res=null;
}
}
resources=null;
}
