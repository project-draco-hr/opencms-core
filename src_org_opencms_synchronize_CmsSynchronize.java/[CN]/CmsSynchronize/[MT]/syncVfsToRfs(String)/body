{
  int action=0;
  List resources=m_cms.getResourcesInFolder(folder,CmsResourceFilter.IGNORE_EXPIRATION);
  for (int i=0; i < resources.size(); i++) {
    CmsResource res=(CmsResource)resources.get(i);
    if (res.getState() != I_CmsConstants.C_STATE_DELETED) {
      if (res.isFolder()) {
        action=testSyncVfs(res);
        if (action == C_EXPORT_VFS) {
          exportToRfs(res);
        }
 else         if (action != C_DELETE_VFS) {
          skipResource(res);
        }
        syncVfsToRfs(m_cms.getSitePath(res));
        if (action == C_DELETE_VFS) {
          deleteFromVfs(res);
        }
      }
 else {
        action=testSyncVfs(res);
switch (action) {
case C_EXPORT_VFS:
          exportToRfs(res);
        break;
case C_UPDATE_VFS:
      updateFromRfs(res);
    break;
case C_DELETE_VFS:
  deleteFromVfs(res);
break;
default :
skipResource(res);
}
}
res=null;
}
}
resources=null;
}
