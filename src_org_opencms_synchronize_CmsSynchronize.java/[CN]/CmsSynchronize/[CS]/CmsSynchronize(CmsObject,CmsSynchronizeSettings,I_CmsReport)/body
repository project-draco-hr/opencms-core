{
  m_cms=cms;
  m_report=report;
  m_count=1;
  if ((settings != null) && (settings.isSyncEnabled())) {
    m_destinationPathInRfs=settings.getDestinationPathInRfs();
    if (m_destinationPathInRfs.endsWith(File.separator) || m_destinationPathInRfs.endsWith("/")) {
      m_destinationPathInRfs=m_destinationPathInRfs.substring(0,m_destinationPathInRfs.length() - 1);
    }
    m_syncList=readSyncList();
    m_newSyncList=new HashMap();
    Iterator i=settings.getSourceListInVfs().iterator();
    while (i.hasNext()) {
      String sourcePathInVfs=(String)i.next();
      report.println(org.opencms.workplace.threads.Messages.get().container(org.opencms.workplace.threads.Messages.RPT_SYNCHRONIZE_VFS_FOLDER_1,sourcePathInVfs),I_CmsReport.C_FORMAT_HEADLINE);
      report.println(org.opencms.workplace.threads.Messages.get().container(org.opencms.workplace.threads.Messages.RPT_SYNCHRONIZE_RFS_FOLDER_1,m_destinationPathInRfs.replace('\\','/')),I_CmsReport.C_FORMAT_HEADLINE);
      syncVfsToRfs(sourcePathInVfs);
    }
    removeFromRfs(m_destinationPathInRfs);
    i=settings.getSourceListInVfs().iterator();
    while (i.hasNext()) {
      copyFromRfs((String)i.next());
    }
    writeSyncList();
    m_syncList=null;
    m_newSyncList=null;
  }
 else {
    throw new CmsSynchronizeException(Messages.get().container(Messages.ERR_INIT_SYNC_0));
  }
}
