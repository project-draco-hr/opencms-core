{
  CmsRequestContext reqCont=cms.getRequestContext();
  CmsProject currentProject=reqCont.currentProject();
  String newSite=(String)parameters.get("site");
  int currentSiteId=cms.getSite(cms.onlineProject().getId()).getId();
  int currentProjectId=currentProject.getId();
  Vector allProjects=null;
  try {
    if (newSite != null && !("".equals(newSite)) && currentSiteId != Integer.parseInt(newSite))     reqCont.setCurrentProject(cms.getSiteBySiteId(Integer.parseInt(newSite)).getOnlineProjectId());
    allProjects=cms.getAllAccessibleProjects();
  }
  finally {
    reqCont.setCurrentProject(currentProjectId);
  }
  for (int i=0; i < allProjects.size(); i++) {
    CmsProject project=(CmsProject)allProjects.elementAt(i);
    if (currentProjectId != project.getId()) {
      values.addElement("" + project.getId());
      names.addElement(project.getName());
    }
  }
  return new Integer(0);
}
