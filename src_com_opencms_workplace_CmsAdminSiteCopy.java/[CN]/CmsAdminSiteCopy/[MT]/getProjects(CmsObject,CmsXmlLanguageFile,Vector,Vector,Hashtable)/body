{
  CmsRequestContext reqCont=cms.getRequestContext();
  CmsProject currentProject=reqCont.currentProject();
  String newSite=(String)parameters.get("site");
  int currentSiteId=cms.getSite(cms.onlineProject().getId()).getId();
  int currentProjectId=currentProject.getId();
  if (newSite != null && !("".equals(newSite)) && currentSiteId != Integer.parseInt(newSite))   reqCont.setCurrentProject(cms.getSiteBySiteId(Integer.parseInt(newSite)).getOnlineProjectId());
  Vector allProjects=cms.getAllAccessibleProjects();
  reqCont.setCurrentProject(currentProjectId);
  int currentProjectNum=0;
  for (int i=0; i < allProjects.size(); i++) {
    CmsProject project=(CmsProject)allProjects.elementAt(i);
    values.addElement("" + project.getId());
    names.addElement(project.getName());
    if (currentProjectId == project.getId())     currentProjectNum=i;
  }
  return new Integer(currentProjectNum);
}
