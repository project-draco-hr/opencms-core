{
  m_listeners.fireAbort(userId,publishJob);
  if ((m_currentPublishThread == null) || !publishJob.m_publishJob.equals(m_currentPublishThread.getPublishJob())) {
    if (!m_publishQueue.abortPublishJob(publishJob.m_publishJob)) {
      throw new CmsPublishException(Messages.get().container(Messages.ERR_PUBLISH_ENGINE_MISSING_PUBLISH_JOB_0));
    }
  }
 else {
    m_currentPublishThread.abort();
  }
  if (publishJob.getPublishList() != null) {
    unlockPublishList(publishJob.m_publishJob);
  }
  if (!removeJob) {
    publishJob.m_publishJob.finish();
    getPublishHistory().add(publishJob.m_publishJob);
  }
 else {
    getPublishQueue().remove(publishJob.m_publishJob);
  }
}
