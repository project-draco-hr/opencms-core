{
  Connection con=null;
  int id;
  int borderId;
  try {
    if (!dbPoolUrl.startsWith(CmsDbPool.C_DBCP_JDBC_URL_PREFIX)) {
      dbPoolUrl=CmsDbPool.C_DBCP_JDBC_URL_PREFIX + dbPoolUrl;
    }
    con=DriverManager.getConnection(dbPoolUrl);
    do {
      id=readId(con,tableName);
      if (id == I_CmsConstants.C_UNKNOWN_ID) {
        id=1;
        createId(con,tableName,id);
      }
      borderId=id + C_GROW_VALUE;
    }
 while (!writeId(con,tableName,id,borderId));
    c_currentId.put(cacheKey,new Integer(id));
    c_borderId.put(cacheKey,new Integer(borderId));
  }
 catch (  SQLException e) {
    throw new CmsDbSqlException(CmsDbUtil.class.getName(),null,e);
  }
 finally {
    if (con != null) {
      try {
        con.close();
      }
 catch (      SQLException exc) {
      }
    }
  }
}
