{
  Element importexportElement=parent.addElement(N_IMPORTEXPORT);
  Element resourceloadersElement=importexportElement.addElement(N_IMPORTEXPORTHANDLERS);
  List handlers=m_importExportManager.getImportExportHandlers();
  Iterator i=handlers.iterator();
  while (i.hasNext()) {
    I_CmsImportExportHandler handler=(I_CmsImportExportHandler)i.next();
    Element loaderNode=resourceloadersElement.addElement(N_IMPORTEXPORTHANDLER);
    loaderNode.addAttribute(A_CLASS,handler.getClass().getName());
  }
  Element importElement=importexportElement.addElement(N_IMPORT);
  importElement.addElement(N_OVERWRITE).setText((new Boolean(m_importExportManager.overwriteCollidingResources())).toString());
  importElement.addElement(N_CONVERT).setText((new Boolean(m_importExportManager.convertToXmlPage())).toString());
  if (m_importExportManager.getOldWebAppUrl() != null) {
    importElement.addElement(N_OLDWEBAPPURL).setText(m_importExportManager.getOldWebAppUrl());
  }
  Element resourcetypesElement=importElement.addElement(N_IMPORTVERSIONS);
  i=m_importExportManager.getImportVersionClasses().iterator();
  while (i.hasNext()) {
    resourcetypesElement.addElement(N_IMPORTVERSION).addAttribute(A_CLASS,i.next().getClass().getName());
  }
  Element immutablesElement=importElement.addElement(N_IMMUTABLES);
  i=m_importExportManager.getImmutableResources().iterator();
  while (i.hasNext()) {
    String uri=(String)i.next();
    immutablesElement.addElement(N_RESOURCE).addAttribute(A_URI,uri);
  }
  Element principalsElement=importElement.addElement(N_PRINCIPALTRANSLATIONS);
  i=m_importExportManager.getImportGroupTranslations().keySet().iterator();
  while (i.hasNext()) {
    String from=(String)i.next();
    principalsElement.addElement(N_PRINCIPALTRANSLATION).addAttribute(A_TYPE,I_CmsPrincipal.C_PRINCIPAL_GROUP).addAttribute(A_FROM,from).addAttribute(A_TO,(String)m_importExportManager.getImportGroupTranslations().get(from));
  }
  i=m_importExportManager.getImportUserTranslations().keySet().iterator();
  while (i.hasNext()) {
    String from=(String)i.next();
    principalsElement.addElement(N_PRINCIPALTRANSLATION).addAttribute(A_TYPE,I_CmsPrincipal.C_PRINCIPAL_USER).addAttribute(A_FROM,from).addAttribute(A_TO,(String)m_importExportManager.getImportUserTranslations().get(from));
  }
  Element propertiesElement=importElement.addElement(N_IGNOREDPROPERTIES);
  i=m_importExportManager.getIgnoredProperties().iterator();
  while (i.hasNext()) {
    String property=(String)i.next();
    propertiesElement.addElement(N_PROPERTY).addAttribute(A_NAME,property);
  }
  return importexportElement;
}
