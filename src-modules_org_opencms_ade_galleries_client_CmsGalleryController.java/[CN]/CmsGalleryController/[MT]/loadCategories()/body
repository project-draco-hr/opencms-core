{
  CmsRpcAction<CmsCategoryTreeEntry> action=new CmsRpcAction<CmsCategoryTreeEntry>(){
    @Override public void execute(){
      if (m_dialogBean.getGalleries() == null) {
        List<String> types=new ArrayList<String>();
        for (        CmsResourceTypeBean type : m_dialogBean.getTypes()) {
          types.add(type.getType());
        }
        getGalleryService().getCategoryTreeTypes(types,this);
      }
 else {
        List<String> galleries=new ArrayList<String>();
        for (        CmsGalleryFolderBean info : m_dialogBean.getGalleries()) {
          galleries.add(info.getPath());
        }
        getGalleryService().getCategoryTreeGalleries(galleries,this);
      }
    }
    @Override protected void onResponse(    CmsCategoryTreeEntry result){
      m_dialogBean.setCategories(result);
      m_handler.setCategoriesTabContent(result);
      m_handler.onCategoriesTabSelection();
    }
  }
;
  action.execute();
}
