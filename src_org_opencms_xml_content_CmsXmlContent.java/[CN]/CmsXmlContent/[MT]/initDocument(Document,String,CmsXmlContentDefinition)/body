{
  m_document=document;
  m_contentDefinition=definition;
  m_encoding=CmsEncoder.lookupEncoding(encoding,encoding);
  m_elementLocales=new HashMap();
  m_elementNames=new HashMap();
  m_locales=new HashSet();
  clearBookmarks();
  for (Iterator i=m_document.getRootElement().elementIterator(); i.hasNext(); ) {
    Element node=(Element)i.next();
    try {
      Locale locale=CmsLocaleManager.getLocale(node.attribute(CmsXmlContentDefinition.XSD_ATTRIBUTE_VALUE_LANGUAGE).getValue());
      addLocale(locale);
      processSchemaNode(node,null,locale,definition);
    }
 catch (    NullPointerException e) {
      LOG.error(Messages.get().getBundle().key(Messages.LOG_XMLCONTENT_INIT_BOOKMARKS_0),e);
    }
  }
}
