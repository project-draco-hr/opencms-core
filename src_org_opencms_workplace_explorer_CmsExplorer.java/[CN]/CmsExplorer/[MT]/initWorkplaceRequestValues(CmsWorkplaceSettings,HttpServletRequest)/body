{
  String currentResource=request.getParameter(C_PARAMETER_RESOURCE);
  String mode=request.getParameter(C_PARAMETER_MODE);
  if (CmsStringUtil.isNotEmpty(mode)) {
    settings.setExplorerMode(mode);
  }
 else {
    if (!(C_VIEW_PROJECT.equals(settings.getExplorerMode()) || C_VIEW_GALLERY.equals(settings.getExplorerMode()))) {
      settings.setExplorerMode(C_VIEW_EXPLORER);
    }
  }
  String filter=request.getParameter(C_PARAMETER_PROJECTFILTER);
  if (CmsStringUtil.isEmpty(filter)) {
    settings.setExplorerProjectFilter("all");
  }
 else {
    settings.setExplorerProjectFilter(filter);
  }
  String projectIdString=request.getParameter(C_PARAMETER_PROJECTID);
  int projectId=getCms().getRequestContext().currentProject().getId();
  if (projectIdString != null && !"".equals(projectIdString)) {
    projectId=Integer.parseInt(projectIdString);
  }
  settings.setExplorerProjectId(projectId);
  boolean showLinks=Boolean.valueOf(request.getParameter(C_PARAMETER_SHOWLINKS)).booleanValue();
  if (showLinks) {
    settings.setExplorerResource(currentResource);
  }
 else {
    if (currentResource != null && currentResource.startsWith(C_LOCATION_SIBLING)) {
      showLinks=true;
      settings.setExplorerResource(currentResource.substring(C_LOCATION_SIBLING.length()));
    }
 else {
      if (CmsStringUtil.isNotEmpty(currentResource) && folderExists(getCms(),currentResource)) {
        settings.setExplorerResource(currentResource);
      }
 else {
        showLinks=settings.getExplorerShowLinks();
        currentResource=settings.getExplorerResource();
        if (!resourceExists(getCms(),currentResource)) {
          settings.setExplorerResource("/");
          showLinks=false;
        }
      }
    }
  }
  settings.setExplorerShowLinks(showLinks);
  String selectedPage=request.getParameter(C_PARAMETER_PAGE);
  if (selectedPage != null) {
    int page=1;
    try {
      page=Integer.parseInt(selectedPage);
    }
 catch (    NumberFormatException e) {
      if (LOG.isInfoEnabled()) {
        LOG.info(e);
      }
    }
    settings.setExplorerPage(page);
  }
  settings.setExplorerFlaturl(request.getParameter(C_PARAMETER_FALTURL));
}
