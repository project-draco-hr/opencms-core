{
  JSONArray resources=new JSONArray();
  CmsObject cms=getCmsObject();
  Locale locale=cms.getRequestContext().getLocale();
  ResourcesAndRelated pubResources=getPublishResources();
  CmsPublishList publishList=new CmsPublishList(resourcesFromJson(ids),m_includeSiblings,false);
  CmsRelationPublishValidator validator=new CmsRelationPublishValidator(cms,publishList);
  List<String> resourceList=new ArrayList<String>(validator.keySet());
  Collections.sort(resourceList);
  for (  String resourceName : validator.keySet()) {
    CmsRelationValidatorInfoEntry infoEntry=validator.getInfoEntry(resourceName);
    CmsResource resource=cms.readResource(resourceName);
    if (resource.getState().isDeleted()) {
    }
 else {
    }
    for (    CmsRelation relation : infoEntry.getRelations()) {
      String relationName;
      if (resource.getState().isDeleted()) {
        relationName=relation.getSourcePath();
      }
 else {
        relationName=relation.getTargetPath();
      }
    }
  }
  String sourceMsg=org.opencms.workplace.commons.Messages.get().getBundle(locale).key(org.opencms.workplace.commons.Messages.GUI_PUBLISH_BROKENRELATIONS_DETAIL_RELATION_SOURCES_0);
  for (  CmsResource resource : pubResources.getResources()) {
    String infoForSource=getInfoForSource(cms,resource);
    JSONObject jsonRes=resourceToJson(resource);
    if (infoForSource != null) {
      jsonRes.put(JsonResource.INFO_NAME.getName(),sourceMsg);
      jsonRes.put(JsonResource.INFO_VALUE.getName(),infoForSource);
    }
    resources.put(jsonRes);
  }
  String relatedMsg=org.opencms.workplace.commons.Messages.get().getBundle(locale).key(org.opencms.workplace.commons.Messages.GUI_PUBLISH_BROKENRELATIONS_DETAIL_RELATION_TARGETS_0);
  for (  CmsResource resource : pubResources.getRelatedResources()) {
    String infoForRelated=getInfoForRelated(cms,locale,resource);
    if (infoForRelated == null) {
      continue;
    }
    JSONObject jsonRes=resourceToJson(resource);
    jsonRes.put(JsonResource.INFO_NAME.getName(),relatedMsg);
    jsonRes.put(JsonResource.INFO_VALUE.getName(),infoForRelated);
    resources.put(jsonRes);
  }
  return resources;
}
