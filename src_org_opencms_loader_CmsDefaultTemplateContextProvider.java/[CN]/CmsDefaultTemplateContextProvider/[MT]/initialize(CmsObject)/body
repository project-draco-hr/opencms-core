{
  try {
    InputStream stream=null;
    if (getConfigurationPropertyPath() != null) {
      try {
        CmsObject clone=OpenCms.initCmsObject(cms);
        clone.getRequestContext().setSiteRoot("");
        CmsResource res=clone.readResource(getConfigurationPropertyPath());
        if (res != null) {
          CmsFile file=cms.readFile(res);
          stream=new ByteArrayInputStream(file.getContents());
        }
      }
 catch (      Exception e) {
        LOG.error("Could not cerate input stream for given configuration path: " + getConfigurationPropertyPath(),e);
      }
    }
    if (stream == null) {
      stream=getClass().getClassLoader().getResourceAsStream("templatecontext.properties");
    }
    Properties properties=new Properties();
    properties.load(stream);
    stream.close();
    String templateMobile=properties.getProperty("template.mobile");
    String templateDesktop=properties.getProperty("template.desktop");
    CmsTemplateContext mobile=new CmsTemplateContext("mobile",templateMobile,null,this);
    m_map.put(mobile.getKey(),mobile);
    CmsTemplateContext desktop=new CmsTemplateContext("desktop",templateDesktop,null,this);
    m_map.put(desktop.getKey(),desktop);
  }
 catch (  Throwable t) {
    LOG.error(t.getLocalizedMessage(),t);
  }
}
