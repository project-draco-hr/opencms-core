{
  Properties additionalTags=new Properties();
  additionalTags.put("new-empty-tags","o:SmartTagType, o:smarttagtype");
  additionalTags.put("new-inline-tags","o:SmartTagType, o:smarttagtype");
  m_tidy.getConfiguration().addProps(additionalTags);
  m_tidy.setTidyMark(false);
  m_tidy.setMakeClean(true);
  m_tidy.setNumEntities(true);
  m_tidy.setPrintBodyOnly(true);
  if (mode == null) {
    m_mode=C_MODE_DISABLED;
  }
 else   if (mode.equals(C_PARAM_DISABLED)) {
    m_mode=C_MODE_DISABLED;
  }
 else   if (mode.equals(C_PARAM_ENABLED)) {
    m_mode=C_MODE_ENABLED;
  }
 else   if (mode.equals(C_PARAM_XHTML)) {
    m_mode=C_MODE_XHTML;
  }
 else   if (mode.equals(C_PARAM_WORD)) {
    m_mode=C_MODE_WORD;
  }
 else {
    m_mode=C_MODE_DISABLED;
  }
switch (m_mode) {
case C_MODE_ENABLED:
    m_tidy.setXHTML(false);
  m_tidy.setWord2000(false);
break;
case C_MODE_XHTML:
m_tidy.setXHTML(true);
m_tidy.setWord2000(true);
break;
case C_MODE_WORD:
m_tidy.setXHTML(false);
m_tidy.setWord2000(true);
break;
default :
break;
}
}
