{
  String sitePath=m_cms.getSitePath(m_resource);
  int pathEnd=sitePath.lastIndexOf('/') + 1;
  String baseName=sitePath.substring(pathEnd);
  m_sitepath=sitePath.substring(0,pathEnd);
switch (BundleType.toBundleType(OpenCms.getResourceManager().getResourceType(m_resource).getTypeName())) {
case PROPERTY:
    String localeSuffix=CmsStringUtil.getLocaleSuffixForName(baseName);
  if ((null != localeSuffix) && !localeSuffix.isEmpty()) {
    baseName=baseName.substring(0,baseName.lastIndexOf(localeSuffix) - (1));
    m_locale=CmsLocaleManager.getLocale(localeSuffix);
  }
 else {
    m_locale=new Locale("default");
  }
break;
case XML:
m_locale=OpenCms.getLocaleManager().getBestAvailableLocaleForXmlContent(m_cms,m_resource,m_xmlBundle);
break;
case DESCRIPTOR:
m_basename=baseName.substring(0,baseName.length() - DESCRIPTOR_POSTFIX.length());
m_locale=new Locale("en");
break;
default :
throw new IllegalArgumentException(Messages.get().container(Messages.ERROR_UNSUPPORTED_BUNDLE_TYPE_1,BundleType.toBundleType(OpenCms.getResourceManager().getResourceType(m_resource).getTypeName())).toString());
}
m_basename=baseName;
}
