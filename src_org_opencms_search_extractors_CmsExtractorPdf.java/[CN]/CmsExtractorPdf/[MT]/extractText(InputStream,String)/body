{
  PDDocument pdfDocument=null;
  try {
    PDFParser parser=new PDFParser(in);
    parser.parse();
    pdfDocument=parser.getPDDocument();
    if (pdfDocument.isEncrypted()) {
      pdfDocument.decrypt("");
    }
    PDFTextStripper stripper=new PDFTextStripper();
    PDDocumentInformation info=pdfDocument.getDocumentInformation();
    Map<String,String> contentItems=new HashMap<String,String>();
    String result=removeControlChars(stripper.getText(pdfDocument));
    StringBuffer content=new StringBuffer(result);
    if (CmsStringUtil.isNotEmpty(result)) {
      contentItems.put(I_CmsExtractionResult.ITEM_RAW,result);
    }
    combineContentItem(info.getTitle(),I_CmsExtractionResult.ITEM_TITLE,content,contentItems);
    combineContentItem(info.getKeywords(),I_CmsExtractionResult.ITEM_KEYWORDS,content,contentItems);
    combineContentItem(info.getSubject(),I_CmsExtractionResult.ITEM_SUBJECT,content,contentItems);
    combineContentItem(info.getAuthor(),I_CmsExtractionResult.ITEM_AUTHOR,content,contentItems);
    combineContentItem(info.getCreator(),I_CmsExtractionResult.ITEM_CREATOR,content,contentItems);
    combineContentItem(info.getProducer(),I_CmsExtractionResult.ITEM_PRODUCER,content,contentItems);
    stripper=null;
    info=null;
    return new CmsExtractionResult(content.toString(),contentItems);
  }
  finally {
    if (pdfDocument != null) {
      pdfDocument.close();
    }
  }
}
