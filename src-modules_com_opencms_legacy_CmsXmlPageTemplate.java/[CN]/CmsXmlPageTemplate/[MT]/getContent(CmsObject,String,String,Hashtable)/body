{
  if (OpenCms.getLog(this).isDebugEnabled()) {
    OpenCms.getLog(this).debug("Loading contents of file " + filename);
  }
  byte[] s=null;
  try {
    CmsFile file=cms.readFile(filename);
    CmsXmlPageLoader loader=(CmsXmlPageLoader)OpenCms.getResourceManager().getLoader(CmsXmlPageLoader.C_RESOURCE_LOADER_ID);
    CmsXmlPage page=CmsXmlPageFactory.unmarshal(cms,file);
    String absolutePath=cms.getSitePath(file);
    Locale locale=OpenCms.getLocaleManager().getBestMatchingLocale(cms.getRequestContext().getLocale(),OpenCms.getLocaleManager().getDefaultLocales(cms,absolutePath),page.getLocales());
    s=loader.dump(cms,file,elementName,locale,null,null);
  }
 catch (  java.lang.ClassCastException e) {
    s=null;
    throw new CmsException("[CmsXmlPageTemplate] " + filename + " is not a xml page");
  }
catch (  org.opencms.main.CmsException e) {
    s=null;
    throw new CmsException("[CmsXmlPageTemplate] Error while reading xml page " + filename + "\n"+ e,e);
  }
catch (  Exception e) {
    s=null;
    String errorMessage="[CmsXmlPageTemplate] Error while loading xml page file " + filename + ": "+ e;
    if (OpenCms.getLog(this).isErrorEnabled()) {
      OpenCms.getLog(this).error(errorMessage,e);
    }
    if (e instanceof CmsException) {
      throw (CmsException)e;
    }
 else {
      throw new CmsLegacyException(errorMessage,CmsLegacyException.C_UNKNOWN_EXCEPTION);
    }
  }
  return s;
}
