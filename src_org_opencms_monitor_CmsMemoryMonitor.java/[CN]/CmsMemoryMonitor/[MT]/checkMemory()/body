{
  long freeMemory=Runtime.getRuntime().freeMemory();
  long totalMemory=Runtime.getRuntime().totalMemory();
  long maxMemory=Runtime.getRuntime().maxMemory();
  long usage=(totalMemory - freeMemory) * 100 / maxMemory;
  if (m_maxUsage > 0 && usage > m_maxUsage) {
    if (OpenCms.getLog(this).isWarnEnabled())     OpenCms.getLog(this).warn("Memory usage of " + usage + "% exceeds max usage of "+ m_maxUsage+ "%, clearing caches");
    OpenCms.fireCmsEvent(new CmsEvent(new CmsObject(),I_CmsEventListener.EVENT_CLEAR_CACHES,Collections.EMPTY_MAP,false));
    System.gc();
    if (OpenCms.getLog(this).isWarnEnabled())     OpenCms.getLog(this).warn("" + "Memory max: ," + Runtime.getRuntime().maxMemory() / 1048576 + " ," + "total: ," + Runtime.getRuntime().totalMemory() / 1048576 + " ," + "free: ," + Runtime.getRuntime().freeMemory() / 1048576);
  }
}
