{
  if ((warning && m_warningLoggedSinceLastLog) || ((m_intervalLog <= 0) && (System.currentTimeMillis() < (m_lastLogWarning + m_intervalWarning)))) {
    return;
  }
 else   if ((!OpenCms.getLog(this).isDebugEnabled()) || ((!warning) && (m_intervalLog <= 0))) {
    return;
  }
  long maxMemory=Runtime.getRuntime().maxMemory() / 1048576;
  long totalMemory=Runtime.getRuntime().totalMemory() / 1048576;
  long usedMemory=(Runtime.getRuntime().totalMemory() - Runtime.getRuntime().freeMemory()) / 1048576;
  long freeMemory=maxMemory - usedMemory;
  long usage=usedMemory * 100 / maxMemory;
  if (warning) {
    m_lastLogWarning=System.currentTimeMillis();
    m_warningLoggedSinceLastLog=true;
    OpenCms.getLog(this).warn(", W A R N I N G Memory consumption of " + usage + "% has reached a critical level"+ " ("+ m_maxUsagePercent+ "% configured)");
  }
 else {
    m_warningLoggedSinceLastLog=false;
    m_lastLogStatus=System.currentTimeMillis();
  }
  String memStatus=", Memory max: " + maxMemory + " mb "+ "total: "+ totalMemory+ " mb "+ "free: "+ freeMemory+ " mb "+ "used: "+ usedMemory+ " mb";
  if (warning) {
    OpenCms.getLog(this).warn(memStatus);
  }
 else {
    long totalSize=0;
    for (Iterator keys=m_monitoredObjects.keySet().iterator(); keys.hasNext(); ) {
      String key=(String)keys.next();
      Object obj=m_monitoredObjects.get(key);
      long size=getKeySize(obj) + getValueSize(obj) + getCosts(obj);
      totalSize+=size;
      PrintfFormat name1=new PrintfFormat("%-100s");
      PrintfFormat name2=new PrintfFormat("%-50s");
      PrintfFormat form=new PrintfFormat("%9s");
      OpenCms.getLog(this).debug(",, " + "Monitored:, " + name1.sprintf(key) + ", "+ "Type:, "+ name2.sprintf(obj.getClass().getName())+ ", "+ "Entries:, "+ form.sprintf(getItems(obj))+ ", "+ "Limit:, "+ form.sprintf(getLimit(obj))+ ", "+ "Size:, "+ form.sprintf(Long.toString(size)));
    }
    memStatus+=" " + "monitored: " + totalSize / 1048576 + " mb";
    OpenCms.getLog(this).debug(memStatus);
  }
}
