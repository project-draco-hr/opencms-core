{
  String fileName=OpenCms.getSystemInfo().getAbsoluteRfsPathRelativeToWebApplication(UPDATE_FOLDER + File.separatorChar + CmsSystemInfo.FOLDER_MODULES+ importFile);
  report.println(Messages.get().container(Messages.RPT_BEGIN_UPDATE_MODULE_1,moduleName),I_CmsReport.FORMAT_HEADLINE);
  if (OpenCms.getModuleManager().getModule(moduleName) != null) {
    report.println(Messages.get().container(Messages.RPT_BEGIN_DELETE_MODULE_1,moduleName),I_CmsReport.FORMAT_HEADLINE);
    List projectFiles=OpenCms.getModuleManager().getModule(moduleName).getResources();
    for (int i=0; i < projectFiles.size(); i++) {
      try {
        m_cms.copyResourceToProject((String)projectFiles.get(i));
      }
 catch (      CmsException e) {
        report.println(e);
      }
    }
    OpenCms.getModuleManager().deleteModule(m_cms,moduleName,true,report);
    m_cms.unlockProject(m_cms.getRequestContext().currentProject().getId());
    m_cms.publishProject(report);
    report.println(Messages.get().container(Messages.RPT_END_DELETE_MODULE_1,moduleName),I_CmsReport.FORMAT_HEADLINE);
  }
  report.println(Messages.get().container(Messages.RPT_BEGIN_IMPORT_MODULE_1,moduleName),I_CmsReport.FORMAT_HEADLINE);
  OpenCms.getImportExportManager().importData(m_cms,fileName,null,report);
  report.println(Messages.get().container(Messages.RPT_END_IMPORT_MODULE_1,moduleName),I_CmsReport.FORMAT_HEADLINE);
  report.println(Messages.get().container(Messages.RPT_END_UPDATE_MODULE_1,moduleName),I_CmsReport.FORMAT_HEADLINE);
}
