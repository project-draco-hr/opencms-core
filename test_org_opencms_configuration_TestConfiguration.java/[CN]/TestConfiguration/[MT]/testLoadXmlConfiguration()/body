{
  URL inputUrl=Thread.currentThread().getContextClassLoader().getResource("org/opencms/configuration/");
  if (!inputUrl.toExternalForm().endsWith("/")) {
    inputUrl=new URL(inputUrl.toExternalForm() + "/");
  }
  CmsConfigurationManager manager=new CmsConfigurationManager(inputUrl.getFile());
  manager.loadXmlConfiguration();
  List allConfigurations=new ArrayList();
  allConfigurations.add(manager);
  allConfigurations.addAll(manager.getConfigurations());
  Iterator i=allConfigurations.iterator();
  while (i.hasNext()) {
    I_CmsXmlConfiguration config=(I_CmsXmlConfiguration)i.next();
    String xmlOrigFile=inputUrl.getFile() + config.getXmlFileName();
    System.out.println("\n\nConfiguration instance: " + config + ":\n");
    Document outputDoc=manager.generateXml(config);
    outputDoc.setName(config.getXmlFileName());
    InputSource source=new InputSource(new FileInputStream(xmlOrigFile));
    Document inputDoc=CmsXmlUtils.unmarshalHelper(source,new CmsXmlEntityResolver(null));
    System.out.println("---");
    System.out.println(CmsXmlUtils.marshal(outputDoc,"UTF-8"));
    System.out.println("---");
    assertEquals(outputDoc,inputDoc);
  }
}
