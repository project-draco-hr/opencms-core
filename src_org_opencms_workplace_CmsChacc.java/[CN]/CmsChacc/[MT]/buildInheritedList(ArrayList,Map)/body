{
  StringBuffer retValue=new StringBuffer("");
  String view=getSettings().getPermissionDetailView();
  Iterator i;
  if ("long".equals(view)) {
    i=entries.iterator();
    while (i.hasNext()) {
      CmsAccessControlEntry curEntry=(CmsAccessControlEntry)i.next();
      retValue.append(buildPermissionEntryForm(curEntry,false,true,getConnectedResource(curEntry,parents)));
    }
  }
 else {
    try {
      String parentUri=com.opencms.file.CmsResource.getParentFolder(getParamResource());
      CmsAccessControlList acList=getCms().getAccessControlList(parentUri,true);
      Set principalSet=acList.getPrincipals();
      i=principalSet.iterator();
      while (i.hasNext()) {
        CmsUUID principalId=(CmsUUID)i.next();
        I_CmsPrincipal principal=getCms().lookupPrincipal(principalId);
        CmsPermissionSet permissions=acList.getPermissions(principal);
        retValue.append(buildPermissionEntryForm(principalId,permissions,false,true));
      }
    }
 catch (    CmsException e) {
    }
  }
  return retValue;
}
