{
  StringBuffer retValue=new StringBuffer(2048);
  retValue.append(dialogSubheadline(key("dialog.permission.headline.inherited")));
  retValue.append("<table border=\"0\">\n<tr>\n");
  retValue.append("\t<td>" + key("dialog.permission.viewselect") + "</td>\n");
  String selectedView=getSettings().getPermissionDetailView();
  retValue.append("\t<form action=\"" + getDialogUri() + "\" method=\"post\" name=\"selectshortview\">\n");
  retValue.append("\t<td>\n");
  retValue.append("\t<input type=\"hidden\" name=\"view\" value=\"short\">\n");
  setParamAction(null);
  retValue.append(paramsAsHidden());
  retValue.append("\t<input  type=\"submit\" class=\"dialogbutton\" value=\"" + key("button.short") + "\"");
  if (!"long".equals(selectedView)) {
    retValue.append(" disabled=\"disabled\"");
  }
  retValue.append(">\n");
  retValue.append("\t</td>\n");
  retValue.append("\t</form>\n\t<form action=\"" + getDialogUri() + "\" method=\"post\" name=\"selectlongview\">\n");
  retValue.append("\t<td>\n");
  retValue.append("\t<input type=\"hidden\" name=\"view\" value=\"long\">\n");
  retValue.append(paramsAsHidden());
  retValue.append("\t<input type=\"submit\" class=\"dialogbutton\" value=\"" + key("button.long") + "\"");
  if ("long".equals(selectedView)) {
    retValue.append(" disabled=\"disabled\"");
  }
  retValue.append(">\n");
  retValue.append("\t</td>\n\t</form>\n");
  retValue.append("</tr>\n</table>\n");
  Vector allEntries=new Vector();
  try {
    allEntries=getCms().getAccessControlEntries(getParamResource(),true);
  }
 catch (  CmsException e) {
  }
  Map parents=new HashMap();
  String path=CmsResource.getParent(getParamResource());
  List parentResources=new ArrayList();
  try {
    parentResources=getCms().readPath(path,false);
  }
 catch (  CmsException e) {
  }
  Iterator k=parentResources.iterator();
  while (k.hasNext()) {
    CmsResource curRes=(CmsResource)k.next();
    parents.put(curRes.getResourceId(),curRes.getFullResourceName());
  }
  ArrayList ownEntries=new ArrayList(0);
  ArrayList inheritedEntries=new ArrayList(0);
  for (int i=0; i < allEntries.size(); i++) {
    CmsAccessControlEntry curEntry=(CmsAccessControlEntry)allEntries.elementAt(i);
    if (curEntry.isInherited()) {
      if ("long".equals(getSettings().getPermissionDetailView())) {
        inheritedEntries.add(curEntry);
      }
    }
 else {
      ownEntries.add(curEntry);
    }
  }
  retValue.append(dialogWhiteBox(HTML_START));
  retValue.append(buildInheritedList(inheritedEntries,parents));
  retValue.append(dialogWhiteBox(HTML_END));
  retValue.append(buildAddForm());
  retValue.append(buildResourceList(ownEntries));
  return retValue.toString();
}
