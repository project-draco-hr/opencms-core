{
  cms.acceptTask(taskid);
  String comment="";
  cms.writeTaskLog(taskid,comment,C_TASKLOGTYPE_ACCEPTED);
  CmsXmlLanguageFile lang=new CmsXmlLanguageFile(cms);
  CmsTask task=cms.readTask(taskid);
  if (cms.getTaskPar(task.getId(),C_TASKPARA_ACCEPTATION) != null) {
    StringBuffer contentBuf=new StringBuffer(lang.getLanguageValue("task.email.accept.content"));
    contentBuf.append("\n");
    contentBuf.append(lang.getLanguageValue("task.label.project"));
    contentBuf.append(": ");
    String projectname="?";
    try {
      projectname=cms.readTask(task.getRoot()).getName();
    }
 catch (    Exception exc) {
    }
    contentBuf.append(projectname);
    contentBuf.append("\n");
    contentBuf.append(lang.getLanguageValue("task.label.task"));
    contentBuf.append(": ");
    contentBuf.append(task.getName());
    int projectid=cms.readProject(task).getId();
    String servletPath=((HttpServletRequest)cms.getRequestContext().getRequest().getOriginalRequest()).getServletPath();
    String serverName=((HttpServletRequest)cms.getRequestContext().getRequest().getOriginalRequest()).getServerName();
    CmsXmlWpConfigFile conf=new CmsXmlWpConfigFile(cms);
    String actionPath=conf.getWorkplaceActionPath();
    contentBuf.append("\n\n\nhttp://" + serverName + servletPath+ actionPath+ "login.html?startTaskId="+ taskid+ "&startProjectId="+ projectid);
    String subject=lang.getLanguageValue("task.email.accept.subject");
    CmsUser[] users={cms.readOwner(task)};
    try {
      com.opencms.defaults.CmsMail mail=new com.opencms.defaults.CmsMail(cms,cms.readAgent(task),users,subject,contentBuf.toString(),"text/plain");
      mail.start();
    }
 catch (    Exception exc) {
      if (A_OpenCms.isLogging()) {
        A_OpenCms.log(I_CmsLogChannels.C_OPENCMS_INFO,"[CmsTaskAction] error while sending mail " + exc.getMessage());
      }
    }
  }
}
