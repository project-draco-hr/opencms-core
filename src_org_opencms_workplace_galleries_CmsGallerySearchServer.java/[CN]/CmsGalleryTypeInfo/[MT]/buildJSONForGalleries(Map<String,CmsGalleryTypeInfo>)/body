{
  JSONArray result=new JSONArray();
  if (galleryTypes == null) {
    return result;
  }
  CmsResourceManager rm=OpenCms.getResourceManager();
  Iterator<Entry<String,CmsGalleryTypeInfo>> iGalleryTypes=galleryTypes.entrySet().iterator();
  while (iGalleryTypes.hasNext()) {
    Entry<String,CmsGalleryTypeInfo> ent=iGalleryTypes.next();
    CmsGalleryTypeInfo tInfo=ent.getValue();
    String iconPath=CmsWorkplace.getResourceUri("filetypes/" + OpenCms.getWorkplaceManager().getExplorerTypeSetting(tInfo.getResourceType().getTypeName()).getIcon());
    JSONArray contentTypes=new JSONArray();
    Iterator<I_CmsResourceType> it=tInfo.getContentTypes().iterator();
    while (it.hasNext()) {
      contentTypes.put(it.next().getTypeId());
    }
    Iterator<CmsResource> ir=tInfo.getGalleries().iterator();
    while (ir.hasNext()) {
      CmsResource res=ir.next();
      JSONObject jsonObj=new JSONObject();
      String sitePath=m_cms.getSitePath(res);
      String title="";
      try {
        title=m_cms.readPropertyObject(sitePath,CmsPropertyDefinition.PROPERTY_TITLE,false).getValue("");
      }
 catch (      CmsException e) {
        if (LOG.isErrorEnabled()) {
          LOG.error(e.getLocalizedMessage(),e);
        }
      }
      try {
        jsonObj.put(JsonKeys.CONTENTTYPES.getName(),contentTypes);
        jsonObj.put(JsonKeys.TITLE.getName(),title);
        jsonObj.put(JsonKeys.PATH.getName(),sitePath);
        jsonObj.put(JsonKeys.GALLERYTYPEID.getName(),tInfo.getResourceType().getTypeId());
        jsonObj.put(JsonKeys.ICON.getName(),iconPath);
      }
 catch (      JSONException e) {
        e.printStackTrace();
      }
      result.put(jsonObj);
    }
  }
  return result;
}
