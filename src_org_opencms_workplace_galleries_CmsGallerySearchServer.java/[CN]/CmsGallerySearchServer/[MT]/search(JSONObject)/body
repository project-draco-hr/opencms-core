{
  JSONObject result=new JSONObject();
  if (query == null) {
    return result;
  }
  CmsGallerySearchParameters params=prepareSearchParams(query);
  CmsGallerySearch searchBean=new CmsGallerySearch();
  searchBean.init(m_cms);
  searchBean.setIndex(ADVANCED_GALLERY_INDEX);
  CmsGallerySearchResultList searchResults=searchBean.getResult(params);
  result.put("sortorder",params.getSortOrder());
  result.put("resultcount",searchResults.getHitCount());
  result.put("resultpage",params.getResultPage());
  result.put("resultlist",buildJSONForSearchResult(searchResults));
  return result;
}
