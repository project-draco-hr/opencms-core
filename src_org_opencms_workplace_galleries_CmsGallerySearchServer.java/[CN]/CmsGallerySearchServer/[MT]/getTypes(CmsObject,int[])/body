{
  JSONArray result=new JSONArray();
  if ((types == null) || (types.length == 0)) {
    return result;
  }
  CmsResourceManager rm=OpenCms.getResourceManager();
  Map<String,JSONObject> resourceTypes=new HashMap<String,JSONObject>();
  for (int i=0; i < types.length; i++) {
    I_CmsResourceType galleryType=rm.getResourceType(types[i]);
    String typesParam=galleryType.getConfiguration().get(CmsRecourceTypeFolderGallery.CONFIGURATION_FOLDER_CONTENT_TYPES);
    if (CmsStringUtil.isEmptyOrWhitespaceOnly(typesParam)) {
      continue;
    }
    List<String> rTypes=CmsStringUtil.splitAsList(typesParam,CmsProperty.VALUE_LIST_DELIMITER,true);
    Iterator<String> iTypes=rTypes.iterator();
    while (iTypes.hasNext()) {
      JSONObject jType;
      I_CmsResourceType rType=rm.getResourceType(iTypes.next());
      String typeName=rType.getTypeName();
      if (resourceTypes.containsKey(typeName)) {
        jType=resourceTypes.get(typeName);
        jType.getJSONArray("galleryTypes").put(types[i]);
      }
 else {
        jType=new JSONObject();
        jType.put("title",typeName);
        jType.put("typeId",rType.getTypeId());
        JSONArray galleryTypes=new JSONArray();
        galleryTypes.put(types[i]);
        jType.put("galleryTypes",galleryTypes);
        resourceTypes.put(typeName,jType);
      }
    }
  }
  Iterator<Entry<String,JSONObject>> iEntries=resourceTypes.entrySet().iterator();
  while (iEntries.hasNext()) {
    Entry<String,JSONObject> entry=iEntries.next();
    result.put(entry.getValue());
  }
  return result;
}
