{
  JSONArray result=new JSONArray();
  if ((searchResult == null) || (searchResult.size() == 0)) {
    return result;
  }
  Iterator<CmsGallerySearchResult> iSearchResult=searchResult.iterator();
  while (iSearchResult.hasNext()) {
    try {
      CmsGallerySearchResult sResult=iSearchResult.next();
      JSONObject resultEntry=new JSONObject();
      String path=sResult.getPath();
      path=getRequestContext().removeSiteRoot(path);
      String fileIcon=getFileIconName(path);
      String iconPath=CmsWorkplace.RES_PATH_FILETYPES;
      if (CmsStringUtil.isEmptyOrWhitespaceOnly(fileIcon)) {
        iconPath+=OpenCms.getWorkplaceManager().getExplorerTypeSetting(sResult.getResourceType()).getIcon();
      }
 else {
        iconPath+="mimetype/" + fileIcon;
      }
      iconPath=CmsWorkplace.getResourceUri(iconPath);
      resultEntry.put(JsonKeys.DATEMODIFIED.getName(),sResult.getDateLastModified());
      resultEntry.put(JsonKeys.TITLE.getName(),sResult.getTitle());
      resultEntry.put(JsonKeys.INFO.getName(),sResult.getDescription());
      resultEntry.put(JsonKeys.TYPE.getName(),sResult.getResourceType());
      resultEntry.put(JsonKeys.PATH.getName(),path);
      resultEntry.put(JsonKeys.ICON.getName(),iconPath);
      resultEntry.put(JsonKeys.CLIENTID.getName(),OpenCms.getADEManager().convertToClientId(sResult.getStructureId()));
      I_CmsResourceType type=OpenCms.getResourceManager().getResourceType(sResult.getResourceType());
      CmsFormatterInfoBean formatterInfo=new CmsFormatterInfoBean(type,false);
      formatterInfo.setTitleInfo(JsonKeys.TITLE.getName(),JsonKeys.TITLE.getName(),sResult.getTitle());
      formatterInfo.setSubTitleInfo(JsonKeys.TYPE.getName(),JsonKeys.TYPE.getName(),CmsWorkplaceMessages.getResourceTypeName(m_locale,type.getTypeName()));
      formatterInfo.setIcon(iconPath);
      if (!CmsStringUtil.isEmptyOrWhitespaceOnly(sResult.getExcerpt())) {
        formatterInfo.addAdditionalInfo(EXCERPT_FIELD_NAME,OpenCms.getWorkplaceManager().getMessages(m_locale).key(Messages.GUI_LABEL_EXCERPT),sResult.getExcerpt());
      }
      resultEntry.put(JsonKeys.ITEMHTML.getName(),getFormattedListContent(formatterInfo));
      result.put(resultEntry);
    }
 catch (    Exception e) {
      if (LOG.isErrorEnabled()) {
        LOG.error(e.getLocalizedMessage(),e);
      }
    }
  }
  return result;
}
