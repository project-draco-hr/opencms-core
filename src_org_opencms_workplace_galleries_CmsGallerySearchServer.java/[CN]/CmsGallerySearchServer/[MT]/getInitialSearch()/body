{
  JSONObject result=new JSONObject();
  try {
    JSONObject data=getReqDataObj();
    if (data != null) {
      String resourcePath=data.optString(ItemKey.resourcepath.name());
      String sitemapUri=data.optString(SitemapKey.sitemapUri.name());
      if (CmsStringUtil.isNotEmptyOrWhitespaceOnly(resourcePath)) {
        result=findResourceInGallery(resourcePath);
      }
 else       if (CmsStringUtil.isNotEmptyOrWhitespaceOnly(sitemapUri)) {
        result.put(ResponseKey.sitemap.name(),buildJSONForSitemap(sitemapUri,null,null,true));
      }
 else {
        JSONObject queryData=data.getJSONObject(QueryKey.querydata.name());
        result.put(QueryKey.querydata.name(),queryData);
        result.put(ResponseKey.searchresult.name(),search(queryData));
      }
    }
  }
 catch (  Exception e) {
    LOG.error(e.getLocalizedMessage(),e);
  }
  return result.toString();
}
