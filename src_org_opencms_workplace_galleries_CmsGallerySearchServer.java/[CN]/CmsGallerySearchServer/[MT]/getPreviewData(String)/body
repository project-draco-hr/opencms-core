{
  JSONObject result=new JSONObject();
  Map<String,Object> reqAttributes=new HashMap<String,Object>();
  CmsResource resource=m_cms.readResource(resourcePath);
  I_CmsResourceType type=getResourceManager().getResourceType(resource.getTypeId());
  CmsGalleryItemBean reqItem=new CmsGalleryItemBean(resource);
  reqItem.setTypeId(resource.getTypeId());
  reqItem.setTypeName(type.getTypeName());
  reqAttributes.put(ReqParam.GALLERYITEM.getName(),reqItem);
  result.put(JsonKeys.ITEMHTML.getName(),type.getFormattedContent(m_cms,getRequest(),getResponse(),A_CmsResourceType.DefaultFormatters.FORMATTER_GALLERY_PREVIEW.getKey(),reqAttributes));
  result.put(JsonKeys.STATE.getName(),resource.getState().getState());
  JSONArray propertiesJSON=new JSONArray();
  List<String> properties=OpenCms.getWorkplaceManager().getExplorerTypeSetting(type.getTypeName()).getProperties();
  Iterator<String> propIt=properties.iterator();
  while (propIt.hasNext()) {
    String propertyName=propIt.next();
    CmsProperty property=m_cms.readPropertyObject(resource,propertyName,false);
    JSONObject propertyJSON=new JSONObject();
    propertyJSON.put(JsonKeys.NAME.getName(),propertyName);
    propertyJSON.put(JsonKeys.VALUE.getName(),property.getValue());
    propertiesJSON.put(propertyJSON);
  }
  result.put(JsonKeys.PROPERTIES.getName(),propertiesJSON);
  return result;
}
