{
  try {
    String mimetype="unknown/mimetype";
    String mt=OpenCms.getResourceManager().getMimeType(getJsp().link(sitePath),null);
    if (mt.equals("application/msword")) {
      mimetype=mt;
    }
 else     if (mt.equals("application/pdf")) {
      mimetype=mt;
    }
 else     if (mt.equals("application/vnd.ms-excel")) {
      mimetype=mt;
    }
 else     if (mt.equals("application/vnd.ms-powerpoint")) {
      mimetype=mt;
    }
 else     if (mt.equals("image/jpeg")) {
      mimetype=mt;
    }
 else     if (mt.equals("image/png")) {
      mimetype=mt;
    }
 else     if (mt.equals("text/plain")) {
      mimetype=mt;
    }
    jsonObj.put("mimetype",mimetype);
  }
 catch (  JSONException e) {
    if (LOG.isErrorEnabled()) {
      LOG.error(e.getLocalizedMessage(),e);
    }
  }
}
