{
  String C_PROPERTY_WEBC_ID="WebcontestID";
  String C_GEMADI_PATH="system/templates/";
  Vector absPaths=new Vector();
  if (!startFolder.endsWith("/")) {
    startFolder=startFolder.substring(0,startFolder.lastIndexOf('/') + 1);
  }
  CmsFolder curFolder=cms.readFolder(startFolder);
  String prop=cms.readProperty(curFolder.getAbsolutePath(),C_PROPERTY_WEBC_ID);
  String relativePart="";
  while (((prop == null) || ("".equals(prop))) && (curFolder.getParent() != null)) {
    curFolder=cms.readFolder(curFolder.getParent());
    prop=cms.readProperty(curFolder.getAbsolutePath(),C_PROPERTY_WEBC_ID);
    relativePart+="../";
  }
  int basePathLength=curFolder.getAbsolutePath().length();
  Vector files=cms.getFilesInFolder(curFolder.getAbsolutePath() + C_GEMADI_PATH);
  Enumeration enum=files.elements();
  while (enum.hasMoreElements()) {
    CmsFile file=(CmsFile)enum.nextElement();
    if (file.getState() != I_CmsConstants.C_STATE_DELETED && CmsHelperMastertemplates.checkVisible(cms,file)) {
      String nicename=cms.readProperty(file.getAbsolutePath(),I_CmsConstants.C_PROPERTY_TITLE);
      if (nicename == null) {
        nicename=file.getName();
      }
      names.addElement(nicename);
      values.addElement(relativePart + file.getAbsolutePath().substring(basePathLength));
      absPaths.addElement(file.getAbsolutePath());
    }
  }
  Utils.bubblesort(names,values);
  if (currentTemplate != null) {
    for (int i=0; i < values.size(); i++) {
      String template=(String)absPaths.get(i);
      if (currentTemplate.equals(template)) {
        return new Integer(i);
      }
    }
  }
  return new Integer(0);
}
