{
  CmsRpcAction<CmsPropertiesBean> action=new CmsRpcAction<CmsPropertiesBean>(){
    @Override public void execute(){
      start(0,true);
      CmsCoreProvider.getVfsService().loadPropertyData(structureId,this);
    }
    @Override protected void onResponse(    CmsPropertiesBean result){
      I_CmsLayoutBundle.INSTANCE.propertiesCss().ensureInjected();
      CmsSimplePropertyEditorHandler handler=new PropertyEditorHandler();
      handler.setPropertiesBean(result);
      CmsVfsModePropertyEditor editor=new CmsVfsModePropertyEditor(result.getPropertyDefinitions(),handler);
      editor.setReadOnly(result.isReadOnly());
      editor.setShowResourceProperties(!handler.isFolder());
      stop(false);
      final CmsFormDialog dialog=new CmsFormDialog(handler.getDialogTitle(),editor.getForm());
      CmsCoreData.UserInfo userInfo=CmsCoreProvider.get().getUserInfo();
      if (userInfo.isDeveloper()) {
        String style=I_CmsLayoutBundle.INSTANCE.propertiesCss().propertyDefinitionButton();
        CmsPushButton button=new CmsPushButton(style);
        button.setTitle(CmsPropertyDefinitionMessages.messageDialogCaption());
        button.setButtonStyle(ButtonStyle.TRANSPARENT,null);
        button.getElement().getStyle().setFloat(Style.Float.LEFT);
        dialog.addButton(button);
        button.addClickHandler(new ClickHandler(){
          public void onClick(          ClickEvent event){
            m_needsPropertyDefinitionDialog=true;
            dialog.hide();
            editPropertyDefinition();
          }
        }
);
      }
      CmsDialogFormHandler formHandler=new CmsDialogFormHandler();
      formHandler.setDialog(dialog);
      I_CmsFormSubmitHandler submitHandler=new CmsPropertySubmitHandler(handler);
      formHandler.setSubmitHandler(submitHandler);
      editor.getForm().setFormHandler(formHandler);
      editor.initializeWidgets(dialog);
      dialog.centerHorizontally(50);
      dialog.addCloseHandler(new CloseHandler<PopupPanel>(){
        public void onClose(        CloseEvent<PopupPanel> event){
          onClosePropertyDialog();
        }
      }
);
      dialog.catchNotifications();
    }
  }
;
  action.execute();
}
