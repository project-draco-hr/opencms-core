def nonZopeFileUpload(self, resourceType, currentFolder):
    errorNo = 0
    errorMsg = ''
    if self.request.has_key('NewFile'):
        newFile = self.request.get('NewFile', '')
        newFileName = newFile.filename
        newFileNameOnly = self.removeExtension(newFileName)
        newFileExtension = self.getExtension(newFileName).lower()
        allowedExtensions = self.getAllowedExtensions(resourceType)
        deniedExtensions = self.getDeniedExtensions(resourceType)
        if (allowedExtensions is not None):
            isAllowed = False
            if (newFileExtension in allowedExtensions):
                isAllowed = True
        elif (deniedExtensions is not None):
            isAllowed = True
            if (newFileExtension in deniedExtensions):
                isAllowed = False
        else:
            isAllowed = True
        if isAllowed:
            if self.isZope():
                self.zopeFileUpload(resourceType, currentFolder)
            else:
                currentFolderPath = self.serverMapFolder(resourceType, currentFolder)
                i = 0
                while True:
                    newFilePath = ('%s%s' % (currentFolderPath, newFileName))
                    if os.path.exists(newFilePath):
                        i += 1
                        newFilePath = ('%s%s(%s).%s' % (currentFolderPath, newFileNameOnly, i, newFileExtension))
                        errorNo = 201
                        break
                    else:
                        fileHandle = open(newFilePath, 'w')
                        linecount = 0
                        while 1:
                            line = newFile.readline()
                            if (not line):
                                break
                            fileHandle.write(('%s' % line))
                            linecount += 1
                        os.chmod(newFilePath, 511)
                        break
        else:
            newFileName = 'Extension not allowed'
            errorNo = 203
    else:
        newFileName = 'No File'
        errorNo = 202
    string = ('\n<script type="text/javascript">\nwindow.parent.frames["frmUpload"].OnUploadCompleted(%s,"%s");\n</script>\n\t\t\t\t' % (errorNo, newFileName.replace('"', "'")))
    return string
