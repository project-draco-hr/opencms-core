def run(self):
    s = ''
    try:
        if (not self.enabled):
            return self.sendError(1, 'This connector is disabled.  Please check the connector configurations and try again')
        if (not (self.request.has_key('Command') and self.request.has_key('Type') and self.request.has_key('CurrentFolder'))):
            return
        command = self.request.get('Command', None)
        resourceType = self.request.get('Type', None)
        currentFolder = self.request.get('CurrentFolder', None)
        if (currentFolder[(-1)] != '/'):
            currentFolder += '/'
        if (currentFolder[0] != '/'):
            currentFolder = ('/' + currentFolder)
        if ('..' in currentFolder):
            return self.sendError(102, '')
        if (command == 'FileUpload'):
            return self.fileUpload(resourceType, currentFolder)
        s += self.createXmlHeader(command, resourceType, currentFolder)
        if (command == 'GetFolders'):
            f = self.getFolders
        elif (command == 'GetFoldersAndFiles'):
            f = self.getFoldersAndFiles
        elif (command == 'CreateFolder'):
            f = self.createFolder
        else:
            f = None
        if (f is not None):
            s += f(resourceType, currentFolder)
        s += self.createXmlFooter()
    except Exception as e:
        s = ('ERROR: %s' % e)
    return s
