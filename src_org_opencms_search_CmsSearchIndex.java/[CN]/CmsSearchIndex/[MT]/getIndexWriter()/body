{
  IndexWriter indexWriter;
  Analyzer analyzer=OpenCms.getSearchManager().getAnalyzer(m_locale);
  try {
    File f=new File(m_path);
    if (f.exists()) {
      indexWriter=new IndexWriter(m_path,analyzer,!m_incremental);
    }
 else {
      f=f.getParentFile();
      if (f != null && !f.exists()) {
        f.mkdir();
      }
      indexWriter=new IndexWriter(m_path,analyzer,true);
    }
  }
 catch (  Exception exc) {
    throw new CmsIndexException(Messages.get().container(Messages.LOG_INDEX_WRITER_CREATION_FAILED_1,m_name),exc);
  }
  return indexWriter;
}
