{
  String excerpt=null;
  Analyzer analyzer=null;
  Query query=null;
  CmsHighlightExtractor highlighter=null;
  String rawContent=null;
  try {
    analyzer=m_indexManager.getAnalyzer(m_language);
    query=QueryParser.parse(result.getQuery(),I_CmsDocumentFactory.DOC_CONTENT,analyzer);
    highlighter=new CmsHighlightExtractor(new CmsHtmlHighlighter(),query,analyzer);
    rawContent=result.getRawContent();
    if (rawContent != null) {
      int highlightFragmentSizeInBytes=60;
      int maxNumFragmentsRequired=5;
      String fragmentSeparator=".. ";
      excerpt=highlighter.getBestFragments(rawContent,highlightFragmentSizeInBytes,maxNumFragmentsRequired,fragmentSeparator);
      excerpt=excerpt.replaceAll("[\\t\\n\\x0B\\f\\r]","");
    }
  }
 catch (  Exception exc) {
    String message="[Analyzer: " + analyzer + "][Query: "+ query+ "][CmsHighlightExtractor: "+ highlighter+ "][RawContent: ";
    if (rawContent != null) {
      message+=rawContent.length() + "]";
    }
 else {
      message+=rawContent + "]";
    }
    throw new CmsException(message,exc);
  }
  return excerpt;
}
