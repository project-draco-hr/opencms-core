{
  if (!isCheckingPermissions()) {
    return true;
  }
  Fieldable typeField=doc.getFieldable(CmsSearchField.FIELD_TYPE);
  Fieldable pathField=doc.getFieldable(CmsSearchField.FIELD_PATH);
  if ((typeField == null) || (pathField == null)) {
    return true;
  }
  String type=typeField.stringValue();
  if (!CmsSearchFieldConfiguration.VFS_DOCUMENT_KEY_PREFIX.equals(type) && !OpenCms.getResourceManager().hasResourceType(type)) {
    return true;
  }
  String contextPath=cms.getRequestContext().removeSiteRoot(pathField.stringValue());
  return cms.existsResource(contextPath);
}
