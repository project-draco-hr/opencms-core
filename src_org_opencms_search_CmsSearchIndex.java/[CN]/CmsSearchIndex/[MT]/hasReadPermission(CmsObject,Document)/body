{
  if (!isCheckingPermissions()) {
    return true;
  }
  Fieldable typeField=doc.getFieldable(CmsSearchField.FIELD_TYPE);
  Fieldable pathField=doc.getFieldable(CmsSearchField.FIELD_PATH);
  if ((typeField == null) || (pathField == null)) {
    return true;
  }
  String type=typeField.stringValue();
  if (!CmsSearchFieldConfiguration.VFS_DOCUMENT_KEY_PREFIX.equals(type) && !OpenCms.getResourceManager().hasResourceType(type)) {
    return true;
  }
  String contextPath=cms.getRequestContext().removeSiteRoot(pathField.stringValue());
  CmsResourceFilter filter=CmsResourceFilter.DEFAULT;
  if (m_requireViewPermission) {
    filter=CmsResourceFilter.DEFAULT_ONLY_VISIBLE;
  }
  return cms.existsResource(contextPath,filter);
}
