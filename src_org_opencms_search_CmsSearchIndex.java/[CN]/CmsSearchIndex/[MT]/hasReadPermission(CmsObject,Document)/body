{
  if (m_dontCheckPermissions) {
    return true;
  }
  Field typeField=doc.getField(CmsSearchField.FIELD_TYPE);
  Field pathField=doc.getField(CmsSearchField.FIELD_PATH);
  if ((typeField == null) || (pathField == null)) {
    return true;
  }
  String type=typeField.stringValue();
  if (!A_CmsVfsDocument.VFS_DOCUMENT_KEY_PREFIX.equals(type) && !OpenCms.getResourceManager().hasResourceType(type)) {
    return true;
  }
  String contextPath=cms.getRequestContext().removeSiteRoot(pathField.stringValue());
  return cms.existsResource(contextPath);
}
