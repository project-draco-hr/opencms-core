{
  Map<Locale,CmsContainerPageBean> result=new HashMap<Locale,CmsContainerPageBean>();
  String cfgPath=cms.readPropertyObject(content.getFile(),PROPERTY_CONTAINER_NEW_CONFIG,true).getValue("");
  if (CmsStringUtil.isEmptyOrWhitespaceOnly(cfgPath)) {
    throw new CmsIllegalStateException(Messages.get().container(Messages.ERR_CONFIG_NOT_SET_2,cms.getSitePath(content.getFile()),PROPERTY_CONTAINER_NEW_CONFIG));
  }
  CmsResource newConfigRes;
  try {
    newConfigRes=cms.readResource(cfgPath);
  }
 catch (  Exception e) {
    throw new CmsIllegalStateException(Messages.get().container(Messages.ERR_CONFIG_NOT_FOUND_3,cms.getSitePath(content.getFile()),PROPERTY_CONTAINER_NEW_CONFIG,cfgPath));
  }
  if (newConfigRes.getTypeId() != 14) {
    throw new CmsIllegalStateException(Messages.get().container(Messages.ERR_CONFIG_WRONG_TYPE_3,cms.getSitePath(content.getFile()),PROPERTY_CONTAINER_NEW_CONFIG,cfgPath));
  }
  Iterator itLocales=content.getLocales().iterator();
  while (itLocales.hasNext()) {
    Locale locale=(Locale)itLocales.next();
    CmsContainerPageBean cntPage=new CmsContainerPageBean(locale,newConfigRes);
    Iterator itContainers=content.getValues(CmsContainerPageLoader.N_CONTAINER,locale).iterator();
    while (itContainers.hasNext()) {
      I_CmsXmlContentValue container=(I_CmsXmlContentValue)itContainers.next();
      String containerPath=container.getPath();
      String name=content.getValue(CmsXmlUtils.concatXpath(containerPath,CmsContainerPageLoader.N_NAME),locale).getStringValue(cms);
      String type=content.getValue(CmsXmlUtils.concatXpath(containerPath,CmsContainerPageLoader.N_TYPE),locale).getStringValue(cms);
      CmsContainerBean cnt=new CmsContainerBean(name,type,-1);
      Iterator itElements=content.getValues(CmsXmlUtils.concatXpath(containerPath,CmsContainerPageLoader.N_ELEMENT),locale).iterator();
      while (itElements.hasNext()) {
        I_CmsXmlContentValue element=(I_CmsXmlContentValue)itElements.next();
        String elementPath=element.getPath();
        String elemUri=content.getValue(CmsXmlUtils.concatXpath(elementPath,CmsContainerPageLoader.N_URI),locale).getStringValue(cms);
        CmsResource elemRes=cms.readResource(elemUri);
        String formatter=content.getValue(CmsXmlUtils.concatXpath(elementPath,CmsContainerPageLoader.N_FORMATTER),locale).getStringValue(cms);
        CmsResource formatterRes=cms.readResource(formatter);
        CmsContainerElementBean elem=new CmsContainerElementBean(elemRes,formatterRes);
        cnt.addElement(elem);
      }
      cntPage.addContainer(cnt);
    }
    result.put(locale,cntPage);
  }
  return result;
}
