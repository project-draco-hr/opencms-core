{
  initMembers();
  if (CmsStringUtil.isEmpty(configUri)) {
    configUri=jsp.getRequestContext().getUri();
  }
  CmsFile file=jsp.getCmsObject().readFile(configUri);
  CmsXmlContent content=CmsXmlContentFactory.unmarshal(jsp.getCmsObject(),file);
  Locale locale=jsp.getRequestContext().getLocale();
  CmsObject cms=jsp.getCmsObject();
  String stringValue=content.getStringValue(cms,NODE_TITLE,locale);
  setAlbumTitle(getConfigurationValue(stringValue,""));
  stringValue=content.getStringValue(cms,NODE_VFSFOLDER,locale);
  setVfsPathGallery(getConfigurationValue(stringValue,""));
  stringValue=content.getStringValue(cms,NODE_ALIGN_NAVIGATION,locale);
  setAlignNavigation(getConfigurationValue(stringValue,"left"));
  stringValue=content.getStringValue(cms,NODE_NAVIGATION_POSITION,locale);
  setNavigationPosition(getConfigurationValue(stringValue,NAVPOS_BOTTOM_BELOW));
  stringValue=content.getStringValue(cms,NODE_SHOWRESOURCENAMEASTITLE,locale);
  setShowResourceNameAsTitle(Boolean.valueOf(stringValue).booleanValue());
  String nodePrefix=NODE_THUMBS + "/";
  stringValue=content.getStringValue(cms,nodePrefix + NODE_SHOWTITLE,locale);
  setShowThumbTitle(Boolean.valueOf(stringValue).booleanValue());
  stringValue=content.getStringValue(cms,nodePrefix + NODE_ALIGN_TITLE,locale);
  setThumbAlignTitle(getConfigurationValue(stringValue,"left"));
  stringValue=content.getStringValue(cms,nodePrefix + NODE_COLS,locale);
  setThumbCols(Integer.parseInt(getConfigurationValue(stringValue,"1")));
  stringValue=content.getStringValue(cms,nodePrefix + NODE_ROWS,locale);
  setThumbRows(Integer.parseInt(getConfigurationValue(stringValue,"-1")));
  stringValue=content.getStringValue(cms,nodePrefix + NODE_BACKGROUND,locale);
  stringValue=getConfigurationValue(stringValue,"#FFFFFF");
  Color color=Color.WHITE;
  try {
    color=Color.decode(stringValue);
  }
 catch (  NumberFormatException e) {
    throw new CmsException(Messages.get().container(Messages.LOG_ERR_WRONG_THUMB_BGCOLOR_1,stringValue));
  }
  getThumbNailScaler().setColor(color);
  stringValue=content.getStringValue(cms,nodePrefix + NODE_HIGHQUALITY,locale);
  if (Boolean.valueOf(stringValue).booleanValue()) {
    getThumbNailScaler().setQuality(85);
  }
 else {
    getThumbNailScaler().setQuality(50);
    getThumbNailScaler().setRenderMode(Simapi.RENDER_SPEED);
  }
  stringValue=content.getStringValue(cms,nodePrefix + NODE_SIZE,locale);
  setImageSize(stringValue,true);
  stringValue=content.getStringValue(cms,nodePrefix + NODE_FILTER,locale);
  setImageFilter(stringValue,true);
  CmsXmlHtmlValue textValue=(CmsXmlHtmlValue)content.getValue(nodePrefix + NODE_TEXTTOP,locale);
  if (textValue != null) {
    stringValue=textValue.getStringValue(cms);
    setThumbTextTop(getConfigurationValue(stringValue,""));
  }
 else {
    setThumbTextTop("");
  }
  textValue=(CmsXmlHtmlValue)content.getValue(nodePrefix + NODE_TEXTBOTTOM,locale);
  if (textValue != null) {
    stringValue=textValue.getStringValue(cms);
    setThumbTextBottom(getConfigurationValue(stringValue,""));
  }
 else {
    setThumbTextBottom("");
  }
  nodePrefix=NODE_DETAIL + "/";
  stringValue=content.getStringValue(cms,nodePrefix + NODE_SHOWTITLE,locale);
  setShowDetailTitle(Boolean.valueOf(stringValue).booleanValue());
  stringValue=content.getStringValue(cms,nodePrefix + NODE_SHOWDESCRIPTION,locale);
  setShowDetailDescription(Boolean.valueOf(stringValue).booleanValue());
  stringValue=content.getStringValue(cms,nodePrefix + NODE_ALIGN_TITLE,locale);
  setDetailAlignTitle(getConfigurationValue(stringValue,"left"));
  stringValue=content.getStringValue(cms,nodePrefix + NODE_SHOWLINKORIGINAL,locale);
  setShowDetailOriginalLink(Boolean.valueOf(stringValue).booleanValue());
  stringValue=content.getStringValue(cms,nodePrefix + NODE_SIZE,locale);
  setImageSize(stringValue,false);
  stringValue=content.getStringValue(cms,nodePrefix + NODE_FILTER,locale);
  setImageFilter(stringValue,false);
  stringValue=content.getStringValue(cms,nodePrefix + NODE_BACKGROUND,locale);
  stringValue=getConfigurationValue(stringValue,"#FFFFFF");
  color=Color.WHITE;
  try {
    color=Color.decode(stringValue);
  }
 catch (  NumberFormatException e) {
    throw new CmsException(Messages.get().container(Messages.LOG_ERR_WRONG_DETAIL_BGCOLOR_1,stringValue));
  }
  getDetailImageScaler().setColor(color);
}
