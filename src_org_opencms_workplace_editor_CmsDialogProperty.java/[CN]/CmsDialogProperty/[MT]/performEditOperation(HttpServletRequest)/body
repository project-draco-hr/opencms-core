{
  Map activeProperties=getCms().readProperties(getParamResource());
  boolean useTempfileProject="true".equals(getParamUsetempfileproject());
  try {
    if (useTempfileProject) {
      switchToTempProject();
    }
    for (int i=0; i < PROPERTIES.length; i++) {
      String paramValue=request.getParameter(PREFIX_VALUE + PROPERTIES[i]);
      String oldValue=request.getParameter(PREFIX_HIDDEN + PROPERTIES[i]);
      writeProperty(PROPERTIES[i],paramValue,oldValue,activeProperties);
    }
    String paramValue=request.getParameter("enablenav");
    String oldValue=null;
    if ("true".equals(paramValue)) {
      paramValue=request.getParameter("navpos");
      oldValue=request.getParameter(PREFIX_HIDDEN + I_CmsConstants.C_PROPERTY_NAVPOS);
      writeProperty(I_CmsConstants.C_PROPERTY_NAVPOS,paramValue,oldValue,activeProperties);
      paramValue=request.getParameter(PREFIX_VALUE + I_CmsConstants.C_PROPERTY_NAVTEXT);
      oldValue=request.getParameter(PREFIX_HIDDEN + I_CmsConstants.C_PROPERTY_NAVTEXT);
      writeProperty(I_CmsConstants.C_PROPERTY_NAVTEXT,paramValue,oldValue,activeProperties);
    }
 else {
      writeProperty(I_CmsConstants.C_PROPERTY_NAVPOS,null,null,activeProperties);
      writeProperty(I_CmsConstants.C_PROPERTY_NAVTEXT,null,null,activeProperties);
    }
    paramValue=request.getParameter(I_CmsConstants.C_PROPERTY_TEMPLATE);
    oldValue=request.getParameter(PREFIX_HIDDEN + I_CmsConstants.C_PROPERTY_TEMPLATE);
    writeProperty(I_CmsConstants.C_PROPERTY_TEMPLATE,paramValue,oldValue,activeProperties);
    if (paramValue != null && !paramValue.equals(oldValue)) {
      if (getParamOkFunctions() != null && getParamOkFunctions().startsWith("window.close()")) {
        setParamOkFunctions("window.opener.doTemplSubmit(1);");
      }
    }
  }
  finally {
    if (useTempfileProject) {
      switchToCurrentProject();
    }
  }
  return true;
}
