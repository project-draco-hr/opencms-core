{
  Map activeProperties=getCms().readProperties(getParamResource());
  boolean useTempfileProject="true".equals(getParamUsetempfileproject());
  try {
    if (useTempfileProject) {
      switchToTempProject();
    }
    for (int i=0; i < PROPERTIES.length; i++) {
      String paramValue=request.getParameter(PREFIX_VALUE + PROPERTIES[i]);
      String oldValue=request.getParameter(PREFIX_HIDDEN + PROPERTIES[i]);
      writeProperty(PROPERTIES[i],paramValue,oldValue,activeProperties);
    }
    String paramValue=request.getParameter(PREFIX_VALUE + PROP_PAGETYPE);
    String oldPos=request.getParameter(PREFIX_HIDDEN + PROP_PAGETYPE);
    String oldValue="";
    if (oldPos != null && !"".equals(oldPos)) {
      int position=Integer.parseInt(oldPos);
      if (position > 0) {
        oldValue=PAGE_TYPES[position - 1];
      }
    }
    writeProperty(PROP_PAGETYPE,paramValue,oldValue,activeProperties);
    paramValue=request.getParameter(PREFIX_VALUE + PROP_SHOWDOCUMENT);
    oldValue=request.getParameter(PREFIX_HIDDEN + PROP_SHOWDOCUMENT);
    writeProperty(PROP_SHOWDOCUMENT,paramValue,oldValue,activeProperties);
  }
  finally {
    if (useTempfileProject) {
      switchToCurrentProject();
    }
  }
  return true;
}
