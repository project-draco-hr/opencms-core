{
  Map activeProperties=CmsPropertyAdvanced.getPropertyMap(getCms().readPropertyObjects(getParamResource(),false));
  boolean useTempfileProject="true".equals(getParamUsetempfileproject());
  try {
    if (useTempfileProject) {
      switchToTempProject();
    }
    Iterator i=getExplorerTypeSettings().getProperties().iterator();
    while (i.hasNext()) {
      String curProperty=(String)i.next();
      String paramValue=request.getParameter(PREFIX_VALUE + curProperty);
      String oldValue=request.getParameter(PREFIX_HIDDEN + curProperty);
      writeProperty(curProperty,paramValue,oldValue,activeProperties);
    }
    String paramValue=null;
    String oldValue=null;
    if (showNavigation()) {
      paramValue=request.getParameter("enablenav");
      if ("true".equals(paramValue)) {
        paramValue=request.getParameter("navpos");
        if (!"-1".equals(paramValue)) {
          oldValue=request.getParameter(PREFIX_HIDDEN + I_CmsConstants.C_PROPERTY_NAVPOS);
          writeProperty(I_CmsConstants.C_PROPERTY_NAVPOS,paramValue,oldValue,activeProperties);
        }
        paramValue=request.getParameter(PREFIX_VALUE + I_CmsConstants.C_PROPERTY_NAVTEXT);
        oldValue=request.getParameter(PREFIX_HIDDEN + I_CmsConstants.C_PROPERTY_NAVTEXT);
        writeProperty(I_CmsConstants.C_PROPERTY_NAVTEXT,paramValue,oldValue,activeProperties);
      }
 else {
        writeProperty(I_CmsConstants.C_PROPERTY_NAVPOS,null,null,activeProperties);
        writeProperty(I_CmsConstants.C_PROPERTY_NAVTEXT,null,null,activeProperties);
      }
    }
    paramValue=request.getParameter(I_CmsConstants.C_PROPERTY_TEMPLATE);
    oldValue=request.getParameter(PREFIX_HIDDEN + I_CmsConstants.C_PROPERTY_TEMPLATE);
    writeProperty(I_CmsConstants.C_PROPERTY_TEMPLATE,paramValue,oldValue,activeProperties);
    if (paramValue != null && !paramValue.equals(oldValue)) {
      m_templateChanged=true;
    }
  }
  finally {
    if (useTempfileProject) {
      switchToCurrentProject();
    }
  }
  return true;
}
