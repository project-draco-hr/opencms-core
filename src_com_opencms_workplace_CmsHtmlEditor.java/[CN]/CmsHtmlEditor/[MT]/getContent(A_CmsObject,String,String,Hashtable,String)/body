{
  if (C_DEBUG && A_OpenCms.isLogging()) {
    A_OpenCms.log(C_OPENCMS_DEBUG,getClassName() + "getting content of element " + ((elementName == null) ? "<root>" : elementName));
    A_OpenCms.log(C_OPENCMS_DEBUG,getClassName() + "template file is: " + templateFile);
    A_OpenCms.log(C_OPENCMS_DEBUG,getClassName() + "selected template section is: " + ((templateSelector == null) ? "<default>" : templateSelector));
  }
  String content=(String)parameters.get("CONTENT");
  String file=(String)parameters.get("file");
  String exit=(String)parameters.get("EXIT");
  System.err.println("*** Parameter exit: " + exit);
  boolean existsContentParam=(content != null && (!"".equals(content)));
  boolean existsFileParam=(file != null && (!"".equals(file)));
  if (!existsFileParam) {
    throwException("No file requested",CmsException.C_BAD_NAME);
  }
  CmsFile editFile=cms.readFile(file);
  CmsFile tempFile=null;
  String temporaryFileName=editFile.getParent() + C_WP_TEMP_PREFIX + editFile.getName();
  if (exit != null && ("save".equals(exit) || "cancel".equals(exit))) {
    try {
      cms.getRequestContext().getResponse().sendCmsRedirect(getConfigFile(cms).getWorkplaceMainPath());
    }
 catch (    IOException e) {
      throwException("Could not send redirect to workplace main screen.",e);
    }
    return "".getBytes();
  }
  CmsXmlTemplateFile xmlTemplateDocument=getOwnTemplateFile(cms,templateFile,elementName,parameters,templateSelector);
  return startProcessing(cms,xmlTemplateDocument,elementName,parameters,templateSelector);
}
