{
  CmsRequestContext context=cms.getRequestContext();
  if (!publishList.isDirectPublish() && context.currentProject().getType() != I_CmsConstants.C_PROJECT_TYPE_TEMPORARY) {
    List legacyPublishClasses=getLegacyModulePublishClasses();
    if (legacyPublishClasses.isEmpty()) {
      return;
    }
    long publishDate=System.currentTimeMillis();
    boolean backupEnabled=OpenCms.getSystemInfo().isVersionHistoryEnabled();
    if (backupEnabled) {
      try {
        publishDate=cms.readBackupProject(backupTagId).getPublishingDate();
      }
 catch (      CmsException e) {
      }
      if (publishDate == 0) {
        publishDate=System.currentTimeMillis();
      }
    }
    Vector changedResources=new Vector();
    Vector changedModuleMasters=new Vector();
    for (int i=0; i < legacyPublishClasses.size(); i++) {
      try {
        Class.forName((String)legacyPublishClasses.get(i)).getMethod("publishProject",new Class[]{CmsObject.class,Boolean.class,Integer.class,Integer.class,Long.class,Vector.class,Vector.class}).invoke(null,new Object[]{cms,new Boolean(OpenCms.getSystemInfo().isVersionHistoryEnabled()),new Integer(context.currentProject().getId()),new Integer(backupTagId),new Long(publishDate),changedResources,changedModuleMasters});
      }
 catch (      ClassNotFoundException ec) {
        report.println(report.key("report.publish_class_for_module_does_not_exist_1") + (String)legacyPublishClasses.get(i) + report.key("report.publish_class_for_module_does_not_exist_2"),I_CmsReport.C_FORMAT_WARNING);
        if (OpenCms.getLog(this).isErrorEnabled()) {
          OpenCms.getLog(this).error("Error calling publish class of module " + (String)legacyPublishClasses.get(i),ec);
        }
      }
catch (      Throwable t) {
        report.println(t);
        if (OpenCms.getLog(this).isErrorEnabled()) {
          OpenCms.getLog(this).error("Error while publishing data of module " + (String)legacyPublishClasses.get(i),t);
        }
      }
    }
    Iterator i=changedModuleMasters.iterator();
    while (i.hasNext()) {
      CmsPublishedResource currentCosResource=(CmsPublishedResource)i.next();
      cms.postPublishBoResource(currentCosResource,publishList.getPublishHistoryId(),backupTagId);
    }
  }
}
