{
  Map<String,CmsXmlContentProperty> result=new HashMap<String,CmsXmlContentProperty>();
  Map<String,CmsXmlContentProperty> propertiesFromSchema=CmsXmlContentDefinition.getContentHandlerForResource(cms,resource).getProperties();
  result.putAll(propertiesFromSchema);
  if (includeNonSchemaProperties) {
    CmsADEDefaultConfiguration conf=new CmsADEDefaultConfiguration();
    List<CmsXmlContentProperty> propertiesFromConfigFile=conf.getProperties(cms,cms.getSitePath(resource));
    for (    CmsXmlContentProperty prop : propertiesFromConfigFile) {
      result.put(prop.getPropertyName(),prop);
    }
  }
  return result;
}
