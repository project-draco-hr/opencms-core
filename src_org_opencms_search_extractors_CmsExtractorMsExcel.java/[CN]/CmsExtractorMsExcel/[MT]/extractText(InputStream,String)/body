{
  HSSFWorkbook excelWb=new HSSFWorkbook(in);
  StringBuffer result=new StringBuffer(4096);
  int numberOfSheets=excelWb.getNumberOfSheets();
  for (int i=0; i < numberOfSheets; i++) {
    HSSFSheet sheet=excelWb.getSheetAt(i);
    int numberOfRows=sheet.getPhysicalNumberOfRows();
    if (numberOfRows > 0) {
      if (CmsStringUtil.isNotEmpty(excelWb.getSheetName(i))) {
        if (i > 0) {
          result.append("\n\n");
        }
        result.append(excelWb.getSheetName(i).trim());
        result.append(":\n\n");
      }
      Iterator rowIt=sheet.rowIterator();
      while (rowIt.hasNext()) {
        HSSFRow row=(HSSFRow)rowIt.next();
        if (row != null) {
          boolean hasContent=false;
          Iterator it=row.cellIterator();
          while (it.hasNext()) {
            HSSFCell cell=(HSSFCell)it.next();
            String text=null;
switch (cell.getCellType()) {
case HSSFCell.CELL_TYPE_BLANK:
case HSSFCell.CELL_TYPE_ERROR:
              break;
case HSSFCell.CELL_TYPE_NUMERIC:
            try {
              text=Double.toString(cell.getNumericCellValue());
            }
 catch (            Exception e) {
            }
          break;
case HSSFCell.CELL_TYPE_STRING:
default :
        try {
          text=cell.getStringCellValue();
        }
 catch (        Exception e) {
        }
      break;
  }
  if (CmsStringUtil.isNotEmpty(text)) {
    result.append(text.trim());
    result.append(' ');
    hasContent=true;
  }
}
if (hasContent) {
  result.append('\n');
}
}
}
}
}
return new CmsExtractionResult(result.toString());
}
