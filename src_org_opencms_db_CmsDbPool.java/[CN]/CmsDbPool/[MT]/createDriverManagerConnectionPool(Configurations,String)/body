{
  String jdbcDriver=config.getString(C_KEY_DATABASE_POOL + "." + key+ "."+ C_KEY_JDBC_DRIVER);
  String jdbcUrl=config.getString(C_KEY_DATABASE_POOL + "." + key+ "."+ C_KEY_JDBC_URL);
  int maxActive=config.getInteger(C_KEY_DATABASE_POOL + "." + key+ "."+ C_KEY_MAX_ACTIVE,10);
  int maxWait=config.getInteger(C_KEY_DATABASE_POOL + "." + key+ "."+ C_KEY_MAX_WAIT,2000);
  int maxIdle=config.getInteger(C_KEY_DATABASE_POOL + "." + key+ "."+ C_KEY_MAX_IDLE,5);
  String testQuery=config.getString(C_KEY_DATABASE_POOL + "." + key+ "."+ C_KEY_TEST_QUERY);
  String username=config.getString(C_KEY_DATABASE_POOL + "." + key+ "."+ C_KEY_USERNAME);
  String password=config.getString(C_KEY_DATABASE_POOL + "." + key+ "."+ C_KEY_PASSWORD);
  String poolUrl=config.getString(C_KEY_DATABASE_POOL + "." + key+ "."+ C_KEY_POOL_URL);
  String whenExhaustedActionValue=config.getString(C_KEY_DATABASE_POOL + "." + key+ "."+ C_KEY_WHEN_EXHAUSTED_ACTION).trim();
  byte whenExhaustedAction=0;
  boolean testOnBorrow="true".equalsIgnoreCase(config.getString(C_KEY_DATABASE_POOL + "." + key+ "."+ C_KEY_TEST_ON_BORROW).trim());
  if ("block".equalsIgnoreCase(whenExhaustedActionValue)) {
    whenExhaustedAction=GenericObjectPool.WHEN_EXHAUSTED_BLOCK;
  }
 else   if ("fail".equalsIgnoreCase(whenExhaustedActionValue)) {
    whenExhaustedAction=GenericObjectPool.WHEN_EXHAUSTED_FAIL;
  }
 else   if ("grow".equalsIgnoreCase(whenExhaustedActionValue)) {
    whenExhaustedAction=GenericObjectPool.WHEN_EXHAUSTED_GROW;
  }
 else {
    whenExhaustedAction=GenericObjectPool.DEFAULT_WHEN_EXHAUSTED_ACTION;
  }
  if ("".equals(testQuery)) {
    testQuery=null;
  }
  if (username == null) {
    username="";
  }
  if (password == null) {
    password="";
  }
  boolean poolingStmts="true".equalsIgnoreCase(config.getString(C_KEY_DATABASE_STATEMENTS + "." + key+ "."+ C_KEY_POOLING,"true").trim());
  int maxActiveStmts=config.getInteger(C_KEY_DATABASE_STATEMENTS + "." + key+ "."+ C_KEY_MAX_ACTIVE,25);
  int maxWaitStmts=config.getInteger(C_KEY_DATABASE_STATEMENTS + "." + key+ "."+ C_KEY_MAX_WAIT,250);
  int maxIdleStmts=config.getInteger(C_KEY_DATABASE_STATEMENTS + "." + key+ "."+ C_KEY_MAX_IDLE,15);
  String whenStmtsExhaustedActionValue=config.getString(C_KEY_DATABASE_STATEMENTS + "." + key+ "."+ C_KEY_WHEN_EXHAUSTED_ACTION);
  byte whenStmtsExhaustedAction=GenericKeyedObjectPool.WHEN_EXHAUSTED_GROW;
  if (whenStmtsExhaustedActionValue != null) {
    whenStmtsExhaustedActionValue=whenStmtsExhaustedActionValue.trim();
    whenStmtsExhaustedAction=("block".equalsIgnoreCase(whenStmtsExhaustedActionValue)) ? GenericKeyedObjectPool.WHEN_EXHAUSTED_BLOCK : ("fail".equalsIgnoreCase(whenStmtsExhaustedActionValue)) ? GenericKeyedObjectPool.WHEN_EXHAUSTED_FAIL : GenericKeyedObjectPool.WHEN_EXHAUSTED_GROW;
  }
  Class.forName(jdbcDriver).newInstance();
  GenericObjectPool connectionPool=null;
  connectionPool=new GenericObjectPool(null);
  connectionPool.setMaxActive(maxActive);
  connectionPool.setMaxIdle(maxIdle);
  connectionPool.setMaxWait(maxWait);
  connectionPool.setWhenExhaustedAction(whenExhaustedAction);
  connectionPool.setTestOnBorrow(testOnBorrow && (testQuery != null));
  connectionPool.setTestWhileIdle(true);
  ConnectionFactory connectionFactory=new DriverManagerConnectionFactory(jdbcUrl,username,password);
  GenericKeyedObjectPoolFactory statementFactory=null;
  if (poolingStmts) {
    statementFactory=new GenericKeyedObjectPoolFactory(null,maxActiveStmts,whenStmtsExhaustedAction,maxWaitStmts,maxIdleStmts);
  }
  new PoolableConnectionFactory(connectionFactory,connectionPool,statementFactory,testQuery,false,true);
  PoolingDriver driver=new PoolingDriver();
  driver.registerPool(poolUrl,connectionPool);
  if (OpenCms.getLog(CmsLog.CHANNEL_INIT).isInfoEnabled()) {
    OpenCms.getLog(CmsLog.CHANNEL_INIT).info(". Init. JDBC pool      : " + poolUrl + " ("+ jdbcUrl+ ")");
  }
  return poolUrl;
}
