{
  File targetFile=null;
  m_action=m_actionOutputCreate;
  try {
    ZipOutputStream zipStream=new ZipOutputStream(new FileOutputStream(m_zipfile));
    for (int i=0; i < files.length; i++) {
      if (files[i].isFile()) {
        addFileToZip(zipStream,files[i],files[i].getName());
      }
 else {
        addFolderToZip(zipStream,files[i],"");
      }
      repaint();
      files[i]=null;
    }
    zipStream.close();
    targetFile=new File(m_zipfile);
  }
 catch (  Exception e) {
    System.err.println("Error creating zipfile " + e);
  }
  return targetFile;
}
