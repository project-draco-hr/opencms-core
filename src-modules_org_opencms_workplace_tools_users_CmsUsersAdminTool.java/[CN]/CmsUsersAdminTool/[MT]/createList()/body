{
  if (metadata == null) {
    metadata=new CmsListMetadata();
    I_CmsListAction showAddressAction=new CmsListIndependentAction(LIST_ID,LIST_DETAIL_ADDRESS,Messages.get().container(Messages.GUI_USERS_DETAIL_SHOW_ADDRESS_NAME_0),Messages.get().container(Messages.GUI_USERS_DETAIL_SHOW_ADDRESS_HELP_0),"buttons/properties.gif",true,null);
    I_CmsListAction hideAddressAction=new CmsListIndependentAction(LIST_ID,LIST_DETAIL_ADDRESS,Messages.get().container(Messages.GUI_USERS_DETAIL_HIDE_ADDRESS_NAME_0),Messages.get().container(Messages.GUI_USERS_DETAIL_HIDE_ADDRESS_HELP_0),"buttons/properties.gif",true,null);
    CmsListItemDetails userAddressDetails=new CmsListItemDetails(LIST_DETAIL_ADDRESS,LIST_COLUMN_LOGIN,false,showAddressAction,hideAddressAction);
    userAddressDetails.setFormatter(new CmsListItemDetailsFormatter(Messages.get().container(Messages.GUI_USERS_DETAIL_ADDRESS_FORMAT_0)));
    metadata.addItemDetails(userAddressDetails);
    I_CmsListAction showGroupsAction=new CmsListIndependentAction(LIST_ID,LIST_DETAIL_GROUPS,Messages.get().container(Messages.GUI_USERS_DETAIL_SHOW_GROUPS_NAME_0),Messages.get().container(Messages.GUI_USERS_DETAIL_SHOW_GROUPS_HELP_0),"buttons/group_sm.gif",true,null);
    I_CmsListAction hideGroupsAction=new CmsListIndependentAction(LIST_ID,LIST_DETAIL_GROUPS,Messages.get().container(Messages.GUI_USERS_DETAIL_HIDE_GROUPS_NAME_0),Messages.get().container(Messages.GUI_USERS_DETAIL_HIDE_GROUPS_HELP_0),"buttons/group_sm.gif",true,null);
    CmsListItemDetails userGroupsDetails=new CmsListItemDetails(LIST_DETAIL_GROUPS,LIST_COLUMN_LOGIN,true,showGroupsAction,hideGroupsAction);
    userGroupsDetails.setFormatter(new CmsListItemDetailsFormatter(Messages.get().container(Messages.GUI_USERS_DETAIL_GROUPS_FORMAT_0)));
    metadata.addItemDetails(userGroupsDetails);
    metadata.addIndependentAction(CmsListIndependentAction.getDefaultRefreshListAction(LIST_ID));
    CmsListColumnDefinition actionsCol=new CmsListColumnDefinition(LIST_COLUMN_ACTIONS,Messages.get().container(Messages.GUI_USERS_LIST_COLS_ACTIONS_0),"",CmsListColumnAlignEnum.ALIGN_CENTER);
    actionsCol.setSorteable(false);
    CmsUserActivateDeactivateAction userAction=new CmsUserActivateDeactivateAction(LIST_ID,LIST_ACTION_ACTIVATE,getCms());
    CmsListDirectAction userActAction=new CmsListDirectAction(LIST_ID,LIST_ACTION_ACTIVATE);
    userActAction.setName(Messages.get().container(Messages.GUI_USERS_LIST_ACTION_ACTIVATE_NAME_0));
    userActAction.setConfirmationMessage(Messages.get().container(Messages.GUI_USERS_LIST_ACTION_ACTIVATE_CONF_0));
    userActAction.setIconPath("buttons/apply_in.gif");
    userActAction.setEnabled(true);
    userActAction.setHelpText(Messages.get().container(Messages.GUI_USERS_LIST_ACTION_ACTIVATE_HELP_0));
    userAction.setActivationAction(userActAction);
    CmsListDirectAction userDeactAction=new CmsListDirectAction(LIST_ID,LIST_ACTION_DEACTIVATE);
    userDeactAction.setName(Messages.get().container(Messages.GUI_USERS_LIST_ACTION_DEACTIVATE_NAME_0));
    userDeactAction.setConfirmationMessage(Messages.get().container(Messages.GUI_USERS_LIST_ACTION_DEACTIVATE_CONF_0));
    userDeactAction.setIconPath("buttons/apply.gif");
    userDeactAction.setEnabled(true);
    userDeactAction.setHelpText(Messages.get().container(Messages.GUI_USERS_LIST_ACTION_DEACTIVATE_HELP_0));
    userAction.setDeactivationAction(userDeactAction);
    actionsCol.addDirectAction(userAction);
    metadata.addColumn(actionsCol);
    CmsListColumnDefinition loginCol=new CmsListColumnDefinition(LIST_COLUMN_LOGIN,Messages.get().container(Messages.GUI_USERS_LIST_COLS_LOGIN_0),"",CmsListColumnAlignEnum.ALIGN_LEFT);
    loginCol.setDefaultAction(new CmsListDefaultAction(LIST_ID,LIST_ACTION_EDIT,Messages.get().container(Messages.GUI_USERS_LIST_ACTION_EDITUSER_NAME_0),Messages.get().container(Messages.GUI_USERS_LIST_ACTION_EDITUSER_HELP_0),null,true,Messages.get().container(Messages.GUI_USERS_LIST_ACTION_EDITUSER_CONF_0)));
    metadata.addColumn(loginCol);
    CmsListColumnDefinition nameCol=new CmsListColumnDefinition(LIST_COLUMN_NAME,Messages.get().container(Messages.GUI_USERS_LIST_COLS_USERNAME_0),"",CmsListColumnAlignEnum.ALIGN_LEFT);
    metadata.addColumn(nameCol);
    CmsListColumnDefinition emailCol=new CmsListColumnDefinition(LIST_COLUMN_EMAIL,Messages.get().container(Messages.GUI_USERS_LIST_COLS_EMAIL_0),"",CmsListColumnAlignEnum.ALIGN_LEFT);
    metadata.addColumn(emailCol);
    CmsListColumnDefinition lastLoginCol=new CmsListColumnDefinition(LIST_COLUMN_LASTLOGIN,Messages.get().container(Messages.GUI_USERS_LIST_COLS_LASTLOGIN_0),"",CmsListColumnAlignEnum.ALIGN_LEFT);
    lastLoginCol.setFormatter(new CmsListDateMacroFormatter(Messages.get().container(Messages.GUI_USERS_LIST_COLS_LASTLOGIN_FORMAT_0),Messages.get().container(Messages.GUI_USERS_LIST_COLS_LASTLOGIN_NEVER_0)));
    metadata.addColumn(lastLoginCol);
    metadata.addMultiAction(new CmsListMultiAction(LIST_ID,LIST_ACTION_DELETE,Messages.get().container(Messages.GUI_USERS_LIST_ACTION_DELETE_NAME_0),"list/delete.gif",Messages.get().container(Messages.GUI_USERS_LIST_ACTION_DELETE_HELP_0),true,Messages.get().container(Messages.GUI_USERS_LIST_ACTION_DELETE_CONF_0)));
    CmsListMultiAction activateUser=new CmsListMultiAction(LIST_ID,LIST_ACTION_MACTIVATE);
    activateUser.setName(Messages.get().container(Messages.GUI_USERS_LIST_ACTION_MACTIVATE_NAME_0));
    activateUser.setConfirmationMessage(Messages.get().container(Messages.GUI_USERS_LIST_ACTION_MACTIVATE_CONF_0));
    activateUser.setIconPath("buttons/user_sm.gif");
    activateUser.setEnabled(true);
    activateUser.setHelpText(Messages.get().container(Messages.GUI_USERS_LIST_ACTION_MACTIVATE_HELP_0));
    metadata.addMultiAction(activateUser);
    CmsSearchAction searchAction=new CmsSearchAction(LIST_ID,loginCol);
    searchAction.useDefaultShowAllAction();
    metadata.setSearchAction(searchAction);
  }
  return new CmsHtmlList(LIST_ID,Messages.get().container(Messages.GUI_USERS_LIST_NAME_0),metadata);
}
