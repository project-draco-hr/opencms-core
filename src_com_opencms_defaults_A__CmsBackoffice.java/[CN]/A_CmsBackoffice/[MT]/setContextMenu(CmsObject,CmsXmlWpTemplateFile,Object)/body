{
  int state=0;
  CmsUUID lockedByUserId=CmsUUID.getNullUUID();
  int projectId=1;
  int lockedInProject=-1;
  int actProjectId=cms.getRequestContext().currentProject().getId();
  try {
    projectId=((I_CmsExtendedContentDefinition)entryObject).getProjectId();
  }
 catch (  Exception e) {
    if (I_CmsLogChannels.C_PREPROCESSOR_IS_LOGGING && A_OpenCms.isLogging()) {
      A_OpenCms.log(C_OPENCMS_INFO,getClassName() + ": Backoffice setContextMenu: Method getProjectId throwed an exception: " + e.toString());
    }
  }
  if (actProjectId == C_PROJECT_ONLINE_ID) {
    template.setData("backofficecontextmenue","backofficeonline");
  }
 else   if (projectId != actProjectId) {
    template.setData("backofficecontextmenue","backofficenoaccess");
  }
 else {
    try {
      lockedByUserId=((A_CmsContentDefinition)entryObject).getLockstate();
    }
 catch (    Exception e) {
      if (I_CmsLogChannels.C_PREPROCESSOR_IS_LOGGING && A_OpenCms.isLogging()) {
        A_OpenCms.log(C_OPENCMS_INFO,getClassName() + ": Backoffice setContextMenu: Method getLockstate throwed an exception: " + e.toString());
      }
    }
    try {
      state=((I_CmsExtendedContentDefinition)entryObject).getState();
    }
 catch (    Exception e) {
      if (I_CmsLogChannels.C_PREPROCESSOR_IS_LOGGING && A_OpenCms.isLogging()) {
        A_OpenCms.log(C_OPENCMS_INFO,getClassName() + ": Backoffice setContextMenu: Method getState throwed an exception: " + e.toString());
      }
    }
    if (lockedByUserId.isNullUUID()) {
      if (state == C_STATE_UNCHANGED) {
        template.setData("backofficecontextmenue","backofficenolock");
      }
 else       if (state == C_STATE_DELETED) {
        template.setData("backofficecontextmenue","backofficedeleted");
      }
 else {
        template.setData("backofficecontextmenue","backofficenolockchanged");
      }
    }
 else     if (lockedByUserId.equals(cms.getRequestContext().currentUser().getId())) {
      try {
        lockedInProject=((I_CmsExtendedContentDefinition)entryObject).getLockedInProject();
      }
 catch (      Exception e) {
        if (I_CmsLogChannels.C_PREPROCESSOR_IS_LOGGING && A_OpenCms.isLogging()) {
          A_OpenCms.log(C_OPENCMS_INFO,getClassName() + ": Backoffice setContextMenu: Method getLockedInProject throwed an exception: " + e.toString());
        }
      }
      if (lockedInProject == actProjectId) {
        template.setData("backofficecontextmenue","backofficelockuser");
      }
 else {
        template.setData("backofficecontextmenue","backofficelock");
      }
    }
 else {
      template.setData("backofficecontextmenue","backofficelock");
    }
  }
}
