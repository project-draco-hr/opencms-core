{
  int state=0;
  int projectId=1;
  String projectFlag=null;
  int actProjectId=cms.getRequestContext().currentProject().getId();
  String isInProject=null;
  try {
    template.setData("projectflag",template.getDataValue("noproject"));
  }
 catch (  Exception e) {
    if (I_CmsLogChannels.C_PREPROCESSOR_IS_LOGGING && A_OpenCms.isLogging()) {
      A_OpenCms.log(C_OPENCMS_INFO,getClassName() + ": Backoffice setProjectFlag:'no project' section throwed an exception!");
    }
  }
  try {
    state=((I_CmsExtendedContentDefinition)entryObject).getState();
  }
 catch (  Exception e) {
    if (I_CmsLogChannels.C_PREPROCESSOR_IS_LOGGING && A_OpenCms.isLogging()) {
      A_OpenCms.log(C_OPENCMS_INFO,getClassName() + ": Backoffice setProjectFlag: Method getState throwed an exception: " + e.toString());
    }
  }
  if (state == 0) {
    try {
      template.setData("projectflag",template.getDataValue("noproject"));
    }
 catch (    Exception e) {
      if (I_CmsLogChannels.C_PREPROCESSOR_IS_LOGGING && A_OpenCms.isLogging()) {
        A_OpenCms.log(C_OPENCMS_INFO,getClassName() + ": Backoffice setProjectFlag:'no project' section throwed an exception!");
      }
    }
  }
 else {
    try {
      projectId=((I_CmsExtendedContentDefinition)entryObject).getLockedInProject();
    }
 catch (    Exception e) {
      if (I_CmsLogChannels.C_PREPROCESSOR_IS_LOGGING && A_OpenCms.isLogging()) {
        A_OpenCms.log(C_OPENCMS_INFO,getClassName() + ": Backoffice setProjectFlag: Method getLockedInProject throwed an exception: " + e.toString());
      }
    }
    try {
      try {
        isInProject=cms.readProject(projectId).getName();
      }
 catch (      CmsException e) {
        isInProject="";
      }
      template.setData("isInProject",isInProject);
      if (projectId == actProjectId) {
        projectFlag=template.getProcessedDataValue("thisproject",this,parameters);
        template.setData("projectflag",projectFlag);
      }
 else {
        projectFlag=template.getProcessedDataValue("otherproject",this,parameters);
        template.setData("projectflag",projectFlag);
      }
    }
 catch (    Exception e) {
      if (I_CmsLogChannels.C_PREPROCESSOR_IS_LOGGING && A_OpenCms.isLogging()) {
        A_OpenCms.log(C_OPENCMS_INFO,getClassName() + ": Backoffice setLockstates throwed an exception: " + e.toString());
      }
    }
  }
}
