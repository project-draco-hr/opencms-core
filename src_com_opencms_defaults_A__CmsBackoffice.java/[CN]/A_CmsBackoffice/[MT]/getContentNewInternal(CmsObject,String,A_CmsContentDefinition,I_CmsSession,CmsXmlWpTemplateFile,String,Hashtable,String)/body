{
  byte[] returnProcess=null;
  String error="";
  String action=(String)parameters.get("action");
  templateSelector=getTemplateSelector(cms,template,parameters,templateSelector);
  returnProcess=getContentNew(cms,template,elementName,parameters,templateSelector);
  if (returnProcess == null) {
    cd=(A_CmsContentDefinition)session.getValue(this.getContentDefinitionClass().getName());
    if (cd == null) {
      cd=(A_CmsContentDefinition)this.getContentDefinition(cms,this.getContentDefinitionClass());
    }
    Enumeration keys=parameters.keys();
    error=getContentNew(cms,template,cd,elementName,keys,parameters,templateSelector);
    Vector methods=this.getGetMethods(cd);
    Hashtable setMethods=this.getSetMethods(cd);
    this.fillContentDefinition(cms,cd,parameters,setMethods);
    session.putValue(this.getContentDefinitionClass().getName(),cd);
    if (!error.equals("")) {
      template.setData("error",template.getProcessedDataValue("errormsg") + error);
    }
 else {
      template.setData("error","");
    }
    templateSelector=getContentButtonsInternal(cms,cd,session,template,parameters,templateSelector,action,error);
    this.setDatablocks(template,cd,methods);
    returnProcess=startProcessing(cms,template,"",parameters,templateSelector);
  }
  return returnProcess;
}
