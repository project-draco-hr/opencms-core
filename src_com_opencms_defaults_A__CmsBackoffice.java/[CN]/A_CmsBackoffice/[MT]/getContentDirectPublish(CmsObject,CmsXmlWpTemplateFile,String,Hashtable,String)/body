{
  byte[] processResult=null;
  CmsXmlLanguageFile lang=new CmsXmlLanguageFile(cms);
  if (cms.isAdmin() || cms.isManagerOfProject()) {
    I_CmsSession session=CmsXmlTemplateLoader.getSession(cms.getRequestContext(),true);
    Class cdClass=getContentDefinitionClass();
    String id=(String)parameters.get("id");
    if (id == null) {
      id="";
    }
    String action=(String)parameters.get("action");
    if (action == null || action.equals("")) {
      if (id != "") {
        templateSelector="publish";
        template.setData("publishtitle",lang.getLanguageValue("messagebox.title.publishresource"));
        template.setData("publishdialog1",lang.getLanguageValue("messagebox.message1.publishresource"));
        template.setData("newsentry",id);
        template.setData("publishdialog2",lang.getLanguageValue("messagebox.message4.publishresource"));
        template.setData("setaction","default");
      }
    }
 else {
      templateSelector="done";
      session.removeValue("idsave");
      CmsUUID contentId=new CmsUUID(id);
      Object o=null;
      o=getContentDefinition(cms,cdClass,contentId);
      try {
        ((I_CmsExtendedContentDefinition)o).publishResource(cms);
      }
 catch (      Exception e) {
        templateSelector="publisherror";
        template.setData("publisherror",e.getMessage());
      }
    }
  }
 else {
    templateSelector="publisherror";
    template.setData("publisherror",lang.getLanguageValue("error.message.publishresource") + "<br>" + lang.getLanguageValue("error.reason.publishresource"));
  }
  processResult=startProcessing(cms,template,elementName,parameters,templateSelector);
  return processResult;
}
