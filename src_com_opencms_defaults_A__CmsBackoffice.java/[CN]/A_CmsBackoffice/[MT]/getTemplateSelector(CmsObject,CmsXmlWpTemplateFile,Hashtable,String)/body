{
  CmsSession session=(CmsSession)cms.getRequestContext().getSession(true);
  if (templateSelector != null) {
    session.putValue("backofficepagetemplateselector",templateSelector);
  }
  Vector selectors=new Vector();
  Vector filteredSelectors=new Vector();
  selectors=template.getAllSections();
  for (int i=0; i < selectors.size(); i++) {
    String selector=(String)selectors.elementAt(i);
    if ((!selector.equals(C_DEFAULT_SELECTOR)) && (!selector.equals(C_DONE_SELECTOR))) {
      filteredSelectors.addElement(selector);
    }
  }
  String selectedPage=(String)parameters.get("backofficepage");
  if (selectors.size() < 4) {
    template.setData("BOSELECTOR","");
  }
  if (selectedPage != null) {
    templateSelector=selectedPage;
  }
 else   if (filteredSelectors.size() > 0) {
    templateSelector=(String)filteredSelectors.elementAt(0);
    session.putValue("backofficepagetemplateselector",templateSelector);
  }
  session.putValue("backofficepageselectorvector",filteredSelectors);
  return templateSelector;
}
