{
  Element itemElement=getListItemWidget().getElement();
  int top=CmsDomUtil.getRelativeY(y,itemElement);
  int height=itemElement.getOffsetHeight();
  int index;
  String path;
  boolean isParentDndEnabled;
  if (getParentItem() == null) {
    index=getTree().getItemPosition(this);
    path="/";
    isParentDndEnabled=getTree().isDropEnabled();
  }
 else {
    index=getParentItem().getItemPosition(this);
    path=getParentItem().getPath();
    isParentDndEnabled=getParentItem().isDropEnabled();
  }
  Element parentElement=getElement().getParentElement();
  if (top < height / 3) {
    getTree().cancelOpenTimer();
    if (!isParentDndEnabled) {
      return getTree().getPlaceholderIndex();
    }
    parentElement.insertBefore(placeholder,getElement());
    getTree().setPlaceholderPath(path);
    return index;
  }
 else   if ((top > 2 * height / 3) && (top < height)) {
    getTree().cancelOpenTimer();
    if ((getChildCount() == 0) || !isOpen()) {
      if (!isParentDndEnabled) {
        return getTree().getPlaceholderIndex();
      }
      parentElement.insertAfter(placeholder,getElement());
      getTree().setPlaceholderPath(path);
      return index + 1;
    }
 else {
      if (!isDropEnabled()) {
        return getTree().getPlaceholderIndex();
      }
      m_children.getElement().insertBefore(placeholder,m_children.getElement().getFirstChild());
      getTree().setPlaceholderPath(getPath());
      return 0;
    }
  }
 else   if (top < height) {
    if (!isDropEnabled()) {
      getTree().cancelOpenTimer();
      return getTree().getPlaceholderIndex();
    }
    getTree().setOpenTimer(this);
    m_children.getElement().appendChild(placeholder);
    getTree().setPlaceholderPath(getPath());
    return getChildCount();
  }
 else   if (isOpen()) {
    getTree().cancelOpenTimer();
    for (int childIndex=0; childIndex < getChildCount(); childIndex++) {
      CmsTreeItem child=getChild(childIndex);
      Element childElement=child.getElement();
      String positioning=childElement.getStyle().getPosition();
      if ((positioning.equals(Position.ABSOLUTE.getCssName()) || positioning.equals(Position.FIXED.getCssName())) || !child.isVisible()) {
        continue;
      }
      int childLeft=CmsDomUtil.getRelativeX(x,childElement);
      if ((childLeft <= 0) || (childLeft >= childElement.getOffsetWidth())) {
        continue;
      }
      int childTop=CmsDomUtil.getRelativeY(y,childElement);
      int childHeight=childElement.getOffsetHeight();
      if ((childTop <= 0) || (childTop >= childHeight)) {
        continue;
      }
      return child.repositionPlaceholder(x,y,placeholder);
    }
  }
  getTree().cancelOpenTimer();
  return getTree().getPlaceholderIndex();
}
