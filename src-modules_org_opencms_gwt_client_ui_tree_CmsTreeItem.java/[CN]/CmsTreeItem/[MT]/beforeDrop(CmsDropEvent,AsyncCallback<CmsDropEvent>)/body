{
  if (!(e.getTarget() instanceof CmsTree<?>)) {
    if (e.getTarget() instanceof CmsList<?>) {
      super.beforeDrop(e,callback);
      return;
    }
    callback.onSuccess(e);
    return;
  }
  CmsTree<?> tree=(CmsTree<?>)e.getTarget();
  String destPath=e.getPosition().getInfo() + e.getPosition().getName() + "/";
  Object item=tree.getItemByPath(destPath);
  if (item == null) {
    callback.onSuccess(e);
    return;
  }
  I_CmsDraggable draggable=e.getDraggable();
  if (draggable instanceof CmsTreeItem) {
    CmsTreeItem src=(CmsTreeItem)draggable;
    if ((src.getTree() == e.getTarget()) && destPath.equals(src.getPath())) {
      callback.onSuccess(e);
      return;
    }
  }
  String newName=e.getPosition().getName();
  while ((newName != null) && (tree.getItemByPath(e.getPosition().getInfo() + newName + "/") != null)) {
    newName=Window.prompt("duplicated name, please enter a new one",newName);
  }
  if (newName == null) {
    callback.onFailure(null);
  }
 else {
    e.getPosition().setName(newName);
    callback.onSuccess(new CmsDropEvent(CmsTreeItem.this,e.getTarget(),e.getPosition()));
  }
}
