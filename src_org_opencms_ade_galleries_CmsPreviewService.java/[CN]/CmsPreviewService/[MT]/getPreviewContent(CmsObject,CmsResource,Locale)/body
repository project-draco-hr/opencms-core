{
  try {
    if (CmsResourceTypeXmlContent.isXmlContent(resource)) {
      CmsADEConfigData adeConfig=OpenCms.getADEManager().lookupConfiguration(cms,cms.getRequestContext().getRootUri());
      CmsFormatterConfiguration formatters=adeConfig.getFormatters(resource);
      CmsFormatterBean formatter=formatters.getFormatter(CmsFormatterBean.PREVIEW_TYPE,-1);
      if (formatter != null) {
        CmsObject tempCms=OpenCms.initCmsObject(cms);
        tempCms.getRequestContext().setLocale(locale);
        CmsResource formatterResource=tempCms.readResource(formatter.getJspStructureId());
        CmsContainerElementBean element=new CmsContainerElementBean(resource.getStructureId(),formatter.getJspStructureId(),null,false);
        element.initResource(tempCms);
        CmsTemplateLoaderFacade loaderFacade=new CmsTemplateLoaderFacade(OpenCms.getResourceManager().getLoader(formatterResource),element.getResource(),formatterResource);
        CmsResource loaderRes=loaderFacade.getLoaderStartResource();
        CmsContainerBean containerBean=new CmsContainerBean("PREVIEW",CmsFormatterBean.PREVIEW_TYPE,1,Collections.<CmsContainerElementBean>emptyList());
        containerBean.setWidth(String.valueOf(CmsFormatterBean.PREVIEW_WIDTH));
        getRequest().setAttribute(CmsJspStandardContextBean.ATTRIBUTE_CMS_OBJECT,tempCms);
        CmsJspStandardContextBean standardContext=CmsJspStandardContextBean.getInstance(getRequest());
        standardContext.setContainer(containerBean);
        standardContext.setElement(element);
        standardContext.setEdited(true);
        standardContext.setPage(new CmsContainerPageBean(locale,Collections.<CmsContainerBean>singletonList(containerBean)));
        String encoding=getResponse().getCharacterEncoding();
        return (new String(loaderFacade.getLoader().dump(tempCms,loaderRes,null,locale,getRequest(),getResponse()),encoding)).trim();
      }
    }
  }
 catch (  Exception e) {
  }
  return null;
}
