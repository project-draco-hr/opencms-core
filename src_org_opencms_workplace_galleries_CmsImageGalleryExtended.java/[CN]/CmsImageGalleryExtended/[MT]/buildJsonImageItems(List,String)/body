{
  if (images == null) {
    images=new ArrayList();
  }
  List items=new ArrayList(images.size() + 1);
  boolean isPublisEnabled=false;
  if (CmsStringUtil.isNotEmpty(imgParentFolder)) {
    try {
      if (OpenCms.getPublishManager().getPublishList(getCms(),getCms().readResource(imgParentFolder),false).size() > 0) {
        isPublisEnabled=true;
      }
    }
 catch (    Exception e) {
    }
  }
  JSONObject publishInfo=new JSONObject();
  try {
    publishInfo.put("publishable",isPublisEnabled);
  }
 catch (  JSONException e) {
  }
  items.add(publishInfo);
  Iterator i=images.iterator();
  while (i.hasNext()) {
    CmsResource res=(CmsResource)i.next();
    items.add(buildJsonImageObject(res));
  }
  JSONArray jsonArr=new JSONArray(items);
  JspWriter out=getJsp().getJspContext().getOut();
  try {
    out.print(jsonArr.toString());
  }
 catch (  IOException e) {
    if (LOG.isErrorEnabled()) {
      LOG.error(e.getLocalizedMessage(),e);
    }
  }
}
