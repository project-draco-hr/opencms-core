{
  Set<CmsResource> allResources=Sets.newHashSet();
  for (  CmsResource key : publishRelatedResources.keySet()) {
    allResources.add(key);
    for (    CmsResource value : publishRelatedResources.get(key)) {
      allResources.add(value);
    }
  }
  Set<CmsResource> parentFoldersToAdd=Sets.newHashSet();
  for (  CmsResource resource : allResources) {
    if (resource.isFile()) {
      CmsResource parentFolder=getParentFolder(resource);
      if ((parentFolder != null) && !parentFolder.getState().isUnchanged() && !allResources.contains(parentFolder)) {
        parentFoldersToAdd.add(parentFolder);
      }
    }
  }
  for (  CmsResource parentFolder : parentFoldersToAdd) {
    publishRelatedResources.put(parentFolder,new HashSet<CmsResource>());
  }
}
