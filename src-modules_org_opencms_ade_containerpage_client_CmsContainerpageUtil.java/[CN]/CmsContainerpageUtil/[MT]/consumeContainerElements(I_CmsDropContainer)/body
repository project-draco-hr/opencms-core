{
  List<CmsContainerPageElement> elements=new ArrayList<CmsContainerPageElement>();
  Element child=(Element)container.getElement().getFirstChildElement();
  while (child != null) {
    boolean isContainerElement=CmsDomUtil.hasClass(CLASS_CONTAINER_ELEMENTS,child);
    boolean isSubcontainerElement=CmsDomUtil.hasClass(CLASS_SUB_CONTAINER_ELEMENTS,child);
    if (isContainerElement || isSubcontainerElement) {
      String clientId=child.getAttribute("title");
      String sitePath=child.getAttribute("alt");
      String noEditReason=child.getAttribute("rel");
      String newType=child.getAttribute("newType");
      boolean hasProps=Boolean.parseBoolean(child.getAttribute("hasprops"));
      if (isContainerElement) {
        Element elementRoot=(Element)child.getFirstChildElement();
        DOM.removeChild(child,elementRoot);
        CmsContainerPageElement containerElement=createElement(elementRoot,container,clientId,sitePath,noEditReason,hasProps);
        if ((newType != null) && (newType.length() > 0)) {
          containerElement.setNewType(newType);
        }
        elements.add(containerElement);
        DOM.removeChild((Element)container.getElement(),child);
      }
 else       if (isSubcontainerElement && (container instanceof CmsContainerPageContainer)) {
        CmsSubContainerElement subContainer=createSubcontainer(child,container,clientId,sitePath,noEditReason,hasProps);
        subContainer.setContainerId(container.getContainerId());
        elements.add(subContainer);
        DOM.removeChild((Element)container.getElement(),child);
        consumeContainerElements(subContainer);
        addOptionBar(subContainer);
      }
    }
 else {
      DOM.removeChild((Element)container.getElement(),child);
    }
    child=(Element)container.getElement().getFirstChildElement();
  }
  Iterator<CmsContainerPageElement> it=elements.iterator();
  while (it.hasNext()) {
    container.add(it.next());
  }
}
