{
  List<CmsDragContainerElement> elements=new ArrayList<CmsDragContainerElement>();
  Element child=(Element)container.getElement().getFirstChildElement();
  while (child != null) {
    boolean isContainerElement=CmsDomUtil.hasClass(CLASS_CONTAINER_ELEMENTS,child);
    boolean isSubcontainerElement=CmsDomUtil.hasClass(CLASS_SUB_CONTAINER_ELEMENTS,child);
    if (isContainerElement || isSubcontainerElement) {
      String clientId=child.getAttribute("title");
      String sitePath=child.getAttribute("alt");
      String noEditReason=child.getAttribute("rel");
      boolean hasProps=Boolean.parseBoolean(child.getAttribute("hasprops"));
      if (isContainerElement) {
        Element elementRoot=(Element)child.getFirstChildElement();
        DOM.removeChild(child,elementRoot);
        elements.add(createElement(elementRoot,container,clientId,sitePath,noEditReason,hasProps));
        DOM.removeChild(container.getElement(),child);
      }
 else       if (isSubcontainerElement) {
        CmsDragSubcontainer subContainer=createSubcontainer(child,container,clientId,sitePath,noEditReason,hasProps);
        subContainer.setContainerId(container.getContainerId());
        elements.add(subContainer);
        DOM.removeChild(container.getElement(),child);
        consumeContainerElements(subContainer);
        addOptionBar(subContainer);
      }
    }
 else {
      DOM.removeChild(container.getElement(),child);
    }
    child=(Element)container.getElement().getFirstChildElement();
  }
  Iterator<CmsDragContainerElement> it=elements.iterator();
  while (it.hasNext()) {
    container.add(it.next());
  }
}
