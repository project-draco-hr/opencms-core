{
  JSONObject keys=new JSONObject();
  String dialogMode=getDialogMode(request);
  if (GalleryMode.view.name().equals(dialogMode) || GalleryMode.widget.name().equals(dialogMode) || GalleryMode.editor.name().equals(dialogMode)) {
    try {
      keys.put(ReqParam.dialogmode.name(),getDialogMode(request));
      keys.put(ReqParam.gallerypath.name(),getGalleryPath(request));
      keys.put(ReqParam.gallerytabid.name(),GalleryConfiguration.TAB_ID_DEFAULT.getName());
      keys.put(ReqParam.tabs.name(),GalleryConfiguration.TABS_DEFAULT.getName());
      keys.put(ReqParam.types.name(),getTypes(request));
    }
 catch (    Throwable e) {
      LOG.error(e.getLocalizedMessage(),e);
      try {
        keys.put("error",e.getLocalizedMessage());
      }
 catch (      JSONException e1) {
        LOG.error(e1.getLocalizedMessage(),e1);
      }
    }
  }
 else   if (GalleryMode.ade.name().equals(dialogMode)) {
    try {
      keys.put(ReqParam.dialogmode.name(),getDialogMode(request));
      keys.put(ReqParam.gallerypath.name(),"");
      keys.put(ReqParam.gallerytabid.name(),GalleryConfiguration.TABS_ADE.getName());
      keys.put(ReqParam.tabs.name(),GalleryConfiguration.TABS_ADE.getName());
      keys.put(ReqParam.types.name(),"");
    }
 catch (    Throwable e) {
      LOG.error(e.getLocalizedMessage(),e);
      try {
        keys.put("error",e.getLocalizedMessage());
      }
 catch (      JSONException e1) {
        LOG.error(e1.getLocalizedMessage(),e1);
      }
    }
  }
  return keys;
}
