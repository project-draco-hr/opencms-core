{
  if (getQueue(config).waitForSlot()) {
    try {
      return new CmsFormSession(CmsFormModuleAction.getAdminCms(),cms,config);
    }
 catch (    CmsException e) {
      LOG.error(e.getLocalizedMessage(),e);
      throw new CmsFormException(e);
    }
  }
 else {
    String message=Messages.get().container(Messages.ERR_WAIT_QUEUE_EXCEEDED_0).key(cms.getRequestContext().getLocale());
    throw new CmsFormException(CmsFormConstants.ErrorCode.errMaxQueueLengthExceeded,message);
  }
}
