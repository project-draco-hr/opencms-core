{
  if ((x == -1) && (y == -1)) {
    CmsDebugLog.getInstance().printLine("this is wrong usage, doing nothing");
    return currentIndex;
  }
  for (int index=0; index < parent.getChildCount(); index++) {
    Node node=parent.getChild(index);
    if (!(node instanceof Element)) {
      continue;
    }
    Element child=(Element)node;
    String positioning=child.getStyle().getPosition();
    if (positioning.equals(Position.ABSOLUTE.getCssName()) || positioning.equals(Position.FIXED.getCssName())) {
      continue;
    }
    int left=0;
    int width=0;
    int top=0;
    int height=0;
    if (x != -1) {
      left=CmsDomUtil.getRelativeX(x,child);
      width=child.getOffsetWidth();
      if ((left <= 0) || (left >= width)) {
        continue;
      }
    }
    if (y != -1) {
      top=CmsDomUtil.getRelativeY(y,child);
      height=child.getOffsetHeight();
      if ((top <= 0) || (top >= height)) {
        continue;
      }
    }
 else {
      if (child == element) {
        return currentIndex;
      }
      if (left < width / 2) {
        parent.insertBefore(element,child);
        currentIndex=index;
        return currentIndex;
      }
 else {
        parent.insertAfter(element,child);
        currentIndex=index + 1;
        return currentIndex;
      }
    }
    if (child == element) {
      return currentIndex;
    }
    if (top < height / 2) {
      parent.insertBefore(element,child);
      currentIndex=index;
      return currentIndex;
    }
 else {
      parent.insertAfter(element,child);
      currentIndex=index + 1;
      return currentIndex;
    }
  }
  if ((currentIndex >= 0) && (element.getParentElement() == parent)) {
    return currentIndex;
  }
  int top=CmsDomUtil.getRelativeY(y,parent);
  int offsetHeight=parent.getOffsetHeight();
  if ((top >= offsetHeight / 2)) {
    parent.insertFirst(element);
    currentIndex=0;
    return currentIndex;
  }
  parent.appendChild(element);
  currentIndex=parent.getChildCount() - 1;
  return currentIndex;
}
