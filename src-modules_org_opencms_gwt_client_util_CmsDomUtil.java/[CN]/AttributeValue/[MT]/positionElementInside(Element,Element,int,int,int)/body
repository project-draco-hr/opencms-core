{
  for (int index=0; index < parent.getChildCount(); index++) {
    Node node=parent.getChild(index);
    if (!(node instanceof Element)) {
      continue;
    }
    Element child=(Element)node;
    String positioning=child.getStyle().getPosition();
    if (positioning.equals(Position.ABSOLUTE.getCssName()) || positioning.equals(Position.FIXED.getCssName())) {
      continue;
    }
    int left=CmsDomUtil.getRelativeX(x,child);
    if ((left <= 0) || (left >= child.getOffsetWidth())) {
      continue;
    }
    int top=CmsDomUtil.getRelativeY(y,child);
    int height=child.getOffsetHeight();
    if ((top <= 0) || (top >= height)) {
      continue;
    }
    if (child == element) {
      return currentIndex;
    }
    if (top < height / 2) {
      parent.insertBefore(element,child);
      currentIndex=index;
      return currentIndex;
    }
 else {
      parent.insertAfter(element,child);
      currentIndex=index + 1;
      return currentIndex;
    }
  }
  if ((currentIndex >= 0) && (element.getParentElement() == parent)) {
    return currentIndex;
  }
  int top=CmsDomUtil.getRelativeY(y,parent);
  int offsetHeight=parent.getOffsetHeight();
  if ((top >= offsetHeight / 2)) {
    parent.insertFirst(element);
    currentIndex=0;
    return currentIndex;
  }
  parent.appendChild(element);
  currentIndex=parent.getChildCount() - 1;
  return currentIndex;
}
