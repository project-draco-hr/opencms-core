{
  String collectorName=getCollector();
  if (CmsStringUtil.isEmpty(collectorName)) {
    throw new IllegalArgumentException("'contentload' tag requires 'collector' attribute");
  }
  m_controller=(CmsFlexController)pageContext.getRequest().getAttribute(CmsFlexController.ATTRIBUTE_NAME);
  m_cms=m_controller.getCmsObject();
  m_locale=m_cms.getRequestContext().getLocale();
  String param=getProperty();
  String createParam;
  if (CmsStringUtil.isNotEmpty(param)) {
    CmsProperty property;
    try {
      property=m_cms.readPropertyObject(m_cms.getRequestContext().getUri(),param,true);
    }
 catch (    CmsException e) {
      OpenCms.getLog(this).error("Error reading property '" + param + "' on resource "+ m_cms.getRequestContext().getUri(),e);
      property=CmsProperty.getNullProperty();
    }
    param=property.getValue("");
    if (CmsStringUtil.isNotEmpty(getParam())) {
      param=param.concat(getParam());
    }
    createParam=param;
  }
 else {
    param=resolveMagicName(getParam());
    createParam=getParam();
  }
  I_CmsResourceCollector collector=OpenCms.getResourceManager().getContentCollector(collectorName);
  try {
    m_collectorResult=collector.getResults(m_cms,collectorName,param);
    if (collector.getCreateLink(m_cms,collectorName,param) != null) {
      m_directEditCreateLink=CmsEncoder.encode(collectorName + "|" + createParam);
    }
    doLoadNextFile();
  }
 catch (  CmsException e) {
    m_controller.setThrowable(e,m_cms.getRequestContext().getUri());
    throw new JspException(e);
  }
  if (m_editable) {
    String directEditOptions;
    if (m_directEditCreateLink != null) {
      directEditOptions=CmsJspTagEditable.createEditOptions(true,true,true);
      m_directEditFollowOptions=CmsJspTagEditable.createEditOptions(true,true,false);
    }
 else {
      directEditOptions=CmsJspTagEditable.createEditOptions(true,false,false);
      m_directEditFollowOptions=directEditOptions;
    }
    m_directEditPermissions=CmsJspTagEditable.includeDirectEditElement(pageContext,I_CmsEditorActionHandler.C_DIRECT_EDIT_AREA_START,m_resourceName,null,directEditOptions,null,m_directEditCreateLink);
  }
  return EVAL_BODY_INCLUDE;
}
