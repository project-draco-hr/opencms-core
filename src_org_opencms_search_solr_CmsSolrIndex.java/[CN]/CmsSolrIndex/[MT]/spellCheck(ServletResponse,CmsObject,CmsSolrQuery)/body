{
  SolrCore core=null;
  LocalSolrQueryRequest solrQueryRequest=null;
  try {
    q.setRequestHandler("/spell");
    QueryResponse queryResponse=m_solr.query(q);
    core=m_solr instanceof EmbeddedSolrServer ? ((EmbeddedSolrServer)m_solr).getCoreContainer().getCore(getName()) : null;
    SolrQueryResponse solrQueryResponse=new SolrQueryResponse();
    solrQueryResponse.setAllValues(queryResponse.getResponse());
    solrQueryResponse.setEndTime(queryResponse.getQTime());
    solrQueryRequest=new LocalSolrQueryRequest(core,solrQueryResponse.getResponseHeader());
    solrQueryRequest.setParams(q);
    writeResp(res,solrQueryRequest,solrQueryResponse);
  }
 catch (  Exception e) {
    throw new CmsSearchException(Messages.get().container(Messages.LOG_SOLR_ERR_SEARCH_EXECUTION_FAILD_1,q),e);
  }
 finally {
    if (solrQueryRequest != null) {
      solrQueryRequest.close();
    }
    if (core != null) {
      core.close();
    }
  }
}
