{
  m_dialogContext=context;
  CmsVaadinUtils.readAndLocalizeDesign(this,CmsVaadinUtils.getWpMessagesForCurrentLocale(),null);
  final CmsResource resource=context.getResources().get(0);
  final CmsObject cms=context.getCms();
  List<I_CmsHistoryResource> deletedResources=cms.readDeletedResources(cms.getSitePath(resource),m_includeSubfoldersField.getValue().booleanValue());
  initDeletedResources(cms,deletedResources);
  m_cancelButton.addClickListener(new ClickListener(){
    private static final long serialVersionUID=1L;
    @SuppressWarnings("synthetic-access") public void buttonClick(    ClickEvent event){
      m_dialogContext.finish(new ArrayList<CmsUUID>());
    }
  }
);
  m_includeSubfoldersField.addValueChangeListener(new ValueChangeListener(){
    private static final long serialVersionUID=1L;
    @SuppressWarnings("synthetic-access") public void valueChange(    ValueChangeEvent event){
      Boolean value=(Boolean)(event.getProperty().getValue());
      List<I_CmsHistoryResource> historyResources;
      try {
        historyResources=cms.readDeletedResources(cms.getSitePath(resource),value.booleanValue());
        initDeletedResources(cms,historyResources);
      }
 catch (      CmsException e) {
        m_dialogContext.error(e);
      }
    }
  }
);
  m_selectAllField.addValueChangeListener(new ValueChangeListener(){
    private static final long serialVersionUID=1L;
    @SuppressWarnings("synthetic-access") public void valueChange(    ValueChangeEvent event){
      Boolean selectAll=(Boolean)(event.getProperty().getValue());
      for (      Object id : m_selectionContainer.getItemIds()) {
        m_selectionContainer.getItem(id).getItemProperty(PROP_SELECTED).setValue(selectAll);
      }
    }
  }
);
  m_okButton.addClickListener(new ClickListener(){
    private static final long serialVersionUID=1L;
    @SuppressWarnings("synthetic-access") public void buttonClick(    ClickEvent event){
      List<CmsUUID> selectedIds=getSelectedIds();
      List<CmsUUID> updated=Lists.newArrayList();
      try {
        for (        CmsUUID selectedId : selectedIds) {
          cms.restoreDeletedResource(selectedId);
          updated.add(selectedId);
        }
        m_dialogContext.finish(updated);
      }
 catch (      CmsException e) {
        m_dialogContext.error(e);
      }
    }
  }
);
}
