{
  AttributeConfiguration result=null;
  String widgetName=null;
  String widgetConfig=null;
  CmsObject cms=getCmsObject();
  try {
    I_CmsWidget widget=schemaType.getContentDefinition().getContentHandler().getWidget(schemaType);
    if (widget != null) {
      widgetName=widget.getClass().getName();
      long timer=0;
      if (widget instanceof I_CmsADEWidget) {
        if (!checkWidgetsOnly) {
          if (CmsContentService.LOG.isDebugEnabled()) {
            timer=System.currentTimeMillis();
          }
          I_CmsADEWidget adeWidget=(I_CmsADEWidget)widget;
          widgetName=adeWidget.getWidgetName();
          widgetConfig=adeWidget.getConfiguration(cms,schemaType,m_messages,m_file,m_locale);
          if (!adeWidget.isInternal() && !m_widgetConfigurations.containsKey(widgetName)) {
            CmsExternalWidgetConfiguration externalConfiguration=new CmsExternalWidgetConfiguration(widgetName,adeWidget.getInitCall(),adeWidget.getJavaScriptResourceLinks(cms),adeWidget.getCssResourceLinks(cms));
            m_widgetConfigurations.put(widgetName,externalConfiguration);
          }
          if (CmsContentService.LOG.isDebugEnabled()) {
            CmsContentService.LOG.debug(Messages.get().getBundle().key(Messages.LOG_TAKE_READING_WIDGET_CONFIGURATION_TIME_2,widgetName,"" + (System.currentTimeMillis() - timer)));
          }
        }
      }
      m_widgets.add(widget);
    }
  }
 catch (  Exception e) {
    CmsContentService.LOG.debug(e.getMessage(),e);
  }
  result=new AttributeConfiguration(getLabel(schemaType),getHelp(schemaType),widgetName,widgetConfig,readDefaultValue(schemaType,path));
  return result;
}
