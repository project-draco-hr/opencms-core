{
  int scrollLeft=m_isFixed ? 0 : Window.getScrollLeft();
  int scrollTop=m_isFixed ? 0 : Window.getScrollTop();
  int leftSpace=item.getAbsoluteLeft() - (scrollLeft + 10);
  int rightSpace=Window.getClientWidth() - (item.getAbsoluteLeft() + item.getOffsetWidth() + 10);
  boolean showRight=item.getSubMenu().getOffsetWidth() < rightSpace;
  if (!showRight) {
    showRight=leftSpace < rightSpace;
  }
  int topSpace=(item.getAbsoluteTop() - scrollTop) + 10;
  int bottomSpace=(Window.getClientHeight() + scrollTop) - (item.getAbsoluteTop() + 10);
  boolean showBottom=item.getSubMenu().getOffsetHeight() < bottomSpace;
  if (!showBottom) {
    showBottom=topSpace < bottomSpace;
  }
  int left;
  int top;
  if (showRight && showBottom) {
    left=(item.getAbsoluteLeft() + item.getOffsetWidth()) - 4;
    top=item.getAbsoluteTop() - 4;
  }
 else   if (!showRight && showBottom) {
    left=item.getAbsoluteLeft() - item.getSubMenu().getOffsetWidth() - 4;
    top=item.getAbsoluteTop() - 4;
  }
 else   if (showRight && !showBottom) {
    left=(item.getAbsoluteLeft() + item.getOffsetWidth()) - 4;
    top=((item.getAbsoluteTop() - item.getSubMenu().getOffsetHeight()) + item.getOffsetHeight()) - 4;
  }
 else {
    left=item.getAbsoluteLeft() - item.getSubMenu().getOffsetWidth() - 4;
    top=((item.getAbsoluteTop() - item.getSubMenu().getOffsetHeight()) + item.getOffsetHeight()) - 4;
  }
  m_popup.setPopupPosition(left,top);
}
