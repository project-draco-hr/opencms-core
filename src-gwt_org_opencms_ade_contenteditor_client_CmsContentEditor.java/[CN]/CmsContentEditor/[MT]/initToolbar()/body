{
  m_toolbar=new CmsToolbar();
  m_saveExitButton=createButton(Messages.get().key(Messages.GUI_TOOLBAR_SAVE_AND_EXIT_0),I_CmsToolbarButtonLayoutBundle.INSTANCE.toolbarButtonCss().toolbarSaveExit());
  m_saveExitButton.addClickHandler(new ClickHandler(){
    public void onClick(    ClickEvent event){
      deferSaveAndExit();
    }
  }
);
  m_publishButton=createButton("publish",I_CmsToolbarButtonLayoutBundle.INSTANCE.toolbarButtonCss().toolbarPublish());
  m_toolbar.addLeft(m_publishButton);
  m_publishButton.addClickHandler(new ClickHandler(){
    public void onClick(    ClickEvent event){
      boolean unlock=shouldUnlockAutomatically();
      saveAndDeleteEntities(unlock,new Command(){
        public void execute(){
          setSaved();
          HashMap<String,String> params=new HashMap<String,String>(getContext().getPublishParameters());
          CmsUUID structureId=CmsContentDefinition.entityIdToUuid(getEntityId());
          params.put(CmsPublishOptions.PARAM_CONTENT,"" + structureId);
          params.put(CmsPublishOptions.PARAM_START_WITH_CURRENT_PAGE,"");
          CmsPublishDialog.showPublishDialog(params,new CloseHandler<PopupPanel>(){
            public void onClose(            CloseEvent<PopupPanel> closeEvent){
              if (m_onClose != null) {
                m_onClose.execute();
              }
              clearEditor();
            }
          }
);
        }
      }
);
    }
  }
);
  m_toolbar.addLeft(m_saveExitButton);
  m_saveButton=createButton(Messages.get().key(Messages.GUI_TOOLBAR_SAVE_0),I_CmsButton.ButtonData.SAVE.getIconClass());
  m_saveButton.addClickHandler(new ClickHandler(){
    public void onClick(    ClickEvent event){
      deferSave();
    }
  }
);
  m_saveButton.setVisible(false);
  m_toolbar.addLeft(m_saveButton);
  disableSave(Messages.get().key(Messages.GUI_TOOLBAR_NOTHING_CHANGED_0));
  m_openFormButton=createButton(Messages.get().key(Messages.GUI_TOOLBAR_OPEN_FORM_0),I_CmsButton.ButtonData.EDIT.getIconClass());
  m_openFormButton.addClickHandler(new ClickHandler(){
    public void onClick(    ClickEvent event){
      initFormPanel();
      renderFormContent();
    }
  }
);
  m_toolbar.addLeft(m_openFormButton);
  m_hideHelpBubblesButton=new CmsToggleButton();
  m_hideHelpBubblesButton.setImageClass(I_CmsButton.ButtonData.TOGGLE_HELP.getIconClass());
  m_hideHelpBubblesButton.setButtonStyle(ButtonStyle.IMAGE,null);
  m_hideHelpBubblesButton.setSize(Size.big);
  m_hideHelpBubblesButton.addClickHandler(new ClickHandler(){
    public void onClick(    ClickEvent event){
      CmsToggleButton button=(CmsToggleButton)event.getSource();
      hideHelpBubbles(!button.isDown());
    }
  }
);
  m_hideHelpBubblesButton.setDown(CmsCoreProvider.get().isShowEditorHelp());
  ValueFocusHandler.getInstance().hideHelpBubbles(RootPanel.get(),!CmsCoreProvider.get().isShowEditorHelp());
  if (!CmsCoreProvider.get().isShowEditorHelp()) {
    m_hideHelpBubblesButton.setTitle(Messages.get().key(Messages.GUI_TOOLBAR_HELP_BUBBLES_HIDDEN_0));
  }
 else {
    m_hideHelpBubblesButton.setTitle(Messages.get().key(Messages.GUI_TOOLBAR_HELP_BUBBLES_SHOWN_0));
  }
  m_toolbar.addRight(m_hideHelpBubblesButton);
  m_cancelButton=createButton(Messages.get().key(Messages.GUI_TOOLBAR_RESET_0),I_CmsButton.ButtonData.RESET.getIconClass());
  m_cancelButton.addClickHandler(new ClickHandler(){
    public void onClick(    ClickEvent event){
      confirmCancel();
    }
  }
);
  m_toolbar.addRight(m_cancelButton);
  RootPanel.get().add(m_toolbar);
}
