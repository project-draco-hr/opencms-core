{
  if (containerType.equals(CmsDefaultXmlContentHandler.DEFAULT_FORMATTER_TYPE)) {
    return CmsDefaultXmlContentHandler.DEFAULT_FORMATTER;
  }
  try {
    CmsProperty formatterProp=cms.readPropertyObject(resource,PROPERTY_FORMATTER,true);
    String formatter=formatterProp.getValue();
    if (!CmsStringUtil.isEmptyOrWhitespaceOnly(formatter)) {
      CmsMacroResolver resolver=CmsMacroResolver.newInstance();
      resolver.addMacro(MACRO_CONTAINERTYPE,containerType);
      formatter=resolver.resolveMacros(formatter);
      CmsProperty typesProp=cms.readPropertyObject(resource,PROPERTY_CONTAINERTYPES,true);
      List<String> types=typesProp.getValueList();
      if (types.isEmpty() || types.contains(containerType)) {
        return formatter;
      }
    }
  }
 catch (  CmsException e) {
    if (LOG.isErrorEnabled()) {
      LOG.error(Messages.get().getBundle().key(Messages.ERR_READING_FORMATTER_CONFIGURATION_1,cms.getSitePath(resource)),e);
    }
  }
  return null;
}
