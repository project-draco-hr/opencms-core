{
  m_mulipartFileItems=CmsRequestUtil.readMultipartFileItems(req);
  if (m_mulipartFileItems != null) {
    m_parameterMap=CmsRequestUtil.readParameterMapFromMultiPart(getRequestContext().getEncoding(),m_mulipartFileItems);
  }
 else {
    m_parameterMap=new HashMap();
  }
  if (m_mulipartFileItems != null) {
    Map fileUploads=(Map)req.getSession().getAttribute(ATTRIBUTE_FILEITEMS);
    if (fileUploads == null) {
      fileUploads=new HashMap();
    }
    Iterator i=m_mulipartFileItems.iterator();
    while (i.hasNext()) {
      FileItem fileItem=(FileItem)i.next();
      if (CmsStringUtil.isNotEmpty(fileItem.getName())) {
        fileUploads.put(fileItem.getFieldName(),fileItem);
        m_parameterMap.put(fileItem.getFieldName(),new String[]{fileItem.getName()});
      }
    }
    req.getSession().setAttribute(ATTRIBUTE_FILEITEMS,fileUploads);
  }
 else {
    req.getSession().removeAttribute(ATTRIBUTE_FILEITEMS);
  }
  String formAction=getParameter(PARAM_FORMACTION);
  setErrors(new HashMap());
  m_isValidatedCorrect=null;
  setInitial(CmsStringUtil.isEmpty(formAction));
  setMessages(new CmsMessages("/org/opencms/frontend/templateone/form/workplace",getRequestContext().getLocale()));
  setFormConfiguration(new CmsForm(this,getMessages(),isInitial(),formConfigUri,formAction));
}
