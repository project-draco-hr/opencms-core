{
  if (m_popup == null) {
    m_popup=CmsGalleryFactory.createGalleryPopup(new I_CmsGalleryWidgetHandler(){
      public void setWidgetValue(      String resourcePath,      CmsUUID structureId,      CmsCroppingParamBean croppingParameter){
        String path=resourcePath;
        if ((croppingParameter != null) && (croppingParameter.isCropped() || croppingParameter.isScaled())) {
          path+="?" + croppingParameter.toString();
        }
        setValue(path,true);
        m_popup.hide();
      }
    }
,m_referencePath,m_galleryPath,getFormValueAsString(),m_types,m_galleryTypes,m_useFormats,m_imageFormats,m_imageFormatNames);
    m_popup.center();
  }
 else {
    m_popup.searchElement(getFormValueAsString());
  }
}
