{
  Message msg=null;
  try {
    msg=buildMessage(c_MAILSERVER);
  }
 catch (  Exception e) {
    A_OpenCms.log(C_OPENCMS_CRITICAL,getClassName() + "Error while building Email object: " + e.getMessage());
    return;
  }
  try {
    Transport.send(msg);
  }
 catch (  Exception e) {
    for (; e instanceof MessagingException; e=((MessagingException)e).getNextException())     ;
    A_OpenCms.log(C_OPENCMS_CRITICAL,getClassName() + "Error while transmitting mail to SMTP server: " + e);
    if (c_ALTERNATIVE_MAILSERVER != null && !"".equals(c_ALTERNATIVE_MAILSERVER)) {
      A_OpenCms.log(C_OPENCMS_CRITICAL,getClassName() + "Trying alternative server...");
      try {
        msg=buildMessage(c_ALTERNATIVE_MAILSERVER);
        Transport.send(msg);
        A_OpenCms.log(C_OPENCMS_CRITICAL,getClassName() + "...OK. Mail sent.");
      }
 catch (      Exception e2) {
        for (; e2 instanceof MessagingException; e2=((MessagingException)e2).getNextException())         ;
        A_OpenCms.log(C_OPENCMS_CRITICAL,getClassName() + "PANIC! Could not send Email. Even alternative server failed! " + e2);
      }
    }
 else {
      A_OpenCms.log(C_OPENCMS_CRITICAL,getClassName() + "PANIC! No alternative SMTP server given! Could not send Email!");
    }
  }
}
