{
  CmsRequestContext reqCont=cms.getRequestContext();
  I_CmsSession session=cms.getRequestContext().getSession(true);
  String currentView=null;
  Hashtable startSettings=null;
  startSettings=(Hashtable)reqCont.currentUser().getAdditionalInfo(C_ADDITIONAL_INFO_STARTSETTINGS);
  if (startSettings != null) {
    currentView=(String)startSettings.get(C_START_VIEW);
  }
  if (session != null) {
    if (session.getValue(C_PARA_VIEW) != null) {
      currentView=(String)session.getValue(C_PARA_VIEW);
    }
  }
  if (currentView == null) {
    currentView="";
  }
  Vector viewNames=new Vector();
  Vector viewLinks=new Vector();
  int numViews=(cms.getRegistry()).getViews(viewNames,viewLinks);
  int currentViewIndex=0;
  for (int i=0; i < numViews; i++) {
    String loopName=(String)viewNames.elementAt(i);
    String loopLink=(String)viewLinks.elementAt(i);
    boolean visible=true;
    try {
      cms.readFileHeader(loopLink);
    }
 catch (    CmsException e) {
      visible=false;
    }
    if (visible) {
      if (loopLink.equals(currentView)) {
        currentViewIndex=values.size();
      }
      names.addElement(lang.getLanguageValue(loopName));
      values.addElement(loopLink);
    }
  }
  return new Integer(currentViewIndex);
}
