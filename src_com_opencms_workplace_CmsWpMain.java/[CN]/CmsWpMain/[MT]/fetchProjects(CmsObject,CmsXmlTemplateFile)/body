{
  CmsRequestContext reqCont=cms.getRequestContext();
  Vector allProjects=cms.getAllAccessibleProjects();
  int currentProjectId=reqCont.currentProject().getId();
  int numProjects=allProjects.size();
  int currentProjectNum=0;
  int currentLength=0;
  int maxPrjNameLen=0;
  m_ProjectIds=new Vector();
  m_ProjectNames=new Vector();
  for (int i=0; i < numProjects; i++) {
    CmsProject loopProject=(CmsProject)allProjects.elementAt(i);
    String loopProjectName=loopProject.getName();
    String loopProjectId=loopProject.getId() + "";
    m_ProjectIds.addElement(loopProjectId);
    m_ProjectNames.addElement(loopProjectName);
    if (loopProject.getId() == currentProjectId) {
      currentProjectNum=i;
    }
    currentLength=loopProjectName.length();
    if (currentLength > maxPrjNameLen) {
      maxPrjNameLen=currentLength;
    }
  }
  m_SelectedPrjIndex=currentProjectNum;
  try {
    if (maxPrjNameLen <= 20) {
      xmlTemplateDocument.setData("PRJ_SELECT",xmlTemplateDocument.getProcessedDataValue("PRJ_SELECT_NORMAL",this));
    }
 else {
      xmlTemplateDocument.setData("PRJ_SELECT",xmlTemplateDocument.getProcessedDataValue("PRJ_SELECT_LARGE",this));
    }
  }
 catch (  CmsException e) {
  }
}
