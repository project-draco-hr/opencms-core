{
  WaterFilter water=new WaterFilter();
  water.setAmplitude(m_settings.getFilterAmplitude());
  water.setAntialias(true);
  water.setPhase(0);
  water.setWavelength(m_settings.getFilterWaveLength());
  ImageDeformation backgroundDeformation=new ImageDeformationByFilters(new ImageFilter[]{});
  ImageDeformation textDeformation=new ImageDeformationByFilters(new ImageFilter[]{});
  ImageDeformation postDeformation=new ImageDeformationByFilters(new ImageFilter[]{water});
  WordGenerator randomWords=new RandomWordGenerator("1234567890");
  TextPaster paster=new BaffleRandomTextPaster(new Integer(m_settings.getMinPhraseLength()),new Integer(m_settings.getMaxPhraseLength()),m_settings.getFontColor(),m_settings.getHolesPerGlyph(),m_settings.getBackgroundColor());
  BackgroundGenerator background;
  if (m_settings.isUseBackgroundImage()) {
    background=new FileReaderRandomBackgroundGenerator(new Integer(m_settings.getImageWidth()),new Integer(m_settings.getImageHeight()),OpenCms.getSystemInfo().getAbsoluteRfsPathRelativeToWebInf("gimpybackgrounds" + File.separatorChar));
  }
 else {
    background=new UniColorBackgroundGenerator(new Integer(m_settings.getImageWidth()),new Integer(m_settings.getImageHeight()),m_settings.getBackgroundColor());
  }
  FontGenerator font=new RandomFontGenerator(new Integer(m_settings.getMinFontSize()),new Integer(m_settings.getMaxFontSize()));
  WordToImage wordToImage=new DeformedComposedWordToImage(font,background,paster,backgroundDeformation,textDeformation,postDeformation);
  m_factory=new GimpyFactory(randomWords,wordToImage);
}
