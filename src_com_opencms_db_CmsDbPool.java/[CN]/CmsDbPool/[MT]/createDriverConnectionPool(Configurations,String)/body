{
  String jdbcDriver=config.getString(C_KEY_DATABASE_POOL + "." + key+ "."+ C_KEY_JDBC_DRIVER);
  String jdbcUrl=config.getString(C_KEY_DATABASE_POOL + "." + key+ "."+ C_KEY_JDBC_URL);
  int maxActive=config.getInteger(C_KEY_DATABASE_POOL + "." + key+ "."+ C_KEY_MAX_ACTIVE);
  int maxWait=config.getInteger(C_KEY_DATABASE_POOL + "." + key+ "."+ C_KEY_MAX_WAIT);
  int maxIdle=config.getInteger(C_KEY_DATABASE_POOL + "." + key+ "."+ C_KEY_MAX_IDLE);
  String testQuery=config.getString(C_KEY_DATABASE_POOL + "." + key+ "."+ C_KEY_TEST_QUERY);
  String username=config.getString(C_KEY_DATABASE_POOL + "." + key+ "."+ C_KEY_USERNAME);
  String password=config.getString(C_KEY_DATABASE_POOL + "." + key+ "."+ C_KEY_PASSWORD);
  String poolUrl=config.getString(C_KEY_DATABASE_POOL + "." + key+ "."+ C_KEY_POOL_URL);
  Class.forName(jdbcDriver).newInstance();
  AbandonedConfig abandonedConfig=new AbandonedConfig();
  abandonedConfig.setLogAbandoned(true);
  abandonedConfig.setRemoveAbandoned(true);
  GenericObjectPool connectionPool=new AbandonedObjectPool(null,abandonedConfig);
  connectionPool.setMaxActive(maxActive);
  connectionPool.setMaxIdle(maxIdle);
  connectionPool.setMaxWait(maxWait);
  connectionPool.setWhenExhaustedAction(GenericObjectPool.WHEN_EXHAUSTED_GROW);
  connectionPool.setTestOnBorrow(true);
  ConnectionFactory connectionFactory=new DriverManagerConnectionFactory(jdbcUrl,username,password);
  new PoolableConnectionFactory(connectionFactory,connectionPool,null,testQuery,false,true);
  PoolingDriver driver=new PoolingDriver();
  driver.registerPool(poolUrl,connectionPool);
  return poolUrl;
}
