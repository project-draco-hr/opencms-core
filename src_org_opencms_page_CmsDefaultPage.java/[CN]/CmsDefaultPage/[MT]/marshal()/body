{
  try {
    ByteArrayOutputStream out=new ByteArrayOutputStream();
    OutputFormat format=OutputFormat.createPrettyPrint();
    XMLWriter writer=new XMLWriter(out,format);
    writer.write(m_document);
    writer.close();
    setContents(out.toByteArray());
  }
 catch (  Exception exc) {
    throw new CmsPageException("Marshalling xml page failed",exc);
  }
  return this;
}
