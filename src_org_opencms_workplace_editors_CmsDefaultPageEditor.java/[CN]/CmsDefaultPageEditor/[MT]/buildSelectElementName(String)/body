{
  List elementList=getElementList();
  int counter=0;
  int currentIndex=-1;
  List options=new ArrayList(elementList.size());
  List values=new ArrayList(elementList.size());
  String elementName=getParamElementname();
  if (CmsStringUtil.isEmpty(elementName)) {
    elementName=getParamOldelementname();
  }
  for (int i=0; i < elementList.size(); i++) {
    CmsDialogElement element=(CmsDialogElement)elementList.get(i);
    if (CmsStringUtil.isNotEmpty(elementName) && elementName.equals(element.getName())) {
      currentIndex=counter;
    }
    if ((!m_page.hasValue(element.getName(),getElementLocale()) && element.isMandantory()) || m_page.isEnabled(element.getName(),getElementLocale())) {
      options.add(element.getNiceName());
      values.add(element.getName());
      counter++;
    }
  }
  return buildSelect(attributes,options,values,currentIndex,false);
}
