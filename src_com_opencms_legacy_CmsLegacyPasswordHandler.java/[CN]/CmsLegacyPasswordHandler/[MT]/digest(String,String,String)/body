{
  MessageDigest md;
  byte[] result;
  try {
    if (I_CmsPasswordHandler.C_DIGEST_TYPE_PLAIN.equals(digestType.toLowerCase())) {
      result=password.getBytes(inputEncoding);
    }
 else {
      md=MessageDigest.getInstance(digestType);
      md.reset();
      md.update(password.getBytes(inputEncoding));
      result=md.digest();
    }
  }
 catch (  NoSuchAlgorithmException exc) {
    throw new CmsException("Digest algorithm " + digestType + " not supported.");
  }
catch (  UnsupportedEncodingException exc) {
    throw new CmsException("Password encoding " + inputEncoding + " not supported.");
  }
  StringBuffer buf=new StringBuffer();
  String addZerro;
  for (int i=0; i < result.length; i++) {
    addZerro=Integer.toHexString(128 + result[i]);
    if (addZerro.length() < 2) {
      addZerro='0' + addZerro;
    }
    buf.append(addZerro);
  }
  return buf.toString();
}
