{
  initialize();
  m_cms=cms;
  m_importPath=importPath;
  m_report=report;
  m_digest=digest;
  m_importResource=importResource;
  m_importZip=importZip;
  m_docXml=docXml;
  m_importingChannelData=false;
  m_linkStorage=new HashMap();
  m_linkPropertyStorage=new HashMap();
  if (writtenFilenames != null) {
    writtenFilenames.size();
  }
  if (fileCodes != null) {
    fileCodes.size();
  }
  try {
    if (cms.hasRole(CmsRole.USER_MANAGER)) {
      importGroups();
      importUsers();
    }
    readResourcesFromManifest(excludeList,propertyName,propertyValue);
    convertPointerToSiblings();
  }
 catch (  CmsException e) {
    throw e;
  }
 finally {
    cleanUp();
  }
}
