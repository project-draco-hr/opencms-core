{
  res.setHeader(I_CmsConstants.C_HEADER_SERVER,"OpenCms/" + OpenCms.getSystemInfo().getVersionNumber());
  int runlevel=OpenCmsCore.getInstance().getRunLevel();
  if (runlevel != OpenCms.RUNLEVEL_4_SERVLET_ACCESS) {
    if (runlevel == OpenCms.RUNLEVEL_3_SHELL_ACCESS) {
      init(getServletConfig());
    }
 else {
      res.sendError(HttpServletResponse.SC_SERVICE_UNAVAILABLE);
    }
  }
  String path=req.getPathInfo();
  if ((path != null) && path.startsWith(C_HANDLE)) {
    invokeHandler(req,res);
  }
 else {
    OpenCmsCore.getInstance().showResource(req,res);
  }
}
