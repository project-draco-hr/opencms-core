{
  CmsFile editFile=null;
  try {
    editFile=getCms().readFile(getParamResource());
    String decodedContent=CmsEncoder.unescape(getParamContent(),CmsEncoder.C_UTF8_ENCODING);
    String encoding=getCms().getRequestContext().getEncoding();
    encoding=getCms().readPropertyObject(getParamResource(),I_CmsConstants.C_PROPERTY_CONTENT_ENCODING,true).getValue(encoding);
    try {
      editFile.setContents(decodedContent.getBytes(encoding));
    }
 catch (    UnsupportedEncodingException e) {
      editFile.setContents(decodedContent.getBytes());
    }
    CmsFile writtenFile=getCms().writeFile(editFile);
    try {
      decodedContent=new String(writtenFile.getContents(),encoding);
    }
 catch (    UnsupportedEncodingException e) {
      decodedContent=new String(writtenFile.getContents());
    }
    setParamContent(encodeContent(decodedContent));
  }
 catch (  CmsException e) {
    setParamAction("");
    showErrorPage(this,e,"save",C_PATH_EDITORS + "dialogs/confirm.html");
    setAction(ACTION_CANCEL);
    return;
  }
  setAction(ACTION_SAVE);
}
