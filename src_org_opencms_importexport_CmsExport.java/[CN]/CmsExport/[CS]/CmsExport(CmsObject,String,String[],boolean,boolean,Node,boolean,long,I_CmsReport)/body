{
  m_exportFile=exportFile;
  m_cms=cms;
  m_excludeSystem=excludeSystem;
  m_excludeUnchanged=excludeUnchanged;
  m_exportUserdata=exportUserdata;
  m_isOnlineProject=cms.getRequestContext().currentProject().isOnlineProject();
  m_contentAge=contentAge;
  m_report=report;
  m_exportingModuleData=false;
  if (I_CmsConstants.C_EXPORT_VERSION.equals("3")) {
    openExportFile(moduleNode);
    exportAllResourcesVersion3(resourcesToExport);
    if (m_exportUserdata) {
      exportGroupsVersion3();
      exportUsersVersion3();
    }
    closeExportFile();
  }
 else {
    openExportFile(moduleNode);
    exportAllResources(resourcesToExport);
    if (m_exportUserdata) {
      exportGroups();
      exportUsers();
    }
    closeExportFile();
  }
}
