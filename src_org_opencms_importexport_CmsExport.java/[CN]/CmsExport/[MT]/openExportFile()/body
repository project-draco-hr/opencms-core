{
  if (!m_exportFileName.toLowerCase().endsWith(".zip")) {
    m_exportFileName+=".zip";
  }
  m_exportZipStream=new ZipOutputStream(new FileOutputStream(m_exportFileName));
  StringWriter out=new StringWriter(4096);
  CmsXmlSaxWriter saxWriter=new CmsXmlSaxWriter(out,OpenCms.getDefaultEncoding());
  m_saxWriter=new SAXWriter(saxWriter,saxWriter);
  Document doc=DocumentHelper.createDocument();
  saxWriter.startDocument();
  String exportNodeName;
  if (m_exportingModuleData) {
    exportNodeName=I_CmsConstants.C_EXPORT_TAG_MODULEXPORT;
  }
 else {
    exportNodeName=I_CmsConstants.C_EXPORT_TAG_EXPORT;
  }
  Element exportNode=doc.addElement(exportNodeName);
  m_saxWriter.writeOpen(exportNode);
  Element info=exportNode.addElement(I_CmsConstants.C_EXPORT_TAG_INFO);
  info.addElement(I_CmsConstants.C_EXPORT_TAG_CREATOR).addText(m_cms.getRequestContext().currentUser().getName());
  info.addElement(I_CmsConstants.C_EXPORT_TAG_OC_VERSION).addText(OpenCms.getVersionName());
  info.addElement(I_CmsConstants.C_EXPORT_TAG_DATE).addText(Utils.getNiceDate(System.currentTimeMillis()));
  info.addElement(I_CmsConstants.C_EXPORT_TAG_PROJECT).addText(m_cms.getRequestContext().currentProject().getName());
  info.addElement(I_CmsConstants.C_EXPORT_TAG_VERSION).addText(I_CmsConstants.C_EXPORT_VERSION);
  m_saxWriter.write(info);
  exportNode.remove(info);
  return exportNode;
}
