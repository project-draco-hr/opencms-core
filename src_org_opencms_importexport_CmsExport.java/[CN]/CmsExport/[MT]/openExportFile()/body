{
  setExportZipStream(new ZipOutputStream(new FileOutputStream(getExportFileName())));
  CmsXmlSaxWriter saxHandler=new CmsXmlSaxWriter(new StringWriter(4096),OpenCms.getSystemInfo().getDefaultEncoding());
  saxHandler.setEscapeXml(true);
  saxHandler.setEscapeUnknownChars(true);
  setSaxWriter(new SAXWriter(saxHandler,saxHandler));
  Document doc=DocumentHelper.createDocument();
  saxHandler.startDocument();
  if (m_parameters.isXmlValidation()) {
    saxHandler.startDTD(getExportNodeName(),null,CmsConfigurationManager.DEFAULT_DTD_PREFIX + CmsImportVersion7.DTD_FILENAME);
    saxHandler.endDTD();
  }
  String exportNodeName=getExportNodeName();
  Element exportNode=doc.addElement(exportNodeName);
  getSaxWriter().writeOpen(exportNode);
  Element info=exportNode.addElement(CmsImportExportManager.N_INFO);
  info.addElement(CmsImportExportManager.N_CREATOR).addText(getCms().getRequestContext().currentUser().getName());
  info.addElement(CmsImportExportManager.N_OC_VERSION).addText(OpenCms.getSystemInfo().getVersionNumber());
  info.addElement(CmsImportExportManager.N_DATE).addText(CmsDateUtil.getHeaderDate(System.currentTimeMillis()));
  info.addElement(CmsImportExportManager.N_INFO_PROJECT).addText(getCms().getRequestContext().currentProject().getName());
  info.addElement(CmsImportExportManager.N_VERSION).addText(CmsImportExportManager.EXPORT_VERSION);
  digestElement(exportNode,info);
  return exportNode;
}
