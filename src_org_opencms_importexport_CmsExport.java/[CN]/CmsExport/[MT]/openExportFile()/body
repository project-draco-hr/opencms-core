{
  setExportZipStream(new ZipOutputStream(new FileOutputStream(getExportFileName())));
  CmsXmlSaxWriter saxHandler=new CmsXmlSaxWriter(new StringWriter(4096),OpenCms.getDefaultEncoding());
  setSaxWriter(new SAXWriter(saxHandler,saxHandler));
  Document doc=DocumentHelper.createDocument();
  saxHandler.startDocument();
  String exportNodeName;
  if (isExportingCosData()) {
    exportNodeName=I_CmsConstants.C_EXPORT_TAG_MODULEXPORT;
  }
 else {
    exportNodeName=I_CmsConstants.C_EXPORT_TAG_EXPORT;
  }
  Element exportNode=doc.addElement(exportNodeName);
  getSaxWriter().writeOpen(exportNode);
  Element info=exportNode.addElement(I_CmsConstants.C_EXPORT_TAG_INFO);
  info.addElement(I_CmsConstants.C_EXPORT_TAG_CREATOR).addText(getCms().getRequestContext().currentUser().getName());
  info.addElement(I_CmsConstants.C_EXPORT_TAG_OC_VERSION).addText(OpenCms.getVersionName());
  info.addElement(I_CmsConstants.C_EXPORT_TAG_DATE).addText(Utils.getNiceDate(System.currentTimeMillis()));
  info.addElement(I_CmsConstants.C_EXPORT_TAG_PROJECT).addText(getCms().getRequestContext().currentProject().getName());
  info.addElement(I_CmsConstants.C_EXPORT_TAG_VERSION).addText(I_CmsConstants.C_EXPORT_VERSION);
  digestElement(exportNode,info);
  return exportNode;
}
