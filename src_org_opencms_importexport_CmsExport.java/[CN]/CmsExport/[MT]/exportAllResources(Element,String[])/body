{
  String resourceNodeName=getResourceNodeName();
  m_resourceNode=parent.addElement(resourceNodeName);
  getSaxWriter().writeOpen(m_resourceNode);
  List folderNames=new ArrayList();
  List fileNames=new ArrayList();
  for (int i=0; i < resourcesToExport.length; i++) {
    if (CmsResource.isFolder(resourcesToExport[i])) {
      folderNames.add(resourcesToExport[i]);
    }
 else {
      fileNames.add(resourcesToExport[i]);
    }
  }
  checkRedundancies(folderNames,fileNames);
  m_exportedResources=new HashSet();
  m_exportedPageFiles=new HashSet();
  for (int i=0; i < folderNames.size(); i++) {
    String path=(String)folderNames.get(i);
    addParentFolders(path);
    addChildResources(path);
    m_exportedResources.add(path);
  }
  addFiles(fileNames);
  addPageBodyFiles();
  getSaxWriter().writeClose(m_resourceNode);
  parent.remove(m_resourceNode);
  m_resourceNode=null;
}
