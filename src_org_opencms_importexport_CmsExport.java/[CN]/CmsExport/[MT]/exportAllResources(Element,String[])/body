{
  String fileNodeName;
  if (m_exportingModuleData) {
    fileNodeName=C_EXPORT_TAG_CHANNELS;
  }
 else {
    fileNodeName=C_EXPORT_TAG_FILES;
  }
  m_fileNode=parent.addElement(fileNodeName);
  m_saxWriter.writeOpen(m_fileNode);
  Vector folderNames=new Vector();
  Vector fileNames=new Vector();
  for (int i=0; i < resourcesToExport.length; i++) {
    if (resourcesToExport[i].endsWith(I_CmsConstants.C_FOLDER_SEPARATOR)) {
      folderNames.addElement(resourcesToExport[i]);
    }
 else {
      fileNames.addElement(resourcesToExport[i]);
    }
  }
  checkRedundancies(folderNames,fileNames);
  m_exportedResources=new HashSet();
  m_exportedPageFiles=new HashSet();
  for (int i=0; i < folderNames.size(); i++) {
    String path=(String)folderNames.elementAt(i);
    addParentFolders(path);
    addChildResources(path);
    m_exportedResources.add(path);
  }
  addFiles(fileNames);
  addPageBodyFiles();
  m_saxWriter.writeClose(m_fileNode);
  parent.remove(m_fileNode);
}
