{
  getSaxWriter().writeClose(exportNode);
  CmsXmlSaxWriter xmlSaxWriter=(CmsXmlSaxWriter)getSaxWriter().getContentHandler();
  xmlSaxWriter.endDocument();
  ZipEntry entry=new ZipEntry(CmsImportExportManager.EXPORT_XMLFILENAME);
  getExportZipStream().putNextEntry(entry);
  StringBuffer result=((StringWriter)xmlSaxWriter.getWriter()).getBuffer();
  int steps=result.length() / C_SUB_LENGTH;
  int rest=result.length() % C_SUB_LENGTH;
  int pos=0;
  for (int i=0; i < steps; i++) {
    String sub=result.substring(pos,pos + C_SUB_LENGTH);
    getExportZipStream().write(sub.getBytes(OpenCms.getSystemInfo().getDefaultEncoding()));
    pos+=C_SUB_LENGTH;
  }
  if (rest > 0) {
    String sub=result.substring(pos,pos + rest);
    getExportZipStream().write(sub.getBytes(OpenCms.getSystemInfo().getDefaultEncoding()));
  }
  getExportZipStream().closeEntry();
  getExportZipStream().close();
}
