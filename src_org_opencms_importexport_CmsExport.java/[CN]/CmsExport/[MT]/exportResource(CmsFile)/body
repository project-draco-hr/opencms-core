{
  String source=getSourceFilename(m_cms.readAbsolutePath(file));
  m_report.print(m_report.key("report.exporting"),I_CmsReport.C_FORMAT_NOTE);
  m_report.print(m_cms.readAbsolutePath(file));
  m_report.print(m_report.key("report.dots"),I_CmsReport.C_FORMAT_NOTE);
  try {
    if (!m_exportedResources.contains(file.getResourceId())) {
      ZipEntry entry=new ZipEntry(source);
      m_exportZipStream.putNextEntry(entry);
      m_exportZipStream.write(file.getContents());
      m_exportZipStream.closeEntry();
      m_exportedResources.add(file.getResourceId());
      writeXmlEntrys(file,true);
    }
 else {
      writeXmlEntrys(file,false);
    }
    if (m_cms.getResourceType(file.getType()).getResourceTypeName().equals("page")) {
      m_exportedPageFiles.add("/" + source);
    }
  }
 catch (  Exception exc) {
    m_report.println(exc);
    throw new CmsException(CmsException.C_UNKNOWN_EXCEPTION,exc);
  }
  m_report.println(m_report.key("report.ok"),I_CmsReport.C_FORMAT_OK);
}
