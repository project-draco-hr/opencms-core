{
  PreparedStatement pstmt=null;
  int num;
  Vector temp=(Vector)m_prepStatements.get(key);
synchronized (temp) {
    if (temp.size() > 0) {
      pstmt=(PreparedStatement)temp.firstElement();
      temp.removeElementAt(0);
    }
 else {
      String sql=(String)m_prepStatementsCache.get(key);
      if (count > (m_maxConn - 1)) {
        count=0;
      }
      Connection conn=(Connection)m_connections.elementAt(count);
      count++;
      pstmt=conn.prepareStatement(sql);
      pstmt.clearParameters();
    }
    temp.notify();
  }
  return pstmt;
}
