{
  CmsUploadButton button=new CmsUploadButton(new ExternalResource(OpenCms.getWorkplaceAppManager().getUserIconHelper().getBigIconPath(cms,user)),CmsUserIconHelper.USER_IMAGE_FOLDER + CmsUserIconHelper.TEMP_FOLDER);
  button.getState().setUploadType(UploadType.singlefile);
  button.getState().setTargetFileNamePrefix(user.getId().toString());
  button.addStyleName("o-user-image");
  button.getState().setDialogTitle(CmsVaadinUtils.getMessageText(Messages.GUI_USER_INFO_UPLOAD_IMAGE_DIALOG_TITLE_0));
  if (CmsAppWorkplaceUi.isOnlineProject()) {
    button.setEnabled(false);
    button.setDescription(CmsVaadinUtils.getMessageText(org.opencms.ui.apps.Messages.GUI_TOOLBAR_NOT_AVAILABLE_ONLINE_0));
  }
 else {
    button.setDescription(CmsVaadinUtils.getMessageText(Messages.GUI_USER_INFO_UPLOAD_IMAGE_0));
  }
  button.addUploadListener(uploadListener);
  return button;
}
