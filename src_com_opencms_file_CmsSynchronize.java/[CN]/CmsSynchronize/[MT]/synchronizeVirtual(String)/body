{
  File sfsFile=new File(m_synchronizePath + resourceName);
  String sfsAbsolutePath=sfsFile.getPath().substring(m_synchronizePath.length());
  String[] diskFiles=sfsFile.list();
  File currentFile;
  CmsFile hashFile=null;
  CmsFolder hashFolder=null;
  for (int i=0; i < diskFiles.length; i++) {
    currentFile=new File(sfsFile,diskFiles[i]);
    if (currentFile.isDirectory()) {
      hashFolder=(CmsFolder)m_vfsFolders.get(sfsFile.getPath() + currentFile.getName() + "/");
      if (hashFolder == null) {
        try {
          m_cms.createFolder(sfsAbsolutePath,currentFile.getName());
          m_cms.lockResource(sfsAbsolutePath + currentFile.getName() + "/");
        }
 catch (        CmsException e) {
          if (e.getType() != CmsException.C_FILE_EXISTS) {
            throw e;
          }
        }
      }
      hashFolder=null;
      synchronizeVirtual(sfsAbsolutePath + currentFile.getName() + "/");
    }
 else {
      hashFile=(CmsFile)m_vfsFiles.get(sfsFile.getPath() + currentFile.getName());
      if (hashFile == null) {
        try {
          byte[] content=getFileBytes(currentFile);
          String type=getFileType(currentFile.getName());
          if (!currentFile.getName().startsWith("$")) {
            try {
              m_cms.createFile(sfsAbsolutePath,currentFile.getName(),content,type);
              m_cms.lockResource(sfsAbsolutePath + currentFile.getName());
              m_synchronizeList.putDates(sfsAbsolutePath + currentFile.getName(),(long)System.currentTimeMillis(),currentFile.lastModified());
            }
 catch (            CmsException e) {
              if (e.getType() == CmsException.C_FILE_EXISTS) {
              }
 else {
                throw e;
              }
            }
          }
        }
 catch (        Exception e) {
          throw new CmsException("[" + this.getClass().getName() + "]"+ " Cannot create file in virtual filesystem",e);
        }
      }
      hashFile=null;
    }
  }
}
