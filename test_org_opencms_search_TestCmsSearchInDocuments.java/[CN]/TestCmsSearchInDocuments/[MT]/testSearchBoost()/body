{
  CmsObject cms=getCmsObject();
  echo("Testing search boosting");
  CmsSearch searchBean=new CmsSearch();
  List searchResult;
  int expected=6;
  searchBean.init(cms);
  searchBean.setIndex(INDEX_OFFLINE);
  searchBean.setSearchRoot("/search/");
  searchBean.setQuery("Alkacon Software");
  searchResult=searchBean.getSearchResult();
  Iterator i=searchResult.iterator();
  while (i.hasNext()) {
    CmsSearchResult res=(CmsSearchResult)i.next();
    System.out.print(res.getPath() + " ");
    System.out.println(res.getScore());
  }
  assertEquals(expected,searchResult.size());
  CmsSearchResult res1=(CmsSearchResult)searchResult.get(searchResult.size() - 1);
  CmsSearchResult res2=(CmsSearchResult)searchResult.get(searchResult.size() - 2);
  CmsSearchResult res3=(CmsSearchResult)searchResult.get(0);
  String path1=cms.getRequestContext().removeSiteRoot(res1.getPath());
  String path2=cms.getRequestContext().removeSiteRoot(res2.getPath());
  String path3=cms.getRequestContext().removeSiteRoot(res3.getPath());
  CmsProperty maxBoost=new CmsProperty(CmsPropertyDefinition.PROPERTY_SEARCH_PRIORITY,I_CmsDocumentFactory.SEARCH_PRIORITY_MAX_VALUE,null,true);
  CmsProperty highBoost=new CmsProperty(CmsPropertyDefinition.PROPERTY_SEARCH_PRIORITY,I_CmsDocumentFactory.SEARCH_PRIORITY_HIGH_VALUE,null,true);
  CmsProperty lowBoost=new CmsProperty(CmsPropertyDefinition.PROPERTY_SEARCH_PRIORITY,I_CmsDocumentFactory.SEARCH_PRIORITY_LOW_VALUE,null,true);
  cms.lockResource(path1);
  cms.writePropertyObject(path1,maxBoost);
  cms.unlockResource(path1);
  cms.lockResource(path2);
  cms.writePropertyObject(path2,highBoost);
  cms.unlockResource(path2);
  cms.lockResource(path3);
  cms.writePropertyObject(path3,lowBoost);
  cms.unlockResource(path3);
  OpenCms.getSearchManager().updateIndex(new CmsShellReport());
  searchBean.setIndex(INDEX_ONLINE);
  searchBean.setQuery("Alkacon Software");
  searchResult=searchBean.getSearchResult();
  i=searchResult.iterator();
  while (i.hasNext()) {
    CmsSearchResult res=(CmsSearchResult)i.next();
    System.out.print(res.getPath() + " ");
    System.out.println(res.getScore() + " ");
    System.out.println(res.getExcerpt());
  }
  assertEquals(expected,searchResult.size());
  assertEquals(res1.getPath(),((CmsSearchResult)searchResult.get(searchResult.size() - 1)).getPath());
  assertEquals(res2.getPath(),((CmsSearchResult)searchResult.get(searchResult.size() - 2)).getPath());
  assertEquals(res3.getPath(),((CmsSearchResult)searchResult.get(0)).getPath());
  searchBean.setIndex(INDEX_OFFLINE);
  searchBean.setQuery("Alkacon Software");
  searchResult=searchBean.getSearchResult();
  i=searchResult.iterator();
  while (i.hasNext()) {
    CmsSearchResult res=(CmsSearchResult)i.next();
    System.out.print(res.getPath() + " ");
    System.out.println(res.getScore() + " ");
    System.out.println(res.getExcerpt());
  }
  assertEquals(expected,searchResult.size());
  assertEquals(res1.getPath(),((CmsSearchResult)searchResult.get(0)).getPath());
  assertEquals(res2.getPath(),((CmsSearchResult)searchResult.get(1)).getPath());
  assertEquals(res3.getPath(),((CmsSearchResult)searchResult.get(searchResult.size() - 1)).getPath());
}
