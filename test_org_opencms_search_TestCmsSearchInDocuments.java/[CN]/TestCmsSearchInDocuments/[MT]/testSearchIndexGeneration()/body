{
  CmsObject cms=getCmsObject();
  echo("Testing search index generation with different resource types");
  cms.createResource("/search/",CmsResourceTypeFolder.RESOURCE_TYPE_ID,null,null);
  cms.unlockResource("/search/");
  importTestResource(cms,"org/opencms/search/extractors/test1.pdf","/search/test1.pdf",CmsResourceTypeBinary.getStaticTypeId(),Collections.EMPTY_LIST);
  importTestResource(cms,"org/opencms/search/extractors/test1.doc","/search/test1.doc",CmsResourceTypeBinary.getStaticTypeId(),Collections.EMPTY_LIST);
  importTestResource(cms,"org/opencms/search/extractors/test1.rtf","/search/test1.rtf",CmsResourceTypeBinary.getStaticTypeId(),Collections.EMPTY_LIST);
  importTestResource(cms,"org/opencms/search/extractors/test1.xls","/search/test1.xls",CmsResourceTypeBinary.getStaticTypeId(),Collections.EMPTY_LIST);
  importTestResource(cms,"org/opencms/search/extractors/test1.ppt","/search/test1.ppt",CmsResourceTypeBinary.getStaticTypeId(),Collections.EMPTY_LIST);
  List properties=new ArrayList();
  properties.add(new CmsProperty(CmsPropertyDefinition.PROPERTY_CONTENT_ENCODING,CmsEncoder.ENCODING_UTF_8,null,true));
  importTestResource(cms,"org/opencms/search/extractors/test1.html","/search/test1.html",CmsResourceTypePlain.getStaticTypeId(),properties);
  assertTrue(cms.existsResource("/search/test1.pdf"));
  assertTrue(cms.existsResource("/search/test1.html"));
  assertTrue(cms.existsResource("/search/test1.doc"));
  assertTrue(cms.existsResource("/search/test1.rtf"));
  assertTrue(cms.existsResource("/search/test1.xls"));
  assertTrue(cms.existsResource("/search/test1.ppt"));
  OpenCms.getPublishManager().publishProject(cms,new CmsShellReport(cms.getRequestContext().getLocale()));
  OpenCms.getPublishManager().waitWhileRunning();
  I_CmsReport report=new CmsShellReport(cms.getRequestContext().getLocale());
  OpenCms.fireCmsEvent(I_CmsEventListener.EVENT_REBUILD_SEARCHINDEX,Collections.singletonMap(I_CmsEventListener.KEY_REPORT,report));
  cms.getRequestContext().setCurrentProject(cms.readProject("Online"));
  assertTrue(cms.existsResource("/search/test1.pdf"));
  assertTrue(cms.existsResource("/search/test1.html"));
  assertTrue(cms.existsResource("/search/test1.doc"));
  assertTrue(cms.existsResource("/search/test1.rtf"));
  assertTrue(cms.existsResource("/search/test1.xls"));
  assertTrue(cms.existsResource("/search/test1.ppt"));
}
