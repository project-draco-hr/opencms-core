{
  m_currentFormat=m_formats.get(formatKey);
  if (m_ratioLocked || m_currentFormat.isFixedRatio()) {
    m_croppingParam.reset();
    m_croppingParam.setTargetHeight(m_currentFormat.getHeight(m_originalHeight,m_originalWidth));
    m_formatForm.setHeightInput(m_croppingParam.getTargetHeight());
    m_croppingParam.setTargetWidth(m_currentFormat.getWidth(m_originalHeight,m_originalWidth));
    m_formatForm.setWidthInput(m_croppingParam.getTargetWidth());
    if (m_currentFormat.isFixedRatio()) {
      m_formatForm.setRatioButton(false,false,"Image ratio is fixed for this format.");
      m_ratioLocked=true;
    }
 else {
      m_formatForm.setRatioButton(false,true,null);
    }
    if (!m_freeFormat && (!m_currentFormat.isHeightEditable() || !m_currentFormat.isWidthEditable())) {
      m_formatForm.setHeightInputEnabled(false);
      m_formatForm.setWidthInputEnabled(false);
    }
 else {
      m_formatForm.setHeightInputEnabled(true);
      m_formatForm.setWidthInputEnabled(true);
    }
  }
 else {
    if (!m_currentFormat.isHeightEditable()) {
      m_croppingParam.setTargetHeight(m_currentFormat.getHeight(m_originalHeight,m_originalWidth));
      m_formatForm.setHeightInput(m_croppingParam.getTargetHeight());
    }
    if (!m_currentFormat.isWidthEditable()) {
      m_croppingParam.setTargetWidth(m_currentFormat.getWidth(m_originalHeight,m_originalWidth));
      m_formatForm.setWidthInput(m_croppingParam.getTargetWidth());
    }
    if (m_freeFormat) {
      m_formatForm.setHeightInputEnabled(true);
      m_formatForm.setWidthInputEnabled(true);
    }
 else {
      if (!m_currentFormat.isHeightEditable()) {
        m_formatForm.setHeightInputEnabled(false);
      }
      if (!m_currentFormat.isWidthEditable()) {
        m_formatForm.setWidthInputEnabled(false);
      }
    }
  }
  fireValueChangedEvent();
}
