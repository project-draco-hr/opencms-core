{
  CmsCollectorData data=new CmsCollectorData(param);
  String foldername=CmsResource.getFolderPath(data.getFileName());
  List result;
  cms.getRequestContext().saveSiteRoot();
  try {
    cms.getRequestContext().setSiteRoot("/");
    CmsResourceFilter filter=CmsResourceFilter.DEFAULT.addRequireType(data.getType());
    result=cms.readResources(foldername,filter,tree);
  }
  finally {
    cms.getRequestContext().restoreSiteRoot();
  }
  Collections.sort(result,CmsResource.COMPARE_DATE_RELEASED);
  Collections.reverse(result);
  if ((data.getCount() > 0) && (result.size() > data.getCount())) {
    result=result.subList(0,data.getCount());
  }
  return result;
}
