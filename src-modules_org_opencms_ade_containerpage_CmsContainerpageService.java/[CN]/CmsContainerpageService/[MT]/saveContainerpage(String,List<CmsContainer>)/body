{
  CmsObject cms=getCmsObject();
  Iterator<CmsContainer> it=containers.iterator();
  CmsADESessionCache cache=getSessionCache();
  List<CmsContainerBean> containerBeans=new ArrayList<CmsContainerBean>();
  while (it.hasNext()) {
    CmsContainer container=it.next();
    List<CmsContainerElementBean> elements=new ArrayList<CmsContainerElementBean>();
    Iterator<String> elIt=container.getElements().iterator();
    while (elIt.hasNext()) {
      try {
        String clientId=elIt.next();
        CmsContainerElementBean element=cache.getCacheContainerElement(clientId);
        CmsResource resource=cms.readResource(element.getElementId());
        I_CmsResourceType resType=OpenCms.getResourceManager().getResourceType(resource);
        String formatterUri=resType.getFormatterForContainerType(cms,resource,container.getType());
        if (CmsStringUtil.isNotEmptyOrWhitespaceOnly(formatterUri)) {
          CmsResource formatter=cms.readResource(formatterUri);
          elements.add(new CmsContainerElementBean(element.getElementId(),formatter.getStructureId(),element.getProperties()));
        }
      }
 catch (      Exception e) {
        log(e.getLocalizedMessage(),e);
      }
    }
    containerBeans.add(new CmsContainerBean(container.getName(),container.getType(),-1,elements));
  }
  CmsContainerPageBean page=new CmsContainerPageBean(cms.getRequestContext().getLocale(),containerBeans);
  try {
    cms.lockResourceTemporary(containerpageUri);
    CmsXmlContainerPage xmlCnt=CmsXmlContainerPageFactory.unmarshal(cms,cms.readFile(containerpageUri));
    xmlCnt.save(cms,page);
    cms.unlockResource(containerpageUri);
  }
 catch (  CmsException e) {
    log(e.getLocalizedMessage(),e);
    throw new CmsRpcException(e.getLocalizedMessage());
  }
}
