{
  setImageClass(I_CmsButton.ButtonData.PUBLISH.getIconClass());
  setTitle(I_CmsButton.ButtonData.PUBLISH.getTitle());
  addClickHandler(new ClickHandler(){
    /** 
 * @see com.google.gwt.event.dom.client.ClickHandler#onClick(com.google.gwt.event.dom.client.ClickEvent)
 */
    public void onClick(    ClickEvent event){
      toolbar.onButtonActivation(CmsToolbarPublishButton.this);
      CmsDomUtil.ensureMouseOut(getElement());
      setDown(false);
      setEnabled(false);
      if (controller.hasChanges()) {
        CmsAcceptDeclineCancelDialog leavingDialog=new CmsAcceptDeclineCancelDialog(Messages.get().key(Messages.GUI_DIALOG_CHANGES_PUBLISH_TITLE_0),Messages.get().key(Messages.GUI_DIALOG_CHANGES_PUBLISH_TEXT_0));
        leavingDialog.setHandler(new I_CmsAcceptDeclineCancelHandler(){
          /** 
 * @see org.opencms.gwt.client.ui.I_CmsAcceptDeclineCancelHandler#onAccept()
 */
          public void onAccept(){
            controller.commit(true);
            openPublish();
          }
          /** 
 * @see org.opencms.gwt.client.ui.I_CmsCloseDialogHandler#onClose()
 */
          public void onClose(){
            setEnabled(true);
          }
          /** 
 * @see org.opencms.gwt.client.ui.I_CmsAcceptDeclineCancelHandler#onDecline()
 */
          public void onDecline(){
            openPublish();
          }
        }
);
        leavingDialog.setAcceptText(Messages.get().key(Messages.GUI_YES_0));
        leavingDialog.setDeclineText(Messages.get().key(Messages.GUI_NO_0));
        leavingDialog.setCloseText(Messages.get().key(Messages.GUI_CANCEL_0));
        leavingDialog.center();
      }
 else {
        openPublish();
      }
    }
  }
);
}
