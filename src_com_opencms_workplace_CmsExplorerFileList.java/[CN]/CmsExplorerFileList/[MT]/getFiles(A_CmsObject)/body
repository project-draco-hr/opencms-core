{
  Vector filesfolders=new Vector();
  String foldername;
  String filelist;
  String currentFilelist;
  String currentFolder;
  Vector files;
  Vector folders;
  Enumeration enum;
  CmsFile file;
  CmsFolder folder;
  HttpSession session=((HttpServletRequest)cms.getRequestContext().getRequest().getOriginalRequest()).getSession(true);
  foldername=cms.getRequestContext().getRequest().getParameter(C_PARA_FOLDER);
  if (foldername != null) {
    session.putValue(C_PARA_FOLDER,foldername);
  }
  currentFolder=(String)session.getValue(C_PARA_FOLDER);
  if (currentFolder == null) {
    currentFolder=cms.getRequestContext().currentFolder().getAbsolutePath();
  }
  filelist=cms.getRequestContext().getRequest().getParameter(C_PARA_FILELIST);
  if (filelist != null) {
    session.putValue(C_PARA_FILELIST,filelist);
  }
  currentFilelist=(String)session.getValue(C_PARA_FILELIST);
  if (currentFilelist == null) {
    currentFilelist=cms.getRequestContext().currentFolder().getAbsolutePath();
  }
  System.err.println("########################");
  System.err.println("filelist " + filelist);
  System.err.println("currentfilelist " + currentFilelist);
  System.err.println("########################");
  folders=cms.getSubFolders(currentFilelist);
  files=cms.getFilesInFolder(currentFilelist);
  enum=folders.elements();
  while (enum.hasMoreElements()) {
    folder=(CmsFolder)enum.nextElement();
    filesfolders.addElement(folder);
  }
  enum=files.elements();
  while (enum.hasMoreElements()) {
    file=(CmsFile)enum.nextElement();
    filesfolders.addElement(file);
  }
  return filesfolders;
}
