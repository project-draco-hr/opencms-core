{
  CmsResource sourceRes=getCms().readFileHeader(getParamResource());
  if (sourceRes.isFolder() && !DIALOG_WAIT.equals(getParamAction())) {
    return false;
  }
  int copyMode=I_CmsConstants.C_COPY_PRESERVE_LINK;
  try {
    copyMode=Integer.parseInt(getParamCopymode());
  }
 catch (  Exception e) {
  }
  String target=getParamTarget();
  if (target == null)   target="";
  if (!target.startsWith("/")) {
    target=CmsResource.getParent(getParamResource()) + target;
  }
  try {
    CmsResource res=getCms().readFileHeader(target);
    if (res.isFolder()) {
      if (!target.endsWith("/"))       target+="/";
      target=target + CmsResource.getName(getParamResource());
    }
  }
 catch (  CmsException e) {
  }
  setParamTarget(target);
  if (DIALOG_CONFIRMED.equals(getParamAction())) {
    getCms().deleteResource(target,I_CmsConstants.C_DELETE_OPTION_IGNORE_VFS_LINKS);
  }
  getCms().copyResource(getParamResource(),target,"true".equals(getParamKeeprights()),true,copyMode);
  return true;
}
