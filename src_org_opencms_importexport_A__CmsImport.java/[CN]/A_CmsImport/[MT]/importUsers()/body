{
  List userNodes;
  List groupNodes;
  Element currentElement, currentGroup;
  Vector userGroups;
  Hashtable userInfo=new Hashtable();
  String name, description, flags, password, firstname, lastname, email, address, type, pwd, infoNode, defaultGroup;
  try {
    userNodes=m_docXml.selectNodes("//" + CmsImportExportManager.N_USERDATA);
    for (int i=0; i < userNodes.size(); i++) {
      currentElement=(Element)userNodes.get(i);
      name=CmsImport.getChildElementTextValue(currentElement,CmsImportExportManager.N_NAME);
      name=OpenCms.getImportExportManager().translateUser(name);
      pwd=CmsImport.getChildElementTextValue(currentElement,CmsImportExportManager.N_PASSWORD);
      password=new String(Base64.decodeBase64(pwd.trim().getBytes()));
      description=CmsImport.getChildElementTextValue(currentElement,CmsImportExportManager.N_DESCRIPTION);
      flags=CmsImport.getChildElementTextValue(currentElement,CmsImportExportManager.N_FLAGS);
      firstname=CmsImport.getChildElementTextValue(currentElement,CmsImportExportManager.N_FIRSTNAME);
      lastname=CmsImport.getChildElementTextValue(currentElement,CmsImportExportManager.N_LASTNAME);
      email=CmsImport.getChildElementTextValue(currentElement,CmsImportExportManager.N_EMAIL);
      address=CmsImport.getChildElementTextValue(currentElement,CmsImportExportManager.N_TAG_ADDRESS);
      type=CmsImport.getChildElementTextValue(currentElement,CmsImportExportManager.N_TYPE);
      defaultGroup=CmsImport.getChildElementTextValue(currentElement,CmsImportExportManager.N_DEFAULTGROUP);
      infoNode=CmsImport.getChildElementTextValue(currentElement,CmsImportExportManager.N_USERINFO);
      try {
        byte[] value=getFileBytes(infoNode);
        ByteArrayInputStream bin=new ByteArrayInputStream(value);
        ObjectInputStream oin=new ObjectInputStream(bin);
        userInfo=(Hashtable)oin.readObject();
      }
 catch (      IOException ioex) {
        m_report.println(ioex);
      }
      groupNodes=currentElement.selectNodes("*/" + CmsImportExportManager.N_GROUPNAME);
      userGroups=new Vector();
      for (int j=0; j < groupNodes.size(); j++) {
        currentGroup=(Element)groupNodes.get(j);
        String userInGroup=CmsImport.getChildElementTextValue(currentGroup,CmsImportExportManager.N_NAME);
        userInGroup=OpenCms.getImportExportManager().translateGroup(userInGroup);
        userGroups.addElement(userInGroup);
      }
      if (defaultGroup != null && !"".equalsIgnoreCase(defaultGroup)) {
        userInfo.put(CmsUserSettings.ADDITIONAL_INFO_DEFAULTGROUP,defaultGroup);
      }
      importUser(name,description,flags,password,firstname,lastname,email,address,type,userInfo,userGroups);
    }
  }
 catch (  CmsImportExportException e) {
    throw e;
  }
catch (  Exception e) {
    m_report.println(e);
    CmsMessageContainer message=Messages.get().container(Messages.ERR_IMPORTEXPORT_ERROR_IMPORTING_USERS_0);
    if (LOG.isDebugEnabled()) {
      LOG.debug(message.key(),e);
    }
    throw new CmsImportExportException(message,e);
  }
}
