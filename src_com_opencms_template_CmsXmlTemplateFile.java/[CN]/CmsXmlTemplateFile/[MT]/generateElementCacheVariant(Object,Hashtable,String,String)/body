{
  CmsElementVariant result=new CmsElementVariant();
  String datablockName=this.getTemplateDatablockName(templateSelector);
  if (datablockName == null && (templateSelector.toLowerCase().equals("script"))) {
    return result;
  }
  Element domEl=getProcessedData(datablockName,callingObject,parameters,null);
  StringBuffer buf=new StringBuffer();
  for (Node n=domEl.getFirstChild(); n != null; n=treeWalker(domEl,n)) {
    if (n.getNodeType() == n.ELEMENT_NODE && "element".equalsIgnoreCase(n.getNodeName())) {
      String elName=((Element)n).getAttribute("name");
      if (elName != null && !"".equalsIgnoreCase(elName)) {
        if (buf.length() > 0) {
          result.add(buf.toString());
          buf=new StringBuffer();
        }
        CmsElementLink link=new CmsElementLink(elName);
        result.add(link);
      }
    }
 else     if (n.getNodeType() == n.ELEMENT_NODE && "method".equalsIgnoreCase(n.getNodeName())) {
      String methodName=((Element)n).getAttribute("name");
      String tagcontent=getTagValue((Element)n);
      if (methodName != null && !"".equals(methodName)) {
        if (buf.length() > 0) {
          result.add(buf.toString());
          buf=new StringBuffer();
        }
        CmsMethodLink methodLink=new CmsMethodLink(methodName,tagcontent);
        result.add(methodLink);
        if (tagcontent != null && !"".equals(tagcontent)) {
          n=treeWalker(domEl,n);
        }
      }
    }
 else     if (n.getNodeType() == n.TEXT_NODE || n.getNodeType() == n.CDATA_SECTION_NODE) {
      buf.append(n.getNodeValue());
    }
  }
  if (buf.length() > 0) {
    result.add(buf.toString());
  }
  return result;
}
