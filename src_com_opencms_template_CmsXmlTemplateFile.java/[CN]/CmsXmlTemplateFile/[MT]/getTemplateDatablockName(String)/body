{
  String templateDatablockName=null;
  if (templateSelector != null && !"".equals(templateSelector)) {
    if (hasData("template." + templateSelector)) {
      templateDatablockName="template." + templateSelector;
    }
 else {
      A_OpenCms.log(C_OPENCMS_CRITICAL,getClassName() + "cannot load selected template file section " + templateSelector+ " in template file "+ getFilename());
      A_OpenCms.log(C_OPENCMS_CRITICAL,getClassName() + "choosing default template.");
    }
  }
  if (templateDatablockName == null) {
    if (hasData("TEMPLATE")) {
      templateDatablockName="TEMPLATE";
    }
 else     if (hasData("TEMPLATE.default")) {
      templateDatablockName="TEMPLATE.default";
    }
 else {
      A_OpenCms.log(C_OPENCMS_CRITICAL,getClassName() + "template definition file " + getAbsoluteFilename()+ " is corrupt. cannot find default section.");
      throw new CmsException("Corrupt template file " + getAbsoluteFilename() + ". Cannot find default section.",CmsException.C_XML_TAG_MISSING);
    }
  }
  return templateDatablockName;
}
