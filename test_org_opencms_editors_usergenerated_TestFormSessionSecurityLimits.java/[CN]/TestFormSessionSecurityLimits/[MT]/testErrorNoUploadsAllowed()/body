{
  CmsObject cms=getCmsObject();
  CmsUser admin=cms.readUser("Admin");
  CmsResource rootFolder=cms.readResource("/");
  CmsGroup administrators=cms.readGroup("Administrators");
  CmsFormConfiguration config=new CmsFormConfiguration(new CmsUUID(),Optional.of(admin),administrators,"plain",rootFolder,"n_%(number)",Locale.ENGLISH,Optional.<CmsResource>absent(),Optional.<Long>absent(),Optional.of(Integer.valueOf(100)),Optional.<Long>absent(),Optional.<Integer>absent(),false,Optional.of(Arrays.asList(".jpg",".PNG")));
  try {
    CmsFormSessionSecurityUtil.checkCreateUpload(cms,config,"foo.png",100L);
    fail("Exception should have been thrown!");
  }
 catch (  CmsPermissionViolationException e) {
    assertEquals(Messages.ERR_NO_UPLOADS_ALLOWED_0,e.getMessageContainer().getKey());
  }
}
