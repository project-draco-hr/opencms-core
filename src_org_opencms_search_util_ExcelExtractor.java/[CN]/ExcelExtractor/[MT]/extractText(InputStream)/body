{
  StringBuffer sb=new StringBuffer();
  HSSFWorkbook wb=new HSSFWorkbook(in,false);
  int numSheets=wb.getNumberOfSheets();
  for (int i=0; i < numSheets; ++i) {
    HSSFSheet sheet=wb.getSheetAt(i);
    for (int j=sheet.getFirstRowNum(); j <= sheet.getLastRowNum(); ++j) {
      HSSFRow row=sheet.getRow(j);
      if (row != null) {
        for (int k=row.getFirstCellNum(); k <= row.getLastCellNum(); ++k) {
          HSSFCell cell=row.getCell((short)k);
          if (cell != null) {
            int type=cell.getCellType();
            if (type == HSSFCell.CELL_TYPE_STRING) {
              String str=cell.getStringCellValue();
              str=str.trim();
              str=replace(str,"\n","");
              sb.append(str).append(" ");
            }
          }
        }
      }
    }
    sb.append("\n");
  }
  return sb.toString();
}
