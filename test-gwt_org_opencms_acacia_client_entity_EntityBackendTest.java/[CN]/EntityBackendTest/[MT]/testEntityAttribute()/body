{
  I_CmsEntityBackend vie=getVieInstance();
  CmsType simple=vie.createType(SIMPLE_TYPE_ID);
  CmsType complex=vie.createType(COMPLEX_TYPE_ID);
  complex.addAttribute(ATTRIBUTE_NAME,simple,1,3);
  assertNotNull("The newly created type should not be null",simple);
  assertNotNull("The newly created type should not be null",complex);
  assertEquals("The type id should match the initial id",SIMPLE_TYPE_ID,simple.getId());
  assertEquals("The type id should match the initial id",COMPLEX_TYPE_ID,complex.getId());
  assertTrue("This should be a simple type, as it has no attributes.",simple.isSimpleType());
  assertNotNull("The attribute list should not be null.",complex.getAttributeNames());
  assertEquals("The attribute names list should have a length of 1.",1,complex.getAttributeNames().size());
  String attributeType=complex.getAttributeTypeName(ATTRIBUTE_NAME);
  assertEquals("The attribute should be of the type: " + SIMPLE_TYPE_ID,SIMPLE_TYPE_ID,attributeType);
  assertEquals("The max occurrence should be the same as set above",3,complex.getAttributeMaxOccurrence(ATTRIBUTE_NAME));
  assertEquals("The min occurrence should be the same as set above",1,complex.getAttributeMinOccurrence(ATTRIBUTE_NAME));
  List<String> attributes=complex.getAttributeNames();
  assertEquals("The attribute name should be as given above.",ATTRIBUTE_NAME,attributes.get(0));
  CmsEntity entity=vie.createEntity("my-entity",complex.getId());
  String value="my attribute value";
  entity.addAttributeValue(ATTRIBUTE_NAME,value);
  CmsEntityAttribute attribute=entity.getAttribute(ATTRIBUTE_NAME);
  assertNotNull("The entity should have an attribute: " + ATTRIBUTE_NAME,attribute);
  assertEquals("The attribute value should match the previously set value",value,attribute.getSimpleValue());
  assertTrue("The attribute should only have a single value",attribute.isSingleValue());
  entity.addAttributeValue(ATTRIBUTE_NAME,"");
  attribute=entity.getAttribute(ATTRIBUTE_NAME);
  assertFalse("The attribute should no longer be a single value attribute",attribute.isSingleValue());
  assertEquals("The value count should be 2",2,attribute.getValueCount());
  CmsEntity entity2=vie.createEntity("my-second-entity",complex.getId());
  String value2="";
  entity2.addAttributeValue(ATTRIBUTE_NAME,value2);
  CmsEntityAttribute attribute2=entity2.getAttribute(ATTRIBUTE_NAME);
  assertNotNull("The entity should have an attribute even though the value was an empty string: " + ATTRIBUTE_NAME,attribute2);
  assertEquals("The attribute value should match the previously set empty string value",value2,attribute2.getSimpleValue());
}
