{
  m_handler=handler;
  try {
    m_searchObject=(CmsGallerySearchBean)CmsRpcPrefetcher.getSerializedObjectFromDictionary(getGalleryService(),CmsGallerySearchBean.DICT_NAME);
    m_dialogBean=(CmsGalleryDataBean)CmsRpcPrefetcher.getSerializedObjectFromDictionary(getGalleryService(),CmsGalleryDataBean.DICT_NAME);
    m_dialogMode=m_dialogBean.getMode();
  }
 catch (  SerializationException e) {
    CmsErrorDialog.handleException(new Exception("Deserialization of gallery data failed. This may be caused by expired java-script resources, please clear your browser cache and try again.",e));
  }
  if (m_searchObject == null) {
    m_searchObject=new CmsGallerySearchBean();
    m_searchObject.setLocale(m_dialogBean.getLocale());
    m_searchObject.setScope(m_dialogBean.getScope());
  }
  if (m_dialogBean != null) {
    m_handler.onInitialSearch(m_searchObject,m_dialogBean,this);
    m_eventBus=new SimpleEventBus();
    addValueChangeHandler(handler);
  }
}
