{
  CmsRequestContext reqCont=m_cms.getRequestContext();
  String at="createProject: ";
  try {
    CmsProject project=m_cms.createProject("DeleteModule","A System generated Project to delete The Module " + m_moduleName,C_GROUP_ADMIN,C_GROUP_ADMIN,C_PROJECT_TYPE_TEMPORARY);
    reqCont.setCurrentProject(project.getId());
    at="copyResourceToProject: ";
    for (int i=0; i < m_projectFiles.size(); i++) {
      m_cms.copyResourceToProject((String)m_projectFiles.elementAt(i));
    }
    at="delete files: ";
    m_registry.deleteModule(m_moduleName,m_exclusion);
    at="publishProject: ";
    m_cms.unlockProject(project.getId());
    m_cms.publishProject(project.getId());
  }
 catch (  CmsException e) {
    if (I_CmsLogChannels.C_PREPROCESSOR_IS_LOGGING && A_OpenCms.isLogging()) {
      A_OpenCms.log(A_OpenCms.C_OPENCMS_CRITICAL,"delete module failed " + at + e.getMessage());
    }
  }
}
