{
  boolean access=false;
  int accessflags=resource.getAccessFlags();
  boolean groupAccess=false;
  Enumeration allGroups=cms.getGroupsOfUser(cms.getRequestContext().currentUser().getName()).elements();
  while ((!groupAccess) && allGroups.hasMoreElements()) {
    CmsGroup nextGroup=(CmsGroup)allGroups.nextElement();
    if (nextGroup.getName().equals(C_GROUP_ADMIN)) {
      return true;
    }
    groupAccess=cms.readGroup(resource).equals(nextGroup);
  }
  if (groupAccess && (accessflags & C_ACCESS_GROUP_READ) == C_ACCESS_GROUP_READ) {
    return true;
  }
  if (resource.getOwnerId() == cms.getRequestContext().currentUser().getId()) {
    if ((accessflags & C_ACCESS_OWNER_READ) == C_ACCESS_OWNER_READ) {
      return true;
    }
  }
  if ((accessflags & C_ACCESS_PUBLIC_READ) == C_ACCESS_PUBLIC_READ) {
    return true;
  }
  return access;
}
