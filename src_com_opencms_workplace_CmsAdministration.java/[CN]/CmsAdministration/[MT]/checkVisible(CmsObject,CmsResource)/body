{
  boolean access=false;
  int accessflags=resource.getAccessFlags();
  boolean groupAccess=false;
  Enumeration allGroups=cms.getGroupsOfUser(cms.getRequestContext().currentUser().getName()).elements();
  while ((!groupAccess) && allGroups.hasMoreElements()) {
    CmsGroup nextGroup=(CmsGroup)allGroups.nextElement();
    if (nextGroup.getName().equals(C_GROUP_ADMIN)) {
      return true;
    }
    groupAccess=cms.readGroup(resource).equals(nextGroup);
  }
  if (groupAccess && (accessflags & C_ACCESS_GROUP_VISIBLE) == C_ACCESS_GROUP_VISIBLE) {
    return true;
  }
  if (resource.getOwnerId().equals(cms.getRequestContext().currentUser().getId())) {
    if ((accessflags & C_PERMISSION_VIEW) == C_PERMISSION_VIEW) {
      return true;
    }
  }
  if ((accessflags & C_ACCESS_PUBLIC_VISIBLE) == C_ACCESS_PUBLIC_VISIBLE) {
    return true;
  }
  return access;
}
