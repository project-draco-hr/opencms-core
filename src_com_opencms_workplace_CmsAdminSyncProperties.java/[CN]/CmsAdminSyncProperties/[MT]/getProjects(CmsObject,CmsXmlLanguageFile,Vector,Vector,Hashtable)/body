{
  Vector projects=cms.getAllAccessibleProjects();
  int retValue=-1;
  CmsProject curProject=cms.getRequestContext().currentProject();
  String defaultProject=curProject.getId() + "";
  I_CmsSession session=CmsXmlTemplateLoader.getSession(cms.getRequestContext(),true);
  String enteredProject=(String)session.getValue(C_SYNCPROJECT);
  if (enteredProject != null && !"".equals(enteredProject)) {
    defaultProject=enteredProject;
  }
  int n=0;
  for (int z=0; z < projects.size(); z++) {
    CmsProject loopProject=(CmsProject)projects.elementAt(z);
    if (!loopProject.isOnlineProject()) {
      String loopProjectName=loopProject.getName();
      String loopProjectId=loopProject.getId() + "";
      if (defaultProject.equals(loopProjectId)) {
        retValue=n;
        cms.getRequestContext().setCurrentProject(cms.readProject(Integer.parseInt(loopProjectId)));
      }
      names.addElement(loopProjectName);
      values.addElement(loopProjectId);
      n++;
    }
  }
  return new Integer(retValue);
}
