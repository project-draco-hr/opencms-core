{
  CmsFile file=null;
  String resourceName=cms.getRequestContext().getUri();
  try {
    file=cms.readFile(resourceName);
  }
 catch (  CmsException e) {
    if (e.getType() == CmsException.C_NOT_FOUND) {
      try {
        CmsFolder folder=cms.readFolder(resourceName);
        String defaultFileName=cms.readProperty(folder.getPath(),I_CmsConstants.C_PROPERTY_DEFAULT_FILE);
        if (defaultFileName != null) {
          String tmpResourceName=folder.getPath() + defaultFileName;
          try {
            file=cms.readFile(tmpResourceName);
            cms.getRequestContext().getRequest().setRequestedResource(tmpResourceName);
          }
 catch (          CmsException exc) {
            if (exc.getType() == CmsException.C_NO_ACCESS) {
              throw exc;
            }
          }
        }
        if (file == null) {
          for (int i=0; i < m_defaultFilenames.length; i++) {
            String tmpResourceName=folder.getPath() + m_defaultFilenames[i];
            try {
              file=cms.readFile(tmpResourceName);
              cms.getRequestContext().getRequest().setRequestedResource(tmpResourceName);
              break;
            }
 catch (            CmsException exc) {
              if (exc.getType() == CmsException.C_NO_ACCESS) {
                throw exc;
              }
            }
          }
        }
        if (file == null) {
          throw e;
        }
      }
 catch (      CmsException ex) {
        if (ex.getType() == CmsException.C_NOT_FOUND) {
          throw e;
        }
        throw ex;
      }
    }
 else {
      throw e;
    }
  }
  if (file != null) {
    if ((file.getAccessFlags() & C_ACCESS_INTERNAL_READ) > 0) {
      throw new CmsException(CmsException.C_EXTXT[CmsException.C_INTERNAL_FILE] + cms.getRequestContext().getUri(),CmsException.C_INTERNAL_FILE);
    }
  }
  return file;
}
