{
  Vector v=new Vector(to.length);
  for (int i=0; i < to.length; i++) {
    if (to[i].getEmail() == null) {
      continue;
    }
    if (to[i].getEmail().equals("")) {
      continue;
    }
    if (to[i].getEmail().indexOf("@") == -1 || to[i].getEmail().indexOf(".") == -1) {
      throw new CmsException("[" + CmsTaskAction.class.getName() + "] "+ "Error in sending email, Invalid recipient email address: "+ to[i].getEmail(),CmsException.C_BAD_NAME);
    }
    try {
      v.addElement(new InternetAddress(to[i].getEmail()));
    }
 catch (    AddressException e) {
      throw new CmsException("[" + CmsTaskAction.class.getName() + "] "+ "Error in sending email, Invalid recipient email address: "+ to[i].getEmail(),CmsException.C_BAD_NAME);
    }
  }
  if (v.size() == 0) {
    throw new CmsException("[" + CmsTaskAction.class.getName() + "] "+ "Error in sending email,Unknown recipient email address.",CmsException.C_BAD_NAME);
  }
  return createMail(from,v,subject,content,false);
}
