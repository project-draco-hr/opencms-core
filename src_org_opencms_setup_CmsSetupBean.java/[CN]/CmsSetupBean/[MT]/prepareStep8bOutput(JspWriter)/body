{
  m_oldLoggingOffset=m_newLoggingOffset;
  m_newLoggingOffset=m_workplaceImportThread.getLoggingThread().getMessages().size();
  if (isInitialized()) {
    for (int i=m_oldLoggingOffset; i < m_newLoggingOffset; i++) {
      String str=m_workplaceImportThread.getLoggingThread().getMessages().elementAt(i).toString();
      str=CmsEncoder.escapeWBlanks(str,"UTF-8");
      out.println("output[" + (i - m_oldLoggingOffset) + "] = \""+ str+ "\";");
    }
  }
 else {
    out.println("output[0] = 'ERROR';");
  }
  boolean threadFinished=m_workplaceImportThread.isFinished();
  boolean allWritten=m_oldLoggingOffset >= m_workplaceImportThread.getLoggingThread().getMessages().size();
  return threadFinished && allWritten;
}
