{
  Object result=null;
  I_CmsWpElement workplaceObject=null;
  String tagname=n.getTagName().toLowerCase();
  String classname=null;
  classname=(String)m_wpTags.get(tagname);
  if (classname == null || "".equals(classname)) {
    throwException("Don't know which class handles " + tagname + " tags.");
  }
  Object loadedClass=CmsTemplateClassManager.getClassInstance(classname);
  if (!(loadedClass instanceof I_CmsWpElement)) {
    throwException("Loaded class " + classname + " is not implementing I_CmsWpElement");
  }
  processNode(n,m_mainProcessTags,null,callingObject,userObj);
  workplaceObject=(I_CmsWpElement)loadedClass;
  try {
    result=workplaceObject.handleSpecialWorkplaceTag(m_cms,n,this,callingObject,(Hashtable)userObj,m_languageFile);
  }
 catch (  Exception e) {
    String errorMessage="Error while building workplace element \"" + tagname + "\": "+ e;
    if (e instanceof CmsException) {
      if (OpenCms.getLog(CmsLog.CHANNEL_WORKPLACE_XML).isWarnEnabled()) {
        OpenCms.getLog(CmsLog.CHANNEL_WORKPLACE_XML).warn(errorMessage,e);
      }
      throw (CmsException)e;
    }
 else {
      throwException(errorMessage,e);
    }
  }
  return result;
}
