{
  CmsWorkflowResponse response=null;
  try {
    CmsObject cms=getCmsObject();
    CmsPublish pub=new CmsPublish(cms,getCachedOptions());
    List<CmsResource> publishResources=idsToResources(cms,toPublish);
    pub.removeResourcesFromPublishList(toRemove);
    response=OpenCms.getWorkflowManager().executeAction(cms,action,publishResources);
  }
 catch (  Throwable e) {
    error(e);
  }
  return response;
}
