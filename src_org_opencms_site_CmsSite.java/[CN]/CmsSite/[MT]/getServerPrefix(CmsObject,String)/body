{
  if (equals(OpenCms.getSiteManager().getDefaultSite())) {
    return OpenCms.getSiteManager().getWorkplaceServer();
  }
  boolean secure=false;
  if (hasSecureServer()) {
    if (resourceName.startsWith(cms.getRequestContext().getSiteRoot())) {
      resourceName=resourceName.substring(cms.getRequestContext().getSiteRoot().length());
    }
    try {
      secure=Boolean.valueOf(cms.readPropertyObject(CmsRequestUtil.getRequestLink(resourceName),CmsPropertyDefinition.PROPERTY_SECURE,true).getValue()).booleanValue();
    }
 catch (    CmsException e) {
      if (LOG.isErrorEnabled()) {
        LOG.error(e.getLocalizedMessage(),e);
      }
    }
  }
  return (secure ? getSecureUrl() : getUrl());
}
