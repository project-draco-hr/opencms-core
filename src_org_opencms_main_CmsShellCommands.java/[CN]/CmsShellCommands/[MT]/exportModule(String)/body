{
  CmsModule module=OpenCms.getModuleManager().getModule(moduleName);
  if (module == null) {
    throw new CmsDbEntryNotFoundException(Messages.get().container(Messages.ERR_UNKNOWN_MODULE_1,moduleName));
  }
  String filename=OpenCms.getSystemInfo().getAbsoluteRfsPathRelativeToWebInf(OpenCms.getSystemInfo().getPackagesRfsPath() + I_CmsConstants.C_MODULE_PATH + moduleName+ "_"+ OpenCms.getModuleManager().getModule(moduleName).getVersion().toString());
  String[] resources=new String[module.getResources().size()];
  System.arraycopy(module.getResources().toArray(),0,resources,0,resources.length);
  CmsModuleImportExportHandler moduleExportHandler=new CmsModuleImportExportHandler();
  moduleExportHandler.setFileName(filename);
  moduleExportHandler.setAdditionalResources(resources);
  moduleExportHandler.setModuleName(module.getName().replace('\\','/'));
  moduleExportHandler.setDescription(Messages.get().key(m_shell.getLocale(),Messages.GUI_SHELL_IMPORTEXPORT_MODULE_HANDLER_NAME_1,new Object[]{moduleExportHandler.getModuleName()}));
  OpenCms.getImportExportManager().exportData(m_cms,moduleExportHandler,new CmsShellReport());
}
