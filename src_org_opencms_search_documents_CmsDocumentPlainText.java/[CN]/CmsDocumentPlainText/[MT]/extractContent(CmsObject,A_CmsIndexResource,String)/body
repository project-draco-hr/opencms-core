{
  CmsResource resource=(CmsResource)indexResource.getData();
  String result=null;
  try {
    String path=cms.getRequestContext().removeSiteRoot(resource.getRootPath());
    CmsProperty extractionClass=cms.readPropertyObject(path,CmsPropertyDefinition.PROPERTY_SEARCH_EXTRACTIONCLASS,true);
    if (extractionClass != CmsProperty.getNullProperty()) {
      Object ext=Class.forName(extractionClass.getValue()).newInstance();
      if (ext instanceof I_CmsSearchExtractor) {
        I_CmsSearchExtractor extractor=(I_CmsSearchExtractor)ext;
        return extractor.extractContent(cms,indexResource,language);
      }
 else {
        throw new CmsIndexException(Messages.get().container(Messages.ERR_EXTRACTION_CLASS_2,resource.getRootPath(),ext.getClass().getName()));
      }
    }
 else {
      CmsProperty encoding=cms.readPropertyObject(path,CmsPropertyDefinition.PROPERTY_CONTENT_ENCODING,true);
      CmsFile file=readFile(cms,resource);
      result=new String(file.getContents(),encoding.getValue(OpenCms.getSystemInfo().getDefaultEncoding()));
      return new CmsExtractionResult(result);
    }
  }
 catch (  Exception e) {
    throw new CmsIndexException(Messages.get().container(Messages.ERR_TEXT_EXTRACTION_1,resource.getRootPath()),e);
  }
}
