{
  File[] res;
  File fsFile=getFileInFs(folder);
  try {
    m_cms.readFolder(translate(folder));
  }
 catch (  CmsException e) {
    CmsResource newFolder=m_cms.createResource(translate(folder),C_TYPE_FOLDER_NAME,new HashMap(),new byte[0],null);
    Iterator i=m_checkFile.iterator();
    while (i.hasNext()) {
      try {
        ((I_CmsSyncModification)i.next()).modifyVfs(m_cms,newFolder,fsFile);
      }
 catch (      CmsSynchronizeException e1) {
        break;
      }
    }
    m_cms.unlockResource(translate(folder));
    newFolder=m_cms.readFolder(translate(folder));
    String resourcename=m_cms.readAbsolutePath(newFolder);
    CmsSynchronizeList sync=new CmsSynchronizeList(folder,resourcename,newFolder.getDateLastModified(),fsFile.lastModified());
    m_newSyncList.put(resourcename,sync);
  }
  if (fsFile.isDirectory()) {
    res=fsFile.listFiles();
    for (int i=0; i < res.length; i++) {
      String resname=res[i].getAbsolutePath();
      resname=resname.substring(m_synchronizePath.length(),resname.length());
      resname=resname.replace(File.separatorChar,'/');
      if (res[i].isFile()) {
        if (!m_newSyncList.containsKey(translate(resname))) {
          importToVfs(res[i],resname,folder);
        }
      }
 else {
        copyFromFs(resname + "/");
      }
    }
  }
  res=null;
}
