{
  boolean alive=false;
  try {
    if (!con.isClosed()) {
      con.clearWarnings();
      alive=true;
    }
  }
 catch (  SQLException exc) {
  }
  if ((con.getEstablishedTime() + (m_maxage)) < System.currentTimeMillis()) {
    alive=false;
    if (I_CmsLogChannels.C_PREPROCESSOR_IS_LOGGING && A_OpenCms.isLogging()) {
      A_OpenCms.log(I_CmsLogChannels.C_OPENCMS_POOL,"[" + getClass().getName() + "] "+ m_poolname+ ": connection is to old, destroy it.");
    }
  }
synchronized (m_availableConnections) {
    if (alive) {
      m_availableConnections.push(con);
      m_availableConnections.notify();
    }
 else {
      if (I_CmsLogChannels.C_PREPROCESSOR_IS_LOGGING && A_OpenCms.isLogging()) {
        A_OpenCms.log(I_CmsLogChannels.C_OPENCMS_POOL,"[" + getClass().getName() + "] "+ m_poolname+ ": connection was broken");
      }
      con.closeOriginalConnection();
      m_connectionAmount--;
      try {
        createConnections(1);
        m_availableConnections.notify();
      }
 catch (      SQLException exc) {
        if (I_CmsLogChannels.C_PREPROCESSOR_IS_LOGGING && A_OpenCms.isLogging()) {
          A_OpenCms.log(I_CmsLogChannels.C_OPENCMS_POOL,"[" + getClass().getName() + "] "+ m_poolname+ ": unable to create new connection for broken one");
        }
      }
    }
  }
}
