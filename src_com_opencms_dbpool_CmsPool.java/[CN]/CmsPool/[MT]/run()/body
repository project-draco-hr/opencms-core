{
  if (I_CmsLogChannels.C_PREPROCESSOR_IS_LOGGING && A_OpenCms.isLogging()) {
    A_OpenCms.log(I_CmsLogChannels.C_OPENCMS_POOL,"[" + getClass().getName() + "] "+ m_poolname+ ": starting connection-guard");
  }
  for (; ; ) {
    try {
      sleep(m_timeout);
    }
 catch (    InterruptedException exc) {
    }
    if (I_CmsLogChannels.C_PREPROCESSOR_IS_LOGGING && A_OpenCms.isLogging()) {
      A_OpenCms.log(I_CmsLogChannels.C_OPENCMS_POOL,"[" + getClass().getName() + "] "+ m_poolname+ ": checking for outtimed connections");
    }
synchronized (m_availableConnections) {
      Enumeration elements=m_availableConnections.elements();
      while (elements.hasMoreElements()) {
        CmsConnection con=(CmsConnection)elements.nextElement();
        if ((con.getLastUsed() + (m_timeout)) < System.currentTimeMillis()) {
          m_availableConnections.removeElement(con);
          m_connectionAmount--;
          con.closeOriginalConnection();
          if (I_CmsLogChannels.C_PREPROCESSOR_IS_LOGGING && A_OpenCms.isLogging()) {
            A_OpenCms.log(I_CmsLogChannels.C_OPENCMS_POOL,"[" + getClass().getName() + "] "+ m_poolname+ ": closing one outtimed connection");
          }
        }
      }
      if (m_connectionAmount < m_minConn) {
        try {
          createConnections(m_minConn - m_connectionAmount);
        }
 catch (        SQLException exc) {
          if (I_CmsLogChannels.C_PREPROCESSOR_IS_LOGGING && A_OpenCms.isLogging()) {
            A_OpenCms.log(I_CmsLogChannels.C_OPENCMS_POOL,"[" + getClass().getName() + "] "+ m_poolname+ ": unable to create new connection for broken one");
          }
        }
      }
    }
  }
}
