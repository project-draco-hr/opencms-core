{
  CmsResource sourceRes=getCms().readFileHeader(getParamResource());
  if (sourceRes.isFolder() && !DIALOG_WAIT.equals(getParamAction())) {
    return false;
  }
  String target=getParamTarget();
  if (target == null)   target="";
  if (target.equals(getParamResource())) {
    throw new CmsException("Can't move resource onto itself.",CmsException.C_FILESYSTEM_ERROR);
  }
  if (!target.startsWith("/")) {
    target=CmsResource.getParentFolder(getParamResource()) + target;
  }
  try {
    CmsResource res=getCms().readFileHeader(target);
    if (res.isFolder()) {
      if (!target.endsWith("/"))       target+="/";
      target=target + CmsResource.getName(getParamResource());
      if (target.endsWith("/"))       target=target.substring(0,target.length() - 1);
    }
  }
 catch (  CmsException e) {
  }
  setParamTarget(target);
  CmsResource targetRes=null;
  try {
    targetRes=getCms().readFileHeader(target);
  }
 catch (  CmsException e) {
  }
  if (targetRes != null) {
    if (DIALOG_CONFIRMED.equals(getParamAction())) {
      getCms().deleteResource(target,I_CmsConstants.C_DELETE_OPTION_IGNORE_VFS_LINKS);
    }
 else {
      throw new CmsException("The target already exists",CmsException.C_FILE_EXISTS);
    }
  }
  getCms().moveResource(getParamResource(),target);
  return true;
}
