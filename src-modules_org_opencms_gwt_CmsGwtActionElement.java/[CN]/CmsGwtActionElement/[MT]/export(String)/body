{
  StringBuffer localeMetaTag=new StringBuffer();
  String cmsLocale=OpenCms.getWorkplaceManager().getWorkplaceLocale(getCmsObject()).getLanguage();
  String locale=null;
  try {
    locale=new GwtLocaleFactoryImpl().fromString(cmsLocale).getLanguage();
  }
 catch (  IllegalArgumentException e) {
    locale=GwtLocale.DEFAULT_LOCALE;
  }
  if (CmsStringUtil.isEmptyOrWhitespaceOnly(locale)) {
    locale=GwtLocale.DEFAULT_LOCALE;
  }
  String metaLocale="<meta name=\"gwt:property\" content=\"locale=" + locale + "\">";
  localeMetaTag.append(metaLocale);
  StringBuffer sb=new StringBuffer();
  String prefetchedData=serialize(I_CmsCoreService.class.getMethod("prefetch"),getCoreData());
  sb.append(CmsCoreData.DICT_NAME).append("='").append(prefetchedData).append("';");
  sb.append(ClientMessages.get().export(getRequest()));
  wrapScript(sb);
  sb.append("<style type=\"text/css\">\n @import url(\"").append(iconCssLink(iconCssClassPrefix)).append("\");\n</style>\n");
  return localeMetaTag.append(sb).toString();
}
