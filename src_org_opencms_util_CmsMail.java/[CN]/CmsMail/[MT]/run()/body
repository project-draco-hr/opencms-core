{
  Message msg=null;
  Iterator i=OpenCms.getSystemInfo().getMailSettings().getMailHosts().iterator();
  boolean success=false;
  while (i.hasNext()) {
    CmsMailSettings.CmsMailHost host=(CmsMailSettings.CmsMailHost)i.next();
    try {
      msg=buildMessage(host);
      Transport.send(msg);
      success=true;
      if (OpenCms.getLog(this).isInfoEnabled()) {
        OpenCms.getLog(this).info("Success sending mail from '" + m_from + "' to '"+ getRecieverNames()+ "' with subject '"+ m_subject+ "' using host "+ host);
      }
    }
 catch (    Exception e) {
      while (e instanceof MessagingException) {
        e=((MessagingException)e).getNextException();
      }
      if (OpenCms.getLog(this).isErrorEnabled()) {
        OpenCms.getLog(this).error("Error while transmitting mail using host " + host,e);
      }
    }
    if (success) {
      break;
    }
  }
  if ((!success) && OpenCms.getLog(this).isErrorEnabled()) {
    OpenCms.getLog(this).error("Could not send mail from '" + m_from + "' to '"+ getRecieverNames()+ "' with subject '"+ m_subject+ "' using any configred host");
  }
}
