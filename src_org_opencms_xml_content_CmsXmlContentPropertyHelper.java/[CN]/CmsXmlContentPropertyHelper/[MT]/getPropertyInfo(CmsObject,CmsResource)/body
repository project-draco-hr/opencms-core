{
  Map<String,CmsXmlContentProperty> result=new HashMap<String,CmsXmlContentProperty>();
  I_CmsXmlContentHandler contentHandler=CmsXmlContentDefinition.getContentHandlerForResource(cms,resource);
  CmsMacroResolver resolver=new CmsMacroResolver();
  resolver.setCmsObject(cms);
  CmsUserSettings settings=new CmsUserSettings(cms.getRequestContext().currentUser());
  CmsMessages messages=contentHandler.getMessages(settings.getLocale());
  resolver.setMessages(messages);
  resolver.setKeepEmptyMacros(true);
  Map<String,CmsXmlContentProperty> propertiesConf=contentHandler.getProperties();
  for (  Map.Entry<String,CmsXmlContentProperty> entry : propertiesConf.entrySet()) {
    String propertyName=entry.getKey();
    CmsXmlContentProperty property=entry.getValue();
    CmsXmlContentProperty newProperty=new CmsXmlContentProperty(propertyName,property.getPropertyType(),property.getWidget(),resolver.resolveMacros(property.getWidgetConfiguration()),property.getRuleRegex(),property.getRuleType(),property.getDefault(),resolver.resolveMacros(property.getNiceName()),resolver.resolveMacros(property.getDescription()),resolver.resolveMacros(property.getError()));
    result.put(propertyName,newProperty);
  }
  return result;
}
