{
  StringBuffer result;
  int i;
  char ch;
  String charRef;
  result=new StringBuffer(source.length());
  for (i=0; i < source.length(); ++i) {
    ch=source.charAt(i);
    charRef=getEntityRef(ch);
    if (charRef == null)     result.append(ch);
 else     result.append('&').append(charRef).append(';');
  }
  return result.toString();
}
