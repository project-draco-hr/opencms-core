{
  CmsObject cms=getCmsObject();
  echo("Testing readResources: reading modified resources");
  cms.getRequestContext().setSiteRoot("/");
  String path="/sites/default/folder2";
  String resourcename;
  resourcename=path + "/subfolder21/subsubfolder211/jsp1.jsp";
  cms.lockResource(resourcename);
  cms.touch(resourcename,System.currentTimeMillis(),0L,0L,false);
  resourcename=path + "/subfolder22/subsubfolder221/page1.html";
  cms.lockResource(resourcename);
  cms.deleteResource(resourcename,I_CmsConstants.C_DELETE_OPTION_PRESERVE_SIBLINGS);
  resourcename=path + "/newpage.html";
  cms.createResource(resourcename,CmsResourceTypeFolder.C_RESOURCE_TYPE_ID);
  storeResources(cms,path + "/newpage.html",false);
  List result=cms.readResources(null,CmsResourceFilter.ALL.addRequireState(I_CmsConstants.C_STATE_NEW));
  int i;
  for (i=0; i < result.size(); i++) {
    assertFilter(cms,(CmsResource)result.get(i),OpenCmsTestResourceFilter.FILTER_EQUAL);
  }
  assertEquals(this.m_currentResourceStrorage.size(),i);
  storeResources(cms,path + "/subfolder21/subsubfolder211/jsp1.jsp",false);
  storeResources(cms,path + "/subfolder22/subsubfolder221/jsp1.jsp",false);
  storeResources(cms,path + "/subfolder22/subsubfolder221/page1.html",false);
  result=cms.readResources(null,CmsResourceFilter.ALL_MODIFIED);
  for (i=0; i < result.size(); i++) {
    assertFilter(cms,(CmsResource)result.get(i),OpenCmsTestResourceFilter.FILTER_EQUAL);
  }
  assertEquals(this.m_currentResourceStrorage.size(),i);
}
