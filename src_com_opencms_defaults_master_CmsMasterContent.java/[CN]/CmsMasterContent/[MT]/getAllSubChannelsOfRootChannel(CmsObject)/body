{
  Vector allChannels=new Vector();
  cms.getRequestContext().saveSiteRoot();
  try {
    String rootChannel=getDbAccessObject(this.getSubId()).getRootChannel();
    cms.getRequestContext().setSiteRoot(I_CmsConstants.VFS_FOLDER_CHANNELS);
    Vector subChannels=new Vector(cms.getResourcesInFolder(rootChannel,CmsResourceFilter.ONLY_VISIBLE));
    int offset=rootChannel.length() - 1;
    for (int i=0; i < subChannels.size(); i++) {
      CmsResource resource=(CmsResource)subChannels.get(i);
      if (resource.getState() != I_CmsConstants.C_STATE_DELETED) {
        String folder=cms.getSitePath(resource);
        Vector v=getAllSubChannelsOf(cms,folder);
        if (v.size() == 0 && cms.hasPermissions(resource,CmsPermissionSet.ACCESS_VIEW)) {
          allChannels.add(folder.substring(offset));
        }
 else {
          for (int j=0; j < v.size(); j++) {
            allChannels.add(((String)v.get(j)).substring(offset));
          }
        }
      }
    }
  }
  finally {
    cms.getRequestContext().restoreSiteRoot();
  }
  return allChannels;
}
