{
  CmsFile file=cms.readFile(resourcename);
  CmsXmlControlFile hXml=new CmsXmlControlFile(cms,file);
  String bodyPath=(I_CmsWpConstants.C_VFS_PATH_BODIES.substring(0,I_CmsWpConstants.C_VFS_PATH_BODIES.lastIndexOf("/"))) + (resourcename);
  String body=hXml.getElementTemplate("body");
  body=hXml.validateBodyPath(cms,body,file);
  String bodyXml=cms.getRequestContext().getDirectoryTranslator().translateResource(I_CmsConstants.VFS_FOLDER_DEFAULT_SITE + body);
  if ((I_CmsConstants.VFS_FOLDER_DEFAULT_SITE + bodyPath).equals(bodyXml)) {
    String destinationFolder=destination.substring(0,destination.lastIndexOf("/") + 1);
    checkFolders(cms,destinationFolder);
    String newbodyPath=(I_CmsWpConstants.C_VFS_PATH_BODIES.substring(0,I_CmsWpConstants.C_VFS_PATH_BODIES.lastIndexOf("/"))) + destination;
    hXml.setElementTemplate("body",newbodyPath);
    cms.doCopyFile(resourcename,destination,lockCopy,copyMode);
    CmsFile newPageFile=cms.readFile(destination);
    newPageFile.setContents(hXml.getXmlText().getBytes());
    cms.writeFile(newPageFile);
    cms.doCopyFile(bodyPath,newbodyPath,lockCopy,copyMode);
    cms.createLinkEntrys(newPageFile.getResourceId(),cms.readLinkEntrys(file.getResourceId()));
  }
 else {
    cms.doCopyFile(resourcename,destination,true,copyMode);
  }
}
