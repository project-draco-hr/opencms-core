{
  if (!cms.hasPermissions(resourcename,I_CmsConstants.C_WRITE_ACCESS)) {
    throw new CmsException(resourcename,CmsException.C_NO_ACCESS);
  }
  CmsFile file=cms.readFile(resourcename);
  cms.doRestoreResource(versionId,resourcename);
  String bodyPath=checkBodyPath(cms,(CmsFile)file);
  if (bodyPath != null) {
    try {
      cms.doRestoreResource(versionId,bodyPath);
    }
 catch (    CmsException e) {
      if (e.getType() == CmsException.C_NOT_FOUND) {
        if (I_CmsLogChannels.C_PREPROCESSOR_IS_LOGGING && A_OpenCms.isLogging()) {
          A_OpenCms.log(A_OpenCms.C_OPENCMS_INFO,"[CmsResourceTypePage] version " + versionId + " of "+ bodyPath+ " not found!");
        }
      }
 else {
        throw e;
      }
    }
  }
  CmsPageLinks linkObject=cms.getPageLinks(cms.readAbsolutePath(file));
  cms.createLinkEntrys(linkObject.getResourceId(),linkObject.getLinkTargets());
}
