{
  CmsFile file=cms.readFile(source);
  CmsXmlControlFile hXml=new CmsXmlControlFile(cms,file);
  String bodyPath=(I_CmsWpConstants.C_VFS_PATH_BODIES.substring(0,I_CmsWpConstants.C_VFS_PATH_BODIES.lastIndexOf("/"))) + (source);
  String body=hXml.getElementTemplate("body");
  body=hXml.validateBodyPath(cms,body,file);
  String bodyXml=cms.getRequestContext().getDirectoryTranslator().translateResource(C_DEFVFS + body);
  if ((C_DEFVFS + bodyPath).equals(bodyXml)) {
    String destinationFolder=destination.substring(0,destination.lastIndexOf("/") + 1);
    checkFolders(cms,destinationFolder);
    String newbodyPath=(I_CmsWpConstants.C_VFS_PATH_BODIES.substring(0,I_CmsWpConstants.C_VFS_PATH_BODIES.lastIndexOf("/"))) + destination;
    hXml.setElementTemplate("body",newbodyPath);
    cms.doCopyFile(source,destination);
    CmsFile newPageFile=cms.readFile(destination);
    newPageFile.setContents(hXml.getXmlText().getBytes());
    cms.writeFile(newPageFile);
    cms.doCopyFile(bodyPath,newbodyPath);
    cms.createLinkEntrys(newPageFile.getResourceId(),cms.readLinkEntrys(file.getResourceId()));
  }
 else {
    cms.doCopyFile(source,destination);
  }
  if (!keepFlags) {
    setDefaultFlags(cms,destination);
  }
}
