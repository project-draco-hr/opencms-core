{
  CmsFile file=cms.readFile(filename);
  if ((cms.getRequestContext().currentUser().equals(cms.readOwner(file))) || (cms.userInGroup(cms.getRequestContext().currentUser().getName(),C_GROUP_ADMIN))) {
    cms.doChmod(filename,flags);
    String bodyPath=checkBodyPath(cms,(CmsFile)file);
    if (bodyPath != null) {
      if ((flags & C_ACCESS_INTERNAL_READ) == 0) {
        flags+=C_ACCESS_INTERNAL_READ;
      }
      cms.doChmod(bodyPath,flags);
    }
  }
}
