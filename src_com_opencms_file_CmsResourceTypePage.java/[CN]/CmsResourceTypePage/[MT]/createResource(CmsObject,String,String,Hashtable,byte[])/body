{
  Vector allMasterTemplates=cms.getFilesInFolder(C_CONTENTTEMPLATEPATH);
  String masterTemplate="";
  if (allMasterTemplates.size() > 0) {
    masterTemplate=((CmsFile)allMasterTemplates.elementAt(0)).getAbsolutePath();
  }
  String bodyFolder=(C_CONTENTBODYPATH.substring(0,C_CONTENTBODYPATH.lastIndexOf("/"))) + folder;
  CmsFile file=cms.doCreateFile(folder,name,"".getBytes(),m_resourceTypeName,properties);
  cms.doLockResource(folder + name,true);
  CmsXmlControlFile pageXml=new CmsXmlControlFile(cms,file);
  pageXml.setTemplateClass(C_CLASSNAME);
  pageXml.setMasterTemplate(masterTemplate);
  pageXml.setElementClass("body",C_CLASSNAME);
  pageXml.setElementTemplate("body",bodyFolder + name);
  pageXml.write();
  checkFolders(cms,folder);
  CmsFile bodyFile=cms.doCreateFile(bodyFolder,name,(C_DEFAULTBODY_START + new String(contents) + C_DEFAULTBODY_END).getBytes(),I_CmsConstants.C_TYPE_PLAIN_NAME,new Hashtable());
  cms.doLockResource(bodyFolder + name,true);
  int flags=bodyFile.getAccessFlags();
  if ((flags & C_ACCESS_INTERNAL_READ) == 0) {
    flags+=C_ACCESS_INTERNAL_READ;
  }
  cms.chmod(bodyFile.getAbsolutePath(),flags);
  return file;
}
