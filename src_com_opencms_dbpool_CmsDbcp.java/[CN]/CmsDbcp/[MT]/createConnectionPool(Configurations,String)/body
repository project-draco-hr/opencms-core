{
  String jdbcDriver=config.getString(key + "." + C_KEY_JDBC_DRIVER);
  String jdbcUrl=config.getString(key + "." + C_KEY_JDBC_URL);
  int maxActive=config.getInteger(key + "." + C_KEY_MAX_ACTIVE);
  int maxWait=config.getInteger(key + "." + C_KEY_MAX_WAIT);
  int maxIdle=config.getInteger(key + "." + C_KEY_MAX_IDLE);
  String testQuery=config.getString(key + "." + C_KEY_TEST_QUERY);
  String username=config.getString(key + "." + C_KEY_USERNAME);
  String password=config.getString(key + "." + C_KEY_PASSWORD);
  String poolUrl=config.getString(key + "." + C_KEY_POOL_URL);
  Class.forName(jdbcDriver).newInstance();
  GenericObjectPool connectionPool=new GenericObjectPool(null);
  connectionPool.setMaxActive(maxActive);
  connectionPool.setMaxIdle(maxIdle);
  connectionPool.setMaxWait(maxWait);
  ConnectionFactory connectionFactory=new DriverManagerConnectionFactory(jdbcUrl,username,password);
  KeyedObjectPoolFactory statementFactory=new StackKeyedObjectPoolFactory(5000);
  new PoolableConnectionFactory(connectionFactory,connectionPool,statementFactory,testQuery,false,true);
  PoolingDriver driver=new PoolingDriver();
  driver.registerPool(poolUrl,connectionPool);
  return poolUrl;
}
