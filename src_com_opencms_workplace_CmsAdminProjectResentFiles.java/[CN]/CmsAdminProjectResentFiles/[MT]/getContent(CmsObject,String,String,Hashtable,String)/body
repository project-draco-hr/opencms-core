{
  HttpServletRequest orgReq=(HttpServletRequest)cms.getRequestContext().getRequest().getOriginalRequest();
  HttpSession session=orgReq.getSession(true);
  CmsXmlWpTemplateFile xmlTemplateDocument=(CmsXmlWpTemplateFile)getOwnTemplateFile(cms,templateFile,elementName,parameters,templateSelector);
  String filter=(String)parameters.get("filter");
  String action=(String)parameters.get("action");
  xmlTemplateDocument.setData("onload","");
  if ("restoreproject".equals(action)) {
    Integer oldId=(Integer)session.getValue("oldProjectId");
    if (oldId != null) {
      cms.getRequestContext().setCurrentProject(oldId.intValue());
    }
    session.removeValue("oldProjectId");
    try {
      cms.getRequestContext().getResponse().sendCmsRedirect(getConfigFile(cms).getWorkplaceActionPath() + "administration_head_5.html");
    }
 catch (    IOException exc) {
      throw new CmsException("Could not redirect to administration_head_5.html",exc);
    }
    return null;
  }
  if (filter == null) {
    filter="all";
    if (session.getValue("oldProjectId") == null) {
      int projectId=Integer.parseInt((String)parameters.get("projectid"));
      session.putValue("oldProjectId",new Integer(cms.getRequestContext().currentProject().getId()));
      cms.getRequestContext().setCurrentProject(projectId);
      xmlTemplateDocument.setData("onload","window.top.body.admin_head.location.href='administration_head_4.html';");
    }
  }
  session.putValue("filter",filter);
  return startProcessing(cms,xmlTemplateDocument,elementName,parameters,templateSelector);
}
