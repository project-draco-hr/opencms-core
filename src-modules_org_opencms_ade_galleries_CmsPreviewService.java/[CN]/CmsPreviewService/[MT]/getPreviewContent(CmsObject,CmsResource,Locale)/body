{
  try {
    if (CmsResourceTypeXmlContent.isXmlContent(resource)) {
      CmsFormatterBean formatter=OpenCms.getADEManager().getFormatterForContainer(cms,resource,CmsFormatterBean.PREVIEW_TYPE,-1);
      if (formatter != null) {
        CmsResource formatterResource=cms.readResource(formatter.getJspRootPath());
        CmsContainerElementBean element=new CmsContainerElementBean(resource.getStructureId(),formatterResource.getStructureId(),null,false);
        element.initResource(cms);
        CmsTemplateLoaderFacade loaderFacade=new CmsTemplateLoaderFacade(OpenCms.getResourceManager().getLoader(formatterResource),element.getResource(),formatterResource);
        CmsResource loaderRes=loaderFacade.getLoaderStartResource();
        CmsContainerBean containerBean=new CmsContainerBean("PREVIEW",CmsFormatterBean.PREVIEW_TYPE,CmsFormatterBean.PREVIEW_WIDTH,Collections.<CmsContainerElementBean>emptyList());
        getRequest().setAttribute(CmsJspStandardContextBean.ATTRIBUTE_CMS_OBJECT,cms);
        CmsJspStandardContextBean standardContext=CmsJspStandardContextBean.getInstance(getRequest());
        standardContext.setContainer(containerBean);
        standardContext.setElement(element);
        standardContext.setDndMode(true);
        standardContext.setPage(new CmsContainerPageBean(locale,Collections.<CmsContainerBean>singletonList(containerBean)));
        String encoding=getResponse().getCharacterEncoding();
        return (new String(loaderFacade.getLoader().dump(cms,loaderRes,null,locale,getRequest(),getResponse()),encoding)).trim();
      }
    }
  }
 catch (  Exception e) {
  }
  return null;
}
