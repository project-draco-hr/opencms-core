{
  Set resources=new HashSet();
  CmsRelationFilter filter=CmsRelationFilter.SOURCES.filterType(CmsRelationType.CATEGORY);
  if (recursive) {
    filter=filter.filterIncludeChildren();
  }
  CmsCategory category=readCategory(cms,categoryPath,referencePath);
  Iterator itRelations=cms.getRelationsForResource(cms.getRequestContext().removeSiteRoot(category.getRootPath()),filter).iterator();
  while (itRelations.hasNext()) {
    CmsRelation relation=(CmsRelation)itRelations.next();
    try {
      resources.add(relation.getSource(cms,CmsResourceFilter.DEFAULT));
    }
 catch (    CmsException e) {
      if (LOG.isErrorEnabled()) {
        LOG.error(e.getLocalizedMessage(),e);
      }
    }
  }
  List result=new ArrayList(resources);
  Collections.sort(result);
  return result;
}
