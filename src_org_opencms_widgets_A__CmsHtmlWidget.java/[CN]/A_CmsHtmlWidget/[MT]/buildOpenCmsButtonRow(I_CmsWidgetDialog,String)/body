{
  StringBuffer result=new StringBuffer(2048);
  boolean buttonsActive=false;
  result.append(buildOpenCmsButtonRow(CmsWorkplace.HTML_START,widgetDialog));
  if (getHtmlWidgetOption().showLinkDialog()) {
    result.append(widgetDialog.button("javascript:setActiveEditor('" + paramId + "');openLinkDialog('"+ Messages.get().getBundle(widgetDialog.getLocale()).key(Messages.GUI_BUTTON_LINKTO_0)+ "');",null,"link","button.linkto",widgetDialog.getButtonStyle()));
    buttonsActive=true;
  }
  if (getHtmlWidgetOption().showAnchorDialog()) {
    result.append(widgetDialog.button("javascript:setActiveEditor('" + paramId + "');openAnchorDialog('"+ Messages.get().getBundle(widgetDialog.getLocale()).key(Messages.ERR_EDITOR_MESSAGE_NOSELECTION_0)+ "');",null,"anchor",Messages.GUI_BUTTON_ANCHOR_0,widgetDialog.getButtonStyle()));
    buttonsActive=true;
  }
  Map galleryMap=OpenCms.getWorkplaceManager().getGalleries();
  List galleries=new ArrayList(galleryMap.values());
  Collections.sort(galleries);
  StringBuffer galleryResult=new StringBuffer(256);
  boolean showGallery=false;
  for (int k=0; k < galleries.size(); k++) {
    A_CmsGallery currGallery=(A_CmsGallery)galleries.get(k);
    String galleryType=currGallery.getResourceType().getTypeName();
    if (getHtmlWidgetOption().showGalleryDialog(galleryType)) {
      galleryResult.append(widgetDialog.button("javascript:setActiveEditor('" + paramId + "');openGallery('"+ galleryType+ "');",null,galleryType,Messages.getButtonName(CmsStringUtil.substitute(galleryType,"gallery","")),widgetDialog.getButtonStyle()));
      showGallery=true;
    }
  }
  if (showGallery) {
    if (buttonsActive) {
      result.append(widgetDialog.buttonBarSeparator(5,5));
    }
    result.append(galleryResult);
    buttonsActive=true;
  }
  if (!buttonsActive) {
    return "";
  }
  result.append(buildOpenCmsButtonRow(CmsWorkplace.HTML_END,widgetDialog));
  return result.toString();
}
