{
  if (OpenCms.isLogging(CmsLog.CHANNEL_WORKPLACE_XML,CmsLog.LEVEL_WARN) && C_DEBUG) {
    OpenCms.log(CmsLog.CHANNEL_WORKPLACE_XML,CmsLog.LEVEL_WARN,this.getClassName() + "getting content of element " + ((elementName == null) ? "<root>" : elementName));
    OpenCms.log(CmsLog.CHANNEL_WORKPLACE_XML,CmsLog.LEVEL_WARN,this.getClassName() + "template file is: " + templateFile);
    OpenCms.log(CmsLog.CHANNEL_WORKPLACE_XML,CmsLog.LEVEL_WARN,this.getClassName() + "selected template section is: " + ((templateSelector == null) ? "<default>" : templateSelector));
  }
  CmsXmlTemplateFile xmlTemplateDocument=getOwnTemplateFile(cms,templateFile,elementName,parameters,templateSelector);
  I_CmsSession session=cms.getRequestContext().getSession(true);
  Vector files=(Vector)session.getValue(C_SESSION_MODULE_VECTOR);
  String step=(String)parameters.get(C_STEP);
  if (step == null) {
    String list="";
    for (int i=0; i < files.size(); i++) {
      xmlTemplateDocument.setData(C_FILENAME,(String)files.elementAt(i));
      list+=xmlTemplateDocument.getProcessedDataValue(C_LISTENTRY);
    }
    xmlTemplateDocument.setData(C_LIST,list);
  }
 else {
    Vector outFiles=new Vector();
    for (int i=0; i < files.size(); i++) {
      String file=(String)files.elementAt(i);
      String test=(String)parameters.get(file);
      if (test == null) {
        outFiles.addElement(file);
      }
    }
    session.putValue(C_SESSION_MODULE_VECTOR,outFiles);
    templateSelector=C_READY;
  }
  return startProcessing(cms,xmlTemplateDocument,elementName,parameters,templateSelector);
}
