{
  if (res == null) {
    return target;
  }
  try {
    I_CmsDetailPageFinder finder=OpenCms.getSitemapManager().getDetailPageFinder();
    String detailPage=finder.getDetailPage(cms,res,cms.getRequestContext().getUri());
    if (detailPage == null) {
      return target;
    }
    String urlName=cms.readNewestUrlNameForId(res.getStructureId());
    return CmsStringUtil.joinPaths(detailPage,urlName,"/");
  }
 catch (  CmsException e) {
    LOG.warn(e.getLocalizedMessage(),e);
    return target;
  }
}
