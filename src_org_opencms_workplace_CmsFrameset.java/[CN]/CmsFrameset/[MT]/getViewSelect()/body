{
  CmsRequestContext reqCont=getCms().getRequestContext();
  String currentView=(String)getSession().getAttribute(I_CmsWpConstants.C_PARA_VIEW);
  if (currentView == null) {
    Hashtable startSettings=(Hashtable)reqCont.currentUser().getAdditionalInfo(I_CmsConstants.C_ADDITIONAL_INFO_STARTSETTINGS);
    if (startSettings != null) {
      currentView=(String)startSettings.get(I_CmsConstants.C_START_VIEW);
    }
  }
  System.err.println("currentView: " + currentView);
  Vector viewNames=new Vector();
  Vector viewLinks=new Vector();
  List options=new ArrayList();
  List values=new ArrayList();
  int currentViewIndex=-1;
  int numViews=0;
  try {
    numViews=(getCms().getRegistry()).getViews(viewNames,viewLinks);
  }
 catch (  CmsException e) {
  }
  for (int i=0; i < numViews; i++) {
    String loopName=(String)viewNames.elementAt(i);
    String loopLink=(String)viewLinks.elementAt(i);
    boolean visible=true;
    try {
      getCms().readFileHeader(loopLink);
    }
 catch (    CmsException e) {
      visible=false;
    }
    if (visible) {
      loopLink=getJsp().link(loopLink);
      if (loopLink.equals(currentView)) {
        currentViewIndex=values.size();
      }
      options.add(key(loopName));
      values.add(loopLink);
    }
  }
  return buildSelect("class=\"textfeld\" name=\"wpView\" style=\"width:150px\" onchange=\"document.forms.wpViewSelect.submit()\"",options,values,currentViewIndex);
}
