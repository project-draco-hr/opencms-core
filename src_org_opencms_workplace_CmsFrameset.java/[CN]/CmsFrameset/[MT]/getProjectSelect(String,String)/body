{
  List allProjects;
  try {
    allProjects=getCms().getAllAccessibleProjects();
  }
 catch (  CmsException e) {
    if (OpenCms.getLog(this).isInfoEnabled()) {
      OpenCms.getLog(this).info(e);
    }
    allProjects=Collections.EMPTY_LIST;
  }
  List options=new ArrayList();
  List values=new ArrayList();
  int selectedIndex=0;
  int maxNameLength=0;
  for (int i=0, n=allProjects.size(); i < n; i++) {
    CmsProject loopProject=(CmsProject)allProjects.get(i);
    String loopProjectName=loopProject.getName();
    String loopProjectId=Integer.toString(loopProject.getId());
    values.add(loopProjectId);
    options.add(loopProjectName);
    if (loopProject.getId() == getSettings().getProject()) {
      selectedIndex=i;
    }
    maxNameLength=Math.max(loopProjectName.length(),maxNameLength);
  }
  if (maxNameLength <= 20) {
    StringBuffer buf=new StringBuffer(htmlAttributes.length() + htmlWidth.length() + 5);
    buf.append(htmlAttributes);
    buf.append(" ");
    buf.append(htmlWidth);
    htmlAttributes=buf.toString();
  }
  return buildSelect(htmlAttributes,options,values,selectedIndex);
}
