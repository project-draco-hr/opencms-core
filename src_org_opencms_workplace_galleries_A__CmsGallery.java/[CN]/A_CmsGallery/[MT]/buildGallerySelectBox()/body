{
  List galleries=getGalleries();
  if (galleries != null && galleries.size() == 1) {
    CmsResource res=(CmsResource)galleries.get(0);
    StringBuffer result=new StringBuffer(32);
    String path=getCms().getSitePath(res);
    String title="";
    try {
      title=getCms().readPropertyObject(path,CmsPropertyDefinition.PROPERTY_TITLE,false).getValue("");
    }
 catch (    CmsException e) {
      LOG.error(e);
    }
    result.append(title);
    result.append(" (");
    result.append(path);
    result.append(" )\r\n");
    result.append("<input type=\"hidden\" name=\"");
    result.append(PARAM_GALLERYPATH);
    result.append("\" value=\"");
    result.append(path);
    result.append("\">");
    return result.toString();
  }
 else   if (galleries.size() > 1) {
    int galleryCount=galleries.size();
    List options=new ArrayList(galleryCount);
    List values=new ArrayList(galleryCount);
    int selectedIndex=-1;
    for (int i=0; i < galleryCount; i++) {
      CmsResource res=(CmsResource)galleries.get(i);
      String path=getCms().getSitePath(res);
      if (path.equals(getParamGalleryPath())) {
        selectedIndex=i;
      }
      String title="";
      try {
        title=getCms().readPropertyObject(path,CmsPropertyDefinition.PROPERTY_TITLE,false).getValue("");
      }
 catch (      CmsException e) {
        if (LOG.isErrorEnabled()) {
          LOG.error(e);
        }
      }
      options.add(title + " (" + path+ ")");
      values.add(path);
    }
    selectedIndex=sortOptions(options,values);
    String attrs="name=\"" + PARAM_GALLERYPATH;
    attrs+="\" size=\"1\" style=\"width: 100%;\" onchange=\"displayGallery();\"";
    return buildSelect(attrs,options,values,selectedIndex);
  }
 else {
    StringBuffer result=new StringBuffer(4);
    result.append(key("error.reason.no." + getGalleryTypeName()));
    result.append("\r\n<input type=\"hidden\" name=\"");
    result.append(PARAM_GALLERYPATH);
    result.append("\">");
    return result.toString();
  }
}
