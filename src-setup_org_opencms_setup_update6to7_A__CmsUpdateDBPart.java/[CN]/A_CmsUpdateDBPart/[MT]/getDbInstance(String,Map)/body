{
  m_poolData=new HashMap(dbPoolData);
  if (dbName.indexOf("mysql") > -1) {
    String engine="MYISAM";
    CmsSetupDb setupDb=new CmsSetupDb(null);
    CmsSetupDBWrapper db=null;
    try {
      setupDb.setConnection((String)m_poolData.get("driver"),(String)m_poolData.get("url"),(String)m_poolData.get("params"),(String)m_poolData.get("user"),(String)m_poolData.get("pwd"));
      db=setupDb.executeSqlStatement("SHOW TABLE STATUS LIKE 'CMS_GROUPS';",null);
      if (db.getResultSet().next()) {
        engine=db.getResultSet().getString("Engine").toUpperCase();
      }
    }
 catch (    SQLException e) {
      e.printStackTrace();
    }
 finally {
      if (db != null) {
        db.close();
      }
      setupDb.closeConnection();
    }
    m_poolData.put("engine",engine);
    System.out.println("Table engine:               " + engine);
    return getInstanceForDb("mysql");
  }
 else   if (dbName.indexOf("oracle") > -1) {
    String dataTablespace="users";
    String indexTablespace="users";
    CmsSetupDb setupDb=new CmsSetupDb(null);
    try {
      setupDb.setConnection((String)m_poolData.get("driver"),(String)m_poolData.get("url"),(String)m_poolData.get("params"),(String)m_poolData.get("user"),(String)m_poolData.get("pwd"));
      CmsSetupDBWrapper db=null;
      try {
        db=setupDb.executeSqlStatement("SELECT DISTINCT tablespace_name FROM user_tables",null);
        if (db.getResultSet().next()) {
          dataTablespace=db.getResultSet().getString(1).toLowerCase();
        }
      }
  finally {
        if (db != null) {
          db.close();
        }
      }
      try {
        db=setupDb.executeSqlStatement("SELECT DISTINCT tablespace_name FROM user_indexes",null);
        if (db.getResultSet().next()) {
          indexTablespace=db.getResultSet().getString(1).toLowerCase();
        }
      }
  finally {
        if (db != null) {
          db.close();
        }
      }
    }
 catch (    SQLException e) {
      e.printStackTrace();
    }
 finally {
      setupDb.closeConnection();
    }
    m_poolData.put("indexTablespace",indexTablespace);
    System.out.println("Index Tablespace:           " + indexTablespace);
    m_poolData.put("dataTablespace",dataTablespace);
    System.out.println("Data Tablespace:            " + dataTablespace);
    return getInstanceForDb("oracle");
  }
 else   if (dbName.indexOf("postgresql") > -1) {
    String dataTablespace="pg_default";
    String indexTablespace="pg_default";
    CmsSetupDb setupDb=new CmsSetupDb(null);
    try {
      setupDb.setConnection((String)m_poolData.get("driver"),(String)m_poolData.get("url"),(String)m_poolData.get("params"),(String)m_poolData.get("user"),(String)m_poolData.get("pwd"));
      CmsSetupDBWrapper db=null;
      try {
        db=setupDb.executeSqlStatement("SELECT DISTINCT pg_tablespace.spcname FROM pg_class, pg_tablespace WHERE pg_class.relname='cms_user' AND pg_class.reltablespace = pg_tablespace.oid",null);
        if (db.getResultSet().next()) {
          dataTablespace=db.getResultSet().getString(1).toLowerCase();
        }
      }
  finally {
        if (db != null) {
          db.close();
        }
      }
      try {
        db=setupDb.executeSqlStatement("SELECT DISTINCT pg_tablespace.spcname FROM pg_class, pg_tablespace WHERE pg_class.relname='cms_users_pkey' AND pg_class.reltablespace = pg_tablespace.oid",null);
        if (db.getResultSet().next()) {
          indexTablespace=db.getResultSet().getString(1).toLowerCase();
        }
      }
  finally {
        if (db != null) {
          db.close();
        }
      }
    }
 catch (    SQLException e) {
      e.printStackTrace();
    }
 finally {
      setupDb.closeConnection();
    }
    m_poolData.put("indexTablespace",indexTablespace);
    System.out.println("Index Tablespace:           " + indexTablespace);
    m_poolData.put("dataTablespace",dataTablespace);
    System.out.println("Data Tablespace:            " + dataTablespace);
    return getInstanceForDb("postgresql");
  }
 else {
    System.out.println("db " + dbName + " not supported");
    return null;
  }
}
