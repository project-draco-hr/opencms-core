{
  CmsProject project=null;
  if ((description == null) || (description.length() < 1)) {
    description=" ";
  }
  long createTime=System.currentTimeMillis();
  Connection conn=null;
  PreparedStatement stmt=null;
  int id=CmsDbUtil.UNKNOWN_ID;
  try {
    if (reservedParam == null) {
      id=m_sqlManager.nextId(TABLE_PROJECTS);
      conn=m_sqlManager.getConnection(dbc);
    }
 else {
      id=((Integer)((Map)reservedParam).get("pkProjectId")).intValue();
      int projectId=((Integer)((Map)reservedParam).get("projectId")).intValue();
      conn=m_sqlManager.getConnection(dbc,projectId);
    }
    stmt=m_sqlManager.getPreparedStatement(conn,"C_PROJECTS_CREATE");
    stmt.setInt(1,id);
    stmt.setString(2,owner.getId().toString());
    stmt.setString(3,group.getId().toString());
    stmt.setString(4,managergroup.getId().toString());
    stmt.setInt(5,task.getId());
    stmt.setString(6,name);
    stmt.setString(7,description);
    stmt.setInt(8,flags);
    stmt.setLong(9,createTime);
    stmt.setInt(10,type);
    stmt.executeUpdate();
    project=new CmsProject(id,name,description,task.getId(),owner.getId(),group.getId(),managergroup.getId(),flags,createTime,type);
  }
 catch (  SQLException e) {
    throw new CmsDbSqlException(Messages.get().container(Messages.ERR_GENERIC_SQL_1,CmsDbSqlException.getErrorQuery(stmt)),e);
  }
 finally {
    m_sqlManager.closeAll(dbc,conn,stmt,null);
  }
  return project;
}
