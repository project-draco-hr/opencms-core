{
  CmsFile offlineFile=null;
  byte[] contents=null;
  String encoding=null;
  try {
    if (offlineFile == null) {
      offlineFile=m_driverManager.getVfsDriver().readFile(context.currentProject().getId(),false,offlineResource.getStructureId());
      offlineFile.setFullResourceName(offlineResource.getRootPath());
    }
    contents=offlineFile.getContents();
    encoding=m_driverManager.getVfsDriver().readProperty(I_CmsConstants.C_PROPERTY_CONTENT_ENCODING,context.currentProject().getId(),offlineFile,offlineFile.getType());
    if (encoding != null) {
      try {
        contents=(new String(contents,encoding)).getBytes();
      }
 catch (      UnsupportedEncodingException uex) {
      }
    }
    discAccess.writeFile(offlineResource.getRootPath(),exportKey,contents);
  }
 catch (  Exception e) {
    if (OpenCms.getLog(this).isErrorEnabled()) {
      OpenCms.getLog(this).error("Error writing export point of " + offlineResource.toString(),e);
    }
    throw e;
  }
}
