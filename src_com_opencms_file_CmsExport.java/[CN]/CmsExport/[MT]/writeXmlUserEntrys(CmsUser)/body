{
  String name, password, recoveryPassword, description, firstname;
  String lastname, email, flags, defaultGroup, address, section, type;
  Hashtable info=null;
  Vector userGroups=null;
  sun.misc.BASE64Encoder enc;
  name=user.getName();
  password=user.getPassword();
  recoveryPassword=user.getRecoveryPassword();
  description=user.getDescription();
  firstname=user.getFirstname();
  lastname=user.getLastname();
  email=user.getEmail();
  flags=Integer.toString(user.getFlags());
  info=user.getAdditionalInfo();
  defaultGroup=user.getDefaultGroup().getName();
  address=user.getAddress();
  section=user.getSection();
  type=Integer.toString(user.getType());
  userGroups=m_cms.getDirectGroupsOfUser(user.getName());
  Element userdata=m_docXml.createElement(C_EXPORT_TAG_USERDATA);
  m_userdataElement.appendChild(userdata);
  addElement(userdata,C_EXPORT_TAG_NAME,name);
  enc=new sun.misc.BASE64Encoder();
  String passwd=new String(enc.encodeBuffer(password.getBytes()));
  addCdataElement(userdata,C_EXPORT_TAG_PASSWORD,passwd);
  enc=new sun.misc.BASE64Encoder();
  String recPasswd=new String(enc.encodeBuffer(recoveryPassword.getBytes()));
  addCdataElement(userdata,C_EXPORT_TAG_RECOVERYPASSWORD,recPasswd);
  addCdataElement(userdata,C_EXPORT_TAG_DESCRIPTION,description);
  addElement(userdata,C_EXPORT_TAG_FIRSTNAME,firstname);
  addElement(userdata,C_EXPORT_TAG_LASTNAME,lastname);
  addElement(userdata,C_EXPORT_TAG_EMAIL,email);
  addElement(userdata,C_EXPORT_TAG_FLAGS,flags);
  addElement(userdata,C_EXPORT_TAG_DEFAULTGROUP,defaultGroup);
  addCdataElement(userdata,C_EXPORT_TAG_ADDRESS,address);
  addElement(userdata,C_EXPORT_TAG_SECTION,section);
  addElement(userdata,C_EXPORT_TAG_TYPE,type);
  Element userinfos=m_docXml.createElement(C_EXPORT_TAG_USERINFOS);
  userdata.appendChild(userinfos);
  Enumeration keys=info.keys();
  while (keys.hasMoreElements()) {
    Element userinfo=m_docXml.createElement(C_EXPORT_TAG_INFO);
    userinfos.appendChild(userinfo);
    String key=(String)keys.nextElement();
    String value=(String)info.get(key);
    addElement(userinfo,C_EXPORT_TAG_NAME,key);
    enc=new sun.misc.BASE64Encoder();
    String infostr=new String(enc.encodeBuffer(value.getBytes()));
    addCdataElement(userinfo,C_EXPORT_TAG_VALUE,infostr);
  }
  Element usergroup=m_docXml.createElement(C_EXPORT_TAG_USERGROUPS);
  userdata.appendChild(usergroup);
  for (int i=0; i < userGroups.size(); i++) {
    String groupName=((CmsGroup)userGroups.elementAt(i)).getName();
    addElement(usergroup,C_EXPORT_TAG_NAME,groupName);
  }
}
