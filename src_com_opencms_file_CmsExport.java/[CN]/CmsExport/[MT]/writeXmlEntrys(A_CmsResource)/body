{
  String source, type, user, group, access;
  source=getSourceFilename(resource.getAbsolutePath());
  type=m_cms.getResourceType(resource.getType()).getResourceName();
  user=m_cms.readOwner(resource).getName();
  group=m_cms.readGroup(resource).getName();
  access=resource.getAccessFlags() + "";
  Element file=m_docXml.createElement(C_TAG_FILE);
  m_filesElement.appendChild(file);
  if (resource.isFile()) {
    addElement(file,C_TAG_SOURCE,source);
  }
  addElement(file,C_TAG_DESTINATION,source);
  addElement(file,C_TAG_TYPE,type);
  addElement(file,C_TAG_USER,user);
  addElement(file,C_TAG_GROUP,group);
  addElement(file,C_TAG_ACCESS,access);
  Element properties=m_docXml.createElement(C_TAG_PROPERTIES);
  file.appendChild(properties);
  Hashtable fileProperties=m_cms.readAllProperties(resource.getAbsolutePath());
  Enumeration keys=fileProperties.keys();
  while (keys.hasMoreElements()) {
    Element property=m_docXml.createElement(C_TAG_PROPERTY);
    properties.appendChild(property);
    String key=(String)keys.nextElement();
    String value=(String)fileProperties.get(key);
    String propertyType=m_cms.readPropertydefinition(key,type).getType() + "";
    addElement(property,C_TAG_NAME,key);
    addElement(property,C_TAG_TYPE,propertyType);
    addCdataElement(property,C_TAG_VALUE,value);
  }
}
