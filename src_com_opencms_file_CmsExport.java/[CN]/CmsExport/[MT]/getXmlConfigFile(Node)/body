{
  try {
    m_docXml=A_CmsXmlContent.getXmlParser().createEmptyDocument(C_EXPORT_TAG_EXPORT);
    Node exportNode=m_docXml.getFirstChild();
    exportNode.appendChild(m_docXml.createComment("Creator: " + m_cms.getRequestContext().currentUser().getName()));
    exportNode.appendChild(m_docXml.createComment("Createdate: " + Utils.getNiceDate(new Date().getTime())));
    exportNode.appendChild(m_docXml.createComment("CurrentProject: " + m_cms.getRequestContext().currentProject().getName()));
    if (moduleNode != null) {
      exportNode.appendChild(A_CmsXmlContent.getXmlParser().importNode(m_docXml,moduleNode));
      NodeList files=((Element)exportNode).getElementsByTagName("files");
      if (files.getLength() == 1) {
        files.item(0).getParentNode().removeChild(files.item(0));
      }
    }
    m_filesElement=m_docXml.createElement(C_EXPORT_TAG_FILES);
    m_docXml.getDocumentElement().appendChild(m_filesElement);
    if (m_exportUserdata) {
      m_userdataElement=m_docXml.createElement(C_EXPORT_TAG_USERGROUPDATA);
      m_docXml.getDocumentElement().appendChild(m_userdataElement);
    }
  }
 catch (  Exception exc) {
    throw new CmsException(CmsException.C_UNKNOWN_EXCEPTION,exc);
  }
}
