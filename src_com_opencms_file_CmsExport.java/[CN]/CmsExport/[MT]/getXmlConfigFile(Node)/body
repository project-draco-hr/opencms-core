{
  try {
    if (m_exportingModuleData) {
      m_docXml=A_CmsXmlContent.getXmlParser().createEmptyDocument(C_EXPORT_TAG_MODULEXPORT);
    }
 else {
      m_docXml=A_CmsXmlContent.getXmlParser().createEmptyDocument(C_EXPORT_TAG_EXPORT);
    }
    Node exportNode=m_docXml.getFirstChild();
    Element info=m_docXml.createElement(C_EXPORT_TAG_INFO);
    m_docXml.getDocumentElement().appendChild(info);
    addElement(m_docXml,info,C_EXPORT_TAG_CREATOR,m_cms.getRequestContext().currentUser().getName());
    addElement(m_docXml,info,C_EXPORT_TAG_OC_VERSION,A_OpenCms.getVersionName());
    addElement(m_docXml,info,C_EXPORT_TAG_DATE,Utils.getNiceDate(new Date().getTime()));
    addElement(m_docXml,info,C_EXPORT_TAG_PROJECT,m_cms.getRequestContext().currentProject().getName());
    addElement(m_docXml,info,C_EXPORT_TAG_VERSION,C_EXPORT_VERSION);
    if (moduleNode != null) {
      exportNode.appendChild(A_CmsXmlContent.getXmlParser().importNode(m_docXml,moduleNode));
      NodeList files=((Element)exportNode).getElementsByTagName("files");
      if (files.getLength() == 1) {
        files.item(0).getParentNode().removeChild(files.item(0));
      }
    }
    if (m_exportingModuleData) {
      m_filesElement=m_docXml.createElement(C_EXPORT_TAG_CHANNELS);
      m_docXml.getDocumentElement().appendChild(m_filesElement);
      m_mastersElement=m_docXml.createElement(C_EXPORT_TAG_MASTERS);
      m_docXml.getDocumentElement().appendChild(m_mastersElement);
    }
 else {
      m_filesElement=m_docXml.createElement(C_EXPORT_TAG_FILES);
      m_docXml.getDocumentElement().appendChild(m_filesElement);
    }
    if (m_exportUserdata) {
      m_userdataElement=m_docXml.createElement(C_EXPORT_TAG_USERGROUPDATA);
      m_docXml.getDocumentElement().appendChild(m_userdataElement);
    }
  }
 catch (  Exception exc) {
    throw new CmsException(CmsException.C_UNKNOWN_EXCEPTION,exc);
  }
}
