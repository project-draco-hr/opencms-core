{
  String source=getSourceFilename(file.getAbsolutePath());
  m_report.print(m_report.key("report.exporting"),I_CmsReport.C_FORMAT_NOTE);
  m_report.print(file.getAbsolutePath());
  m_report.print(m_report.key("report.dots"),I_CmsReport.C_FORMAT_NOTE);
  try {
    writeXmlEntrys((CmsResource)file);
    ZipEntry entry=new ZipEntry(source);
    m_exportZipStream.putNextEntry(entry);
    m_exportZipStream.write(file.getContents());
    m_exportZipStream.closeEntry();
  }
 catch (  Exception exc) {
    m_report.println(exc);
    throw new CmsException(CmsException.C_UNKNOWN_EXCEPTION,exc);
  }
  if (file.getType() == m_pageType) {
    m_exportedPageFiles.add(file.getAbsolutePath());
  }
  m_report.println(m_report.key("report.ok"),I_CmsReport.C_FORMAT_OK);
}
