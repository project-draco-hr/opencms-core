{
  Vector subFolders=m_cms.getSubFolders(path);
  Vector subFiles=m_cms.getFilesInFolder(path);
  for (int i=0; i < subFiles.size(); i++) {
    CmsResource file=(CmsResource)subFiles.elementAt(i);
    int state=file.getState();
    if (m_isOnlineProject || (!m_excludeUnchanged) || state == C_STATE_NEW || state == C_STATE_CHANGED) {
      if ((state != C_STATE_DELETED) && (!file.getName().startsWith("~"))) {
        exportFile(m_cms.readFile(file.getAbsolutePath()));
      }
    }
  }
  for (int i=0; i < subFolders.size(); i++) {
    CmsResource folder=(CmsResource)subFolders.elementAt(i);
    if (folder.getState() != C_STATE_DELETED) {
      if (folder.getAbsolutePath().startsWith("/system/") || folder.getAbsolutePath().startsWith("/pics/system/") || folder.getAbsolutePath().startsWith("/moduledemos/")) {
        if (!m_excludeSystem) {
          writeXmlEntrys(folder);
          exportResources(folder.getAbsolutePath());
        }
      }
 else {
        writeXmlEntrys(folder);
        exportResources(folder.getAbsolutePath());
      }
    }
  }
}
