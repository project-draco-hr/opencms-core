{
  m_exportFile=exportFile;
  m_cms=cms;
  m_includeSystem=includeSystem;
  Vector folderNames=new Vector();
  Vector fileNames=new Vector();
  for (int i=0; i < exportPaths.length; i++) {
    if (exportPaths[i].endsWith(C_ROOT)) {
      folderNames.addElement(exportPaths[i]);
    }
 else {
      fileNames.addElement(exportPaths[i]);
    }
  }
  if (includeSystem) {
    folderNames.addElement("/system/");
  }
  getExportResource();
  getXmlConfigFile();
  checkRedundancies(folderNames,fileNames);
  for (int i=0; i < folderNames.size(); i++) {
    String path=(String)folderNames.elementAt(i);
    addSuperFolders(path);
    exportResources(path);
  }
  addSingleFiles(fileNames);
  writeXmlConfigFile();
  try {
    m_exportZipStream.close();
  }
 catch (  IOException exc) {
    throw new CmsException(CmsException.C_UNKNOWN_EXCEPTION,exc);
  }
}
