{
  m_exportFile=exportFile;
  m_cms=cms;
  m_excludeSystem=excludeSystem;
  m_excludeUnchanged=excludeUnchanged;
  m_exportUserdata=exportUserdata;
  m_isOnlineProject=cms.getRequestContext().currentProject().equals(cms.onlineProject());
  m_contentAge=contentAge;
  m_report=report;
  Vector folderNames=new Vector();
  Vector fileNames=new Vector();
  for (int i=0; i < exportPaths.length; i++) {
    if (exportPaths[i].endsWith(C_ROOT)) {
      folderNames.addElement(exportPaths[i]);
    }
 else {
      fileNames.addElement(exportPaths[i]);
    }
  }
  getExportResource();
  getXmlConfigFile(moduleNode);
  checkRedundancies(folderNames,fileNames);
  m_exportedPageFiles=new HashSet();
  m_exportedResources=new HashSet();
  m_pageType=cms.getResourceType("page").getResourceType();
  for (int i=0; i < folderNames.size(); i++) {
    String path=(String)folderNames.elementAt(i);
    addSuperFolders(path);
    exportResources(path);
    m_exportedResources.add(path);
  }
  addSingleFiles(fileNames);
  addPageBodyFiles();
  if (m_exportUserdata) {
    exportGroups();
    exportUsers();
  }
  writeXmlConfigFile();
  try {
    m_exportZipStream.close();
  }
 catch (  IOException exc) {
    throw new CmsException(CmsException.C_UNKNOWN_EXCEPTION,exc);
  }
}
