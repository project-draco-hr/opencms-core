{
  CmsSetupTestResult testResult=new CmsSetupTestResult();
  testResult.setName("XML Parser");
  try {
    DOMParser parser=new DOMParser();
    String document="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<test>test</test>\n";
    parser.parse(new InputSource(new ByteArrayInputStream(document.getBytes("UTF-8"))));
    Document doc=parser.getDocument();
    String versionStr=null;
    try {
      doc.getClass().getMethod("getXmlEncoding",new Class[]{}).invoke(doc,new Object[]{});
      versionStr=Version.getVersion();
    }
 catch (    Throwable t) {
    }
    if (versionStr == null) {
      try {
        doc.getClass().getMethod("getEncoding",new Class[]{}).invoke(doc,new Object[]{});
        versionStr="Xerces version 1";
      }
 catch (      Throwable t) {
      }
    }
    testResult.setResult(versionStr);
    testResult.setHelp("OpenCms requires Xerces version 1 or Xerces version 2 to run. Usually these should be available as part of the servlet environment.");
    testResult.setGreen();
  }
 catch (  Exception e) {
    testResult.setResult("Unable to test the XML parser!");
    testResult.setInfo(e.toString());
    testResult.setRed();
  }
 finally {
    m_testResults.add(testResult);
  }
}
