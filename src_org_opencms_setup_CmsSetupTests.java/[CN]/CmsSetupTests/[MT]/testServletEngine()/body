{
  CmsSetupTestResult testResult=new CmsSetupTestResult();
  try {
    String[] supportedEngines={"Apache Tomcat/4.1","Apache Tomcat/4.0","Apache Tomcat/5.0"};
    String[] unsupportedEngines={"Tomcat Web Server/3.2","Tomcat Web Server/3.3","Resin/2.0.b2"};
    String[] unsupportedServletEngineInfo={"Tomcat 3.2 is no longer supported. Please use Tomcat 4.x instead.","Tomcat 3.3 is no longer supported. Please use Tomcat 4.x instead.","The OpenCms JSP integration does currently not work with Resin. Please use Tomcat 4.x instead."};
    ServletConfig config=m_pageContext.getServletConfig();
    String servletEngine=config.getServletContext().getServerInfo();
    boolean supportedServletEngine=hasSupportedServletEngine(servletEngine,supportedEngines);
    int unsupportedServletEngine=unsupportedServletEngine(servletEngine,unsupportedEngines);
    testResult.setName("Servlet engine");
    testResult.setResult(servletEngine);
    if (unsupportedServletEngine > -1) {
      testResult.setRed();
      testResult.setInfo(unsupportedServletEngineInfo[unsupportedServletEngine]);
      testResult.setHelp("This servlet engine does not work with OpenCms. Even though OpenCms is fully standards compliant, " + "the standard leaves some 'grey' (i.e. undefined) areas. " + "Please consider using another, supported engine.");
    }
 else     if (!supportedServletEngine) {
      testResult.setYellow();
      testResult.setHelp("This servlet engine has not been tested with OpenCms. Please consider using another, supported engine.");
    }
 else {
      testResult.setGreen();
    }
  }
 catch (  Exception e) {
    testResult.setRed();
    testResult.setResult("Unable to test servlet engine!");
    testResult.setInfo(e.toString());
  }
 finally {
    m_testResults.add(testResult);
  }
}
