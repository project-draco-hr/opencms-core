{
  long timer1=0;
  if (DEBUG > 0) {
    timer1=System.currentTimeMillis();
    System.err.println("========== XmlTemplateLoader loading: " + file.getAbsolutePath());
  }
  try {
    I_CmsRequest cms_req=cms.getRequestContext().getRequest();
    byte[] result=null;
    HttpServletRequest originalreq=(HttpServletRequest)cms_req.getOriginalRequest();
    com.opencms.file.CmsFile fx=req.getCmsObject().readFile(file.getAbsolutePath());
    cms.getRequestContext().setUri(fx.getAbsolutePath());
    cms_req.setOriginalRequest(req);
    result=generateOutput(cms,fx,fx.getLauncherClassname(),cms_req,m_openCms);
    cms_req.setOriginalRequest(originalreq);
    cms.getRequestContext().setUri(null);
    if (result != null) {
      res.getOutputStream().write(result);
    }
  }
 catch (  Exception e) {
    System.err.println("Error in CmsXmlTemplateLoader: " + e.toString());
    if (DEBUG > 0)     e.printStackTrace(System.err);
    throw new ServletException("Error in CmsXmlTemplateLoader processing",e);
  }
  if (DEBUG > 0) {
    long timer2=System.currentTimeMillis() - timer1;
    System.err.println("========== Time delivering XmlTemplate for " + file.getAbsolutePath() + ": "+ timer2+ "ms");
  }
}
