{
  getJsp().getRequest().setAttribute(C_SESSION_WORKPLACE_CLASS,this);
  m_userSettings.setUser(getSettings().getUser());
  try {
    m_userSettings.save(getCms());
  }
 catch (  CmsException e) {
  }
  CmsWorkplaceAction.updatePreferences(getCms());
  try {
    int projectId=Integer.parseInt(m_userSettings.getStartProject());
    getCms().getRequestContext().setCurrentProject(projectId);
    getSettings().setProject(projectId);
  }
 catch (  Exception e) {
  }
  try {
    if (DIALOG_SET.equals(getParamAction())) {
      getCms().getRequestContext().getResponse().sendCmsRedirect(C_PATH_DIALOGS + "/preferences.html?" + PARAM_TAB+ "="+ getActiveTab());
    }
 else {
      getCms().getRequestContext().getResponse().sendCmsRedirect(C_PATH_DIALOGS + "/preferences.html?" + PARAM_ACTION+ "="+ DIALOG_RELOAD);
    }
  }
 catch (  IOException e) {
  }
}
