{
  HttpServletRequest request=getJsp().getRequest();
  request.setAttribute(C_SESSION_WORKPLACE_CLASS,this);
  Enumeration enum=request.getParameterNames();
  while (enum.hasMoreElements()) {
    String paramName=(String)enum.nextElement();
    if (paramName.startsWith(PARAM_PREFERREDEDITOR_PREFIX)) {
      String paramValue=request.getParameter(paramName);
      if (paramValue != null && !INPUT_DEFAULT.equals(paramValue.trim())) {
        m_userSettings.setPreferredEditor(paramName.substring(PARAM_PREFERREDEDITOR_PREFIX.length()),paramValue);
      }
 else {
        m_userSettings.setPreferredEditor(paramName.substring(PARAM_PREFERREDEDITOR_PREFIX.length()),null);
      }
    }
  }
  m_userSettings.setUser(getSettings().getUser());
  try {
    m_userSettings.save(getCms());
  }
 catch (  CmsException e) {
  }
  CmsWorkplaceAction.updatePreferences(getCms(),getJsp().getRequest());
  try {
    int projectId=Integer.parseInt(m_userSettings.getStartProject());
    getCms().getRequestContext().setCurrentProject(getCms().readProject(projectId));
    getSettings().setProject(projectId);
  }
 catch (  Exception e) {
  }
  try {
    if (DIALOG_SET.equals(getParamAction())) {
      sendCmsRedirect(C_PATH_DIALOGS + "/preferences.html?" + PARAM_TAB+ "="+ getActiveTab()+ "&"+ PARAM_SETPRESSED+ "=true");
    }
 else {
      sendCmsRedirect(C_PATH_DIALOGS + "/preferences.html?" + PARAM_ACTION+ "="+ DIALOG_RELOAD);
    }
  }
 catch (  IOException e) {
  }
}
