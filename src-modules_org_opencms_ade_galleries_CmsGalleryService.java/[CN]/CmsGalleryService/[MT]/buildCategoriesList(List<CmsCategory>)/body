{
  LinkedHashMap<String,CmsCategoriesListInfoBean> map=new LinkedHashMap<String,CmsCategoriesListInfoBean>();
  if ((categories == null) || (categories.size() == 0)) {
    return map;
  }
  Map<String,CmsCategory> sorted=new TreeMap<String,CmsCategory>();
  Iterator<CmsCategory> i=categories.iterator();
  while (i.hasNext()) {
    CmsCategory category=i.next();
    String categoryPath=category.getPath();
    if (sorted.get(categoryPath) != null) {
      continue;
    }
    sorted.put(categoryPath,category);
  }
  List<CmsCategory> sortedCategories=new ArrayList<CmsCategory>(sorted.values());
  i=sortedCategories.iterator();
  while (i.hasNext()) {
    CmsCategory cat=i.next();
    CmsCategoriesListInfoBean bean=new CmsCategoriesListInfoBean();
    try {
      bean.setId(cat.getPath());
      bean.setTitle(cat.getTitle());
      bean.setSubTitle(cat.getPath());
      bean.setRootPath(cat.getRootPath());
      int level=CmsResource.getPathLevel(cat.getPath());
      bean.setLevel(level);
      String iconPath=CmsWorkplace.getResourceUri(CmsWorkplace.RES_PATH_FILETYPES + OpenCms.getWorkplaceManager().getExplorerTypeSetting(CmsResourceTypeFolder.RESOURCE_TYPE_NAME).getIcon());
      bean.setIconResource(iconPath);
      map.put(cat.getPath(),bean);
    }
 catch (    Exception e) {
      if (LOG.isErrorEnabled()) {
        LOG.error(e.getLocalizedMessage(),e);
      }
    }
  }
  return map;
}
