{
  CmsObject cms=getCmsObject();
  echo("Testing XML page link replacement");
  String filename="/folder1/subfolder11/test1.html";
  String content=CmsXmlPageFactory.createDocument(Locale.ENGLISH,UTF8);
  List properties=new ArrayList();
  properties.add(new CmsProperty(I_CmsConstants.C_PROPERTY_CONTENT_ENCODING,UTF8,null));
  properties.add(new CmsProperty(I_CmsConstants.C_PROPERTY_LOCALE,Locale.ENGLISH.toString(),null));
  properties.add(new CmsProperty(CmsXmlPage.C_PROPERTY_ALLOW_RELATIVE,String.valueOf(false),null));
  cms.createResource(filename,CmsResourceTypeXmlPage.getStaticTypeId(),content.getBytes(UTF8),properties);
  CmsFile file=cms.readFile(filename);
  CmsXmlPage page=CmsXmlPageFactory.unmarshal(cms,file);
  String element="test";
  page.addValue(element,Locale.ENGLISH);
  String text;
  page.setStringValue(cms,element,Locale.ENGLISH,"<a href=\"index.html\">link</a>");
  text=page.getStringValue(cms,element,Locale.ENGLISH);
  assertEquals("<a href=\"/data/opencms/folder1/subfolder11/index.html\">link</a>",text);
  page.setStringValue(cms,element,Locale.ENGLISH,"<a href=\"index_noexist.html\">link</a>");
  text=page.getStringValue(cms,element,Locale.ENGLISH);
  assertEquals("<a href=\"/data/opencms/folder1/subfolder11/index_noexist.html\">link</a>",text);
}
