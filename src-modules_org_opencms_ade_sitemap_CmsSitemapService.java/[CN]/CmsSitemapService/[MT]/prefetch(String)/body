{
  CmsSitemapData result=null;
  CmsObject cms=getCmsObject();
  CmsSitemapManager sitemapMgr=OpenCms.getSitemapManager();
  try {
    CmsResource sitemap=cms.readResource(sitemapUri);
    Map<String,CmsXmlContentProperty> propertyConfig=sitemapMgr.getElementPropertyConfiguration(cms,sitemap,true);
    I_CmsXmlContentHandler contentHandler=CmsXmlContentDefinition.getContentHandlerForResource(cms,sitemap);
    CmsMacroResolver resolver=CmsXmlContentPropertyHelper.getMacroResolverForProperties(cms,contentHandler);
    Map<String,CmsXmlContentProperty> resolvedProps=CmsXmlContentPropertyHelper.resolveMacrosInProperties(propertyConfig,resolver);
    String parentSitemap=sitemapMgr.getParentSitemap(cms,sitemapUri);
    String openPath=getRequest().getParameter("path");
    String entryPoint=sitemapMgr.getEntryPoint(cms,sitemapUri);
    CmsSitemapEntry entry=sitemapMgr.getEntryForUri(cms,entryPoint);
    Map<String,CmsComputedPropertyValue> parentProperties=new HashMap<String,CmsComputedPropertyValue>(entry.getParentComputedProperties());
    String siteRoot=OpenCms.getSiteManager().getSiteRoot(sitemap.getRootPath());
    String exportName=sitemapMgr.getExportnameForSiteRoot(siteRoot);
    CmsSite site=OpenCms.getSiteManager().getSiteForSiteRoot(siteRoot);
    boolean isSecure=site.hasSecureServer();
    result=new CmsSitemapData(getDefaultTemplate(sitemapUri),getTemplates(),resolvedProps,getClipboardData(),parentProperties,exportName,isSecure,getNoEditReason(cms,getRequest()),isDisplayToolbar(getRequest()),OpenCms.getResourceManager().getResourceType(CmsResourceTypeXmlContainerPage.getStaticTypeName()).getTypeId(),parentSitemap,getRoot(sitemap,parentSitemap,openPath,propertyConfig),sitemap.getDateLastModified(),openPath);
  }
 catch (  Throwable e) {
    error(e);
  }
  return result;
}
