{
  if (C_DEBUG && A_OpenCms.isLogging()) {
    A_OpenCms.log(C_OPENCMS_DEBUG,this.getClassName() + "getting content of element " + ((elementName == null) ? "<root>" : elementName));
    A_OpenCms.log(C_OPENCMS_DEBUG,this.getClassName() + "template file is: " + templateFile);
    A_OpenCms.log(C_OPENCMS_DEBUG,this.getClassName() + "selected template section is: " + ((templateSelector == null) ? "<default>" : templateSelector));
  }
  CmsXmlTemplateFile templateDocument=getOwnTemplateFile(cms,templateFile,elementName,parameters,templateSelector);
  CmsRequestContext reqCont=cms.getRequestContext();
  I_CmsRegistry reg=cms.getRegistry();
  String step=(String)parameters.get(C_ACTION);
  String moduleName=(String)parameters.get(C_MODULE);
  if ((step != null) && ("ok".equals(step))) {
    String exportName=(String)parameters.get("modulename");
    String[] resourcen=new String[4];
    resourcen[0]="/moduledemos/" + exportName + "/";
    resourcen[1]="/system/modules/" + exportName + "/";
    resourcen[2]="/system/classes/" + exportName.replace('.','/') + "/";
    resourcen[3]="/content/bodys/moduledemos/" + exportName + "/";
    reg.exportModule(exportName,resourcen,cms.readExportPath() + exportName + "_"+ reg.getModuleVersion(exportName));
    templateSelector="done";
  }
 else {
    templateDocument.setData("modulename",moduleName);
  }
  return startProcessing(cms,templateDocument,elementName,parameters,templateSelector);
}
