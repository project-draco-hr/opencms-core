{
  echo("Testing Exception behaviour during login");
  CmsObject cms=getCmsObject();
  String adminUser=OpenCms.getDefaultUsers().getUserAdmin();
  cms.loginUser(adminUser,"admin");
  assertEquals(adminUser,cms.getRequestContext().currentUser().getName());
  CmsException error=null;
  try {
    cms.loginUser(adminUser,"imamwrong");
  }
 catch (  CmsAuthentificationException e) {
    error=e;
  }
  assertNotNull(error);
  assertSame(Messages.ERR_LOGIN_FAILED_3,error.getMessageContainer().getKey());
  error=null;
  try {
    cms.loginUser("idontexist","imnotimportant");
  }
 catch (  CmsAuthentificationException e) {
    error=e;
  }
  assertNotNull(error);
  assertSame(Messages.ERR_LOGIN_FAILED_NO_USER_3,error.getMessageContainer().getKey());
  String test1User="test1";
  cms.loginUser(test1User,"test1");
  assertEquals(test1User,cms.getRequestContext().currentUser().getName());
  cms.loginUser(adminUser,"admin");
  assertEquals(adminUser,cms.getRequestContext().currentUser().getName());
  CmsUser test1=cms.readUser(test1User);
  test1.setDisabled();
  cms.writeUser(test1);
  error=null;
  try {
    cms.loginUser(test1User,"test1");
  }
 catch (  CmsAuthentificationException e) {
    error=e;
  }
  assertNotNull(error);
  assertSame(Messages.ERR_LOGIN_FAILED_DISABLED_3,error.getMessageContainer().getKey());
  test1.setEnabled();
  cms.writeUser(test1);
  cms.loginUser(test1User,"test1");
  assertEquals(test1User,cms.getRequestContext().currentUser().getName());
}
