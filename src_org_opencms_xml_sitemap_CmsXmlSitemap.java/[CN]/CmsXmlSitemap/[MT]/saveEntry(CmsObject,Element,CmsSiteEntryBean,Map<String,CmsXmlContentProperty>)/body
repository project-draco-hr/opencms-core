{
  Element entryElement=parent.addElement(XmlNode.SITEENTRY.getName());
  entryElement.addElement(XmlNode.ID.getName()).addCDATA(entry.getId().toString());
  entryElement.addElement(XmlNode.NAME.getName()).addCDATA(entry.getName());
  entryElement.addElement(XmlNode.TITLE.getName()).addCDATA(entry.getTitle());
  Element vfsFile=entryElement.addElement(XmlNode.VFSFILE.getName());
  fillResource(cms,vfsFile,entry.getResourceId());
  Element propElement=null;
  for (  Map.Entry<String,String> property : entry.getProperties().entrySet()) {
    String propName=property.getKey();
    boolean isSitemapProperty=CmsSitemapManager.PROPERTY_SITEMAP.equals(propName);
    if (!propertiesConf.containsKey(propName) && !isSitemapProperty) {
      continue;
    }
    if (propElement == null) {
      propElement=entryElement.addElement(XmlNode.PROPERTIES.getName());
    }
    propElement.addElement(XmlNode.NAME.getName()).addCDATA(propName);
    Element valueElement=propElement.addElement(XmlNode.VALUE.getName());
    String value=property.getValue();
    if (isSitemapProperty || CmsXmlContentProperty.PropType.isVfsList(propertiesConf.get(propName).getPropertyType())) {
      Element filelistElem=valueElement.addElement(XmlNode.FILELIST.getName());
      for (      String strId : CmsStringUtil.splitAsList(value,CmsXmlContentProperty.PROP_SEPARATOR)) {
        try {
          Element fileValueElem=filelistElem.addElement(XmlNode.URI.getName());
          fillResource(cms,fileValueElem,new CmsUUID(strId));
        }
 catch (        CmsException e) {
          LOG.error(e.getLocalizedMessage(),e);
        }
      }
    }
 else {
      valueElement.addElement(XmlNode.STRING.getName()).addCDATA(value);
    }
  }
  int subentryCount=0;
  for (  CmsSiteEntryBean subentry : entry.getSubEntries()) {
    saveEntry(cms,entryElement,subentry,propertiesConf);
    subentryCount++;
  }
}
