{
  m_document=document;
  m_contentDefinition=definition;
  m_encoding=CmsEncoder.lookupEncoding(encoding,encoding);
  m_elementLocales=new HashMap<String,Set<Locale>>();
  m_elementNames=new HashMap<Locale,Set<String>>();
  m_locales=new HashSet<Locale>();
  m_sitemaps=new HashMap<Locale,CmsSitemapBean>();
  clearBookmarks();
  for (Iterator<Element> itSitemaps=CmsXmlGenericWrapper.elementIterator(m_document.getRootElement()); itSitemaps.hasNext(); ) {
    Element sitemap=itSitemaps.next();
    try {
      Locale locale=CmsLocaleManager.getLocale(sitemap.attribute(CmsXmlContentDefinition.XSD_ATTRIBUTE_VALUE_LANGUAGE).getValue());
      addLocale(locale);
      Element entryPoint=sitemap.element(XmlNode.EntryPoint.name());
      String entryPointPath=null;
      if (entryPoint != null) {
        createBookmark(entryPoint,locale,sitemap,null,definition);
        Element linkEntryPoint=entryPoint.element(CmsXmlPage.NODE_LINK);
        if (linkEntryPoint == null) {
        }
 else {
          entryPointPath=new CmsLink(linkEntryPoint).getUri();
        }
      }
 else {
        entryPointPath="/";
      }
      List<CmsSiteEntryBean> entries=readSiteEntries(sitemap,"",definition,locale,entryPointPath);
      m_sitemaps.put(locale,new CmsSitemapBean(locale,entryPointPath,entries));
    }
 catch (    NullPointerException e) {
      LOG.error(org.opencms.xml.content.Messages.get().getBundle().key(org.opencms.xml.content.Messages.LOG_XMLCONTENT_INIT_BOOKMARKS_0),e);
    }
  }
}
