{
  Locale locale=cms.getRequestContext().getLocale();
  if (!hasLocale(locale)) {
    addLocale(cms,locale);
  }
  Set<String> modified=new HashSet<String>();
  for (  I_CmsSitemapChange change : changes) {
switch (change.getType()) {
case DELETE:
      modified.addAll(deleteEntry(cms,(CmsSitemapChangeDelete)change));
    break;
case NEW:
case SUBSITEMAP_NEW:
  modified.add(newEntry(cms,(CmsSitemapChangeNew)change));
break;
case MOVE:
modified.addAll(moveEntry(cms,(CmsSitemapChangeMove)change));
break;
case EDIT:
modified.add(editEntry(cms,(CmsSitemapChangeEdit)change));
break;
default :
}
}
initDocument(m_document,m_encoding,m_contentDefinition);
List<String> result=new ArrayList<String>(modified);
Collections.sort(result);
OpenCms.fireCmsEvent(new CmsEvent(I_CmsEventListener.EVENT_SITEMAP_CHANGED,Collections.<String,Object>singletonMap(I_CmsEventListener.KEY_RESOURCES,result)));
}
