{
  CmsProperty currentProperty=cms.readPropertyObject(resource,CmsPropertyDefinition.PROPERTY_TITLE,false);
  if (currentProperty.isNullProperty()) {
    currentProperty=new CmsProperty();
    currentProperty.setName(CmsPropertyDefinition.PROPERTY_TITLE);
    if (OpenCms.getWorkplaceManager().isDefaultPropertiesOnStructure()) {
      currentProperty.setStructureValue(title);
      currentProperty.setResourceValue(null);
    }
 else {
      currentProperty.setStructureValue(null);
      currentProperty.setResourceValue(title);
    }
  }
 else   if (currentProperty.getStructureValue() != null) {
    currentProperty.setStructureValue(title);
    currentProperty.setResourceValue(null);
  }
 else {
    currentProperty.setStructureValue(null);
    currentProperty.setResourceValue(title);
  }
  CmsLock lock=cms.getLock(resource);
  if (lock.isUnlocked()) {
    cms.lockResource(cms.getSitePath(resource));
  }
  cms.writePropertyObject(cms.getSitePath(resource),currentProperty);
  cms.unlockResource(cms.getSitePath(resource));
}
