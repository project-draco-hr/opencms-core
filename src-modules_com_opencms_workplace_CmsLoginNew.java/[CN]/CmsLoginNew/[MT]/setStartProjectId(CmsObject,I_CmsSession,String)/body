{
  int currentProject=I_CmsConstants.C_PROJECT_ONLINE_ID;
  if ((startProjectId != null) && (!"".equals(startProjectId))) {
    try {
      currentProject=(new Integer(startProjectId)).intValue();
    }
 catch (    NumberFormatException e) {
    }
  }
 else {
    CmsUserSettings settings=new CmsUserSettings(cms.getRequestContext().currentUser());
    try {
      CmsProject project=cms.readProject(settings.getStartProject());
      currentProject=project.getId();
    }
 catch (    CmsDbEntryNotFoundException e) {
      currentProject=I_CmsConstants.C_PROJECT_ONLINE_ID;
    }
  }
  try {
    CmsProject project=cms.readProject(currentProject);
    if (!cms.getAllAccessibleProjects().contains(project)) {
      currentProject=I_CmsConstants.C_PROJECT_ONLINE_ID;
    }
  }
 catch (  Exception e) {
    currentProject=I_CmsConstants.C_PROJECT_ONLINE_ID;
  }
  cms.getRequestContext().setCurrentProject(cms.readProject(currentProject));
}
