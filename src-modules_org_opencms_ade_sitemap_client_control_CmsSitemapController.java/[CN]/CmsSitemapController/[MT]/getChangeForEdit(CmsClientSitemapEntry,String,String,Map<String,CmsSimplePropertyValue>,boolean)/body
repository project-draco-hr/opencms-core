{
  boolean changedTitle=((title != null) && !title.trim().equals(entry.getTitle()));
  boolean changedVfsRef=((vfsReference != null) && !vfsReference.trim().equals(entry.getVfsPath()));
  Map<String,CmsSimplePropertyValue> oldProps=new HashMap<String,CmsSimplePropertyValue>(entry.getProperties());
  Map<String,CmsSimplePropertyValue> newProps=new HashMap<String,CmsSimplePropertyValue>(entry.getProperties());
  CmsCollectionUtil.updateMapAndRemoveNulls(properties,newProps);
  boolean changedProperties=!oldProps.equals(newProps);
  if (!changedTitle && !changedVfsRef && !changedProperties&& isNew) {
    return null;
  }
  CmsClientSitemapEntry newEntry=new CmsClientSitemapEntry(entry);
  if (changedTitle) {
    newEntry.setTitle(title);
    newEntry.setInNavigation(true);
  }
  newEntry.setEdited();
  newEntry.setNew(entry.isNew() && isNew);
  if (changedVfsRef) {
    newEntry.setVfsPath(vfsReference);
  }
  if (changedProperties) {
    newEntry.setProperties(newProps);
  }
  return new CmsClientSitemapChangeEdit(entry,newEntry);
}
