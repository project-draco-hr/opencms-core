{
  CmsFilterData data=new CmsFilterData(param);
  String foldername=CmsResource.getFolderPath(data.getFileName());
  List result;
  String siteRoot=cms.getRequestContext().getSiteRoot();
  int prefix=siteRoot.length();
  cms.getRequestContext().saveSiteRoot();
  try {
    cms.getRequestContext().setSiteRoot("/");
    CmsResourceFilter filter=CmsResourceFilter.DEFAULT.addRequireType(data.getType());
    List resources=cms.readResources(foldername,filter,tree);
    result=new ArrayList(resources.size());
    Iterator i=resources.iterator();
    while (i.hasNext()) {
      CmsResource resource=(CmsResource)i.next();
      result.add(cms.getSitePath(resource).substring(prefix));
    }
  }
  finally {
    cms.getRequestContext().restoreSiteRoot();
  }
  Collections.sort(result);
  Collections.reverse(result);
  if ((data.getCount() > 0) && (result.size() > data.getCount())) {
    result=result.subList(0,data.getCount());
  }
  return result;
}
