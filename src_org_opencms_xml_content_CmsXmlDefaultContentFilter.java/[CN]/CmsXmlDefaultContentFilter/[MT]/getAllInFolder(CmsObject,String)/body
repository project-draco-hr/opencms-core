{
  int pos1=param.indexOf('|');
  if (pos1 == -1) {
    throw new CmsException("Malformed filter parameter '" + param + "'");
  }
  String foldername=CmsResource.getFolderPath(param.substring(0,pos1));
  int type=Integer.valueOf(param.substring(pos1 + 1)).intValue();
  List result;
  String siteRoot=cms.getRequestContext().getSiteRoot();
  int prefix=siteRoot.length();
  cms.getRequestContext().saveSiteRoot();
  try {
    cms.getRequestContext().setSiteRoot("/");
    List resources=cms.getFilesInFolder(foldername);
    result=new ArrayList(resources.size());
    Iterator i=resources.iterator();
    while (i.hasNext()) {
      CmsResource resource=(CmsResource)i.next();
      if (resource.getTypeId() != type) {
        continue;
      }
      result.add(cms.getSitePath(resource).substring(prefix));
    }
  }
  finally {
    cms.getRequestContext().restoreSiteRoot();
  }
  Collections.sort(result);
  Collections.reverse(result);
  return result;
}
