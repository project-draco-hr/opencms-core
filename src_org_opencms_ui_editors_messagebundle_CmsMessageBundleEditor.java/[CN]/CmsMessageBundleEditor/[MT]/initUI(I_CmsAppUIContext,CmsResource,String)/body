{
  m_cms=((CmsUIServlet)VaadinServlet.getCurrent()).getCmsObject();
  m_messages=Messages.get().getBundle(UI.getCurrent().getLocale());
  m_resource=resource;
  m_backLink=backLink;
  m_context=context;
  try {
    m_model=new CmsMessageBundleEditorModel(m_cms,m_resource);
    m_configurableMessages=m_model.getConfigurableMessages(m_messages,UI.getCurrent().getLocale());
    fillToolBar(context);
    fillAppInfo(context);
    Component main=createMainComponent();
    if (m_model.hasMasterMode()) {
      m_fieldFactories.put(CmsMessageBundleEditorTypes.EditMode.MASTER,new CmsMessageBundleEditorTypes.TranslateTableFieldFactory(m_table,m_model.getEditableColumns(CmsMessageBundleEditorTypes.EditMode.MASTER)));
      m_styleGenerators.put(CmsMessageBundleEditorTypes.EditMode.MASTER,new CmsMessageBundleEditorTypes.TranslateTableCellStyleGenerator(m_model.getEditableColumns(CmsMessageBundleEditorTypes.EditMode.MASTER)));
    }
    m_fieldFactories.put(CmsMessageBundleEditorTypes.EditMode.DEFAULT,new CmsMessageBundleEditorTypes.TranslateTableFieldFactory(m_table,m_model.getEditableColumns(CmsMessageBundleEditorTypes.EditMode.DEFAULT)));
    m_styleGenerators.put(CmsMessageBundleEditorTypes.EditMode.DEFAULT,new CmsMessageBundleEditorTypes.TranslateTableCellStyleGenerator(m_model.getEditableColumns(CmsMessageBundleEditorTypes.EditMode.DEFAULT)));
    m_table.setTableFieldFactory(m_fieldFactories.get(m_model.getEditMode()));
    m_table.setCellStyleGenerator(m_styleGenerators.get(m_model.getEditMode()));
    adjustVisibleColumns();
    context.setAppContent(main);
    adjustFocus();
    if (m_model.getSwitchedLocaleOnOpening()) {
      String caption=m_messages.key(Messages.GUI_NOTIFICATION_MESSAGEBUNDLEEDITOR_SWITCHED_LOCALE_CAPTION_0);
      String description=m_messages.key(Messages.GUI_NOTIFICATION_MESSAGEBUNDLEEDITOR_SWITCHED_LOCALE_DESCRIPTION_0);
      Notification warningSwitchedLocale=new Notification(caption,description,Type.WARNING_MESSAGE,true);
      warningSwitchedLocale.setDelayMsec(-1);
      warningSwitchedLocale.show(UI.getCurrent().getPage());
    }
  }
 catch (  IOException|CmsException e) {
    LOG.error(m_messages.key(Messages.ERR_LOADING_RESOURCES_0),e);
    Notification.show(m_messages.key(Messages.ERR_LOADING_RESOURCES_0),Type.ERROR_MESSAGE);
    closeAction();
  }
}
