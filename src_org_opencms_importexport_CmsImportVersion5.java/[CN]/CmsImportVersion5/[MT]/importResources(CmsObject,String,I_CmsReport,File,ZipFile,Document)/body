{
  initialize();
  m_cms=cms;
  m_importPath=importPath;
  m_report=report;
  m_importResource=importResource;
  m_importZip=importZip;
  m_docXml=docXml;
  m_linkStorage=new HashMap();
  m_linkPropertyStorage=new HashMap();
  m_parseables=new ArrayList();
  m_importedRelations=new HashMap();
  try {
    if (OpenCms.getRoleManager().hasRole(cms,CmsRole.ACCOUNT_MANAGER)) {
      importGroups();
      importUsers();
    }
    readResourcesFromManifest();
    convertPointerToSiblings();
    rewriteParseables();
    importRelations();
  }
  finally {
    cleanUp();
  }
}
