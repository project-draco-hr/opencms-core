{
  StringBuffer html=new StringBuffer(32);
  try {
    if (CmsStringUtil.isNotEmpty(getParamResourcePath())) {
      CmsResource res=getCms().readResource(getParamResourcePath());
      if (res != null) {
        String pointer=new String(CmsFile.upgrade(res,getCms()).getContents());
        if (CmsStringUtil.isEmptyOrWhitespaceOnly(pointer)) {
          pointer=getJsp().link(getCms().getSitePath(res));
        }
        String title=getPropertyValue(res,CmsPropertyDefinition.PROPERTY_TITLE);
        String description=getJsp().property(CmsPropertyDefinition.PROPERTY_DESCRIPTION,getParamResourcePath());
        String keywords=getJsp().property(CmsPropertyDefinition.PROPERTY_KEYWORDS,getParamResourcePath());
        String lastmodified=getMessages().getDateTime(res.getDateLastModified());
        html.append("<table cellpadding=\"2\" cellspacing=\"2\" border=\"0\" style=\"align: middle; width:100%; background-color: ThreeDFace; margin: 0;\">");
        html.append("<tr align=\"left\">");
        html.append("<td width=\"35%\"><b>");
        html.append(key("input.linkto"));
        html.append("</b></td>");
        html.append("<td width=\"65%\"><a href=\"#\" onclick=\"");
        html.append("javascript:window.open('");
        html.append(getJsp().link(getCms().getSitePath(res)));
        html.append("','_preview','')");
        html.append("\">");
        html.append(pointer);
        html.append("</a></td>");
        html.append(previewRow(key("label.name"),res.getName()));
        html.append(previewRow(key("input.title"),title));
        html.append(previewRow(key("input.datelastmodified"),lastmodified));
        if (CmsStringUtil.isNotEmpty(description)) {
          html.append(previewRow(key("input.description"),description));
        }
        if (CmsStringUtil.isNotEmpty(keywords)) {
          html.append(previewRow(key("input.keywords"),keywords));
        }
        html.append("</table>");
      }
    }
  }
 catch (  CmsException e) {
    LOG.error(e);
  }
  return html.toString();
}
