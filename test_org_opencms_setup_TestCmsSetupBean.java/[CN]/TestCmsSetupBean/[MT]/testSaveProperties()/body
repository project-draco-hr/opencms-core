{
  CmsSetupBean bean=new CmsSetupBean();
  bean.init("",null,null);
  String base=getTestDataPath(File.separator + "WEB-INF" + File.separator+ "base");
  String inputFile=base + CmsSystemInfo.FILE_PROPERTIES;
  String outputFile=base + "output.properties";
  System.out.println("Reading properties from " + inputFile);
  CmsConfigurationParameter oldProperties=new CmsConfigurationParameter(inputFile);
  System.out.println("Writing properties to " + outputFile);
  bean.copyFile(inputFile,outputFile);
  bean.saveProperties(oldProperties,outputFile,false);
  System.out.println("Checking properties from " + outputFile);
  CmsConfigurationParameter newProperties=new CmsConfigurationParameter(outputFile);
  for (  String key : oldProperties.getParameterSet()) {
    Object obj=oldProperties.getObject(key);
    String oldValue="", newValue="";
    if (obj instanceof Vector) {
      StringBuffer buf;
      buf=new StringBuffer();
      for (Iterator j=((Vector)obj).iterator(); j.hasNext(); ) {
        buf.append("[" + (String)j.next() + "]");
      }
      oldValue=buf.toString();
      buf=new StringBuffer();
      for (Iterator j=((Vector)newProperties.getObject(key)).iterator(); j.hasNext(); ) {
        buf.append("[" + (String)j.next() + "]");
      }
      newValue=buf.toString();
    }
 else {
      oldValue=(String)obj;
      newValue=newProperties.getString(key);
    }
    System.out.println(key);
    System.out.println(oldValue);
    System.out.println(newValue);
    System.out.println("---");
    assertEquals(oldValue,newValue);
  }
  File output=new File(outputFile);
  output.delete();
}
