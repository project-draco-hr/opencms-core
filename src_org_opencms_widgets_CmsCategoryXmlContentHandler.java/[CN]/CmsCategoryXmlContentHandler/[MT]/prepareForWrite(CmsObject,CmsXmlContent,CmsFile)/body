{
  super.prepareForWrite(cms,content,file);
  if (!CmsWorkplace.isTemporaryFile(file)) {
    String folderPath=cms.getRequestContext().removeSiteRoot(CmsResource.getFolderPath(file.getRootPath()));
    String tmpName=CmsWorkplace.getTemporaryFileName(file.getName());
    if (cms.existsResource(folderPath + tmpName,CmsResourceFilter.ALL)) {
      List listsib=cms.readSiblings(cms.getSitePath(file),CmsResourceFilter.ALL);
      for (int i=0; i < listsib.size(); i++) {
        CmsResource resource=(CmsResource)listsib.get(i);
        try {
          Locale locale=getDefaultLocale(cms,cms.getSitePath(resource));
          resetCategories(cms,resource);
          setCategories(cms,content,resource,locale);
        }
 catch (        CmsException ex) {
          if (LOG.isErrorEnabled()) {
            LOG.error(ex.getLocalizedMessage(),ex);
          }
        }
      }
    }
  }
  return file;
}
