{
  CmsXmlContentErrorHandler handler=super.resolveValidation(cms,value,errorHandler);
  I_CmsWidget widget=null;
  try {
    widget=value.getContentDefinition().getContentHandler().getWidget(value);
  }
 catch (  CmsXmlException e) {
    if (LOG.isErrorEnabled()) {
      LOG.error(e.getLocalizedMessage(),e);
    }
  }
  if (widget instanceof CmsCategoryWidget) {
    String stringValue=value.getStringValue(cms);
    if (CmsStringUtil.isEmptyOrWhitespaceOnly(stringValue)) {
      errorHandler.addError(value,Messages.get().getBundle(value.getLocale()).key(Messages.GUI_CATEGORY_CHECK_EMPTY_ERROR_0));
      return handler;
    }
    if (((CmsCategoryWidget)widget).isOnlyLeafs()) {
      try {
        if (!cms.getSubFolders(stringValue).isEmpty()) {
          errorHandler.addError(value,Messages.get().getBundle(value.getLocale()).key(Messages.GUI_CATEGORY_CHECK_NOLEAF_ERROR_0));
        }
      }
 catch (      CmsException e) {
        if (LOG.isErrorEnabled()) {
          LOG.error(e.getLocalizedMessage(),e);
        }
      }
    }
  }
  return handler;
}
