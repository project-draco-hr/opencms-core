{
  int length;
  try {
    I_CmsResponse resp=cms.getRequestContext().getResponse();
    if ((!cms.getRequestContext().isStreaming()) && result != null && !resp.isRedirected()) {
      OutputStream out=resp.getOutputStream();
      resp.setContentLength(result.length);
      resp.setHeader("Connection","keep-alive");
      out.write(result);
      out.flush();
      out.close();
    }
  }
 catch (  IOException ioe) {
    A_OpenCms.log(C_OPENCMS_INFO,getClassName() + "IO error while writing to response stream for " + cms.getRequestContext().getFileUri());
    A_OpenCms.log(C_OPENCMS_INFO,getClassName() + ioe);
  }
catch (  Exception e) {
    String errorMessage="Cannot write output to HTTP response stream";
    handleException(cms,e,errorMessage);
  }
}
