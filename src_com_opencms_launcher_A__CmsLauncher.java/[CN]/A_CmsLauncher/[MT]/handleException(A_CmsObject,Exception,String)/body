{
  if (A_OpenCms.isLogging()) {
    A_OpenCms.log(C_OPENCMS_CRITICAL,getClassName() + errorText);
    if (!(e instanceof CmsException)) {
      A_OpenCms.log(C_OPENCMS_CRITICAL,getClassName() + e);
    }
    A_OpenCms.log(C_OPENCMS_CRITICAL,getClassName() + "Cannot create output. Must send error. Sorry.");
  }
  A_CmsRequestContext reqContext=cms.getRequestContext();
  if (cms.anonymousUser().equals(reqContext.currentUser())) {
    throw new CmsException(CmsException.C_SERVICE_UNAVAILABLE);
  }
 else {
    if (e instanceof CmsException) {
      throw (CmsException)e;
    }
 else {
      throw new CmsException(errorText,e);
    }
  }
}
