{
  int ret=-1;
  HttpSession session=((HttpServletRequest)cms.getRequestContext().getRequest().getOriginalRequest()).getSession(true);
  String chosenFolder=(String)parameters.get(C_PARA_FOLDER);
  if (chosenFolder == null) {
    chosenFolder=(String)session.getValue(C_PARA_FOLDER);
  }
  if (chosenFolder == null) {
    chosenFolder="";
  }
  Vector folders=cms.getSubFolders(getConfigFile(cms).getDownGalleryPath());
  int numFolders=folders.size();
  for (int i=0; i < numFolders; i++) {
    CmsResource currFolder=(CmsResource)folders.elementAt(i);
    String name=currFolder.getName();
    if (chosenFolder.equals(currFolder.getAbsolutePath())) {
      ret=i;
    }
    values.addElement(currFolder.getAbsolutePath());
    names.addElement(name);
  }
  return new Integer(ret);
}
