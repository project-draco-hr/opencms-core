{
  Map params=new HashMap();
  params.put(PARAM_RESOURCE,"");
  if (isPopup()) {
    try {
      JspWriter out=getJsp().getJspContext().getOut();
      out.write("<html><head></head>\n");
      out.write("<body onload=\"top.close();\">\n");
      out.write("</body>\n");
      out.write("</html>\n");
    }
 catch (    IOException e) {
      getJsp().include(FILE_EXPLORER_FILELIST,null,params);
    }
  }
 else   if (getParamCloseLink() != null) {
    try {
      setForwarded(true);
      CmsRequestUtil.forwardRequest(getParamCloseLink(),getJsp().getRequest(),getJsp().getResponse());
    }
 catch (    Exception e) {
      throw new JspException(e.getMessage(),e);
    }
  }
 else   if (getParamFramename() != null) {
    String frameUri=(String)getSettings().getFrameUris().get(getParamFramename());
    if (frameUri != null) {
      if (frameUri.startsWith(OpenCms.getSystemInfo().getOpenCmsContext())) {
        frameUri=frameUri.substring(OpenCms.getSystemInfo().getOpenCmsContext().length());
      }
      if (frameUri.endsWith("administration_content_top.html")) {
        String wpClass=this.getClass().getName();
        String wpPackage=this.getClass().getPackage().getName();
        if ((wpPackage.endsWith("commons") || wpPackage.endsWith("gallery")) && (!wpClass.endsWith("Report"))) {
          getJsp().include(FILE_EXPLORER_FILELIST,null,params);
        }
 else {
          try {
            getJsp().getResponse().sendRedirect(getJsp().link(frameUri) + "?sender=/system/workplace/administration/");
          }
 catch (          IOException e) {
            params.put("sender","/system/workplace/administration/");
            getJsp().include(frameUri,null,params);
          }
        }
      }
 else {
        getJsp().include(frameUri,null,params);
      }
    }
 else {
      getJsp().include(FILE_EXPLORER_FILELIST,null,params);
    }
  }
 else {
    getJsp().include(FILE_EXPLORER_FILELIST,null,params);
  }
}
