{
  setParamAction(CmsDialog.DIALOG_LOCKS_CONFIRMED);
  CmsLock lockwp=new CmsLock(getJsp());
  lockwp.setBlockingFilter(blockingFilter);
  lockwp.setNonBlockingFilter(nonBlockingFilter);
  StringBuffer html=new StringBuffer(512);
  html.append(htmlStart("help.explorer.contextmenu.lock"));
  html.append(lockwp.buildIncludeJs());
  html.append(buildLockConfirmationMessageJS());
  html.append(bodyStart("dialog"));
  html.append("<div id='lock-body-id' class='hide'>\n");
  html.append(dialogStart());
  html.append(dialogContentStart(getParamTitle()));
  html.append(buildLockHeaderBox());
  html.append(dialogSpacer());
  html.append("<form name='main' action='");
  html.append(getDialogUri());
  html.append("' method='post' class='nomargin' onsubmit=\"return submitAction('");
  html.append(CmsDialog.DIALOG_OK);
  html.append("', null, 'main');\">\n");
  html.append(paramsAsHidden());
  html.append("<input type='hidden' name='");
  html.append(CmsDialog.PARAM_FRAMENAME);
  html.append("' value=''>\n");
  html.append(buildAjaxResultContainer(key(org.opencms.workplace.commons.Messages.GUI_LOCK_RESOURCES_TITLE_0)));
  html.append("<div id='conf-msg'></div>\n");
  html.append(buildLockAdditionalOptions());
  html.append(dialogContentEnd());
  html.append(dialogLockButtons());
  html.append("</form>\n");
  html.append(dialogEnd());
  html.append("</div>\n");
  html.append(bodyEnd());
  html.append(lockwp.buildLockRequest(hiddenTimeout,includeRelated));
  html.append(htmlEnd());
  return html.toString();
}
