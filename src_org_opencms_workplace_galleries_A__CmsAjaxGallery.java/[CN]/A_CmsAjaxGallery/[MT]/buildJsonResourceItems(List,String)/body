{
  if (resourceitems == null) {
    resourceitems=new ArrayList();
  }
  List items=new ArrayList(resourceitems.size() + 1);
  boolean isPublishEnabled=false;
  if (CmsStringUtil.isNotEmpty(parentFolder)) {
    try {
      if (OpenCms.getPublishManager().getPublishList(getCms(),getCms().readResource(parentFolder),false).size() > 0) {
        isPublishEnabled=true;
      }
    }
 catch (    Exception e) {
    }
  }
  JSONObject publishInfo=new JSONObject();
  try {
    publishInfo.put("publishable",isPublishEnabled);
  }
 catch (  JSONException e) {
  }
  items.add(publishInfo);
  Iterator i=resourceitems.iterator();
  while (i.hasNext()) {
    CmsResource res=(CmsResource)i.next();
    items.add(buildJsonItemObject(res));
  }
  JSONArray jsonArr=new JSONArray(items);
  JspWriter out=getJsp().getJspContext().getOut();
  try {
    out.print(jsonArr.toString());
  }
 catch (  IOException e) {
    if (LOG.isErrorEnabled()) {
      LOG.error(e.getLocalizedMessage(),e);
    }
  }
}
