{
  com.opencms.file.oracleplsql.CmsDbAccess dbAccess=(com.opencms.file.oracleplsql.CmsDbAccess)m_dbAccess;
  CmsUser newUser=readUser(currentUser,currentProject,username,password);
  if (newUser.getFlags() == C_FLAG_ENABLED) {
    newUser.setLastlogin(new Date().getTime());
    dbAccess.writeUser(newUser);
    m_userCache.put(newUser.getName(),newUser);
    return (newUser);
  }
 else {
    throw new CmsException("[" + this.getClass().getName() + "] "+ username,CmsException.C_NO_ACCESS);
  }
}
