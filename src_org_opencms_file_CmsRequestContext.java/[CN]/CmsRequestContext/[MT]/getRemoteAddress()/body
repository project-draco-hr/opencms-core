{
  if (m_remoteAddr == null) {
    try {
      if ((m_req != null) && (m_req.getOriginalRequestType() == I_CmsConstants.C_REQUEST_HTTP)) {
        m_remoteAddr=((HttpServletRequest)m_req.getOriginalRequest()).getHeader(I_CmsConstants.C_REQUEST_FORWARDED_FOR);
        if (m_remoteAddr == null) {
          m_remoteAddr=((HttpServletRequest)m_req.getOriginalRequest()).getRemoteAddr();
        }
      }
    }
 catch (    Throwable t) {
      m_remoteAddr=I_CmsConstants.C_IP_LOCALHOST;
      if (OpenCms.getLog(this).isWarnEnabled()) {
        OpenCms.getLog(this).warn("Error reading remote ip address in request context",t);
      }
    }
  }
  return m_remoteAddr;
}
