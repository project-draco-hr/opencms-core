{
  CmsObject cms=getCms();
  String uri="";
  String serverPrefix="";
  String vfsName=CmsLinkManager.getAbsoluteUri(getParamResource(),cms.getRequestContext().getUri());
  String secureResource="";
  String exportedResource="";
  try {
    if (resourceIsFolder()) {
      vfsName=vfsName.concat("/");
    }
    secureResource=getCms().readPropertyObject(getParamResource(),I_CmsConstants.C_PROPERTY_SECURE,true).getValue();
    exportedResource=getCms().readPropertyObject(getParamResource(),I_CmsConstants.C_PROPERTY_EXPORT,true).getValue();
  }
 catch (  CmsException e) {
    if (OpenCms.getLog(this).isInfoEnabled()) {
      OpenCms.getLog(this).info(e);
    }
  }
  if (Boolean.valueOf(exportedResource).booleanValue()) {
    uri=OpenCms.getStaticExportManager().getRfsName(cms,vfsName);
  }
 else {
    uri=OpenCms.getStaticExportManager().getVfsPrefix().concat(vfsName);
  }
  CmsSite currentSite=CmsSiteManager.getCurrentSite(getCms());
  if (currentSite == OpenCms.getSiteManager().getDefaultSite()) {
    serverPrefix=OpenCms.getSiteManager().getWorkplaceServer();
  }
 else {
    if (Boolean.valueOf(secureResource).booleanValue()) {
      serverPrefix=currentSite.getSecureUrl();
    }
 else {
      serverPrefix=currentSite.getUrl();
    }
  }
  return serverPrefix + uri;
}
