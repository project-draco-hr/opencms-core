{
  StringBuffer result=new StringBuffer(128);
  try {
    getCms().getRequestContext().setAttribute(CmsRequestContext.ATTRIBUTE_EDITOR,new Boolean(true));
    Locale locale=getElementLocale();
    result.append("<table class=\"xmlTable\">\n");
    List typeSequence=m_contentDefinition.getTypeSequence();
    Iterator i=typeSequence.iterator();
    while (i.hasNext()) {
      I_CmsXmlSchemaType type=(I_CmsXmlSchemaType)i.next();
      String name=type.getElementName();
      int count=m_content.getIndexCount(name,locale);
      for (int j=0; j < count; j++) {
        I_CmsXmlContentValue value=m_content.getValue(name,locale,j);
        I_CmsXmlWidget widget=m_contentDefinition.getContentHandler().getEditorWidget(value,m_content,m_contentDefinition);
        result.append(widget.getDialogWidget(getCms(),m_content,this,m_contentDefinition,value));
      }
    }
    result.append("</table>\n");
  }
 catch (  Throwable t) {
    OpenCms.getLog(this).error("Error in XML editor",t);
  }
  return result.toString();
}
