{
  m_isPre=false;
  m_isScript=false;
  m_buffer=new StringBuffer(4096);
  StringBuffer newContent=new StringBuffer(content.length() + 32);
  newContent.append(CmsLinkProcessor.C_HTML_START);
  newContent.append(content);
  newContent.append(CmsLinkProcessor.C_HTML_END);
  Lexer lexer=new Lexer();
  Page page;
  try {
    InputStream stream=new ByteArrayInputStream(newContent.toString().getBytes(encoding));
    page=new Page(stream,encoding);
  }
 catch (  UnsupportedEncodingException e) {
    throw new ParserException("Invalid encoding for HTML content parsing '" + encoding + "'");
  }
  lexer.setPage(page);
  m_parser.setLexer(lexer);
  m_parser.visitAllNodesWith(this);
  String result=m_buffer.toString();
  m_buffer=null;
  return result.substring(CmsLinkProcessor.C_HTML_START.length(),result.length() - CmsLinkProcessor.C_HTML_END.length());
}
