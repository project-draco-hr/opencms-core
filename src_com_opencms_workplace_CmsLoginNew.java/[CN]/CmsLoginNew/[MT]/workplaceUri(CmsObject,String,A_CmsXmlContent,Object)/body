{
  try {
    cms.readFileHeader(CmsWorkplaceAction.C_JSP_WORKPLACE_URI);
    return LinkSubstitution.getLinkSubstitution(cms,CmsWorkplaceAction.C_JSP_WORKPLACE_URI);
  }
 catch (  CmsException e) {
    if (e.getType() == CmsException.C_ACCESS_DENIED) {
      return LinkSubstitution.getLinkSubstitution(cms,CmsWorkplaceAction.C_JSP_WORKPLACE_URI);
    }
  }
  return LinkSubstitution.getLinkSubstitution(cms,CmsWorkplaceAction.C_XML_WORKPLACE_URI);
}
