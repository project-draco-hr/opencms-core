{
  int currentProject=cms.onlineProject().getId();
  if ((startProjectId != null) && (!"".equals(startProjectId))) {
    try {
      currentProject=(new Integer(startProjectId)).intValue();
    }
 catch (    NumberFormatException e) {
    }
  }
 else {
    Hashtable startSettings=(Hashtable)cms.getRequestContext().currentUser().getAdditionalInfo(C_ADDITIONAL_INFO_STARTSETTINGS);
    if (startSettings != null) {
      Integer i=(Integer)startSettings.get(C_START_PROJECT);
      if (i != null)       currentProject=i.intValue();
    }
  }
  try {
    if (!cms.accessProject(currentProject)) {
      currentProject=cms.onlineProject().getId();
    }
  }
 catch (  Exception e) {
    currentProject=cms.onlineProject().getId();
  }
  cms.getRequestContext().setCurrentProject(currentProject);
}
