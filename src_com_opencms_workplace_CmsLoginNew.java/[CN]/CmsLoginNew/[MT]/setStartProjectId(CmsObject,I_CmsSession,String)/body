{
  int currentProject=I_CmsConstants.C_PROJECT_ONLINE_ID;
  if ((startProjectId != null) && (!"".equals(startProjectId))) {
    try {
      currentProject=(new Integer(startProjectId)).intValue();
    }
 catch (    NumberFormatException e) {
    }
  }
 else {
    Hashtable startSettings=(Hashtable)cms.getRequestContext().currentUser().getAdditionalInfo(I_CmsConstants.C_ADDITIONAL_INFO_STARTSETTINGS);
    if (startSettings != null) {
      Integer i=(Integer)startSettings.get(I_CmsConstants.C_START_PROJECT);
      if (i != null)       currentProject=i.intValue();
    }
  }
  try {
    if (!cms.accessProject(currentProject)) {
      currentProject=I_CmsConstants.C_PROJECT_ONLINE_ID;
    }
  }
 catch (  Exception e) {
    currentProject=I_CmsConstants.C_PROJECT_ONLINE_ID;
  }
  cms.getRequestContext().setCurrentProject(currentProject);
}
