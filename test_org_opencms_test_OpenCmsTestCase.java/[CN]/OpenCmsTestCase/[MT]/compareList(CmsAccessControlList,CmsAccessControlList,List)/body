{
  boolean isOverwriteAll=false;
  Iterator itTargets=target.getPermissionMap().keySet().iterator();
  while (itTargets.hasNext()) {
    CmsUUID principalId=(CmsUUID)itTargets.next();
    if (principalId.equals(CmsAccessControlEntry.PRINCIPAL_OVERWRITE_ALL_ID)) {
      isOverwriteAll=true;
    }
  }
  HashMap result=new HashMap();
  Map destinationMap=target.getPermissionMap();
  Map sourceMap=source.getPermissionMap();
  Iterator i=sourceMap.entrySet().iterator();
  while (i.hasNext()) {
    Map.Entry entry=(Map.Entry)i.next();
    CmsUUID key=(CmsUUID)entry.getKey();
    CmsPermissionSet value=(CmsPermissionSet)entry.getValue();
    if (destinationMap.containsKey(key)) {
      CmsPermissionSet destValue=(CmsPermissionSet)destinationMap.get(key);
      if (!destValue.equals(value)) {
        result.put(key,key + " " + value+ " != "+ destValue);
      }
    }
 else     if (!isOverwriteAll) {
      result.put(key,"missing " + key);
    }
  }
  if (exclude != null) {
    Iterator l=exclude.iterator();
    while (l.hasNext()) {
      CmsUUID excludeUUID=(CmsUUID)l.next();
      if (result.containsKey(excludeUUID)) {
        result.remove(excludeUUID);
      }
    }
  }
  return new ArrayList(result.values());
}
