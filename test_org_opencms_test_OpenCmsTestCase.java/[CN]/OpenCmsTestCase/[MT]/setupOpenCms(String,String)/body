{
  System.out.println("\n\n\n----- Starting test case: Importing OpenCms VFS data -----");
  setupDatabase();
  if (m_shell != null) {
    try {
      m_shell.exit();
      m_shell=null;
    }
 catch (    Throwable t) {
    }
  }
  copyConfiguration();
  m_shell=new CmsShell(getTestDataPath() + "WEB-INF" + File.separator,"${user}@${project}>",null);
  File script;
  FileInputStream stream=null;
  CmsObject cms=null;
  try {
    script=new File(getTestDataPath() + "scripts/script_base.txt");
    stream=new FileInputStream(script);
    m_shell.start(stream);
    script=new File(getTestDataPath() + "scripts/script_default_folders.txt");
    stream=new FileInputStream(script);
    m_shell.start(stream);
    cms=OpenCms.initCmsObject(OpenCms.getDefaultUsers().getUserGuest());
    cms.loginUser("Admin","admin");
    cms.getRequestContext().setCurrentProject(cms.readProject("_setupProject"));
    importResources(cms,importFolder,targetFolder);
    script=new File(getTestDataPath() + "scripts/script_publish.txt");
    stream=new FileInputStream(script);
    m_shell.start(stream);
    cms.getRequestContext().setCurrentProject(cms.readProject("Offline"));
    cms.getRequestContext().setSiteRoot("/sites/default/");
    System.out.println("----- Starting test cases -----");
  }
 catch (  Throwable t) {
    fail("Unable to setup OpenCms\n" + CmsException.getStackTraceAsString(t));
  }
  return cms;
}
