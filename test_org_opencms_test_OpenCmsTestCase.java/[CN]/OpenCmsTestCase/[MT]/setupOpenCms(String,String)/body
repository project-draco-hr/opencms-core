{
  setupDatabase();
  if (m_shell != null) {
    try {
      m_shell.exit();
      m_shell=null;
    }
 catch (    Throwable t) {
    }
  }
  m_shell=new CmsShell(getTestDataPath() + "WEB-INF" + File.separator,"${user}@${project}>",null);
  File script;
  FileInputStream stream=null;
  script=new File(getTestDataPath() + "scripts/script_base.txt");
  stream=new FileInputStream(script);
  m_shell.start(stream);
  script=new File(getTestDataPath() + "scripts/script_default_folders.txt");
  stream=new FileInputStream(script);
  m_shell.start(stream);
  CmsObject cms=OpenCms.initCmsObject(OpenCms.getDefaultUsers().getUserGuest());
  cms.loginUser("Admin","admin");
  cms.getRequestContext().setCurrentProject(cms.readProject("_setupProject"));
  importResources(cms,importFolder,targetFolder);
  script=new File(getTestDataPath() + "scripts/script_publish.txt");
  stream=new FileInputStream(script);
  m_shell.start(stream);
  cms.getRequestContext().setCurrentProject(cms.readProject("Offline"));
  cms.getRequestContext().setSiteRoot("/sites/default/");
  createStorage(cms,OpenCmsTestResourceStorage.DEFAULT_STORAGE);
  switchStorage(OpenCmsTestResourceStorage.DEFAULT_STORAGE);
  System.out.println("----- Starting test cases -----");
  return cms;
}
