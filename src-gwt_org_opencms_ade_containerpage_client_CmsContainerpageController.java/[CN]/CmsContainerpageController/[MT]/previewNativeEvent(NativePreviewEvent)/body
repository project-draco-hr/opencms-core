{
  Event nativeEvent=Event.as(event.getNativeEvent());
  if (!hasPageChanged()) {
    return;
  }
  if ((nativeEvent.getTypeInt() == Event.ONCLICK)) {
    EventTarget target=nativeEvent.getEventTarget();
    if (!Element.is(target)) {
      return;
    }
    Element element=Element.as(target);
    element=CmsDomUtil.getAncestor(element,CmsDomUtil.Tag.a);
    if (element == null) {
      return;
    }
    AnchorElement anc=AnchorElement.as(element);
    final String uri=anc.getHref();
    if (CmsStringUtil.isEmptyOrWhitespaceOnly(uri) || (CmsDomUtil.getAncestor(element,"x-date-picker") != null)) {
      return;
    }
    nativeEvent.preventDefault();
    nativeEvent.stopPropagation();
    m_handler.leavePage(uri);
  }
  if ((event.getTypeInt() == Event.ONKEYDOWN) && (nativeEvent.getKeyCode() == 116)) {
    nativeEvent.preventDefault();
    nativeEvent.stopPropagation();
    m_handler.leavePage(Window.Location.getHref());
  }
}
