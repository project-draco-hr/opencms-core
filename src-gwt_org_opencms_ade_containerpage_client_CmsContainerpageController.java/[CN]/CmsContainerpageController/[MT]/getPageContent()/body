{
  List<CmsContainer> containers=new ArrayList<CmsContainer>();
  for (  Entry<String,org.opencms.ade.containerpage.client.ui.CmsContainerPageContainer> entry : m_targetContainers.entrySet()) {
    CmsContainerJso cnt=m_containers.get(entry.getKey());
    if (!cnt.isDetailView()) {
      List<CmsContainerElement> elements=new ArrayList<CmsContainerElement>();
      Iterator<Widget> elIt=entry.getValue().iterator();
      while (elIt.hasNext()) {
        try {
          CmsContainerPageElementPanel elementWidget=(CmsContainerPageElementPanel)elIt.next();
          CmsContainerElement element=new CmsContainerElement();
          element.setClientId(elementWidget.getId());
          element.setResourceType(elementWidget.getNewType());
          element.setNew(elementWidget.isNew());
          element.setSitePath(elementWidget.getSitePath());
          elements.add(element);
        }
 catch (        ClassCastException e) {
          CmsDebugLog.getInstance().printLine("WARNING: there is an inappropriate element within a container");
        }
      }
      containers.add(new CmsContainer(entry.getKey(),cnt.getType(),cnt.getWidth(),cnt.getMaxElements(),elements));
    }
  }
  return containers;
}
