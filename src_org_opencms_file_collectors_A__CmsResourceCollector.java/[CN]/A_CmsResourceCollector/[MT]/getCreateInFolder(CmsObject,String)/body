{
  CmsCollectorData data=new CmsCollectorData(param);
  String foldername=CmsResource.getFolderPath(data.getFileName());
  List resources=cms.readResources(foldername,CmsResourceFilter.ALL,false);
  List result=new ArrayList(resources.size());
  for (int i=0; i < resources.size(); i++) {
    CmsResource resource=(CmsResource)resources.get(i);
    result.add(resource.getRootPath());
  }
  String fileName=cms.getRequestContext().addSiteRoot(data.getFileName());
  int fileNameLength=fileName.length();
  String checkFileName;
  String checkName;
  StringBuffer checkTempFileName;
  String number;
  CmsMacroResolver resolver=CmsMacroResolver.newInstance();
  int j=0;
  do {
    number=NUMBER_FORMAT.sprintf(++j);
    resolver.addMacro(MACRO_NUMBER,number);
    checkFileName=resolver.resolveMacros(fileName);
    checkName=CmsResource.getName(checkFileName);
    checkTempFileName=new StringBuffer(fileNameLength);
    checkTempFileName.append(CmsResource.getFolderPath(checkFileName));
    checkTempFileName.append(CmsWorkplace.TEMP_FILE_PREFIX);
    checkTempFileName.append(checkName);
  }
 while (result.contains(checkFileName) || result.contains(checkTempFileName.toString()));
  return cms.getRequestContext().removeSiteRoot(checkFileName);
}
