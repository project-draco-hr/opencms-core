{
  int maxOccurrence=getEntityType().getAttributeMaxOccurrence(m_attributeName);
  EntityAttribute attribute=m_entity.getAttribute(m_attributeName);
  boolean mayHaveMore=((attribute == null) || (attribute.getValueCount() < maxOccurrence));
  if (mayHaveMore && getAttributeType().isSimpleType()) {
    I_FormEditWidget widget=m_widgetService.getAttributeFormWidget(m_attributeName);
    m_entity.addAttributeValue(m_attributeName,value);
    String defaultValue=m_widgetService.getDefaultAttributeValue(m_attributeName,getSimplePath(m_entity.getAttribute(m_attributeName).getValueCount() - 1));
    AttributeValueView valueView=null;
    if ((m_attributeValueViews.size() == 1) && !m_attributeValueViews.get(0).hasValue()) {
      valueView=m_attributeValueViews.get(0);
      valueView.setActive();
      valueView.getValueWidget().setValue(value);
    }
 else {
      valueView=new AttributeValueView(this,m_widgetService.getAttributeLabel(m_attributeName),m_widgetService.getAttributeHelp(m_attributeName));
      if (m_widgetService.isDisplaySingleLine(m_attributeName)) {
        valueView.setCompactMode(AttributeValueView.COMPACT_MODE_SINGLE_LINE);
      }
      ((FlowPanel)m_attributeValueViews.get(0).getParent()).add(valueView);
      valueView.setValueWidget(widget,value,defaultValue,true);
    }
    UndoRedoHandler handler=UndoRedoHandler.getInstance();
    if (handler.isIntitalized()) {
      handler.addChange(m_entity.getId(),m_attributeName,m_entity.getAttribute(m_attributeName).getValueCount() - 1,ChangeType.add);
    }
    updateButtonVisisbility();
  }
}
