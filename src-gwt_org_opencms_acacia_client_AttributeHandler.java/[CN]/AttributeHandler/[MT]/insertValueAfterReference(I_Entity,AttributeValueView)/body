{
  int valueIndex=-1;
  if (reference.getElement().getNextSiblingElement() == null) {
    m_entity.addAttributeValue(m_attributeName,value);
  }
 else {
    valueIndex=reference.getValueIndex() + 1;
    m_entity.insertAttributeValue(m_attributeName,value,valueIndex);
  }
  AttributeValueView valueWidget=reference;
  if (reference.hasValue()) {
    valueWidget=new AttributeValueView(this,m_widgetService.getAttributeLabel(m_attributeName),m_widgetService.getAttributeHelp(m_attributeName));
    Renderer.setAttributeChoice(m_widgetService,valueWidget,getAttributeType());
    if (valueIndex == -1) {
      ((FlowPanel)reference.getParent()).add(valueWidget);
    }
 else {
      ((FlowPanel)reference.getParent()).insert(valueWidget,valueIndex);
      m_widgetService.addChangedOrderPath(getSimplePath(-1));
    }
  }
  valueIndex=valueWidget.getValueIndex();
  insertHandlers(valueIndex);
  I_EntityRenderer renderer=m_widgetService.getRendererForAttribute(m_attributeName,getAttributeType());
  valueWidget.setValueEntity(renderer,value);
}
