{
  CmsObject cms=getCmsObject();
  I_CmsPasswordHandler passwordHandler=new CmsDefaultPasswordHandler();
  CmsUser user;
  if ("com.opencms.legacy.CmsLegacyPasswordHandler".equals(OpenCms.getPasswordHandler().getClass().getName())) {
    echo("Skipping test since digest encoding is set to legacy");
    return;
  }
  user=cms.readUser("Admin");
  assertEquals(user.getPassword(),passwordHandler.digest("admin","MD5","UTF-8"));
  user=cms.readUser("Guest");
  assertEquals(user.getPassword(),passwordHandler.digest("","MD5","UTF-8"));
  user=cms.readUser("test1");
  assertEquals(user.getPassword(),passwordHandler.digest("test1","MD5","UTF-8"));
  user=cms.readUser("test2");
  assertEquals(user.getPassword(),passwordHandler.digest("test2","MD5","UTF-8"));
}
