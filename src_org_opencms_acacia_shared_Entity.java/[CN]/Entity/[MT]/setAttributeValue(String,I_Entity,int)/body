{
  if (m_simpleAttributes.containsKey(attributeName)) {
    throw new RuntimeException("Attribute already exists with a simple type value.");
  }
  if (!(value instanceof Entity)) {
    value=transformToSerializableEntity(value);
  }
  if (!m_entityAttributes.containsKey(attributeName)) {
    if (index != 0) {
      throw new IndexOutOfBoundsException();
    }
 else {
      List<Entity> values=new ArrayList<Entity>();
      values.add((Entity)value);
      m_entityAttributes.put(attributeName,values);
    }
  }
 else {
    m_entityAttributes.get(attributeName).add(index,(Entity)value);
  }
}
