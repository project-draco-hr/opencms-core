{
  try {
    super.processPOIFSReaderEvent(event);
    if (!event.getName().startsWith(POWERPOINT_EVENT_NAME)) {
      return;
    }
    DocumentInputStream input=event.getStream();
    byte[] buffer=new byte[input.available()];
    input.read(buffer,0,input.available());
    for (int i=0; i < buffer.length - 20; i++) {
      int type=LittleEndian.getUShort(buffer,i + 2);
      int size=(int)LittleEndian.getUInt(buffer,i + 4) + 3;
      String encoding=null;
switch (type) {
case PPT_TEXTBYTE_ATOM:
        encoding=ENCODING_CP1252;
case PPT_TEXTCHAR_ATOM:
      if (encoding == null) {
        encoding=ENCODING_UTF16;
      }
    int start=i + 4 + 1;
  int end=start + size;
byte[] buf=new byte[size];
System.arraycopy(buffer,start,buf,0,buf.length);
m_buffer.append(CmsEncoder.createString(buf,encoding));
i=end;
default :
}
}
}
 catch (Exception e) {
}
}
