{
  CmsObject cms=getCmsObject();
  echo("Testing default suffix statix export link generation");
  String folder="/folder1/subfolder11/subsubfolder111/";
  String vfsName1=folder + "image.gif";
  String vfsName2=folder + "xml.xml";
  CmsProperty exportProp=cms.readPropertyObject(vfsName1,CmsPropertyDefinition.PROPERTY_EXPORT,true);
  assertTrue(exportProp.isNullProperty());
  OpenCms.getStaticExportManager().setDefault("false");
  String rfsPrefix=OpenCms.getStaticExportManager().getRfsPrefix(cms.getRequestContext().getSiteRoot() + folder);
  String expected1, expected2;
  cms.getRequestContext().setCurrentProject(cms.readProject("Online"));
  echo("Testing default export based on file suffix");
  assertTrue(OpenCms.getStaticExportManager().isSuffixExportable(vfsName1));
  expected1=rfsPrefix + cms.getRequestContext().getSiteRoot() + vfsName1;
  checkLinkWithoutParameters(cms,vfsName1,expected1);
  checkLinkWithParameters(cms,vfsName1,expected1);
  assertEquals(expected1,OpenCms.getLinkManager().substituteLink(cms,vfsName1));
  assertFalse(OpenCms.getStaticExportManager().isSuffixExportable(vfsName2));
  expected1=rfsPrefix + cms.getRequestContext().getSiteRoot() + vfsName2;
  checkLinkWithoutParameters(cms,vfsName2,expected1);
  checkLinkWithParameters(cms,vfsName2,expected1);
  expected2=OpenCms.getStaticExportManager().getVfsPrefix() + vfsName2;
  assertEquals(expected2,OpenCms.getLinkManager().substituteLink(cms,vfsName2));
  echo("Testing default export based on file suffix with 'exportname' property set");
  cms.getRequestContext().setCurrentProject(cms.readProject("Offline"));
  cms.lockResource(folder);
  cms.writePropertyObject(folder,new CmsProperty(CmsPropertyDefinition.PROPERTY_EXPORTNAME,"testfolder",null));
  cms.unlockResource(folder);
  cms.publishProject();
  cms.getRequestContext().setCurrentProject(cms.readProject("Online"));
  assertTrue(OpenCms.getStaticExportManager().isSuffixExportable(vfsName1));
  expected1=rfsPrefix + "/testfolder/image.gif";
  checkLinkWithoutParameters(cms,vfsName1,expected1);
  checkLinkWithParameters(cms,vfsName1,expected1);
  assertEquals(expected1,OpenCms.getLinkManager().substituteLink(cms,vfsName1));
  assertFalse(OpenCms.getStaticExportManager().isSuffixExportable(vfsName2));
  expected1=rfsPrefix + "/testfolder/xml.xml";
  checkLinkWithoutParameters(cms,vfsName2,expected1);
  checkLinkWithParameters(cms,vfsName2,expected1);
  expected2=OpenCms.getStaticExportManager().getVfsPrefix() + vfsName2;
  assertEquals(expected2,OpenCms.getLinkManager().substituteLink(cms,vfsName2));
}
