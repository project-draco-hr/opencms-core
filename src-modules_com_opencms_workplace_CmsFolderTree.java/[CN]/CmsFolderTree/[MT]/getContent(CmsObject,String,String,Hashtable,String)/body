{
  CmsXmlWpTemplateFile xmlTemplateDocument=new CmsXmlWpTemplateFile(cms,templateFile);
  I_CmsSession session=CmsXmlTemplateLoader.getSession(cms.getRequestContext(),true);
  String formname=(String)parameters.get(CmsWorkplaceDefault.C_PARA_FORMNAME);
  if (formname != null) {
    session.putValue(CmsWorkplaceDefault.C_PARA_FORMNAME,formname);
  }
  formname=(String)session.getValue(CmsWorkplaceDefault.C_PARA_FORMNAME);
  String varname=(String)parameters.get(CmsWorkplaceDefault.C_PARA_VARIABLE);
  if (varname != null) {
    session.putValue(CmsWorkplaceDefault.C_PARA_VARIABLE,varname);
  }
  varname=(String)session.getValue(CmsWorkplaceDefault.C_PARA_VARIABLE);
  String files=(String)parameters.get(CmsWorkplaceDefault.C_PARA_VIEWFILE);
  if (files != null) {
    if (files.equals("yes")) {
      session.putValue(CmsWorkplaceDefault.C_PARA_VIEWFILE,files);
    }
 else {
      session.removeValue(CmsWorkplaceDefault.C_PARA_VIEWFILE);
    }
  }
  String offselect=(String)parameters.get("onlineselect");
  if (offselect != null) {
    if ("yes".equals(offselect)) {
      session.putValue("onlineselect_in_foldertree",offselect);
    }
 else {
      session.removeValue("onlineselect_in_foldertree");
    }
  }
  xmlTemplateDocument.setData("FORMNAME",formname);
  xmlTemplateDocument.setData("VARIABLE",varname);
  return startProcessing(cms,xmlTemplateDocument,"",parameters,"template");
}
