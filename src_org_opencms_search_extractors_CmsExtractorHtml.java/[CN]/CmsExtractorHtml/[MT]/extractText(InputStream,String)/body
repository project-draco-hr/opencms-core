{
  if (CmsStringUtil.isEmpty(encoding)) {
    encoding=OpenCms.getSystemInfo().getDefaultEncoding();
  }
  Parser parser=new Parser();
  Lexer lexer=new Lexer();
  Page page=new Page(in,encoding);
  lexer.setPage(page);
  parser.setLexer(lexer);
  StringBean stringBean=new StringBean();
  parser.visitAllNodesWith(stringBean);
  String result=stringBean.getStrings();
  result=removeControlChars(result);
  return new CmsExtractionResult(result);
}
