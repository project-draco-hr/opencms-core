{
  folder=CmsResource.getFolderPath(folder);
  if (endlevel < startlevel) {
    return Collections.EMPTY_LIST;
  }
  int currentlevel=CmsResource.getPathLevel(folder);
  if (currentlevel < endlevel) {
    endlevel=currentlevel;
  }
  if (startlevel == endlevel) {
    return getNavigationForFolder(cms,CmsResource.getPathPart(folder,startlevel),startlevel);
  }
  ArrayList result=new ArrayList();
  float parentcount=0;
  for (int i=startlevel; i <= endlevel; i++) {
    String currentfolder=CmsResource.getPathPart(folder,i);
    List entries=getNavigationForFolder(cms,currentfolder);
    if (parentcount > 0) {
      for (int it=0; it < entries.size(); i++) {
        CmsJspNavElement e=(CmsJspNavElement)entries.get(it);
        e.setNavPosition(e.getNavPosition() + parentcount);
      }
    }
    result.addAll(entries);
    Collections.sort(result);
    float pos=0;
    int count=0;
    String nextfolder=CmsResource.getPathPart(folder,i + 1);
    parentcount=0;
    for (int it=0; it < result.size(); it++) {
      pos=10000 * (++count);
      CmsJspNavElement e=(CmsJspNavElement)result.get(it);
      e.setNavPosition(pos);
      if (e.getResourceName().startsWith(nextfolder)) {
        parentcount=pos;
      }
    }
    if (parentcount == 0) {
      parentcount=pos;
    }
  }
  return result;
}
