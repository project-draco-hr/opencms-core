{
  List<CmsProperty> properties;
  CmsResource resource;
  try {
    resource=m_cms.readResource(sitePath);
    if (resource.isFolder() && !sitePath.endsWith("/")) {
      sitePath=sitePath + "/";
    }
    properties=m_cms.readPropertyObjects(resource,false);
  }
 catch (  Exception e) {
    LOG.error(e.getLocalizedMessage(),e);
    return null;
  }
  int level=CmsResource.getPathLevel(sitePath);
  if (sitePath.endsWith("/")) {
    level--;
  }
  return new CmsJspNavElement(sitePath,resource,CmsProperty.toMap(properties),level);
}
