{
  boolean noLimit=false;
  if (endLevel < 0) {
    noLimit=true;
  }
  ArrayList list=new ArrayList();
  ArrayList curnav=getNavigationForFolder(cms,folder);
  Iterator i=curnav.iterator();
  while (i.hasNext()) {
    CmsJspNavElement ne=(CmsJspNavElement)i.next();
    list.add(ne);
    if (ne.isFolderLink() && (noLimit || (ne.getNavTreeLevel() < endLevel))) {
      ArrayList subnav=getSiteNavigation(cms,ne.getResourceName(),endLevel);
      list.addAll(subnav);
    }
  }
  return list;
}
