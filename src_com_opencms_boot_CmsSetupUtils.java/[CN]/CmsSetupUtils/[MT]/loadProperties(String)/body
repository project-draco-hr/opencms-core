{
  FileInputStream input=null;
  ExtendedProperties properties=null;
  try {
    input=new FileInputStream(new File(path));
    properties=new ExtendedProperties();
    properties.load(input);
    input.close();
  }
 catch (  IOException e) {
    try {
      input.close();
    }
 catch (    Exception ex) {
    }
    throw e;
  }
  for (Iterator i=properties.keySet().iterator(); i.hasNext(); ) {
    String key=(String)i.next();
    Object obj=properties.get(key);
    String value[]={};
    if (obj instanceof Vector) {
      value=(String[])((Vector)obj).toArray(value);
    }
 else {
      String v[]={(String)obj};
      value=v;
    }
    for (int j=0; j < value.length; j++) {
      value[j]=CmsStringSubstitution.substitute(value[j],"\\,",",");
      value[j]=CmsStringSubstitution.substitute(value[j],"\\=","=");
    }
    if (value.length > 1) {
      properties.put(key,new Vector(Arrays.asList(value)));
    }
 else {
      properties.put(key,value[0]);
    }
  }
  return properties;
}
