{
  boolean failed=false;
  int lockCount=0;
  for (  CmsPair<CmsSingleResourceLock,Long> lockRequest : m_lockRequests) {
    CmsSingleResourceLock lock=lockRequest.getFirst();
    Long timestampObj=lockRequest.getSecond();
    long timestamp=timestampObj.longValue();
    boolean result;
    if (timestamp == -1) {
      result=lock.lock();
    }
 else {
      result=lock.lockAndCheck(timestamp);
    }
    if (!result) {
      failed=true;
      break;
    }
    lockCount+=1;
  }
  if (failed) {
    for (int j=0; j < lockCount; j++) {
      m_lockRequests.get(j).getFirst().unlock();
    }
  }
  return !failed;
}
