{
  List elementList=null;
  try {
    elementList=CmsDialogElements.computeElements(getCms(),getParamTempfile());
  }
 catch (  CmsException e) {
    List bodies=m_page.getNames(getElementLocale());
    Collections.sort(bodies);
    int currentIndex=bodies.indexOf(getParamElementname());
    if (currentIndex == -1) {
      currentIndex=bodies.indexOf(I_CmsConstants.C_XML_BODY_ELEMENT);
      setParamElementname(I_CmsConstants.C_XML_BODY_ELEMENT);
    }
    return buildSelect(attributes,bodies,bodies,currentIndex,false);
  }
  int counter=0;
  int currentIndex=-1;
  Iterator i=elementList.iterator();
  List options=new ArrayList(elementList.size());
  List values=new ArrayList(elementList.size());
  while (i.hasNext()) {
    String[] currentElement=(String[])i.next();
    String elementName=currentElement[0];
    String elementNice=currentElement[1];
    if (getParamElementname().equals(elementName)) {
      currentIndex=counter;
    }
    if ((!m_page.hasElement(elementName,getElementLocale()) && "1".equals(currentElement[2])) || m_page.isEnabled(elementName,getElementLocale())) {
      options.add(elementNice);
      values.add(elementName);
      counter++;
    }
  }
  return buildSelect(attributes,options,values,currentIndex,false);
}
