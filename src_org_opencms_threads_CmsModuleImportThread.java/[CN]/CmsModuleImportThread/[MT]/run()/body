{
  try {
    if (DEBUG) {
      System.err.println("CmsAdminModuleImportThread() started");
    }
    String moduleName=m_moduleName.replace('\\','/');
    CmsProject project=null;
    try {
      getCms().getRequestContext().saveSiteRoot();
      getCms().getRequestContext().setSiteRoot("/");
      project=getCms().createProject("ImportModule","A System generated project to import the module " + moduleName,OpenCms.getDefaultUsers().getGroupAdministrators(),OpenCms.getDefaultUsers().getGroupAdministrators(),I_CmsConstants.C_PROJECT_TYPE_TEMPORARY);
      getCms().getRequestContext().setCurrentProject(project.getId());
      getCms().copyResourceToProject("/");
    }
  finally {
      getCms().getRequestContext().restoreSiteRoot();
    }
    getReport().print(getReport().key("report.import_module_begin"),I_CmsReport.C_FORMAT_HEADLINE);
    getReport().println(" <i>" + moduleName + "</i>",I_CmsReport.C_FORMAT_HEADLINE);
    m_registry.importModule(m_zipName,m_conflictFiles,getReport());
    getReport().println(getReport().key("report.publish_project_begin"),I_CmsReport.C_FORMAT_HEADLINE);
    getCms().unlockProject(project.getId());
    getCms().publishProject(getReport());
    getReport().println(getReport().key("report.publish_project_end"),I_CmsReport.C_FORMAT_HEADLINE);
    getReport().println(getReport().key("report.import_module_end"),I_CmsReport.C_FORMAT_HEADLINE);
    if (DEBUG) {
      System.err.println("CmsAdminModuleImportThread() finished");
    }
  }
 catch (  CmsException e) {
    getReport().println(e);
    if (OpenCms.isLogging(CmsLog.CHANNEL_MAIN,CmsLog.LEVEL_ERROR)) {
      OpenCms.log(CmsLog.CHANNEL_MAIN,CmsLog.LEVEL_ERROR,e.getMessage());
    }
    if (DEBUG) {
      System.err.println("CmsAdminModuleImportThread() Exception:" + e.getMessage());
    }
  }
}
