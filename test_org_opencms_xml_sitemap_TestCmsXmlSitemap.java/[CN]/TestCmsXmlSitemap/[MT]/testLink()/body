{
  CmsObject cms=getCmsObject();
  String contentName="/containerpage/content.html";
  CmsFile contentFile=cms.readFile(contentName);
  String xsdName="/containerpage/content.xsd";
  CmsResource xsdResource=cms.readResource(xsdName);
  List<CmsRelation> relations=cms.getRelationsForResource(contentFile,CmsRelationFilter.TARGETS.filterType(CmsRelationType.XSD));
  assertEquals(1,relations.size());
  assertRelation(new CmsRelation(contentFile,xsdResource,CmsRelationType.XSD),relations.get(0));
  relations=cms.getRelationsForResource(contentFile,CmsRelationFilter.TARGETS);
  assertEquals(1,relations.size());
  CmsXmlContent contentXml=CmsXmlContentFactory.unmarshal(cms,contentFile);
  I_CmsXmlContentValue contentValue=contentXml.getValue("Text",Locale.ENGLISH);
  contentValue.setStringValue(cms,"<a href='/'>sitemap link</a>");
  contentFile.setContents(contentXml.marshal());
  cms.lockResource(contentName);
  cms.writeFile(contentFile);
  relations=cms.getRelationsForResource(contentFile,CmsRelationFilter.TARGETS.filterType(CmsRelationType.XSD));
  assertEquals(1,relations.size());
  assertRelation(new CmsRelation(contentFile,xsdResource,CmsRelationType.XSD),relations.get(0));
  relations=cms.getRelationsForResource(contentFile,CmsRelationFilter.TARGETS.filterType(CmsRelationType.HYPERLINK));
  assertEquals(1,relations.size());
  assertRelation(new CmsRelation(contentFile,OpenCms.getSitemapManager().getEntryForUri(cms,"/"),CmsRelationType.HYPERLINK),relations.get(0));
  relations=cms.getRelationsForResource(contentFile,CmsRelationFilter.TARGETS);
  assertEquals(2,relations.size());
}
