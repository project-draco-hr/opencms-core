{
  try {
    m_importFile=importFile;
    m_importPath=importPath;
    m_cms=cms;
    getImportResource();
    m_cms.lockResource(m_importPath);
    if (m_zipStreamIn == null) {
      importResources(m_importResource,m_importPath);
    }
 else {
      importZipResource(m_zipStreamIn,m_importPath,false);
    }
    m_cms.unlockResource(m_importPath,false);
    cms.joinLinksToTargets(new CmsShellReport());
  }
 catch (  Exception exc) {
    throw new CmsException(CmsException.C_UNKNOWN_EXCEPTION,exc);
  }
}
