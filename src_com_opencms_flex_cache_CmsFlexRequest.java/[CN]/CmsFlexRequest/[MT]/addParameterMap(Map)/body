{
  if (map == null)   return m_parameters;
  if ((m_parameters == null) || (m_parameters.size() == 0)) {
    m_parameters=Collections.unmodifiableMap(map);
  }
 else {
    HashMap parameters=new HashMap();
    parameters.putAll(m_parameters);
    Iterator it=map.keySet().iterator();
    while (it.hasNext()) {
      String key=(String)it.next();
      if (parameters.containsKey(key)) {
        String[] oldValues=(String[])parameters.get(key);
        String[] newValues=(String[])map.get(key);
        String[] mergeValues=new String[oldValues.length + newValues.length];
        System.arraycopy(oldValues,0,mergeValues,0,oldValues.length);
        System.arraycopy(newValues,0,mergeValues,oldValues.length,newValues.length);
        parameters.put(key,mergeValues);
      }
 else {
        parameters.put(key,map.get(key));
      }
    }
    m_parameters=Collections.unmodifiableMap(parameters);
  }
  return m_parameters;
}
