{
  if (DEBUG)   System.err.println(getClass().getName() + " location=" + location);
  if (location == null)   return null;
  if (location.startsWith("/"))   return location;
  java.net.URL url=null;
  try {
    url=new java.net.URL(location);
  }
 catch (  java.net.MalformedURLException e1) {
    String requrl=getRequestURL().toString();
    try {
      url=new java.net.URL(new java.net.URL(requrl),location);
    }
 catch (    java.net.MalformedURLException e2) {
      return location;
    }
  }
  String uri=url.getPath();
  if (uri.startsWith(A_OpenCms.getOpenCmsContext())) {
    uri=uri.substring(A_OpenCms.getOpenCmsContext().length());
  }
  if (url.getQuery() != null)   uri+="?" + url.getQuery();
  if (DEBUG)   System.err.println(getClass().getName() + " result=" + uri);
  return uri;
}
