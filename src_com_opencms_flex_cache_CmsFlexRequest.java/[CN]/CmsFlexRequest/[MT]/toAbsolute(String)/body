{
  if (DEBUG)   System.err.println("FlexRequest.toAbsolute(): location=" + location);
  if (location == null)   return (location);
  java.net.URL url=null;
  try {
    url=new java.net.URL(location);
  }
 catch (  java.net.MalformedURLException e1) {
    String requrl=getRequestURL().toString();
    try {
      url=new java.net.URL(new java.net.URL(requrl),location);
    }
 catch (    java.net.MalformedURLException e2) {
      return location;
    }
  }
  String uri=url.getPath();
  String context=getContextPath() + getServletPath();
  if (uri.startsWith(context)) {
    uri=uri.substring(context.length());
  }
  if (url.getQuery() != null)   uri+="?" + url.getQuery();
  if (DEBUG)   System.err.println("FlexRequest.toAbsolute(): result=" + uri);
  return uri;
}
