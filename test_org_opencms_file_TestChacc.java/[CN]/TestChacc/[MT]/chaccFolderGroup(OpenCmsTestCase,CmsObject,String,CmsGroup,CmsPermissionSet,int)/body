{
  tc.storeResources(cms,resource1);
  cms.chacc(resource1,"group",group.getName(),permissions.getAllowedPermissions(),permissions.getDeniedPermissions(),flags);
  tc.assertFilter(cms,resource1,OpenCmsTestResourceFilter.FILTER_CHACC);
  CmsResource res=cms.readFileHeader(resource1,CmsResourceFilter.ALL);
  CmsAccessControlEntry ace=new CmsAccessControlEntry(res.getResourceId(),group.getId(),permissions.getAllowedPermissions(),permissions.getDeniedPermissions(),flags + I_CmsConstants.C_ACCESSFLAGS_GROUP);
  tc.assertAce(cms,resource1,ace);
  int denied=permissions.getDeniedPermissions();
  if ((flags & I_CmsConstants.C_ACCESSFLAGS_OVERWRITE) > 0) {
    denied=0;
  }
  CmsPermissionSet permission=new CmsPermissionSet(permissions.getAllowedPermissions(),denied);
  tc.assertAcl(cms,resource1,group.getId(),permission);
  List subresources=tc.getSubtree(cms,resource1);
  Iterator j=subresources.iterator();
  while (j.hasNext()) {
    CmsResource subRes=(CmsResource)j.next();
    String subResName=cms.readAbsolutePath(subRes);
    tc.assertFilter(cms,subResName,OpenCmsTestResourceFilter.FILTER_CHACC);
    ace=new CmsAccessControlEntry(res.getResourceId(),group.getId(),permissions.getAllowedPermissions(),permissions.getDeniedPermissions(),flags + I_CmsConstants.C_ACCESSFLAGS_GROUP + I_CmsConstants.C_ACCESSFLAGS_INHERITED);
    tc.assertAce(cms,subResName,ace);
    permission=new CmsPermissionSet(permissions.getAllowedPermissions(),denied);
    tc.assertAcl(cms,resource1,subResName,group.getId(),permission);
  }
}
