{
  if (m_current == null) {
    m_current=LazyMap.decorate(new HashMap<CmsJspNavElement,Boolean>(),new Transformer(){
      /** 
 * The log object for this class. 
 */
      private final Log LOGG=CmsLog.getLog(CmsTemplateMenu.class);
      /** 
 * @see org.apache.commons.collections.Transformer#transform(java.lang.Object)
 */
      public Object transform(      Object input){
        CmsJspNavElement elem=(CmsJspNavElement)input;
        String uri=getCmsObject().getRequestContext().getUri();
        CmsJspNavElement uriElem=null;
        try {
          uriElem=new CmsJspNavElement(uri,CmsProperty.toMap(getCmsObject().readPropertyObjects(uri,false)));
        }
 catch (        CmsException e) {
          LOGG.debug(e.getLocalizedMessage(),e);
        }
        if (elem.getResourceName().equals(uri)) {
          return Boolean.TRUE;
        }
        String path=null;
        try {
          CmsResource resource=getCmsObject().readDefaultFile(elem.getResourceName());
          path=getCmsObject().getSitePath(resource);
        }
 catch (        CmsException e) {
          LOGG.debug(e.getLocalizedMessage(),e);
        }
        if ((path == null) || ((uriElem != null) && uriElem.isInNavigation())) {
          path=elem.getResourceName();
        }
        if (uri.equals(path)) {
          return Boolean.TRUE;
        }
        CmsJspNavElement navElem=uriElem;
        while ((navElem != null) && !navElem.isInNavigation()) {
          String parentPath=CmsResource.getParentFolder(navElem.getResourceName());
          if (parentPath == null) {
            break;
          }
          try {
            navElem=new CmsJspNavElement(parentPath,CmsProperty.toMap(getCmsObject().readPropertyObjects(parentPath,false)));
          }
 catch (          CmsException e) {
            LOGG.debug(e.getLocalizedMessage());
            break;
          }
        }
        if ((navElem != null) && (uriElem != null) && !uriElem.isInNavigation()) {
          return Boolean.valueOf(elem.equals(navElem));
        }
        return Boolean.FALSE;
      }
    }
);
  }
  return m_current;
}
