{
  CmsObject cms=getCmsObject();
  echo("Testing lock state after sibling creation");
  String source="/folder2/index.html";
  String destination1="/folder2/index_sib1.html";
  String destination2="/folder2/index_sib2.html";
  storeResources(cms,source);
  cms.copyResource(source,destination1,I_CmsConstants.C_COPY_AS_SIBLING);
  assertLock(cms,source,CmsLock.C_TYPE_SHARED_EXCLUSIVE);
  assertLock(cms,destination1,CmsLock.C_TYPE_EXCLUSIVE);
  cms.copyResource(source,destination2,I_CmsConstants.C_COPY_AS_SIBLING);
  assertLock(cms,source,CmsLock.C_TYPE_SHARED_EXCLUSIVE);
  assertLock(cms,destination1,CmsLock.C_TYPE_EXCLUSIVE);
  assertLock(cms,destination2,CmsLock.C_TYPE_SHARED_EXCLUSIVE);
  source="/folder2/page1.html";
  destination1="/folder2/page1_sib1.html";
  destination2="/folder2/page1_sib2.html";
  cms.lockResource(source);
  cms.createSibling(source,destination1,null);
  assertLock(cms,source,CmsLock.C_TYPE_EXCLUSIVE);
  assertLock(cms,destination1,CmsLock.C_TYPE_SHARED_EXCLUSIVE);
  cms.createSibling(destination1,destination2,null);
  assertLock(cms,source,CmsLock.C_TYPE_EXCLUSIVE);
  assertLock(cms,destination1,CmsLock.C_TYPE_SHARED_EXCLUSIVE);
  assertLock(cms,destination2,CmsLock.C_TYPE_SHARED_EXCLUSIVE);
}
