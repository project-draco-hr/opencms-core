{
  m_currentEvent=event;
  if (m_dragging && (event.getNativeButton() == NativeEvent.BUTTON_LEFT)) {
    m_dragging=false;
    if (m_currentTarget != null) {
      elementDropAction();
      m_dragElement.onDropTarget(this,m_currentTarget);
      m_currentTarget.onDrop(this);
      m_currentTarget=null;
    }
 else {
      elementCancelAction();
      m_dragElement.onDragCancel(this);
    }
    DOM.releaseCapture(m_dragElement.getElement());
    event.preventDefault();
    event.stopPropagation();
    restoreElementAfterDrag();
    m_dragElement.onDragStop(this);
  }
}
