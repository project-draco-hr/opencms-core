{
  CmsObject cms=getCmsObject();
  if (change.getParentId() != null) {
    CmsResource parentFolder=cms.readResource(change.getParentId());
    String entryPath="";
    CmsResource entryFolder=null;
    if ("xmlredirect".equals(OpenCms.getResourceManager().getResourceType(change.getNewResourceTypeId()).getTypeName())) {
      entryPath=CmsStringUtil.joinPaths(cms.getSitePath(parentFolder),change.getName());
    }
 else {
      String entryFolderPath=CmsStringUtil.joinPaths(cms.getSitePath(parentFolder),change.getName() + "/");
      entryFolder=new CmsResource(change.getEntryId(),new CmsUUID(),entryFolderPath,CmsResourceTypeFolder.getStaticTypeId(),true,0,cms.getRequestContext().currentProject().getUuid(),CmsResource.STATE_NEW,System.currentTimeMillis(),cms.getRequestContext().currentUser().getId(),System.currentTimeMillis(),cms.getRequestContext().currentUser().getId(),CmsResource.DATE_RELEASED_DEFAULT,CmsResource.DATE_EXPIRED_DEFAULT,1,0,System.currentTimeMillis(),0);
      entryFolder=cms.createResource(entryFolderPath,entryFolder,null,generateInheritProperties(change,entryFolder));
      entryPath=CmsStringUtil.joinPaths(entryFolderPath,"index.html");
    }
    byte[] content=null;
    if (change.getNewCopyResourceId() != null) {
      CmsResource copyPage=cms.readResource(change.getNewCopyResourceId());
      content=cms.readFile(copyPage).getContents();
    }
    CmsResource newRes=cms.createResource(entryPath,change.getNewResourceTypeId(),content,generateOwnProperties(change));
    if (entryFolder != null) {
      tryUnlock(entryFolder);
    }
    tryUnlock(newRes);
  }
}
