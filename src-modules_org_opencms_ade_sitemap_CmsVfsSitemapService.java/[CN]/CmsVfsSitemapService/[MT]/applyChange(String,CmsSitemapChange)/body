{
  CmsObject cms=getCmsObject();
  CmsResource configFile=null;
  CmsClientSitemapEntry changedEntry=null;
  if (change.hasDetailPageInfos()) {
    CmsSitemapConfigurationData sitemapConfig=OpenCms.getADEConfigurationManager().getSitemapConfiguration(cms,cms.getRequestContext().addSiteRoot(entryPoint));
    CmsConfigurationSourceInfo srcInfo=sitemapConfig.getLastSource();
    if (!srcInfo.isModuleConfiguration() && (srcInfo.getResource() != null)) {
      configFile=srcInfo.getResource();
    }
    ensureLock(configFile);
  }
  if (change.isNew()) {
    changedEntry=createNewEntry(entryPoint,change);
  }
 else   if (change.getEntryId() != null) {
    modifyEntry(change);
  }
  if (change.hasDetailPageInfos() && (configFile != null)) {
    saveDetailPages(change.getDetailPageInfos(),configFile);
    tryUnlock(configFile);
  }
  return changedEntry;
}
