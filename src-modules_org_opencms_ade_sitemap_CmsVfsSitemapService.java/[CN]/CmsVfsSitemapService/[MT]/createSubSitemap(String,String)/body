{
  CmsObject cms=getCmsObject();
  try {
    ensureSession();
    CmsResource subSitemapFolder=cms.readResource(path);
    ensureLock(subSitemapFolder);
    String folderName=CmsStringUtil.joinPaths("/","_config");
    String sitemapConfigName=CmsStringUtil.joinPaths(folderName,"sitemap_" + subSitemapFolder.getName() + ".config");
    if (!cms.existsResource(folderName)) {
      tryUnlock(cms.createResource(folderName,CmsResourceTypeFolder.getStaticTypeId()));
    }
    if (cms.existsResource(sitemapConfigName)) {
      sitemapConfigName=OpenCms.getResourceManager().getNameGenerator().getNewFileName(cms,CmsStringUtil.joinPaths(folderName,"sitemap_" + subSitemapFolder.getName() + "_%(number).config"));
    }
    tryUnlock(cms.createResource(sitemapConfigName,OpenCms.getResourceManager().getResourceType("sitemap_config").getTypeId()));
    List<CmsProperty> propertyObjects=new ArrayList<CmsProperty>();
    propertyObjects.add(new CmsProperty(CmsPropertyDefinition.PROPERTY_CONFIG_SITEMAP,sitemapConfigName,sitemapConfigName));
    cms.writePropertyObjects(path,propertyObjects);
    subSitemapFolder.setType(getEntryPointType());
    cms.writeResource(subSitemapFolder);
    tryUnlock(subSitemapFolder);
    CmsSitemapClipboardData clipboard=getClipboardData();
    CmsClientSitemapEntry entry=toClientEntry(getNavBuilder().getNavigationForResource(cms.getSitePath(subSitemapFolder)),false);
    clipboard.addModified(entry);
    setClipboardData(clipboard);
    return new CmsSubSitemapInfo(path,System.currentTimeMillis());
  }
 catch (  Exception e) {
    error(e);
  }
  return null;
}
