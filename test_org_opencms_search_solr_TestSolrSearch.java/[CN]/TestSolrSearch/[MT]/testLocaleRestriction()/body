{
  CmsObject cms=OpenCms.initCmsObject(getCmsObject());
  String folderName="/folder1/subfolder12/subsubfolder121/";
  CmsResource master=importTestResource(cms,"org/opencms/search/pdf-test-112.pdf",folderName + "master.pdf",CmsResourceTypeBinary.getStaticTypeId(),Collections.<CmsProperty>emptyList());
  CmsResource de=importTestResource(cms,"org/opencms/search/pdf-test-112.pdf",folderName + "master_de.pdf",CmsResourceTypeBinary.getStaticTypeId(),Collections.<CmsProperty>emptyList());
  CmsResource en=importTestResource(cms,"org/opencms/search/pdf-test-112.pdf",folderName + "master_en.pdf",CmsResourceTypeBinary.getStaticTypeId(),Collections.<CmsProperty>emptyList());
  CmsResource fr=importTestResource(cms,"org/opencms/search/pdf-test-112.pdf",folderName + "master_fr.pdf",CmsResourceTypeBinary.getStaticTypeId(),Collections.<CmsProperty>emptyList());
  OpenCms.getPublishManager().publishProject(cms,new CmsShellReport(cms.getRequestContext().getLocale()));
  OpenCms.getPublishManager().waitWhileRunning();
  CmsSolrIndex index=OpenCms.getSearchManager().getIndexSolr(AllTests.SOLR_ONLINE);
  cms.getRequestContext().setLocale(Locale.GERMAN);
  CmsSolrQuery query=new CmsSolrQuery(cms,null);
  query.setText("Testfile Intranet");
  CmsSolrResultList result=index.search(cms,query);
  assertTrue(!result.contains(master));
  assertTrue(!result.contains(en));
  assertTrue(result.contains(de));
  assertTrue(!result.contains(fr));
  query=new CmsSolrQuery();
  query.setLocales(Collections.singletonList(Locale.GERMAN));
  query.setText("Testfile Intranet");
  result=index.search(cms,query);
  assertTrue(!result.contains(master));
  assertTrue(!result.contains(en));
  assertTrue(result.contains(de));
  assertTrue(!result.contains(fr));
  query=new CmsSolrQuery();
  query.setLocales(Collections.singletonList(Locale.FRENCH));
  query.setText("Testfile Intranet");
  result=index.search(cms,query);
  assertTrue(!result.contains(master));
  assertTrue(!result.contains(en));
  assertTrue(!result.contains(de));
  assertTrue(result.contains(fr));
  query=new CmsSolrQuery();
  query.setLocales(Collections.singletonList(Locale.ENGLISH));
  query.setText("Testfile Intranet");
  result=index.search(cms,query);
  assertTrue(result.contains(master));
  assertTrue(result.contains(en));
  assertTrue(!result.contains(de));
  assertTrue(!result.contains(fr));
  query=new CmsSolrQuery();
  List<Locale> l=Collections.emptyList();
  query.setLocales(l);
  query.setText("Testfile Intranet");
  result=index.search(cms,query);
  assertTrue(result.contains(master));
  assertTrue(result.contains(en));
  assertTrue(result.contains(de));
  assertTrue(result.contains(fr));
}
