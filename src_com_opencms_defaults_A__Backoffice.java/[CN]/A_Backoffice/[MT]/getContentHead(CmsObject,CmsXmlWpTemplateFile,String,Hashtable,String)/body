{
  byte[] processResult=null;
  Class cdClass=getContentDefinitionClass();
  String singleSelection="";
  String allSelections="";
  CmsSession session=(CmsSession)cms.getRequestContext().getSession(true);
  String selectBoxValue=(String)session.getValue("selectbox");
  Vector filterMethods=new Vector();
  try {
    filterMethods=(Vector)cdClass.getMethod("getFilterMethods",new Class[]{CmsObject.class}).invoke(null,new Object[]{cms});
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
  FilterMethod filterMethod=null;
  if (selectBoxValue == null) {
    FilterMethod defaultFilter=(FilterMethod)filterMethods.firstElement();
    session.putValue("selectbox",defaultFilter.getFilterName());
  }
  for (int i=0; i < filterMethods.size(); i++) {
    FilterMethod currentFilter=(FilterMethod)filterMethods.elementAt(i);
    template.setData("selectname",currentFilter.getFilterName());
    template.setData("selectnumber","" + i);
    template.setData("selectparameter","" + currentFilter.hasUserParameter());
    try {
      singleSelection=template.getProcessedDataValue("singleselection",this);
      allSelections+=singleSelection;
    }
 catch (    Exception e) {
      e.printStackTrace();
    }
  }
  String createButton=null;
  try {
    createButton=(String)getCreateUrl(cms,null,null,null);
  }
 catch (  Exception e) {
  }
  if (createButton == null) {
    String cb=template.getDataValue("nowand");
    template.setData("createbutton",cb);
  }
 else {
    String cb=template.getDataValue("wand");
    template.setData("createbutton",cb);
  }
  template.setData("selectionbox","" + allSelections);
  processResult=startProcessing(cms,template,elementName,parameters,templateSelector);
  return processResult;
}
