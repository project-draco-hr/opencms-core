{
  int writeCount=getWriteCount();
  try {
    if (writeCount > m_lastFlush) {
      CmsFile file=getFile();
      if (file != null) {
        file.setContents(m_buffer.getContents());
        ensureLock();
        m_cms.writeFile(file);
      }
    }
    m_lastFlush=writeCount;
  }
 catch (  CmsException e) {
    LOG.error(e.getLocalizedMessage(),e);
    throw new IOException(e);
  }
}
