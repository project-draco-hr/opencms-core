{
  StringBuffer query=new StringBuffer(256);
  if (getQuery() != null) {
    query.append("+(");
    query.append(getQuery());
    query.append(")");
  }
  if (restriction.getQuery() != null) {
    query.append(" +(");
    query.append(restriction.getQuery());
    query.append(")");
  }
  List fields=null;
  if ((m_fields != null) && (m_fields.size() > 0)) {
    if ((restriction.getFields() != null) && (restriction.getFields().size() > 0)) {
      fields=ListUtils.intersection(m_fields,restriction.getFields());
    }
 else {
      fields=m_fields;
    }
  }
 else {
    fields=restriction.getFields();
  }
  List roots=null;
  if ((m_roots != null) && (m_roots.size() > 0)) {
    if ((restriction.getRoots() != null) && (restriction.getRoots().size() > 0)) {
      roots=ListUtils.intersection(m_roots,restriction.getRoots());
    }
 else {
      roots=m_roots;
    }
  }
 else {
    roots=restriction.getRoots();
  }
  List categories=null;
  if ((m_categories != null) && (m_categories.size() > 0)) {
    if ((restriction.getCategories() != null) && (restriction.getCategories().size() > 0)) {
      categories=ListUtils.intersection(m_categories,restriction.getCategories());
    }
 else {
      categories=m_categories;
    }
  }
 else {
    categories=restriction.getCategories();
  }
  return new CmsSearchParameters(query.toString(),fields,roots,categories,m_calculateCategories,m_sort);
}
