{
  if (valueParam != null) {
    if (valueParam.indexOf("<link>") != -1 || valueParam.indexOf("<LINK>") != -1) {
      return false;
    }
    if (valueParam.startsWith("#")) {
      return false;
    }
    if (valueParam.toLowerCase().startsWith("javascript:")) {
      return false;
    }
  }
  if (orgUrl == null) {
    return false;
  }
  if (valueParam == null) {
    return false;
  }
  URL paramUrl=null;
  String protocol=null;
  String spec=valueParam.trim();
  int index=spec.indexOf(":");
  if (index >= 0) {
    String tmpProtocol=spec.substring(0,index).trim().toLowerCase();
    if ((tmpProtocol.length() > 0) && Character.isLetter(tmpProtocol.charAt(0))) {
      char c;
      boolean isValid=true;
      for (int i=1; i < tmpProtocol.length(); i++) {
        c=tmpProtocol.charAt(i);
        if (!Character.isLetterOrDigit(c) && c != '.' && c != '+' && c != '-') {
          isValid=false;
          break;
        }
      }
      if (isValid) {
        spec="http" + spec.substring(index);
        protocol=tmpProtocol;
      }
    }
  }
  try {
    paramUrl=new URL(spec);
    if (protocol == null) {
      protocol=paramUrl.getProtocol();
    }
  }
 catch (  MalformedURLException e) {
    return true;
  }
  System.err.println("orgUrl: " + orgUrl + " paramUrl: "+ paramUrl+ " file: "+ paramUrl.getFile()+ " prefix: "+ servletUri);
  if (orgUrl.getProtocol().equalsIgnoreCase(protocol) && orgUrl.getHost().equalsIgnoreCase(paramUrl.getHost()) && paramUrl.getFile().startsWith(servletUri)) {
    if (paramUrl.getFile() == null || "".equals(paramUrl.getFile())) {
      return false;
    }
 else {
      return true;
    }
  }
  return false;
}
