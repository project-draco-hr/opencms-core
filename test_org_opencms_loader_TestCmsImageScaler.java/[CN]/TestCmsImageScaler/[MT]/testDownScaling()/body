{
  String img01="org/opencms/loader/img_01.jpg";
  byte[] content=CmsFileUtil.readFile(img01);
  CmsImageScaler image=new CmsImageScaler(content,img01);
  assertEquals(800,image.getWidth());
  assertEquals(600,image.getHeight());
  CmsImageScaler downScaler=new CmsImageScaler("w:800,h:600,t:1,q:80");
  assertFalse(image.isDownScaleRequired(downScaler));
  downScaler=new CmsImageScaler("w:600,h:800,t:1,q:80");
  assertFalse(image.isDownScaleRequired(downScaler));
  downScaler=new CmsImageScaler("w:640,h:480,t:1,q:80");
  assertTrue(image.isDownScaleRequired(downScaler));
  downScaler=image.getDownScaler(downScaler);
  byte[] scaled=downScaler.scaleImage(content,img01);
  CmsImageScaler scaledImage=new CmsImageScaler(scaled,img01);
  assertEquals(640,scaledImage.getWidth());
  assertEquals(480,scaledImage.getHeight());
  image=new CmsImageScaler(content,img01);
  assertEquals(800,image.getWidth());
  assertEquals(600,image.getHeight());
  downScaler=new CmsImageScaler("w:480,h:640,t:1,q:80");
  assertTrue(image.isDownScaleRequired(downScaler));
  downScaler=image.getDownScaler(downScaler);
  scaled=downScaler.scaleImage(content,img01);
  scaledImage=new CmsImageScaler(scaled,img01);
  assertEquals(640,scaledImage.getWidth());
  assertEquals(480,scaledImage.getHeight());
  String img02="org/opencms/loader/img_02.gif";
  content=CmsFileUtil.readFile(img02);
  image=new CmsImageScaler(content,img02);
  assertEquals(480,image.getWidth());
  assertEquals(643,image.getHeight());
  downScaler=new CmsImageScaler("w:800,h:600,t:1,q:80");
  assertFalse(image.isDownScaleRequired(downScaler));
  downScaler=new CmsImageScaler("w:600,h:800,t:1,q:80");
  assertFalse(image.isDownScaleRequired(downScaler));
  downScaler=new CmsImageScaler("w:643,h:480,t:1,q:80");
  assertFalse(image.isDownScaleRequired(downScaler));
  downScaler=new CmsImageScaler("w:400,h:500,t:1,q:80");
  assertTrue(image.isDownScaleRequired(downScaler));
}
