{
  String containerType=getType();
  int containerWidth=getContainerWidth();
  ServletRequest req=pageContext.getRequest();
  boolean isOnline=cms.getRequestContext().currentProject().isOnlineProject();
  CmsUUID detailId=CmsDetailPageResourceHandler.getDetailId(req);
  if (detailId != null) {
    CmsResource resUri=cms.readResource(detailId);
    String elementFormatter=OpenCms.getADEManager().getFormatterForContainerTypeAndWidth(cms,resUri,containerType,containerWidth);
    if (CmsStringUtil.isEmptyOrWhitespaceOnly(elementFormatter)) {
      if (!isOnline) {
        throw new CmsIllegalStateException(Messages.get().container(Messages.ERR_XSD_NO_TEMPLATE_FORMATTER_3,cms.getSitePath(resUri),OpenCms.getResourceManager().getResourceType(resUri).getTypeName(),containerType));
      }
    }
 else {
      CmsContainerElementBean element=new CmsContainerElementBean(resUri.getStructureId(),cms.readResource(elementFormatter).getStructureId(),null);
      allElems.add(0,element);
    }
  }
}
