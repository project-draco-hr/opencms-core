{
  List options=new ArrayList();
  List values=new ArrayList();
  int selectedIndex=0;
  List sites=OpenCms.getSiteManager().getAvailableSites(getCms(),true,false,getCms().getRequestContext().getOuFqn());
  String wpSite=getParamTabWpSite();
  if (CmsStringUtil.isNotEmptyOrWhitespaceOnly(wpSite) && !wpSite.endsWith("/")) {
    wpSite+="/";
  }
  Iterator i=sites.iterator();
  int pos=0;
  while (i.hasNext()) {
    CmsSite site=(CmsSite)i.next();
    String siteRoot=site.getSiteRoot();
    if (!siteRoot.endsWith("/")) {
      siteRoot+="/";
    }
    values.add(siteRoot);
    options.add(substituteSiteTitle(site.getTitle()));
    if (siteRoot.equals(wpSite)) {
      selectedIndex=pos;
    }
    pos++;
  }
  if (sites.size() < 1) {
    String siteRoot=getCms().getRequestContext().getSiteRoot();
    CmsSite site=OpenCms.getSiteManager().getSiteForSiteRoot(siteRoot);
    if (!siteRoot.endsWith("/")) {
      siteRoot+="/";
    }
    String title="";
    if (site != null) {
      title=site.getTitle();
    }
    values.add(siteRoot);
    options.add(title);
  }
  return buildSelect(htmlAttributes,options,values,selectedIndex);
}
