{
  StringBuffer result=new StringBuffer(1024);
  HttpServletRequest request=getJsp().getRequest();
  if (htmlAttributes != null) {
    htmlAttributes+=" name=\"" + PARAM_PREFERREDEDITOR_PREFIX;
  }
  Map resourceEditors=OpenCms.getWorkplaceManager().getWorkplaceEditorManager().getConfigurableEditors();
  if (resourceEditors != null) {
    Iterator i=resourceEditors.keySet().iterator();
    SortedMap rankResources=new TreeMap();
    while (i.hasNext()) {
      String currentResourceType=(String)i.next();
      CmsExplorerTypeSettings settings=OpenCms.getWorkplaceManager().getExplorerTypeSetting(currentResourceType);
      rankResources.put(new Float(settings.getNewResourceOrder()),currentResourceType);
    }
    while (rankResources.size() > 0) {
      Float keyVal=(Float)rankResources.firstKey();
      String currentResourceType=(String)rankResources.get(keyVal);
      SortedMap availableEditors=(TreeMap)resourceEditors.get(currentResourceType);
      if ((availableEditors != null) && (availableEditors.size() > 0)) {
        String preSelection=computeEditorPreselection(request,currentResourceType);
        List options=new ArrayList(availableEditors.size() + 1);
        List values=new ArrayList(availableEditors.size() + 1);
        options.add(key(Messages.GUI_PREF_EDITOR_BEST_0));
        values.add(INPUT_DEFAULT);
        int selectedIndex=0;
        int counter=1;
        while (availableEditors.size() > 0) {
          Float key=(Float)availableEditors.lastKey();
          CmsWorkplaceEditorConfiguration conf=(CmsWorkplaceEditorConfiguration)availableEditors.get(key);
          options.add(keyDefault(conf.getEditorLabel(),conf.getEditorLabel()));
          values.add(conf.getEditorUri());
          if (conf.getEditorUri().equals(preSelection)) {
            selectedIndex=counter;
          }
          counter++;
          availableEditors.remove(key);
        }
        result.append("<tr>\n\t<td style=\"white-space: nowrap;\">");
        String localizedName=keyDefault("label.editor.preferred." + currentResourceType,"");
        if (CmsStringUtil.isEmpty(localizedName)) {
          localizedName=CmsWorkplaceMessages.getResourceTypeName(this,currentResourceType);
        }
        result.append(localizedName);
        result.append("</td>\n\t<td>");
        result.append(buildSelect(htmlAttributes + currentResourceType + "\"",options,values,selectedIndex));
        result.append("</td>\n</tr>\n");
      }
      rankResources.remove(keyVal);
    }
  }
  return result.toString();
}
