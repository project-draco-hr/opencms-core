{
  if (checkPort(cms)) {
    String lasturl=getLastUrl(cms,parameters);
    CmsXmlTemplateLoader.getResponse(cms.getRequestContext()).setHeader("Cache-Control","no-cache");
    CmsXmlTemplateLoader.getResponse(cms.getRequestContext()).setHeader("Pragma","no-cache");
    ((CmsXmlWpTemplateFile)xmlTemplateDocument).setData("lasturl",lasturl);
    return super.startProcessing(cms,xmlTemplateDocument,elementName,parameters,templateSelector);
  }
 else {
    throw new CmsException("No access to the workplace with this port",CmsException.C_NOT_FOUND);
  }
}
