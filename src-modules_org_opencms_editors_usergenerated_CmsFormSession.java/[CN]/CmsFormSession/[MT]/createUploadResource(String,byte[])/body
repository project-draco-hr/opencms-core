{
  CmsResource result=null;
  CmsFormSessionSecurityUtil.checkCreateUpload(m_cms,m_configuration,fileName,content.length);
  if (m_configuration.getUploadParentFolder().isPresent()) {
    String sitePath=OpenCms.getResourceManager().getNameGenerator().getUniqueFileName(m_cms,m_configuration.getUploadParentFolder().get().getRootPath(),fileName);
    int resTypeId=OpenCms.getResourceManager().getDefaultTypeForName(sitePath).getTypeId();
    result=m_cms.createResource(fileName,resTypeId,content,null);
  }
  return result;
}
