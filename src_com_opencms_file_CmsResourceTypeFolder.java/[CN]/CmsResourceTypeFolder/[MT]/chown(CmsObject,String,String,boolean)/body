{
  CmsFolder folder=cms.readFolder(filename);
  if ((cms.getRequestContext().currentUser().equals(cms.readOwner(folder))) || (cms.userInGroup(cms.getRequestContext().currentUser().getName(),C_GROUP_ADMIN))) {
    cms.doChown(filename,newOwner);
    String bodyFolder=C_CONTENTBODYPATH.substring(0,C_CONTENTBODYPATH.lastIndexOf("/")) + folder.getAbsolutePath();
    try {
      cms.readFolder(bodyFolder);
      cms.doChown(bodyFolder,newOwner);
    }
 catch (    CmsException ex) {
    }
    if (chRekursive) {
      Vector allFolders=new Vector();
      Vector allFiles=new Vector();
      getAllResources(cms,filename,allFiles,allFolders);
      for (int i=0; i < allFolders.size(); i++) {
        CmsFolder curfolder=(CmsFolder)allFolders.elementAt(i);
        if (curfolder.getState() != C_STATE_DELETED) {
          cms.doChown(curfolder.getAbsolutePath(),newOwner);
          bodyFolder=C_CONTENTBODYPATH.substring(0,C_CONTENTBODYPATH.lastIndexOf("/")) + curfolder.getAbsolutePath();
          try {
            cms.readFolder(bodyFolder);
            cms.doChown(bodyFolder,newOwner);
          }
 catch (          CmsException ex) {
          }
        }
      }
      for (int i=0; i < allFiles.size(); i++) {
        CmsFile newfile=(CmsFile)allFiles.elementAt(i);
        if (newfile.getState() != C_STATE_DELETED) {
          cms.chown(newfile.getAbsolutePath(),newOwner);
        }
      }
    }
  }
 else {
    throw new CmsException("[" + this.getClass().getName() + "] "+ filename,CmsException.C_NO_ACCESS);
  }
}
