{
  CmsResource importedResource=null;
  destination=importPath + destination;
  if (!destination.endsWith(C_FOLDER_SEPERATOR))   destination+=C_FOLDER_SEPERATOR;
  boolean changed=true;
  CmsUser resowner=null;
  CmsGroup resgroup=null;
  try {
    resowner=cms.readUser(user);
  }
 catch (  CmsException e) {
    System.err.println("User " + user + " not found");
    resowner=cms.getRequestContext().currentUser();
  }
  try {
    resgroup=cms.readGroup(group);
  }
 catch (  CmsException e) {
    System.err.println("Group " + group + " not found");
    resgroup=cms.getRequestContext().currentGroup();
  }
  try {
    importedResource=cms.doCreateResource(destination,C_TYPE_FOLDER,properties,C_UNKNOWN_LAUNCHER_ID,C_UNKNOWN_LAUNCHER,resowner.getName(),resgroup.getName(),Integer.parseInt(access),new byte[0]);
    if (importedResource != null) {
      changed=false;
    }
  }
 catch (  CmsException e) {
  }
  if (changed) {
    changed=false;
    importedResource=cms.readFolder(destination);
    Hashtable oldProperties=cms.readAllProperties(importedResource.getAbsolutePath());
    if (oldProperties == null) {
      oldProperties=new Hashtable();
    }
    if (properties == null) {
      properties=new Hashtable();
    }
    if (oldProperties.size() != properties.size()) {
      changed=true;
    }
 else {
      Enumeration keys=properties.keys();
      while (keys.hasMoreElements()) {
        String curKey=(String)keys.nextElement();
        String value=(String)properties.get(curKey);
        String oldValue=(String)oldProperties.get(curKey);
        if ((oldValue == null) || !(value.trim().equals(oldValue.trim()))) {
          changed=true;
          break;
        }
      }
    }
    if (importedResource.getAccessFlags() != Integer.parseInt(access) || importedResource.getOwnerId() != resowner.getId() || importedResource.getGroupId() != resgroup.getId()) {
      changed=true;
    }
    if (importedResource.getType() != cms.getResourceType(type).getResourceType()) {
      changed=true;
    }
    if (changed) {
      lockResource(cms,importedResource.getAbsolutePath(),true);
      cms.doWriteResource(importedResource.getAbsolutePath(),properties,resowner.getName(),resgroup.getName(),Integer.parseInt(access),C_TYPE_FOLDER,new byte[0]);
    }
  }
  return importedResource;
}
