{
  CmsResource cmsfolder=null;
  String path=importPath + destination.substring(0,destination.lastIndexOf("/") + 1);
  String name=destination.substring((destination.lastIndexOf("/") + 1),destination.length());
  String fullname=null;
  try {
    cmsfolder=createResource(cms,path,name,properties,content);
    if (cmsfolder != null) {
      fullname=cmsfolder.getAbsolutePath();
      lockResource(cms,fullname,true);
    }
  }
 catch (  CmsException e) {
  }
  if (fullname == null) {
    cmsfolder=cms.readFolder(path,name + "/");
    Hashtable oldProperties=cms.readAllProperties(cmsfolder.getAbsolutePath());
    if (oldProperties == null) {
      oldProperties=new Hashtable();
    }
    if (properties == null) {
      properties=new Hashtable();
    }
    if (!oldProperties.equals(properties)) {
      fullname=cmsfolder.getAbsolutePath();
      lockResource(cms,fullname,true);
      cms.writeProperties(fullname,properties);
    }
    if (fullname == null) {
      if (cmsfolder.getAccessFlags() != Integer.parseInt(access) || cmsfolder.getOwnerId() != cms.readUser(user).getId() || cmsfolder.getGroupId() != cms.readGroup(group).getId()) {
        fullname=cmsfolder.getAbsolutePath();
        lockResource(cms,fullname,true);
      }
    }
  }
  if (fullname != null) {
    try {
      cms.chmod(fullname,Integer.parseInt(access));
    }
 catch (    CmsException e) {
      System.out.println("chmod(" + access + ") failed ");
    }
    try {
      cms.chgrp(fullname,group);
    }
 catch (    CmsException e) {
      System.out.println("chgrp(" + group + ") failed ");
    }
    try {
      cms.chown(fullname,user);
    }
 catch (    CmsException e) {
      System.out.println("chown((" + user + ") failed ");
    }
  }
  return cmsfolder;
}
