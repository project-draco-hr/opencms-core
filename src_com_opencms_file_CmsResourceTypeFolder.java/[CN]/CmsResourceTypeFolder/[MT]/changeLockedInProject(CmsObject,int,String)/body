{
  Vector allSubFolders=new Vector();
  Vector allSubFiles=new Vector();
  getAllResources(cms,resourcename,allSubFiles,allSubFolders);
  for (int i=0; i < allSubFiles.size(); i++) {
    CmsFile curFile=(CmsFile)allSubFiles.elementAt(i);
    if (curFile.getState() != C_STATE_UNCHANGED) {
      cms.changeLockedInProject(newProjectId,curFile.getAbsolutePath());
    }
  }
  for (int i=0; i < allSubFolders.size(); i++) {
    CmsFolder curFolder=(CmsFolder)allSubFolders.elementAt(i);
    if (curFolder.getState() != C_STATE_UNCHANGED) {
      changeLockedInProject(cms,newProjectId,curFolder.getAbsolutePath());
    }
  }
  cms.doChangeLockedInProject(newProjectId,resourcename);
  String bodyFolder=C_VFS_PATH_BODIES.substring(0,C_VFS_PATH_BODIES.lastIndexOf("/")) + resourcename;
  try {
    cms.readFolder(bodyFolder,true);
    changeLockedInProject(cms,newProjectId,bodyFolder);
  }
 catch (  CmsException ex) {
  }
}
