{
  StringBuffer newContent=new StringBuffer(content.length() + 32);
  newContent.append(C_HTML_START);
  newContent.append(content);
  newContent.append(C_HTML_END);
  CmsLinkVisitor visitor=new CmsLinkVisitor(this);
  Parser parser=new Parser();
  Lexer lexer=new Lexer();
  Page page;
  try {
    InputStream stream=new ByteArrayInputStream(newContent.toString().getBytes(encoding));
    page=new Page(stream,encoding);
  }
 catch (  UnsupportedEncodingException e) {
    int todo=0;
    throw new ParserException(Messages.get().key(Messages.ERR_INVALID_ENCODING_1,encoding));
  }
  lexer.setPage(page);
  parser.setLexer(lexer);
  parser.visitAllNodesWith(visitor);
  String result=visitor.getHtml();
  if (result.length() > 0) {
    return result.substring(C_HTML_START.length(),result.length() - C_HTML_END.length());
  }
 else {
    return result;
  }
}
