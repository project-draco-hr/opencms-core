{
switch (m_mode) {
case PROCESS_LINKS:
    if (linkTag.getAttribute("href") != null) {
      CmsLink link=m_linkTable.getLink(getLinkName(linkTag.getLink()));
      if (link != null) {
        linkTag.setLink(CmsLinkProcessor.escapeLink(processLink(link)));
      }
    }
  break;
case REPLACE_LINKS:
if (linkTag.getAttribute("href") != null) {
  String targetUri=linkTag.extractLink();
  if (CmsStringUtil.isNotEmpty(targetUri)) {
    String internalUri=CmsLinkManager.getSitePath(m_cms,m_relativePath,targetUri);
    if (internalUri != null) {
      linkTag.setLink(replaceLink(m_linkTable.addLink(linkTag.getTagName(),internalUri,true)));
    }
 else {
      linkTag.setLink(replaceLink(m_linkTable.addLink(linkTag.getTagName(),targetUri,false)));
    }
  }
}
break;
default :
break;
}
}
