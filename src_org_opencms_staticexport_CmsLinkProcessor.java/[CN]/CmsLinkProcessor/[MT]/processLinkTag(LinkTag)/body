{
  if (tag.getAttribute("href") != null) {
    CmsLink link;
switch (m_mode) {
case PROCESS_LINKS:
      link=m_linkTable.getLink(CmsMacroResolver.stripMacro(tag.getLink()));
    if (link != null) {
      tag.setLink(escapeLink(processLink(link)));
    }
  break;
case REPLACE_LINKS:
String targetUri=tag.extractLink();
if (CmsStringUtil.isNotEmpty(targetUri)) {
String internalUri=CmsLinkManager.getSitePath(m_cms,m_relativePath,targetUri);
if (internalUri != null) {
  link=m_linkTable.addLink(tag.getTagName(),internalUri,true);
}
 else {
  link=m_linkTable.addLink(tag.getTagName(),targetUri,false);
}
tag.setLink(CmsMacroResolver.formatMacro(link.getName()));
}
break;
default :
}
}
}
