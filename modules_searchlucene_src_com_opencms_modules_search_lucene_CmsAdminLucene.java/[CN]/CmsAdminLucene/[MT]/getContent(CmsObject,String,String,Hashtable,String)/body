{
  CmsXmlWpTemplateFile xmlTemplateDocument=new CmsXmlWpTemplateFile(cms,templateFile);
  String info=(String)parameters.get("info");
  if (info != null && "dep_out".equals(info)) {
  }
  String action=(String)parameters.get("action");
  boolean active=OpenCms.getRegistry().getModuleParameterBoolean("com.opencms.modules.search.lucene","active");
  boolean indexPDFs=OpenCms.getRegistry().getModuleParameterBoolean("com.opencms.modules.search.lucene","indexPDFs");
  if (debug)   System.err.println("action=" + action);
  if ((action == null) || ("".equals(action))) {
    Vector files=cms.getAllExportLinks();
    String exportUrl="";
    int html=0, pdf=0;
    for (int i=0; i < files.size(); i++) {
      exportUrl=(String)files.get(i);
      if (exportUrl.indexOf(".htm") != -1)       html++;
 else       if (exportUrl.indexOf(".pdf") != -1)       pdf++;
    }
    xmlTemplateDocument.setData("htmlfiles",html + "");
    if (indexPDFs)     xmlTemplateDocument.setData("pdffiles",pdf + "");
 else     xmlTemplateDocument.setData("pdffiles"," - ");
    if (!active)     templateSelector="not_active";
  }
 else {
    ControlLucene.indexProject(cms);
    templateSelector="done";
  }
  return startProcessing(cms,xmlTemplateDocument,elementName,parameters,templateSelector);
}
