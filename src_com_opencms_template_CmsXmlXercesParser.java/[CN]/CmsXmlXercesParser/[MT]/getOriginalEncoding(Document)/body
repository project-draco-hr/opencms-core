{
  if (doc instanceof org.apache.xerces.dom.CoreDocumentImpl) {
    String result=((org.apache.xerces.dom.CoreDocumentImpl)doc).getEncoding();
    if ((result != null) && !"".equals(result.trim())) {
      return result;
    }
  }
  return C_XML_ENCODING;
}
