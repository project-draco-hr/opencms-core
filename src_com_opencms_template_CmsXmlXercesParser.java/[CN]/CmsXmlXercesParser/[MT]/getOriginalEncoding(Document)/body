{
  if (doc instanceof org.apache.xerces.dom.CoreDocumentImpl) {
    org.apache.xerces.dom.CoreDocumentImpl d=(org.apache.xerces.dom.CoreDocumentImpl)doc;
    String result=null;
    if ((m_xercesVersion == 2) || (m_xercesVersion == 0)) {
      try {
        result=(String)d.getClass().getMethod("getXmlEncoding",new Class[]{}).invoke(d,new Object[]{});
        m_xercesVersion=2;
      }
 catch (      Throwable t) {
        OpenCms.getLog(this).debug("Xerces 2 not found - getXmlEncoding() did not work",t);
      }
    }
    if ((m_xercesVersion == 1) || (m_xercesVersion == 0)) {
      try {
        result=(String)d.getClass().getMethod("getEncoding",new Class[]{}).invoke(d,new Object[]{});
        m_xercesVersion=1;
      }
 catch (      Throwable t) {
        OpenCms.getLog(this).debug("Xerces 1 not found - getEncoding() did not work",t);
      }
    }
    if ((result != null) && !"".equals(result.trim())) {
      return result;
    }
  }
  return OpenCms.getSystemInfo().getDefaultEncoding();
}
