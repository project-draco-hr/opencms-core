{
  Connection conn=null;
  PreparedStatement stmt=null;
  String ownerName=new String();
  String group=new String();
  String managerGroup=new String();
  try {
    CmsUser owner=m_driverManager.readUser(currentProject.getOwnerId());
    ownerName=owner.getName() + " " + owner.getFirstname()+ " "+ owner.getLastname();
  }
 catch (  CmsException e) {
    ownerName="";
  }
  try {
    group=m_driverManager.getUserDriver().readGroup(currentProject.getGroupId()).getName();
  }
 catch (  CmsException e) {
    group="";
  }
  try {
    managerGroup=m_driverManager.getUserDriver().readGroup(currentProject.getManagerGroupId()).getName();
  }
 catch (  CmsException e) {
    managerGroup="";
  }
  List projectresources=m_driverManager.getProjectDriver().readProjectResources(currentProject);
  try {
    conn=m_sqlManager.getConnectionForBackup();
    stmt=m_sqlManager.getPreparedStatement(conn,"C_PROJECTS_CREATE_BACKUP");
    stmt.setInt(1,tagId);
    stmt.setInt(2,currentProject.getId());
    stmt.setString(3,currentProject.getName());
    stmt.setTimestamp(4,new Timestamp(publishDate));
    stmt.setString(5,currentUser.getId().toString());
    stmt.setString(6,currentUser.getName() + " " + currentUser.getFirstname()+ " "+ currentUser.getLastname());
    stmt.setString(7,currentProject.getOwnerId().toString());
    stmt.setString(8,ownerName);
    stmt.setString(9,currentProject.getGroupId().toString());
    stmt.setString(10,group);
    stmt.setString(11,currentProject.getManagerGroupId().toString());
    stmt.setString(12,managerGroup);
    stmt.setString(13,currentProject.getDescription());
    stmt.setTimestamp(14,new Timestamp(currentProject.getCreateDate()));
    stmt.setInt(15,currentProject.getType());
    stmt.setInt(16,currentProject.getTaskId());
    stmt.executeUpdate();
    m_sqlManager.closeAll(null,stmt,null);
    stmt=m_sqlManager.getPreparedStatement(conn,"C_PROJECTRESOURCES_CREATE_BACKUP");
    Iterator i=projectresources.iterator();
    while (i.hasNext()) {
      stmt.setInt(1,tagId);
      stmt.setInt(2,currentProject.getId());
      stmt.setString(3,(String)i.next());
      stmt.executeUpdate();
      stmt.clearParameters();
    }
  }
 catch (  SQLException e) {
    throw m_sqlManager.getCmsException(this,null,CmsException.C_SQL_ERROR,e,false);
  }
catch (  Exception ex) {
    throw m_sqlManager.getCmsException(this,null,CmsException.C_UNKNOWN_EXCEPTION,ex,false);
  }
 finally {
    m_sqlManager.closeAll(conn,stmt,null);
  }
}
