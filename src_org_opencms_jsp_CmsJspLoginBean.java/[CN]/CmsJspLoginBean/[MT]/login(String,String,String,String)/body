{
  HttpSession session=null;
  m_loginException=null;
  try {
    getCmsObject().loginUser(username,password,getRequestContext().getRemoteAddress(),I_CmsConstants.C_USER_TYPE_SYSTEMUSER);
    session=getRequest().getSession(true);
    if (login_project != null) {
      getCmsObject().getRequestContext().setCurrentProject(getCmsObject().readProject(login_project));
    }
  }
 catch (  CmsException e) {
    m_loginException=e;
    if (session != null) {
      session.invalidate();
    }
  }
  if (m_loginException == null) {
    if (OpenCms.getLog(CmsJspLoginBean.class).isInfoEnabled()) {
      OpenCms.getLog(CmsJspLoginBean.class).info("Login of user '" + username + "' on page "+ getRequestContext().addSiteRoot(getRequestContext().getUri()));
    }
    if (login_redirect != null) {
      getResponse().sendRedirect(link(login_redirect));
    }
 else {
      getResponse().sendRedirect(getFormLink());
    }
  }
 else {
    if (OpenCms.getLog(CmsJspLoginBean.class).isWarnEnabled()) {
      OpenCms.getLog(CmsJspLoginBean.class).warn("Failed login attempt for user '" + username + "' on page "+ getRequestContext().addSiteRoot(getRequestContext().getUri()));
    }
  }
}
