{
  I_CmsImportExportHandler handler=null;
  String handlerKey=null;
  try {
    if (cms.isAdmin()) {
      handlerKey=getImportExportHandlerKey(importFile);
      handler=getImportExportHandler(handlerKey);
      handler.importData(cms,importFile,importPath,report);
    }
 else {
      throw new CmsSecurityException("[" + this.getClass().getName() + "]",CmsSecurityException.C_SECURITY_ADMIN_PRIVILEGES_REQUIRED);
    }
  }
  finally {
    if (cms.isAdmin()) {
      OpenCms.fireCmsEvent(new CmsEvent(cms,I_CmsEventListener.EVENT_CLEAR_CACHES,Collections.EMPTY_MAP,false));
    }
  }
}
