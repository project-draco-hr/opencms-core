{
  String finishMessage;
  String unlock=(String)parameters.get(PARAM_UNLOCK);
  CmsProject project=cms.getRequestContext().currentProject();
  try {
    if (Boolean.valueOf(unlock).booleanValue()) {
      cms.unlockProject(project.getId());
    }
    cms.publishProject(new CmsLogReport(cms.getRequestContext().getLocale(),CmsPublishJob.class));
    finishMessage=Messages.get().key(Messages.LOG_PUBLISH_FINISHED_1,project.getName());
  }
 catch (  CmsException e) {
    finishMessage=Messages.get().key(Messages.LOG_PUBLISH_FAILED_2,project.getName(),e.getMessageContainer().key());
  }
  return finishMessage;
}
