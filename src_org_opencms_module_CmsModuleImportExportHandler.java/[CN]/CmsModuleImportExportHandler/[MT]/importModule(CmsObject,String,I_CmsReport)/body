{
  if ((cms == null) || !cms.isAdmin()) {
    throw new CmsSecurityException(CmsSecurityException.C_SECURITY_ADMIN_PRIVILEGES_REQUIRED);
  }
  CmsModule importedModule=readModuleFromImport(importResource);
  if (OpenCms.getModuleManager().hasModule(importedModule.getName())) {
    throw new CmsConfigurationException("The module '" + importedModule.getName() + "' is already installed",CmsConfigurationException.C_CONFIGURATION_ERROR);
  }
  List dependencies=OpenCms.getModuleManager().checkDependencies(importedModule,CmsModuleManager.C_DEPENDENCY_MODE_IMPORT);
  if (dependencies.size() > 0) {
    String missingModules="";
    Iterator it=dependencies.iterator();
    while (it.hasNext()) {
      CmsModuleDependency dependency=(CmsModuleDependency)it.next();
      missingModules+="Module: " + dependency.getName() + " Version: "+ dependency.getVersion()+ "\n";
    }
    throw new CmsConfigurationException("The following dependencies for the module are not fulfilled:\n" + missingModules,CmsConfigurationException.C_CONFIGURATION_MODULE_DEPENDENCIES);
  }
  Vector exclusion=new Vector();
  exclusion.add(I_CmsWpConstants.C_VFS_PATH_SYSTEM);
  exclusion.add(I_CmsWpConstants.C_VFS_PATH_MODULES);
  exclusion.add(I_CmsWpConstants.C_VFS_PATH_WORKPLACE);
  exclusion.add(I_CmsWpConstants.C_VFS_PATH_GALLERIES);
  exclusion.add(I_CmsWpConstants.C_VFS_PATH_HELP);
  exclusion.add(I_CmsWpConstants.C_VFS_PATH_LOCALES);
  exclusion.add(I_CmsWpConstants.C_VFS_PATH_SCRIPTS);
  exclusion.add(I_CmsWpConstants.C_VFS_PATH_SYSTEMPICS);
  exclusion.add(I_CmsWpConstants.C_VFS_GALLERY_PICS);
  exclusion.add(I_CmsWpConstants.C_VFS_GALLERY_HTML);
  exclusion.add(I_CmsWpConstants.C_VFS_GALLERY_DOWNLOAD);
  exclusion.add(I_CmsWpConstants.C_VFS_GALLERY_EXTERNALLINKS);
  CmsImport cmsImport=new CmsImport(cms,importResource,"/",report);
  cmsImport.importResources(exclusion,new Vector(),new Vector(),null,null);
  OpenCms.getModuleManager().addModule(cms,importedModule);
}
