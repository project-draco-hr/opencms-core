{
  CmsXmlTemplateFile templateDocument=getOwnTemplateFile(cms,templateFile,elementName,parameters,templateSelector);
  long length=0;
  long toSkip;
  if ("ok".equalsIgnoreCase((String)parameters.get("step"))) {
    templateSelector="done";
  }
 else {
    StringBuffer logfilecontent=new StringBuffer();
    String logfilename=A_OpenCms.getLogFileName();
    try {
      File file=new File(logfilename);
      length=file.length();
      toSkip=length - 4000;
      FileReader reader=new FileReader(file);
      LineNumberReader lnr=new LineNumberReader(reader);
      if (toSkip > 0) {
        lnr.skip(toSkip);
        lnr.readLine();
      }
      String line=lnr.readLine();
      while (line != null) {
        logfilecontent.append(line + "\n");
        line=lnr.readLine();
      }
    }
 catch (    Exception exc) {
      logfilecontent.append(Utils.getStackTrace(exc));
    }
    templateDocument.setData("logfile",Encoder.escape(logfilecontent.toString(),cms.getRequestContext().getEncoding()));
    templateDocument.setData("logfilesize",length + "");
  }
  return startProcessing(cms,templateDocument,elementName,parameters,templateSelector);
}
