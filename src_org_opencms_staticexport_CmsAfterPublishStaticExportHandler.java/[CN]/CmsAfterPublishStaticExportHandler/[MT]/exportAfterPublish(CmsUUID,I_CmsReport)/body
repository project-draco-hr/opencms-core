{
  String rfsName=CmsFileUtil.normalizePath(OpenCms.getStaticExportManager().getExportPath(OpenCms.getStaticExportManager().getTestResource()) + OpenCms.getStaticExportManager().getTestResource());
  if (LOG.isDebugEnabled()) {
    LOG.debug(Messages.get().key(Messages.LOG_CHECKING_TEST_RESOURCE_1,rfsName));
  }
  File file=new File(rfsName);
  if (!file.exists()) {
    if (LOG.isDebugEnabled()) {
      LOG.debug(Messages.get().key(Messages.LOG_TEST_RESOURCE_NOT_EXISTANT_0));
    }
    OpenCms.getStaticExportManager().exportFullStaticRender(true,report);
  }
 else {
    if (LOG.isDebugEnabled()) {
      LOG.debug(Messages.get().key(Messages.LOG_TEST_RESOURCE_EXISTS_0));
    }
    scrubExportFolders(publishHistoryId);
    CmsObject cms=OpenCms.initCmsObject(OpenCms.getDefaultUsers().getUserExport());
    List publishedResources=cms.readPublishedResources(publishHistoryId);
    doExportAfterPublish(publishedResources,report);
  }
}
