{
  String rfsName=CmsFileUtil.normalizePath(OpenCms.getStaticExportManager().getExportPath() + OpenCms.getStaticExportManager().getTestResource());
  if (OpenCms.getLog(this).isDebugEnabled()) {
    OpenCms.getLog(this).debug("Static export, checking test resource " + rfsName);
  }
  File file=new File(rfsName);
  if (!file.exists()) {
    if (OpenCms.getLog(this).isDebugEnabled()) {
      OpenCms.getLog(this).debug("Test resource does not exist -> do export 'full static render'");
    }
    OpenCms.getStaticExportManager().exportFullStaticRender(true,report);
  }
 else {
    if (OpenCms.getLog(this).isDebugEnabled()) {
      OpenCms.getLog(this).debug("Test resource exists -> do static export 'after publish'");
    }
    scrubExportFolders(publishHistoryId);
    CmsObject cms=OpenCms.initCmsObject(OpenCms.getDefaultUsers().getUserExport());
    List publishedResources=cms.readPublishedResources(publishHistoryId);
    doExportAfterPublish(publishedResources,report);
  }
}
