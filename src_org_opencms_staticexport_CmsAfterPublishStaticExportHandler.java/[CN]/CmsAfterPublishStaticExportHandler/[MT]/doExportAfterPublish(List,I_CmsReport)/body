{
  boolean templatesFound;
  CmsObject cmsExportObject=OpenCms.initCmsObject(OpenCms.getDefaultUsers().getUserExport());
  templatesFound=OpenCms.getStaticExportManager().exportNonTemplateResources(cmsExportObject,resources,report);
  if ((templatesFound) || (!OpenCms.getStaticExportManager().getQuickPlainExport())) {
    long timestamp=0;
    List publishedTemplateResources;
    boolean newTemplateLinksFound;
    int linkMode=CmsStaticExportManager.C_EXPORT_LINK_WITHOUT_PARAMETER;
    do {
      publishedTemplateResources=cmsExportObject.readStaticExportResources(linkMode,timestamp);
      newTemplateLinksFound=publishedTemplateResources.size() > 0;
      if (newTemplateLinksFound) {
        if (linkMode == CmsStaticExportManager.C_EXPORT_LINK_WITHOUT_PARAMETER) {
          linkMode=CmsStaticExportManager.C_EXPORT_LINK_WITH_PARAMETER;
        }
 else {
          timestamp=System.currentTimeMillis();
        }
        OpenCms.getStaticExportManager().exportTemplateResources(publishedTemplateResources,report);
      }
    }
 while (newTemplateLinksFound);
  }
}
