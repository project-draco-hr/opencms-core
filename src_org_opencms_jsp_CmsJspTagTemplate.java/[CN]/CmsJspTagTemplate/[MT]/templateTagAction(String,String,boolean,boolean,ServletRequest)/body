{
  CmsFlexController controller=(CmsFlexController)req.getAttribute(CmsFlexController.ATTRIBUTE_NAME);
  CmsXmlPage page=(CmsXmlPage)req.getAttribute(org.opencms.loader.CmsXmlPageLoader.C_XMLPAGE_OBJECT);
  if (page != null && elementlist != null) {
    String absolutePath=controller.getCmsObject().readAbsolutePath(page.getFile());
    Locale locale=OpenCms.getLocaleManager().getBestMatchingLocale(controller.getCmsObject().getRequestContext().getLocale(),OpenCms.getLocaleManager().getDefaultLocales(controller.getCmsObject(),absolutePath),page.getLocales());
    String elements[]=CmsStringSubstitution.split(elementlist,",");
    boolean found=false;
    for (int i=0; i < elements.length; i++) {
      String el=elements[i].trim();
      if (page.hasElement(el,locale) && page.isEnabled(el,locale)) {
        found=true;
        if (!checkall) {
          break;
        }
      }
 else {
        if (checkall) {
          return false;
        }
      }
    }
    if (!found && !checknone) {
      return false;
    }
 else     if (found && checknone) {
      return false;
    }
  }
  String param=req.getParameter(C_TEMPLATE_ELEMENT);
  return ((element == null) || (param == null) || (param.equals(element)));
}
