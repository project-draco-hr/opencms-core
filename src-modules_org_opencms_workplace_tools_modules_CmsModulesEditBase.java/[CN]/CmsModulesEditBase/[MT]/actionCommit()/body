{
  List errors=new ArrayList();
  Set moduleNames=OpenCms.getModuleManager().getModuleNames();
  if (moduleNames.contains(m_module.getName())) {
    try {
      OpenCms.getModuleManager().updateModule(getCms(),m_module);
    }
 catch (    CmsConfigurationException ce) {
      errors.add(ce);
    }
catch (    CmsRoleViolationException re) {
      errors.add(re);
    }
  }
 else {
    try {
      OpenCms.getModuleManager().addModule(getCms(),m_module);
    }
 catch (    CmsConfigurationException ce) {
      errors.add(ce);
    }
catch (    CmsSecurityException se) {
      errors.add(se);
    }
  }
  if (errors.isEmpty()) {
    Map objects=(Map)getSettings().getListObject();
    if (objects != null) {
      objects.remove(CmsModulesList.class.getName());
    }
  }
  setCommitErrors(errors);
}
