{
  m_cms=cms;
  m_exportPath=cms.getStaticExportProperties().getExportPath();
  c_perlUtil=new Perl5Util();
  m_afterPublish=true;
  m_report=new CmsShellReport();
  try {
    m_servletUrl=cms.getRequestContext().getRequest().getServletUrl();
    m_webAppUrl=cms.getRequestContext().getRequest().getWebAppUrl();
    if (I_CmsLogChannels.C_PREPROCESSOR_IS_LOGGING && A_OpenCms.isLogging()) {
      A_OpenCms.log(I_CmsLogChannels.C_OPENCMS_STATICEXPORT,"[CmsStaticExport] Starting the static export on slave server.");
    }
    createDynamicRules();
    checkExportPath();
    if (I_CmsLogChannels.C_PREPROCESSOR_IS_LOGGING && A_OpenCms.isLogging()) {
      A_OpenCms.log(I_CmsLogChannels.C_OPENCMS_STATICEXPORT,"[CmsStaticExport] got " + linksToExport.size() + " links to export.");
    }
    for (int i=0; i < linksToExport.size(); i++) {
      String aktLink=(String)linksToExport.elementAt(i);
      exportLink(aktLink,linksToExport,false);
    }
    if (I_CmsLogChannels.C_PREPROCESSOR_IS_LOGGING && A_OpenCms.isLogging()) {
      A_OpenCms.log(I_CmsLogChannels.C_OPENCMS_STATICEXPORT,"[CmsStaticExport] all done.");
    }
  }
 catch (  NullPointerException e) {
    if (I_CmsLogChannels.C_PREPROCESSOR_IS_LOGGING && A_OpenCms.isLogging()) {
      A_OpenCms.log(I_CmsLogChannels.C_OPENCMS_STATICEXPORT,"[CmsStaticExport] Nothing found to export.");
    }
  }
}
