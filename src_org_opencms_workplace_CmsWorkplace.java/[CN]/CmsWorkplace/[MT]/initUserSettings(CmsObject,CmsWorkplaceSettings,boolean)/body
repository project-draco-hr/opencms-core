{
  if (settings == null) {
    settings=new CmsWorkplaceSettings();
  }
  CmsUser user;
  if (update) {
    try {
      user=cms.readUser(cms.getRequestContext().currentUser().getId());
    }
 catch (    CmsException e) {
      if (LOG.isInfoEnabled()) {
        LOG.info(e.getLocalizedMessage());
      }
      user=cms.getRequestContext().currentUser();
    }
  }
 else {
    user=cms.getRequestContext().currentUser();
  }
  settings.setUser(user);
  settings.setUserSettings(new CmsUserSettings(cms,user));
  return settings;
}
