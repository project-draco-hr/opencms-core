{
  Map resourceTypes=new HashMap();
  List allResTypes=OpenCms.getResourceManager().getResourceTypes();
  for (int i=0; i < allResTypes.size(); i++) {
    I_CmsResourceType type=(I_CmsResourceType)allResTypes.get(i);
    CmsExplorerTypeSettings typeSettings=OpenCms.getWorkplaceManager().getExplorerTypeSetting(type.getTypeName());
    if (typeSettings != null) {
      CmsPermissionSet permissions;
      try {
        permissions=typeSettings.getAccess().getAccessControlList().getPermissions(cms.getRequestContext().currentUser(),cms.getGroupsOfUser(cms.getRequestContext().currentUser().getName()));
      }
 catch (      CmsException e) {
        permissions=typeSettings.getAccess().getAccessControlList().getPermissions(cms.getRequestContext().currentUser());
        if (LOG.isWarnEnabled()) {
          CmsLog.getLog(CmsTree.class).warn(org.opencms.workplace.explorer.Messages.get().key(org.opencms.workplace.explorer.Messages.LOG_READ_GROUPS_OF_USER_FAILED_1,cms.getRequestContext().currentUser().getName()),e);
        }
      }
      if (permissions.getPermissionString().indexOf("+w") != -1) {
        resourceTypes.put(new Integer(type.getTypeId()),type);
      }
    }
  }
  return resourceTypes;
}
