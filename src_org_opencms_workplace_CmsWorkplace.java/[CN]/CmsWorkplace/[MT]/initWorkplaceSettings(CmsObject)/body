{
  if (m_settings != null)   return;
  CmsWorkplaceSettings settings=new CmsWorkplaceSettings();
  String language=null;
  Hashtable startSettings=(Hashtable)cms.getRequestContext().currentUser().getAdditionalInfo(I_CmsConstants.C_ADDITIONAL_INFO_STARTSETTINGS);
  if (startSettings != null) {
    language=(String)startSettings.get(I_CmsConstants.C_START_LANGUAGE);
  }
  if (language == null) {
    Vector languages=(Vector)cms.getRequestContext().getAcceptedLanguages();
    int numlangs=languages.size();
    for (int i=0; i < numlangs; i++) {
      String lang=(String)languages.elementAt(i);
      try {
        cms.readFolder(I_CmsWpConstants.C_VFS_PATH_LOCALES + lang);
        language=lang;
        break;
      }
 catch (      CmsException e) {
      }
    }
  }
  if (language == null) {
    language=I_CmsWpConstants.C_DEFAULT_LANGUAGE;
  }
  settings.setLanguage(language);
  CmsWorkplaceMessages messages=new CmsWorkplaceMessages(cms,language);
  settings.setMessages(messages);
  settings.setUser(cms.getRequestContext().currentUser());
  settings.setGroup(cms.getRequestContext().currentGroup().getName());
  settings.setProject(cms.getRequestContext().currentProject().getId());
  if (startSettings != null) {
    settings.setCurrentView(getJsp().link((String)startSettings.get(I_CmsConstants.C_START_VIEW)));
  }
  m_session.setAttribute(C_SESSION_WORKPLACE_SETTINGS,settings);
  m_settings=settings;
}
