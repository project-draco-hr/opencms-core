{
  m_editButton.clearHoverState();
  m_popup=new CmsPopup(m_title,-1);
  m_popup.setModal(true);
  m_popup.setAutoHideEnabled(true);
  m_popup.removePadding();
  m_popup.addCloseHandler(new CloseHandler<PopupPanel>(){
    public void onClose(    CloseEvent<PopupPanel> event){
      onPopupClose();
    }
  }
);
  m_hasChanges=false;
  m_requireShowPopup=false;
  m_entityChangeHandlerRegistration=m_parentEntity.addValueChangeHandler(new ValueChangeHandler<Entity>(){
    public void onValueChange(    ValueChangeEvent<Entity> event){
      onEntityChange();
    }
  }
);
  Type type=Vie.getInstance().getType(m_parentEntity.getTypeName());
  FlowPanel formPanel=new FormPanel();
  formPanel.setStyleName(I_LayoutBundle.INSTANCE.form().formParent());
  formPanel.getElement().getStyle().setMargin(0,Unit.PX);
  formPanel.getElement().getStyle().setBorderWidth(0,Unit.PX);
  formPanel.getElement().getStyle().setPropertyPx("minHeight",30);
  m_popup.add(formPanel);
  m_popup.addDialogClose(null);
  I_LayoutBundle.INSTANCE.dialogCss().ensureInjected();
  m_popup.show();
  AttributeHandler.setScrollElement(formPanel.getElement());
  AttributeHandler.setResizeHandler(new ResizeHandler(){
    public void onResize(    ResizeEvent event){
      positionPopup();
    }
  }
);
  m_widgetService.getRendererForType(type).renderAttributeValue(m_parentEntity,m_attributeHandler,m_attributeIndex,formPanel);
  InlineEditOverlay.addOverlayForElement(m_referenceElement);
  positionPopup();
  m_popup.getElement().getStyle().setZIndex(I_LayoutBundle.INSTANCE.constants().css().zIndexPopup());
  m_popupClosed=false;
}
