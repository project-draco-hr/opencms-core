{
  try {
    CmsObject cms=OpenCmsCore.getInstance().initCmsObjectFromSession(req);
    if (cms == null) {
      res.setStatus(HttpServletResponse.SC_EXPECTATION_FAILED);
      res.getWriter().println(ERROR_HTML.replace("$content$","Not logged into OpenCms"));
    }
    CmsSolrIndex index=OpenCms.getSearchManager().getIndexSolr("Solr Offline");
    CmsSolrQuery query=new CmsSolrQuery(cms,CmsRequestUtil.createParameterMap(req.getParameterMap()));
    index.writeResponse(res,index.search(cms,query));
  }
 catch (  Exception e) {
    res.setStatus(HttpServletResponse.SC_EXPECTATION_FAILED);
    res.getWriter().println(ERROR_HTML.replace("$content$",CmsException.getStackTraceAsString(e).replace("\n","<br/>")));
  }
 finally {
    res.getWriter().flush();
  }
}
