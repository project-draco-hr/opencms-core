{
  StringBuffer result=new StringBuffer(8192);
  CmsAcceptLanguageHeaderParser headerParser=new CmsAcceptLanguageHeaderParser(request);
  List locales=headerParser.getAcceptedLocales();
  Locale locale;
  if (locales != null && locales.size() > 0) {
    locale=(Locale)locales.get(0);
  }
 else {
    locale=Locale.ENGLISH;
  }
  CmsMessages messages=new CmsMessages(CmsWorkplaceMessages.C_BUNDLE_NAME,locale);
  result.append(this.getErrormsg("C_ERRORPART_1"));
  result.append(messages.key("error.system.message"));
  result.append(this.getErrormsg("C_ERRORPART_2"));
  result.append(messages.key("error.system.message"));
  result.append(this.getErrormsg("C_ERRORPART_3"));
  result.append(CmsWorkplace.getSkinUri(cms) + "explorer/report_error.gif");
  result.append(this.getErrormsg("C_ERRORPART_4"));
  if (t.getLocalizedMessage() != null) {
    result.append("<p><b>" + CmsStringSubstitution.substitute(t.getLocalizedMessage(),"\n","\n<br>") + "</b></p>");
  }
  result.append("<p>" + messages.key("error.system.resource") + ":<b> "+ cms.getRequestContext().getRequest().getRequestedResource()+ "</b><br>");
  result.append(messages.key("error.system.version") + ":<b> " + this.getSystemInfo().getVersionName()+ "</b><br>");
  result.append(messages.key("error.system.context") + ":<b> " + this.getSystemInfo().getOpenCmsContext()+ "</b></p>");
  result.append(this.getErrormsg("C_ERRORPART_5"));
  result.append(messages.key("button.detail"));
  result.append(this.getErrormsg("C_ERRORPART_6"));
  result.append(CmsStringSubstitution.substitute(CmsException.getStackTraceAsString(t),"\n","\n<br>"));
  result.append(this.getErrormsg("C_ERRORPART_7"));
  result.append(messages.key("button.close"));
  result.append(this.getErrormsg("C_ERRORPART_8"));
  return result.toString();
}
