{
  String servletPath=null;
  String redirectURL=null;
  if (m_useBasicAuthentication) {
    res.setHeader(I_CmsConstants.C_HEADER_WWW_AUTHENTICATE,"BASIC realm=\"" + getSystemInfo().getOpenCmsContext() + "\"");
    res.setStatus(401);
  }
 else {
    servletPath=req.getContextPath() + req.getServletPath();
    redirectURL=servletPath + m_authenticationFormURI + "?requestedResource="+ req.getPathInfo();
    res.sendRedirect(redirectURL);
  }
}
