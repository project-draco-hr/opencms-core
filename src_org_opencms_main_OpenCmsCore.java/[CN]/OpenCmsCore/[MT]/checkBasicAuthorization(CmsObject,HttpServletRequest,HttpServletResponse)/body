{
  String auth=req.getHeader("Authorization");
  if (auth != null) {
    if (auth.toUpperCase().startsWith("BASIC ")) {
      String base64Token=auth.substring(6);
      String token=new String(Base64.decodeBase64(base64Token.getBytes()));
      String username=null;
      String password=null;
      int pos=token.indexOf(":");
      if (pos != -1) {
        username=token.substring(0,pos);
        password=token.substring(pos + 1);
      }
      try {
        try {
          cms.loginUser(username,password);
        }
 catch (        CmsException exc) {
          cms.loginWebUser(username,password);
        }
        req.getSession(true);
      }
 catch (      CmsSecurityException e) {
        requestAuthorization(req,res);
      }
    }
  }
}
