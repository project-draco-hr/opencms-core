{
  CmsObject cms=null;
  CmsRequestHttpServlet cmsReq=new CmsRequestHttpServlet(req,getFileTranslator());
  CmsResponseHttpServlet cmsRes=new CmsResponseHttpServlet(req,res);
  try {
    cms=initCmsObject(req,res,cmsReq,cmsRes);
    CmsFile file=initResource(cms,cms.getRequestContext().getUri());
    if (file != null) {
      res.setContentType(getMimeType(file.getName(),cms.getRequestContext().getEncoding()));
      showResource(req,res,cms,file);
      updateUser(cms,cmsReq);
    }
  }
 catch (  Throwable t) {
    errorHandling(cms,req,res,t);
  }
}
