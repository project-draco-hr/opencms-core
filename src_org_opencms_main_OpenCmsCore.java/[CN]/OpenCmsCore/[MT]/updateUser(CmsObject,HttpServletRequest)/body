{
  if (!cms.getRequestContext().isUpdateSessionEnabled()) {
    return;
  }
  HttpSession session=req.getSession(false);
  if (session != null) {
    if (!cms.getRequestContext().currentUser().isGuestUser()) {
      String sessionId=session.getId();
      CmsSessionInfo sessionInfo=m_sessionInfoManager.getUserInfo(sessionId);
      if (sessionInfo != null) {
        sessionInfo.update(cms.getRequestContext());
      }
 else {
        sessionInfo=new CmsSessionInfo();
        sessionInfo.update(cms.getRequestContext());
        sessionInfo.setSession(session);
        m_sessionInfoManager.putUser(sessionId,sessionInfo);
        CmsSessionBindingListener sessionInfoRemover=new CmsSessionBindingListener(sessionId);
        session.setAttribute("SESSION_INFO_REMOVER",sessionInfoRemover);
      }
    }
  }
}
