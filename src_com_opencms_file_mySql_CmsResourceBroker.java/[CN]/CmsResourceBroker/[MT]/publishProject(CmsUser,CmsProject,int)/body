{
  m_dbAccess.publishProject(currentUser,id,onlineProject(currentUser,currentProject));
  m_subresCache.clear();
  fileSystemChanged();
  CmsProject project=readProject(currentUser,currentProject,id);
  project.setFlags(C_PROJECT_STATE_ARCHIVE);
  project.setPublishingDate(new Date().getTime());
  project.setPublishedBy(currentUser.getId());
  m_dbAccess.writeProject(project);
  m_projectCache.put(project.getId(),project);
  if (m_refresh.length() > 0) {
    try {
      URL url=new URL(m_refresh);
      URLConnection con=url.openConnection();
      con.connect();
      InputStream in=con.getInputStream();
      in.close();
    }
 catch (    Exception ex) {
      throw new CmsException(0,ex);
    }
  }
}
