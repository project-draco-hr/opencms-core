{
  String entryPath=(rootPath == null ? CmsXmlSitemap.XmlNode.SITEENTRY.getName() : CmsXmlUtils.concatXpath(rootPath,CmsXmlSitemap.XmlNode.SITEENTRY.getName()));
  I_CmsXmlContentValue entryValue=getContentValue(cms,xmlSitemap,entryPath,locale,entryCount);
  getContentValue(cms,xmlSitemap,CmsXmlUtils.concatXpath(entryValue.getPath(),CmsXmlSitemap.XmlNode.ID.getName()),locale,0).setStringValue(cms,entry.getId().toString());
  getContentValue(cms,xmlSitemap,CmsXmlUtils.concatXpath(entryValue.getPath(),CmsXmlSitemap.XmlNode.NAME.getName()),locale,0).setStringValue(cms,entry.getName());
  getContentValue(cms,xmlSitemap,CmsXmlUtils.concatXpath(entryValue.getPath(),CmsXmlSitemap.XmlNode.TITLE.getName()),locale,0).setStringValue(cms,entry.getTitle());
  CmsResource res=cms.readResource(entry.getResourceId());
  getContentValue(cms,xmlSitemap,CmsXmlUtils.concatXpath(entryValue.getPath(),CmsXmlSitemap.XmlNode.VFSFILE.getName()),locale,0).setStringValue(cms,cms.getSitePath(res));
  int j=0;
  for (  Map.Entry<String,String> property : entry.getProperties().entrySet()) {
    boolean isSitemapProperty=CmsSitemapManager.PROPERTY_SITEMAP.equals(property.getKey());
    if (!propertiesConf.containsKey(property.getKey()) && !isSitemapProperty) {
      continue;
    }
    I_CmsXmlContentValue propValue=getContentValue(cms,xmlSitemap,CmsXmlUtils.concatXpath(entryValue.getPath(),CmsXmlSitemap.XmlNode.PROPERTIES.getName()),locale,j);
    getContentValue(cms,xmlSitemap,CmsXmlUtils.concatXpath(propValue.getPath(),CmsXmlSitemap.XmlNode.NAME.getName()),locale,0).setStringValue(cms,property.getKey());
    I_CmsXmlContentValue valValue=getContentValue(cms,xmlSitemap,CmsXmlUtils.concatXpath(propValue.getPath(),CmsXmlSitemap.XmlNode.VALUE.getName()),locale,0);
    if (isSitemapProperty || propertiesConf.get(property.getKey()).getPropertyType().equals(CmsXmlContentProperty.T_VFSLIST)) {
      I_CmsXmlContentValue filelistValue=getContentValue(cms,xmlSitemap,CmsXmlUtils.concatXpath(valValue.getPath(),CmsXmlSitemap.XmlNode.FILELIST.getName()),locale,0);
      int index=0;
      for (      String strId : CmsStringUtil.splitAsList(property.getValue(),CmsXmlSitemap.IDS_SEPARATOR)) {
        try {
          CmsResource fileRes=cms.readResource(new CmsUUID(strId));
          I_CmsXmlContentValue fileValue=getContentValue(cms,xmlSitemap,CmsXmlUtils.concatXpath(filelistValue.getPath(),CmsXmlSitemap.XmlNode.URI.getName()),locale,index);
          if (fileValue == null) {
            fileValue=getContentValue(cms,xmlSitemap,CmsXmlUtils.concatXpath(filelistValue.getPath(),CmsXmlSitemap.XmlNode.URI.getName()),locale,index);
          }
          fileValue.setStringValue(cms,cms.getSitePath(fileRes));
          index++;
        }
 catch (        CmsException e) {
          LOG.error(e.getLocalizedMessage(),e);
        }
      }
    }
 else {
      getContentValue(cms,xmlSitemap,CmsXmlUtils.concatXpath(valValue.getPath(),CmsXmlSitemap.XmlNode.STRING.getName()),locale,0).setStringValue(cms,property.getValue());
    }
    j++;
  }
  int subentryCount=0;
  for (  CmsSiteEntryBean subentry : entry.getSubEntries()) {
    saveEntry(cms,locale,entryValue.getPath(),xmlSitemap,subentry,subentryCount,propertiesConf);
    subentryCount++;
  }
}
