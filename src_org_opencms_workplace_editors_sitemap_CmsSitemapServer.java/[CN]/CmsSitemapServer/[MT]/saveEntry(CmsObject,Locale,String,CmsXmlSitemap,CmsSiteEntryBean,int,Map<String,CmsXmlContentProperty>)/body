{
  String entryPath=(rootPath == null ? CmsXmlSitemap.XmlNode.SITEENTRY.getName() : CmsXmlUtils.concatXpath(rootPath,CmsXmlSitemap.XmlNode.SITEENTRY.getName()));
  I_CmsXmlContentValue entryValue=xmlSitemap.getValue(entryPath,locale,entryCount);
  if (entryValue == null) {
    entryValue=xmlSitemap.addValue(cms,entryPath,locale,entryCount);
  }
  xmlSitemap.getValue(CmsXmlUtils.concatXpath(entryValue.getPath(),CmsXmlSitemap.XmlNode.NAME.getName()),locale,0).setStringValue(cms,entry.getName());
  xmlSitemap.getValue(CmsXmlUtils.concatXpath(entryValue.getPath(),CmsXmlSitemap.XmlNode.EXTENSION.getName()),locale,0).setStringValue(cms,entry.getExtension());
  xmlSitemap.getValue(CmsXmlUtils.concatXpath(entryValue.getPath(),CmsXmlSitemap.XmlNode.TITLE.getName()),locale,0).setStringValue(cms,entry.getTitle());
  CmsResource res=cms.readResource(entry.getResourceId());
  xmlSitemap.getValue(CmsXmlUtils.concatXpath(entryValue.getPath(),CmsXmlSitemap.XmlNode.VFSFILE.getName()),locale,0).setStringValue(cms,cms.getSitePath(res));
  int j=0;
  for (  Map.Entry<String,String> property : entry.getProperties().entrySet()) {
    if (!propertiesConf.containsKey(property.getKey())) {
      continue;
    }
    I_CmsXmlContentValue propValue=xmlSitemap.addValue(cms,CmsXmlUtils.concatXpath(entryValue.getPath(),CmsXmlSitemap.XmlNode.PROPERTIES.getName()),locale,j);
    xmlSitemap.getValue(CmsXmlUtils.concatXpath(propValue.getPath(),CmsXmlSitemap.XmlNode.NAME.getName()),locale,0).setStringValue(cms,property.getKey());
    I_CmsXmlContentValue valValue=xmlSitemap.addValue(cms,CmsXmlUtils.concatXpath(propValue.getPath(),CmsXmlSitemap.XmlNode.VALUE.getName()),locale,0);
    if (propertiesConf.get(property.getKey()).getPropertyType().equals(CmsXmlContentProperty.T_VFSLIST)) {
      I_CmsXmlContentValue filelistValue=xmlSitemap.addValue(cms,CmsXmlUtils.concatXpath(valValue.getPath(),CmsXmlSitemap.XmlNode.FILELIST.getName()),locale,0);
      int index=0;
      for (      String strId : CmsStringUtil.splitAsList(property.getValue(),CmsXmlSitemap.IDS_SEPARATOR)) {
        try {
          CmsResource fileRes=cms.readResource(new CmsUUID(strId));
          I_CmsXmlContentValue fileValue=xmlSitemap.getValue(CmsXmlUtils.concatXpath(filelistValue.getPath(),CmsXmlSitemap.XmlNode.URI.getName()),locale,index);
          if (fileValue == null) {
            fileValue=xmlSitemap.addValue(cms,CmsXmlUtils.concatXpath(filelistValue.getPath(),CmsXmlSitemap.XmlNode.URI.getName()),locale,index);
          }
          fileValue.setStringValue(cms,cms.getSitePath(fileRes));
          index++;
        }
 catch (        CmsException e) {
          LOG.error(e.getLocalizedMessage(),e);
        }
      }
    }
 else {
      xmlSitemap.addValue(cms,CmsXmlUtils.concatXpath(valValue.getPath(),CmsXmlSitemap.XmlNode.STRING.getName()),locale,0).setStringValue(cms,property.getValue());
    }
    j++;
  }
  int subentryCount=0;
  for (  CmsSiteEntryBean subentry : entry.getSubEntries()) {
    saveEntry(cms,locale,entryValue.getPath(),xmlSitemap,subentry,subentryCount,propertiesConf);
    subentryCount++;
  }
}
