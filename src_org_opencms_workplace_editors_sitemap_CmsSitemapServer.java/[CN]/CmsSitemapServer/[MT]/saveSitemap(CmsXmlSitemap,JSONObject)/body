{
  CmsObject cms=getCmsObject();
  cms.lockResourceTemporary(cms.getSitePath(xmlSitemap.getFile()));
  Locale locale=cms.getRequestContext().getLocale();
  if (xmlSitemap.hasLocale(locale)) {
    xmlSitemap.removeLocale(locale);
  }
  xmlSitemap.addLocale(cms,locale);
  Map<String,CmsXmlContentProperty> propertiesConf=OpenCms.getADEManager().getElementPropertyConfiguration(cms,xmlSitemap.getFile());
  int entryCount=0;
  List<CmsSiteEntryBean> entries=jsonToEntryList(sitemap.getJSONArray(JsonResponse.SITEMAP.getName()),true);
  for (  CmsSiteEntryBean entry : entries) {
    saveEntry(cms,locale,null,xmlSitemap,entry,entryCount,propertiesConf);
    entryCount++;
  }
  xmlSitemap.getFile().setContents(xmlSitemap.marshal());
  cms.writeFile(xmlSitemap.getFile());
}
