{
  CmsObject cms=getCmsObject();
  CmsSitemapBean sitemap=xmlSitemap.getSitemap(cms,cms.getRequestContext().getLocale());
  JSONObject result=new JSONObject();
  Map<String,CmsXmlContentProperty> propertiesConf=getPropertyConfig(resource);
  JSONArray siteEntries=new JSONArray();
  for (  CmsSiteEntryBean entry : sitemap.getSiteEntries()) {
    JSONObject siteEntry=jsonifyEntry(entry,propertiesConf);
    if (siteEntry != null) {
      siteEntries.put(siteEntry);
    }
  }
  result.put(JsonResponse.sitemap.name(),siteEntries);
  boolean topLevel=true;
  JSONArray superSitemapsJSON=new JSONArray();
  CmsRelationFilter filter=CmsRelationFilter.SOURCES.filterType(CmsRelationType.XML_WEAK);
  for (  CmsRelation relation : cms.getRelationsForResource(resource,filter)) {
    CmsResource source=relation.getSource(cms,CmsResourceFilter.ALL);
    if (CmsResourceTypeXmlSitemap.isSitemap(source)) {
      topLevel=false;
      superSitemapsJSON.put(cms.getSitePath(source));
    }
  }
  result.put(JsonResponse.subSitemap.name(),!topLevel);
  result.put(JsonResponse.superSitemaps.name(),superSitemapsJSON);
  result.put(JsonResponse.properties.name(),getPropertyInfoJSON(resource));
  return result;
}
