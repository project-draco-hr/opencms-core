{
  JSONObject result=new JSONObject();
  result.put(JsonSiteEntry.id.name(),entry.getId().toString());
  result.put(JsonSiteEntry.name.name(),entry.getName());
  result.put(JsonSiteEntry.title.name(),entry.getTitle());
  result.put(JsonSiteEntry.linkId.name(),entry.getResourceId().toString());
  CmsObject cms=getCmsObject();
  JSONObject props=new JSONObject();
  for (  Map.Entry<String,String> prop : entry.getProperties().entrySet()) {
    String key=prop.getKey();
    CmsXmlContentProperty currentPropertyConf=propertyConf.get(key);
    String propType=CmsXmlContentProperty.PropType.string.name();
    if (currentPropertyConf != null) {
      propType=currentPropertyConf.getPropertyType();
    }
    props.put(key,CmsXmlContentPropertyHelper.getPropValuePaths(cms,propType,prop.getValue()));
  }
  result.put(JsonSiteEntry.properties.name(),props);
  try {
    result.put(JsonSiteEntry.content.name(),getEntryContent(entry));
  }
 catch (  CmsVfsResourceNotFoundException e) {
    LOG.debug(e.getLocalizedMessage(),e);
    return null;
  }
catch (  CmsPermissionViolationException e) {
    LOG.debug(e.getLocalizedMessage(),e);
    return null;
  }
catch (  Exception e) {
    LOG.error(e.getLocalizedMessage(),e);
    result.put(JsonSiteEntry.content.name(),e.getLocalizedMessage());
  }
  JSONArray subentries=new JSONArray();
  for (  CmsSitemapEntry subentry : entry.getSubEntries()) {
    JSONObject jsonSubEntry=jsonifyEntry(subentry,propertyConf);
    if (jsonSubEntry != null) {
      subentries.put(jsonSubEntry);
    }
  }
  result.put(JsonSiteEntry.subentries.name(),subentries);
  return result;
}
