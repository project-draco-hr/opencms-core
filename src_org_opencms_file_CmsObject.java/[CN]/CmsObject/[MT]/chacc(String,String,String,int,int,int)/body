{
  CmsResource res=readResource(resourceName,CmsResourceFilter.ALL);
  CmsAccessControlEntry acEntry=null;
  I_CmsPrincipal principal=null;
  if (I_CmsPrincipal.C_PRINCIPAL_GROUP.equalsIgnoreCase(principalType)) {
    principal=readGroup(principalName);
    acEntry=new CmsAccessControlEntry(res.getResourceId(),principal.getId(),allowedPermissions,deniedPermissions,flags);
    acEntry.setFlags(I_CmsConstants.C_ACCESSFLAGS_GROUP);
  }
 else   if (I_CmsPrincipal.C_PRINCIPAL_USER.equalsIgnoreCase(principalType)) {
    principal=readUser(principalName);
    acEntry=new CmsAccessControlEntry(res.getResourceId(),principal.getId(),allowedPermissions,deniedPermissions,flags);
    acEntry.setFlags(I_CmsConstants.C_ACCESSFLAGS_USER);
  }
  m_driverManager.writeAccessControlEntry(m_context,res,acEntry);
}
