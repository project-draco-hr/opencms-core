{
  if (CmsLog.getLog(this).isDebugEnabled() && C_DEBUG) {
    CmsLog.getLog(this).debug("Getting content of element " + ((elementName == null) ? "<root>" : elementName));
    CmsLog.getLog(this).debug("Template file is: " + templateFile);
    CmsLog.getLog(this).debug("Selected template section is: " + ((templateSelector == null) ? "<default>" : templateSelector));
  }
  CmsXmlTemplateFile xmlTemplateDocument=getOwnTemplateFile(cms,templateFile,elementName,parameters,templateSelector);
  I_CmsSession session=CmsXmlTemplateLoader.getSession(cms.getRequestContext(),true);
  Vector files=(Vector)session.getValue(com.opencms.core.I_CmsConstants.C_SESSION_MODULE_VECTOR);
  String step=(String)parameters.get(C_STEP);
  if (step == null) {
    String list="";
    for (int i=0; i < files.size(); i++) {
      xmlTemplateDocument.setData(C_FILENAME,(String)files.elementAt(i));
      list+=xmlTemplateDocument.getProcessedDataValue(C_LISTENTRY);
    }
    xmlTemplateDocument.setData(C_LIST,list);
  }
 else {
    Vector outFiles=new Vector();
    for (int i=0; i < files.size(); i++) {
      String file=(String)files.elementAt(i);
      String test=(String)parameters.get(file);
      if (test == null) {
        outFiles.addElement(file);
      }
    }
    session.putValue(com.opencms.core.I_CmsConstants.C_SESSION_MODULE_VECTOR,outFiles);
    templateSelector=C_READY;
  }
  return startProcessing(cms,xmlTemplateDocument,elementName,parameters,templateSelector);
}
