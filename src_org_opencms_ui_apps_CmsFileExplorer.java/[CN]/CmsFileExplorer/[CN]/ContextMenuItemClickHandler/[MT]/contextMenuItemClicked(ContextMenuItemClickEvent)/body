{
  I_CmsDialogContext context=createDialogContext();
  List<CmsResource> resources=context.getResources();
  Component dialog=instantiate(m_dialogClass,context);
  CmsContextMenuDialogPanel dialogPanel=new CmsContextMenuDialogPanel();
  try {
    if (resources.size() == 1) {
      CmsResourceUtil resUtil=new CmsResourceUtil(context.getCms(),resources.get(0));
      final CmsResourceUtil resUtil1=resUtil;
      final Locale locale=Locale.ENGLISH;
      m_appContext.setAppIcon(new ExternalResource(resUtil1.getBigIconPath()));
      m_appContext.setAppInfo(new VerticalLayout(){
        private static final long serialVersionUID=1L;
{
          addComponent(new Label(resUtil1.getGalleryTitle(locale)));
          addComponent(new Label(resUtil1.getGalleryDescription(locale)));
        }
      }
);
    }
 else     if (resources.size() > 1) {
      for (      CmsResource resource : resources) {
        CmsResourceUtil resUtil=new CmsResourceUtil(context.getCms(),resource);
        Locale locale=Locale.ENGLISH;
        dialogPanel.addResourceInfo(new CmsResourceInfo(resUtil.getGalleryTitle(locale),resUtil.getGalleryDescription(locale),resUtil.getBigIconPath()));
      }
    }
  }
 catch (  Exception e) {
    LOG.error(e.getLocalizedMessage(),e);
  }
  dialogPanel.setContent(dialog);
  m_savedExplorerState=CmsAppWorkplaceUi.get().getNavigator().getState();
  CmsAppWorkplaceUi.get().changeCurrentAppState(CmsAppWorkplaceUi.get().getAppState() + "#dialog");
  m_appContext.setAppContent(dialogPanel);
}
