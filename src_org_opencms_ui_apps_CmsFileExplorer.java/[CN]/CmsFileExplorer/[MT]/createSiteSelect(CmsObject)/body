{
  List<CmsSite> sites=OpenCms.getSiteManager().getAvailableSites(cms,true,true,cms.getRequestContext().getOuFqn());
  final IndexedContainer availableSites=new IndexedContainer();
  availableSites.addContainerProperty(SITE_CAPTION,String.class,null);
  Locale locale=A_CmsUI.get().getLocale();
  for (  CmsSite site : sites) {
    Item siteItem=availableSites.addItem(site.getSiteRoot());
    String title=CmsWorkplace.substituteSiteTitleStatic(site.getTitle(),locale);
    if (CmsStringUtil.isEmptyOrWhitespaceOnly(title)) {
      title=site.getSiteRoot();
    }
    siteItem.getItemProperty(SITE_CAPTION).setValue(title);
  }
  ComboBox combo=new ComboBox(null,availableSites);
  combo.setInputPrompt("You can click here");
  combo.setTextInputAllowed(true);
  combo.setNullSelectionAllowed(false);
  combo.setWidth("200px");
  combo.setItemCaptionPropertyId(SITE_CAPTION);
  combo.select(cms.getRequestContext().getSiteRoot());
  combo.addValueChangeListener(new ValueChangeListener(){
    private static final long serialVersionUID=1L;
    public void valueChange(    ValueChangeEvent event){
      String value=(String)event.getProperty().getValue();
      if (availableSites.containsId(value)) {
        changeSite(value,null);
        availableSites.removeAllContainerFilters();
      }
    }
  }
);
  return combo;
}
