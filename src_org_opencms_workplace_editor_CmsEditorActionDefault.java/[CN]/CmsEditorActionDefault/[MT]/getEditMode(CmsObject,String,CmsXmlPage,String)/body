{
  try {
    CmsResource res=cmsObject.readFileHeader(filename);
    int currentProject=cmsObject.getRequestContext().currentProject().getId();
    CmsUUID userId=cmsObject.getRequestContext().currentUser().getId();
    CmsLock lock=cmsObject.getLock(filename);
    boolean locked=!(lock.isNullLock() || (lock.getUserId().equals(userId) && lock.getProjectId() == currentProject));
    if (currentProject == I_CmsConstants.C_PROJECT_ONLINE_ID) {
      return null;
    }
 else     if (!cmsObject.getResourceType(res.getType()).isDirectEditable()) {
      return null;
    }
 else     if (CmsResource.getName(filename).startsWith(com.opencms.core.I_CmsConstants.C_TEMP_PREFIX)) {
      return C_EDITMODE_INACTIVE;
    }
 else     if (!cmsObject.isInsideCurrentProject(res)) {
      return C_EDITMODE_INACTIVE;
    }
 else     if (!cmsObject.hasPermissions(res,new CmsPermissionSet(I_CmsConstants.C_PERMISSION_WRITE))) {
      if (locked) {
        return C_EDITMODE_DISABLED;
      }
 else {
        return C_EDITMODE_INACTIVE;
      }
    }
 else     if (locked) {
      return C_EDITMODE_DISABLED;
    }
    if (page != null && element != null) {
      String localeName=OpenCms.getLocaleManager().getBestMatchingLocaleName(null,OpenCms.getLocaleManager().getDefaultLocaleNames(cmsObject,filename),page.getLanguages());
      if (!page.hasElement(element,localeName) || !page.isEnabled(element,localeName)) {
        return C_EDITMODE_INACTIVE;
      }
    }
    return C_EDITMODE_ENABLED;
  }
 catch (  CmsException exc) {
    return C_EDITMODE_INACTIVE;
  }
}
