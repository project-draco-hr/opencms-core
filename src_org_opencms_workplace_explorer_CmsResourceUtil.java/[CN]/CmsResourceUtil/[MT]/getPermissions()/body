{
  String permissions;
  try {
    permissions=getCms().getPermissions(getCms().getSitePath(getResource())).getPermissionString();
  }
 catch (  Throwable e) {
    String storedSiteRoot=getCms().getRequestContext().getSiteRoot();
    try {
      getCms().getRequestContext().setSiteRoot("");
      permissions=getCms().getPermissions(getResource().getRootPath()).getPermissionString();
    }
 catch (    Throwable e1) {
      permissions=e1.getMessage();
      if (LOG.isInfoEnabled()) {
        LOG.info(e1);
      }
    }
 finally {
      getCms().getRequestContext().setSiteRoot(storedSiteRoot);
    }
  }
  return permissions;
}
