{
  try {
    JSONObject jsonDoc=toJSON(cms,true);
    if ((!isAttachment()) && (m_attachments != null)) {
      JSONArray jsonAttachments=new JSONArray();
      for (      CmsDocumentLocaleDependency att : m_attachments) {
        JSONObject jsonAttachment=att.toJSON(cms,true);
        jsonAttachments.put(jsonAttachment);
      }
      jsonDoc.put(JSON_ATTACHMENTS,jsonAttachments);
    }
 else     if (isAttachment()) {
      CmsDocumentLocaleDependency main=getMainDocument();
      if (main != null) {
        JSONObject jsonMain=main.toJSON(cms,true);
        List<CmsDocumentLocaleDependency> attachments=main.getAttachments();
        if (attachments != null) {
          JSONArray jsonAttachments=new JSONArray();
          for (          CmsDocumentLocaleDependency att : attachments) {
            JSONObject jsonAttachment=att.toJSON(cms,true);
            jsonAttachments.put(jsonAttachment);
          }
          jsonMain.put(JSON_ATTACHMENTS,jsonAttachments);
        }
        jsonDoc.put(JSON_MAIN,jsonMain);
      }
    }
    return jsonDoc.toString();
  }
 catch (  Exception ex) {
    LOG.error(ex.getLocalizedMessage(),ex);
  }
  return null;
}
