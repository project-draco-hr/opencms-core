{
  if ((content == null) || (locale == null) || !content.hasLocale(locale)) {
    return null;
  }
  Set<Map.Entry<String,CmsListFieldMapping>> mappings=m_mappings.entrySet();
  CmsListEntry result=new CmsListEntry();
  boolean hasTitle=false;
  Iterator<Map.Entry<String,CmsListFieldMapping>> i=mappings.iterator();
  String link=null;
  Date date=null;
  while (i.hasNext()) {
    Map.Entry<String,CmsListFieldMapping> e=i.next();
    String listBoxField=e.getKey();
    CmsListFieldMapping mapping=e.getValue();
    I_CmsXmlContentValue xmlContentValue=null;
    List<String> xmlFields=mapping.getXmlFields();
    for (int j=0, size=xmlFields.size(); j < size; j++) {
      String xmlField=xmlFields.get(j);
      if (CmsStringUtil.isNotEmptyOrWhitespaceOnly(xmlField)) {
        xmlContentValue=content.getValue(xmlField,locale);
        if (xmlContentValue != null) {
          break;
        }
      }
    }
    String value=null;
    if (xmlContentValue != null) {
      value=xmlContentValue.getStringValue(cms);
    }
 else     if (mapping.hasDefaultValue()) {
      value=mapping.getDefaultValue();
    }
    if (value != null) {
      if (mapping.hasMaxLenghtLimit()) {
        value=applyLengthRestriction(cms,xmlContentValue,value,mapping.getMaxLenght());
      }
      int pos=MAPPINGS_LIST.indexOf(listBoxField);
switch (pos) {
case 0:
        result.setTitle(value);
      hasTitle=true;
    break;
case 1:
  result.setAuthor(value);
break;
case 2:
result.setDescription(value);
break;
case 3:
date=convertToDate(cms,content.getFile(),xmlContentValue,value);
if (date != null) {
result.setDate(date);
}
break;
case 4:
if (CmsStringUtil.isNotEmptyOrWhitespaceOnly(value)) {
link=OpenCms.getLinkManager().getServerLink(cms,value);
}
break;
case 5:
if (CmsStringUtil.isNotEmptyOrWhitespaceOnly(value)) {
result.setImage(value);
}
break;
default :
}
}
}
if (hasTitle) {
if (link == null) {
String sPath=cms.getSitePath(content.getFile());
String uri=CmsJspTagLink.subsituteSitemapUri(sPath,cms);
link=OpenCms.getLinkManager().substituteLinkForUnknownTarget(cms,uri);
}
if (CmsStringUtil.isNotEmptyOrWhitespaceOnly(link)) {
result.setLink(link);
}
}
 else {
result=null;
}
return result;
}
