{
  String targetFolder=getTargetFolder();
  List<String> filesToUnzip=getFilesToUnzip();
  for (  FileItem fileItem : m_multiPartFileItems) {
    if ((fileItem != null) && (!fileItem.isFormField())) {
      byte[] content=fileItem.get();
      fileItem.delete();
      String fileName=m_parameterMap.get(fileItem.getFieldName() + I_CmsUploadConstants.UPLOAD_FILENAME_ENCODED_SUFFIX)[0];
      fileName=URLDecoder.decode(fileName,"UTF-8");
      if (filesToUnzip.contains(CmsResource.getName(fileName.replace('\\','/')))) {
        CmsImportFolder importZip=new CmsImportFolder();
        try {
          importZip.importZip(content,targetFolder,getCmsObject(),false);
        }
  finally {
          m_resourcesCreated.addAll(importZip.getCreatedResourceNames());
        }
      }
 else {
        String newResname=createSingleResource(fileName,targetFolder,content);
        m_resourcesCreated.add(newResname);
      }
      if (listener.isCanceled()) {
        throw listener.getException();
      }
    }
  }
}
