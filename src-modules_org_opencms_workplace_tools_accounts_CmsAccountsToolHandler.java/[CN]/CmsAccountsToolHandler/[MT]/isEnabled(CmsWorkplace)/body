{
  if (getLink().equals(GROUPUSERS_FILE)) {
    String groupId=wp.getJsp().getRequest().getParameter(A_CmsEditGroupDialog.PARAM_GROUPID);
    try {
      return !wp.getCms().readGroup(new CmsUUID(groupId)).isVirtual();
    }
 catch (    Exception e) {
      return false;
    }
  }
  if (!getLink().equals(ASSIGN_FILE)) {
    wp.getJsp().getRequest().getSession().removeAttribute(A_CmsOrgUnitUsersList.ORGUNIT_USERS);
    wp.getJsp().getRequest().getSession().removeAttribute(A_CmsOrgUnitUsersList.NOT_ORGUNIT_USERS);
  }
  if (getLink().equals(DELETE_FILE)) {
    String ouFqn=wp.getJsp().getRequest().getParameter(A_CmsOrgUnitDialog.PARAM_OUFQN);
    if (ouFqn == null) {
      ouFqn=wp.getCms().getRequestContext().getOuFqn();
    }
    try {
      if (OpenCms.getOrgUnitManager().getUsers(wp.getCms(),ouFqn,true).size() > 0) {
        return false;
      }
      if (OpenCms.getOrgUnitManager().getGroups(wp.getCms(),ouFqn,true).size() > 0) {
        List groups=OpenCms.getOrgUnitManager().getGroups(wp.getCms(),ouFqn,true);
        Iterator itGroups=groups.iterator();
        while (itGroups.hasNext()) {
          CmsGroup group=(CmsGroup)itGroups.next();
          if (!OpenCms.getDefaultUsers().isDefaultGroup(group.getName())) {
            return false;
          }
        }
      }
      if (OpenCms.getOrgUnitManager().getOrganizationalUnits(wp.getCms(),ouFqn,true).size() > 0) {
        return false;
      }
    }
 catch (    CmsException e) {
    }
  }
  if (getLink().equals(ROLEUSERS_EDIT_FILE)) {
    String roleName=wp.getJsp().getRequest().getParameter(CmsRolesList.PARAM_ROLE);
    if (!OpenCms.getRoleManager().hasRole(wp.getCms(),CmsRole.valueOfGroupName(roleName))) {
      return false;
    }
  }
  return true;
}
