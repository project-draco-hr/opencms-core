{
  String name=n.getAttribute("name");
  String output="++ missing context ++";
  if (name != null) {
    String currentLocale=null;
    CmsUserSettings settings=new CmsUserSettings(cms.getRequestContext().currentUser());
    currentLocale=settings.getLocale().toString();
    StringBuffer result=new StringBuffer();
    output=(String)m_storage.get(currentLocale + name + cms.getRequestContext().getUri());
    if (output == null) {
      CmsXmlWpTemplateFile context=getContextmenueDefinitions(cms);
      context.setData("name",name);
      result.append(context.getProcessedDataValue("CONTEXTHEAD",callingObject,parameters));
      NodeList nl=n.getChildNodes();
      for (int i=0; i < nl.getLength(); i++) {
        Node actualNode=nl.item(i);
        if (actualNode.getNodeType() != Node.TEXT_NODE) {
          Element e=(Element)actualNode;
          if (e.getTagName().toLowerCase().equals("contextspacer")) {
            result.append(context.getProcessedDataValue("CONTEXTSPACER",callingObject,parameters));
          }
 else {
            if (e.getTagName().toLowerCase().equals("contextentry")) {
              context.setData("name",lang.getLanguageValue(e.getAttribute("name")));
              context.setData("href",e.getAttribute("href"));
              result.append(context.getProcessedDataValue("CONTEXTENTRY",callingObject,parameters));
            }
 else {
              if (e.getTagName().toLowerCase().equals("contextdisabled")) {
                context.setData("name",lang.getLanguageValue(e.getAttribute("name")));
                result.append(context.getProcessedDataValue("CONTEXTDISABLED",callingObject,parameters));
              }
            }
          }
        }
      }
      result.append(context.getProcessedDataValue("CONTEXTFOOT",callingObject,parameters));
      output=result.toString();
      m_storage.put(currentLocale + name + cms.getRequestContext().getUri(),output);
    }
  }
  return output;
}
