{
  Vector allFiles=null;
  try {
    allFiles=cms.getFilesInFolder(folder);
  }
 catch (  Exception e) {
    if (A_OpenCms.isLogging()) {
      A_OpenCms.log(C_OPENCMS_CRITICAL,"[CmsNewsContent] " + e);
    }
    allFiles=null;
  }
  if (allFiles == null) {
    String errorMessage="Could not read the article files in folder " + folder;
    if (A_OpenCms.isLogging()) {
      A_OpenCms.log(C_OPENCMS_CRITICAL,"[CmsNewsContent] " + errorMessage);
    }
    throw new CmsException(errorMessage);
  }
  int numFiles=allFiles.size();
  Vector selectedFiles=new Vector();
  for (int i=0; i < numFiles; i++) {
    CmsResource fileHeader=(CmsResource)allFiles.elementAt(i);
    if (fileHeader.getState() != CmsFile.C_STATE_DELETED) {
      selectedFiles.addElement(fileHeader);
    }
  }
  Vector sortedFiles=Utils.sort(cms,selectedFiles,Utils.C_SORT_NAME_DOWN);
  return getFileObjects(cms,sortedFiles,showInactive);
}
