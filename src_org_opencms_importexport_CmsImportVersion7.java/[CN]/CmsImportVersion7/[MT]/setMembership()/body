{
  if ((m_orgUnit == null) || (m_membership == null)) {
    return;
  }
  Map membership=(Map)m_membership.get(m_orgUnit.getName());
  if (membership == null) {
    return;
  }
  Map groups=(Map)membership.get(I_CmsPrincipal.PRINCIPAL_GROUP);
  if (groups != null) {
    Iterator it=groups.entrySet().iterator();
    while (it.hasNext()) {
      Map.Entry entry=(Map.Entry)it.next();
      String userName=(String)entry.getKey();
      String groupName=(String)entry.getValue();
      try {
        getCms().addUserToGroup(userName,groupName);
      }
 catch (      Throwable e) {
        getReport().println(Messages.get().container(Messages.RPT_USER_COULDNT_BE_ADDED_TO_GROUP_2,userName,groupName),I_CmsReport.FORMAT_WARNING);
        if (LOG.isDebugEnabled()) {
          LOG.debug(e.getLocalizedMessage(),e);
        }
      }
    }
  }
  Map roles=(Map)membership.get(I_CmsPrincipal.PRINCIPAL_USER);
  if (roles != null) {
    Iterator it=roles.entrySet().iterator();
    while (it.hasNext()) {
      Map.Entry entry=(Map.Entry)it.next();
      String userName=(String)entry.getKey();
      String roleName=(String)entry.getValue();
      CmsRole role=CmsRole.valueOfRoleName(roleName);
      try {
        OpenCms.getRoleManager().addUserToRole(getCms(),role,userName);
        return;
      }
 catch (      Throwable e) {
        getReport().println(Messages.get().container(Messages.RPT_USER_COULDNT_BE_ADDED_TO_ROLE_2,userName,roleName),I_CmsReport.FORMAT_WARNING);
        if (LOG.isDebugEnabled()) {
          LOG.debug(e.getLocalizedMessage(),e);
        }
      }
    }
  }
}
