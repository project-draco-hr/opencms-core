{
  Connection con=null;
  int id;
  int borderId;
  try {
    if (!poolName.startsWith(CmsDbPool.C_DBCP_JDBC_URL_PREFIX)) {
      poolName=CmsDbPool.C_DBCP_JDBC_URL_PREFIX + poolName;
    }
    con=DriverManager.getConnection(poolName);
    do {
      id=readId(con,tableName);
      if (id == I_CmsConstants.C_UNKNOWN_ID) {
        id=1;
        createId(con,tableName,id);
      }
      borderId=id + C_GROW_VALUE;
    }
 while (!writeId(con,tableName,id,borderId));
    c_currentId.put(key,new Integer(id));
    c_borderId.put(key,new Integer(borderId));
  }
 catch (  SQLException e) {
    throw new CmsException("[" + CmsIdGenerator.class.getName() + "]"+ e.getMessage(),CmsException.C_SQL_ERROR,e);
  }
 finally {
    if (con != null) {
      try {
        con.close();
      }
 catch (      SQLException exc) {
      }
    }
  }
}
