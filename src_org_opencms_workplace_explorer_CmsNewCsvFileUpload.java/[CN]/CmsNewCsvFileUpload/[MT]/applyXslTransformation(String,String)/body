{
  DocumentBuilderFactory factory=DocumentBuilderFactory.newInstance();
  Document document;
  StringWriter result=new StringWriter();
  try {
    InputStream stylesheet=new ByteArrayInputStream(getCms().readFile(xsltFile).getContents());
    DocumentBuilder builder=factory.newDocumentBuilder();
    document=builder.parse(new ByteArrayInputStream(xmlContent.getBytes()));
    TransformerFactory tFactory=TransformerFactory.newInstance();
    StreamSource stylesource=new StreamSource(stylesheet);
    Transformer transformer=tFactory.newTransformer(stylesource);
    DOMSource source=new DOMSource(document);
    StreamResult streamResult=new StreamResult(result);
    transformer.transform(source,streamResult);
  }
 catch (  Exception e) {
    if (OpenCms.getLog(this).isErrorEnabled()) {
      OpenCms.getLog(this).error(e);
    }
  }
  return result.toString();
}
