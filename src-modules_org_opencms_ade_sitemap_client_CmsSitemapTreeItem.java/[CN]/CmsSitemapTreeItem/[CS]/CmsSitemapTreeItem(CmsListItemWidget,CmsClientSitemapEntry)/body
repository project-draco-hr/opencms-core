{
  super(widget,false);
  m_decoratedPanel.addDecorationBoxStyle(CSS.sitemapEntryDecoration());
  m_listItemWidget=widget;
  m_detailPageLabelTitleGenerator=new DetailPageLabelTitleGenerator();
  m_listItemWidget.getSubTitleSuffix().setTitleGenerator(m_detailPageLabelTitleGenerator);
  m_entry=entry;
  m_inNavigationStyle=new CmsStyleVariable(this);
  m_openerForNonNavigationStyle=new CmsStyleVariable(m_opener);
  m_listItemWidget.addTitleStyleName(CSS.itemTitle());
  updateInNavigation(entry);
  m_itemsById.put(entry.getId(),this);
  setId(getName(entry.getSitePath()));
  updateSitePath(entry.getSitePath());
  updateSitemapReferenceStatus(entry);
  updateDetailPageStatus();
  setLockIcon(entry.getLock());
  if (!entry.isFolderType()) {
    hideOpeners();
  }
  setDropEnabled(m_entry.isFolderType() && !m_entry.hasForeignFolderLock());
  widget.setTitleEditHandler(new I_CmsTitleEditHandler(){
    /** 
 * @see org.opencms.gwt.client.ui.CmsListItemWidget.I_CmsTitleEditHandler#handleEdit(org.opencms.gwt.client.ui.input.CmsLabel,com.google.gwt.user.client.ui.TextBox)
 */
    public void handleEdit(    CmsLabel titleLabel,    TextBox box){
      final String newTitle=box.getText();
      box.removeFromParent();
      if (CmsStringUtil.isEmpty(newTitle)) {
        titleLabel.setVisible(true);
        String dialogTitle=Messages.get().key(Messages.GUI_EDIT_TITLE_ERROR_DIALOG_TITLE_0);
        String dialogText=Messages.get().key(Messages.GUI_TITLE_CANT_BE_EMPTY_0);
        CmsAlertDialog alert=new CmsAlertDialog(dialogTitle,dialogText);
        alert.center();
        return;
      }
      String oldTitle=m_entry.getTitle();
      if (!oldTitle.equals(newTitle)) {
        String changePath=Joiner.on("/").join(m_entry.getId().toString(),CmsClientProperty.PROPERTY_NAVTEXT,CmsClientProperty.PATH_STRUCTURE_VALUE);
        CmsPropertyModification propMod=new CmsPropertyModification(changePath,newTitle);
        final List<CmsPropertyModification> propChanges=Collections.<CmsPropertyModification>singletonList(propMod);
        if (m_entry.isNew()) {
          CmsRpcAction<String> action=new CmsRpcAction<String>(){
            /** 
 * @see org.opencms.gwt.client.rpc.CmsRpcAction#execute()
 */
            @Override public void execute(){
              start(0,false);
              CmsCoreProvider.getService().translateUrlName(newTitle,this);
            }
            /** 
 * @see org.opencms.gwt.client.rpc.CmsRpcAction#onResponse(java.lang.Object)
 */
            @Override protected void onResponse(            String result){
              stop(false);
              String newUrlName=result;
              if (!m_entry.isRoot()) {
                String parentPath=CmsResource.getParentFolder(m_entry.getSitePath());
                CmsClientSitemapEntry parent=CmsSitemapView.getInstance().getController().getEntry(parentPath);
                newUrlName=CmsSitemapController.ensureUniqueName(parent,result);
              }
              CmsClientSitemapEntry newEntry=new CmsClientSitemapEntry(m_entry);
              newEntry.setName(newUrlName);
              CmsSitemapController controller=CmsSitemapView.getInstance().getController();
              String changePath=Joiner.on("/").join(m_entry.getId().toString(),CmsClientProperty.PROPERTY_NAVTEXT,CmsClientProperty.PATH_STRUCTURE_VALUE);
              CmsPropertyModification propMod=new CmsPropertyModification(changePath,newTitle);
              controller.editAndChangeName(m_entry,newUrlName,m_entry.getVfsPath(),propChanges,false,ReloadMode.none);
            }
          }
;
          action.execute();
        }
 else {
          CmsSitemapController controller=CmsSitemapView.getInstance().getController();
          controller.edit(m_entry,m_entry.getVfsPath(),propChanges,false);
        }
      }
      titleLabel.setVisible(true);
    }
  }
);
}
