{
  try {
    LineNumberReader lnr=new LineNumberReader(new InputStreamReader(fileInputStream));
    while (!m_exitCalled) {
      printPrompt();
      String line=lnr.readLine();
      if (line == null) {
        try {
          Thread.sleep(500);
        }
 catch (        Throwable t) {
          continue;
        }
      }
      if ((line != null) && line.trim().startsWith("#")) {
        System.out.println(line);
        continue;
      }
      StringReader reader=new StringReader(line);
      StreamTokenizer st=new StreamTokenizer(reader);
      st.eolIsSignificant(true);
      List parameters=new ArrayList();
      while (st.nextToken() != StreamTokenizer.TT_EOF) {
        if (st.ttype == StreamTokenizer.TT_NUMBER) {
          parameters.add(Integer.toString(new Double(st.nval).intValue()));
        }
 else {
          parameters.add(st.sval);
        }
      }
      reader.close();
      if ((parameters == null) || (parameters.size() == 0)) {
        if (m_echo) {
          System.out.println();
        }
        continue;
      }
      String command=(String)parameters.get(0);
      parameters=parameters.subList(1,parameters.size());
      executeCommand(command,parameters);
    }
  }
 catch (  Throwable t) {
    t.printStackTrace(System.err);
  }
}
