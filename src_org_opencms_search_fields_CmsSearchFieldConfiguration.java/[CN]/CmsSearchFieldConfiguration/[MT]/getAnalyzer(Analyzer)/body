{
  analyzer=getAnalyzerForDefaultFields(analyzer);
  PerFieldAnalyzerWrapper result=analyzer instanceof PerFieldAnalyzerWrapper ? (PerFieldAnalyzerWrapper)analyzer : null;
  Iterator<CmsSearchField> i=m_fields.iterator();
  while (i.hasNext()) {
    CmsSearchField field=i.next();
    Analyzer fieldAnalyzer=field.getAnalyzer();
    if (fieldAnalyzer != null) {
      if (result == null) {
        result=new PerFieldAnalyzerWrapper(analyzer);
      }
      result.addAnalyzer(field.getName(),fieldAnalyzer);
    }
  }
  if (result == null) {
    return analyzer;
  }
  return result;
}
