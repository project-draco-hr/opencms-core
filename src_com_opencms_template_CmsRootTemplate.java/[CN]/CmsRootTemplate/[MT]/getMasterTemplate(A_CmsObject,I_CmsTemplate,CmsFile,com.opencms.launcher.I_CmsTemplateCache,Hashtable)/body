{
  long timer=System.currentTimeMillis();
  byte[] result;
  Object cacheKey=templateClass.getKey(cms,masterTemplate.getAbsolutePath(),parameters,null);
  if (A_OpenCms.isLogging()) {
    A_OpenCms.log(C_OPENCMS_DEBUG,"[CmsRootTemplate] Caching key for " + masterTemplate.getName() + " is: "+ cacheKey);
    A_OpenCms.log(C_OPENCMS_DEBUG,"[CmsRootTemplate] isCacheable: " + templateClass.isCacheable(cms,masterTemplate.getAbsolutePath(),null,parameters,null));
    A_OpenCms.log(C_OPENCMS_DEBUG,"[CmsRootTemplate] Cache has  : " + cache.has(cacheKey));
    A_OpenCms.log(C_OPENCMS_DEBUG,"[CmsRootTemplate] should reload: " + templateClass.shouldReload(cms,masterTemplate.getAbsolutePath(),null,parameters,null));
  }
  if (templateClass.isCacheable(cms,masterTemplate.getAbsolutePath(),null,parameters,null) && cache.has(cacheKey) && !templateClass.shouldReload(cms,masterTemplate.getAbsolutePath(),null,parameters,null)) {
    result=cache.get(cacheKey);
    if (A_OpenCms.isLogging()) {
      A_OpenCms.log(C_OPENCMS_INFO,"[CmsRootTemplate] page " + masterTemplate.getAbsolutePath() + " was read from cache.");
    }
  }
 else {
    try {
      result=templateClass.getContent(cms,masterTemplate.getAbsolutePath(),null,parameters);
    }
 catch (    CmsException e) {
      cache.clearCache(cacheKey);
      if (A_OpenCms.isLogging()) {
        A_OpenCms.log(C_OPENCMS_INFO,"[CmsRootTemplate] Could not get contents of master template " + masterTemplate.getName());
      }
      throw e;
    }
    if (templateClass.isCacheable(cms,masterTemplate.getAbsolutePath(),null,parameters,null)) {
      cache.put(cacheKey,result);
    }
  }
  return result;
}
