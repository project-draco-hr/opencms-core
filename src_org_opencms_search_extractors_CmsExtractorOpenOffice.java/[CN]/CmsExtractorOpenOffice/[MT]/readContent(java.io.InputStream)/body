{
  StringBuffer resultBuffer=new StringBuffer();
  SAXReader reader=new SAXReader();
  org.dom4j.Document doc=reader.read(in);
  java.util.List textlist=doc.selectNodes("//text:p[@*] | //text:span[@*]");
  ListIterator li=textlist.listIterator();
  Node textNode;
  String text;
  while (li.hasNext()) {
    textNode=(Node)li.next();
    text=textNode.getText();
    if (text.length() > 1) {
      text=" " + text + " ";
      resultBuffer.append(text);
    }
  }
  return resultBuffer.toString();
}
