{
  CmsResource importedResource=null;
  boolean changed=true;
  try {
    importedResource=cms.doImportResource(resource,content,properties,destination);
    cms.lockResource(destination);
    changed=(importedResource == null);
  }
 catch (  CmsException e) {
  }
  if (changed) {
    CmsResource existingResource=cms.readFileHeader(destination);
    if (existingResource.getResourceId().equals(resource.getResourceId())) {
      cms.lockResource(destination);
      cms.doWriteResource(destination,properties,null,getResourceType(),content);
      importedResource=cms.readFileHeader(destination);
      cms.touch(destination,resource.getDateLastModified(),false,resource.getUserLastModified());
    }
 else {
      cms.copyToLostAndFound(destination);
      resource.setState(I_CmsConstants.C_STATE_CHANGED);
      importedResource=cms.doImportResource(resource,content,properties,destination);
    }
  }
  return importedResource;
}
