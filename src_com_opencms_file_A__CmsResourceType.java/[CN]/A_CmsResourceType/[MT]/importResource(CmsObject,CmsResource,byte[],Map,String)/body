{
  CmsResource importedResource=null;
  boolean changed=true;
  try {
    importedResource=cms.doImportResource(resource,content,properties,destination);
    cms.lockResource(destination);
    changed=(importedResource == null);
  }
 catch (  CmsException e) {
  }
  if (changed) {
    CmsResource existingResource=cms.readFileHeader(destination);
    if (existingResource.getResourceId().equals(resource.getResourceId())) {
      cms.lockResource(destination);
      cms.doWriteResource(destination,properties,null,getResourceType(),content);
      importedResource=cms.readFileHeader(destination);
      cms.touch(destination,resource.getDateLastModified(),false,resource.getUserLastModified());
    }
 else {
      String target=copyToLostAndFound(cms,destination,false);
      CmsResource newRes=new CmsResource(resource.getId(),resource.getResourceId(),resource.getParentId(),resource.getFileId(),CmsResource.getName(target),resource.getType(),resource.getFlags(),resource.getProjectId(),resource.getState(),resource.getLoaderId(),resource.getDateLastModified(),resource.getUserLastModified(),resource.getDateCreated(),resource.getUserCreated(),resource.getLength(),1);
      importedResource=cms.doImportResource(newRes,content,properties,target);
    }
  }
  return importedResource;
}
