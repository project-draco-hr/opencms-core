{
  I_CmsLocaleHandler localeHandler=null;
  String localeHandlerClass=OpenCms.getRegistry().getLocaleHandler();
  try {
    localeHandler=(I_CmsLocaleHandler)Class.forName(localeHandlerClass).newInstance();
    localeHandler.initHandler(cms);
    if (OpenCms.getLog(CmsLog.CHANNEL_INIT).isInfoEnabled()) {
      OpenCms.getLog(CmsLog.CHANNEL_INIT).info(". Locale handler class : " + localeHandlerClass + " instanciated");
    }
  }
 catch (  Exception e) {
    if (OpenCms.getLog(CmsLog.CHANNEL_INIT).isInfoEnabled()) {
      OpenCms.getLog(CmsLog.CHANNEL_INIT).info(". Locale handler class : error initializing locale handler class '" + localeHandlerClass + "' (using default locale handler instead)");
    }
    localeHandler=new CmsDefaultLocaleHandler();
    localeHandler.initHandler(cms);
  }
  String[] availableLocaleNames=configuration.getStringArray("locale.available");
  String[] defaultLocaleNames=configuration.getStringArray("locale.default");
  if (OpenCms.getLog(CmsLog.CHANNEL_INIT).isInfoEnabled()) {
    StringBuffer buf=new StringBuffer();
    for (int i=0; i < availableLocaleNames.length; i++) {
      if (i > 0) {
        buf.append(", ");
      }
      buf.append(availableLocaleNames[i]);
    }
    OpenCms.getLog(CmsLog.CHANNEL_INIT).info(". Available locales    : " + buf.toString());
    buf=new StringBuffer();
    for (int i=0; i < defaultLocaleNames.length; i++) {
      if (i > 0) {
        buf.append(", ");
      }
      buf.append(defaultLocaleNames[i]);
    }
    OpenCms.getLog(CmsLog.CHANNEL_INIT).info(". Default locales      : " + buf.toString());
  }
  return new CmsLocaleManager(localeHandler,availableLocaleNames,defaultLocaleNames);
}
