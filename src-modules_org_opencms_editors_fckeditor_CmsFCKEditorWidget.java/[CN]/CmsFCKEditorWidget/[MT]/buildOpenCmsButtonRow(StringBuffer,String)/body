{
  boolean buttonRendered=false;
  if (CmsStringUtil.isNotEmptyOrWhitespaceOnly(widgetOptionsString)) {
    CmsHtmlWidgetOption option=new CmsHtmlWidgetOption(widgetOptionsString);
    StringBuffer custom=new StringBuffer(512);
    if (option.showSourceEditor()) {
      custom.append("\"Source\"");
      buttonRendered=true;
    }
    boolean showFormatSelect=false;
    if (option.showFormatSelect()) {
      if (buttonRendered) {
        custom.append(",\"-\",");
      }
      custom.append("\"FontFormat\"");
      buttonRendered=true;
      showFormatSelect=true;
    }
    if (option.showStylesXml()) {
      if (!showFormatSelect && buttonRendered) {
        custom.append(",\"-\",");
      }
 else       if (buttonRendered) {
        custom.append(",");
      }
      custom.append("\"Style\"");
      buttonRendered=true;
    }
    boolean showLink=false;
    if (option.showLinkDialog()) {
      if (buttonRendered) {
        custom.append(",");
      }
      custom.append("\"oc-link\"");
      buttonRendered=true;
      showLink=true;
    }
    if (option.showAnchorDialog()) {
      if (buttonRendered) {
        custom.append(",");
      }
      custom.append("\"Anchor\"");
      buttonRendered=true;
      showLink=true;
    }
    if (showLink) {
      custom.append(", \"Unlink\"");
    }
    boolean showGallery=false;
    StringBuffer galleryResult=new StringBuffer(8);
    if ((option.getDisplayGalleries().size() > 0) || option.showImageDialog()) {
      if (option.getDisplayGalleries().contains(CmsAjaxImageGallery.GALLERYTYPE_NAME) || option.showImageDialog()) {
        if (galleryResult.length() > 0) {
          galleryResult.append(", ");
        }
        galleryResult.append("\"OcmsImageGallery\"");
        showGallery=true;
      }
      if (option.getDisplayGalleries().contains(CmsAjaxDownloadGallery.GALLERYTYPE_NAME)) {
        if (galleryResult.length() > 0) {
          galleryResult.append(", ");
        }
        galleryResult.append("\"OcmsDownloadGallery\"");
        showGallery=true;
      }
      if (option.getDisplayGalleries().contains(CmsAjaxLinkGallery.GALLERYTYPE_NAME)) {
        if (galleryResult.length() > 0) {
          galleryResult.append(", ");
        }
        galleryResult.append("\"OcmsLinkGallery\"");
        showGallery=true;
      }
      if (option.getDisplayGalleries().contains(CmsAjaxHtmlGallery.GALLERYTYPE_NAME)) {
        if (galleryResult.length() > 0) {
          galleryResult.append(", ");
        }
        galleryResult.append("\"OcmsHtmlGallery\"");
        showGallery=true;
      }
      if (option.getDisplayGalleries().contains(CmsAjaxTableGallery.GALLERYTYPE_NAME)) {
        if (galleryResult.length() > 0) {
          galleryResult.append(", ");
        }
        galleryResult.append("\"OcmsTableGallery\"");
        showGallery=true;
      }
    }
    if (showGallery) {
      if (buttonRendered) {
        custom.append("],[");
      }
      custom.append(galleryResult);
      buttonRendered=true;
    }
    if (option.showTableDialog()) {
      if (buttonRendered) {
        custom.append(",\"-\",");
      }
      custom.append("\"Table\"");
      buttonRendered=true;
    }
    if (buttonRendered) {
      custom.insert(0,",[");
      toolbar.append(custom);
    }
  }
  return buttonRendered;
}
