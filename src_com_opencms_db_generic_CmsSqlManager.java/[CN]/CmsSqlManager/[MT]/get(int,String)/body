{
  String query=get(queryKey);
  if (projectId < 0) {
    return query;
  }
  if (!m_cachedQueries.containsKey(queryKey)) {
    String searchPattern="_T_";
    String replacePattern=(projectId == I_CmsConstants.C_PROJECT_ONLINE_ID) ? "_ONLINE_" : "_OFFLINE_";
    query=CmsStringSubstitution.substitute(query,searchPattern,replacePattern);
    queryKey+=(projectId == I_CmsConstants.C_PROJECT_ONLINE_ID) ? "_ONLINE" : "_OFFLINE";
    m_cachedQueries.put(queryKey,query);
  }
 else {
    query=(String)m_cachedQueries.get(queryKey);
  }
  return query;
}
