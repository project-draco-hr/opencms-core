{
  CmsObject cms=getCmsObject();
  cms.createResource("/foo1.txt",CmsResourceTypePlain.getStaticTypeId(),"foo1".getBytes(),Collections.singletonList(new CmsProperty("Title","foo1","foo1")));
  I_CmsReport report=new CmsShellReport(Locale.ENGLISH);
  OpenCms.getSearchManager().rebuildAllIndexes(report);
  cms.moveResource("/foo1.txt","/foo2.txt");
  OpenCms.getSearchManager().updateOfflineIndexes(5000);
  A_CmsSearchIndex index=OpenCms.getSearchManager().getIndex(CmsGallerySearchIndex.GALLERY_INDEX_NAME);
  CmsSearchParameters params=new CmsSearchParameters("/foo1.txt");
  CmsSearchResultList results=index.search(cms,params);
  assertEquals(1,results.size());
  assertTrue(results.get(0).getPath().contains("foo2"));
}
