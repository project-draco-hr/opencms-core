{
  int containerModelTypeId=OpenCms.getResourceManager().getResourceType(CmsResourceTypeXmlContainerPage.CONTAINER_MODEL_TYPE_NAME).getTypeId();
  for (  CmsContainerBean container : xmlCnt.getContainerPage(getCmsObject()).getContainers().values()) {
    for (    CmsContainerElementBean element : container.getElements()) {
      try {
        element.initResource(getCmsObject());
        if (containerModelTypeId == element.getResource().getTypeId()) {
          try {
            List<CmsRelation> relations=getCmsObject().getRelationsForResource(element.getResource(),CmsRelationFilter.relationsFromStructureId(element.getId()).filterType(CmsRelationType.CONTAINER_MODEL));
            if (relations.isEmpty()) {
              ensureLock(element.getResource());
              setContainerModelRelation(getCmsObject(),containerpage,element.getResource());
              tryUnlock(element.getResource());
            }
          }
 catch (          CmsException e) {
            LOG.error(e.getLocalizedMessage(),e);
          }
        }
      }
 catch (      Exception e) {
        LOG.error(e.getLocalizedMessage(),e);
      }
    }
  }
}
