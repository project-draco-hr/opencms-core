{
  ensureSession();
  CmsResource pageResource=getCmsObject().readResource(pageStructureId);
  CmsResource groupContainerResource=null;
  if (groupContainer.isNew()) {
    CmsADEConfigData config=OpenCms.getADEManager().lookupConfiguration(getCmsObject(),pageResource.getRootPath());
    CmsResourceTypeConfig typeConfig=config.getResourceType(CmsResourceTypeXmlContainerPage.GROUP_CONTAINER_TYPE_NAME);
    groupContainerResource=typeConfig.createNewElement(getCmsObject());
    String resourceName=cms.getSitePath(groupContainerResource);
    groupContainer.setSitePath(resourceName);
    groupContainer.setClientId(groupContainerResource.getStructureId().toString());
  }
  if (groupContainerResource == null) {
    CmsUUID id=convertToServerId(groupContainer.getClientId());
    groupContainerResource=cms.readResource(id);
  }
  CmsGroupContainerBean groupContainerBean=getGroupContainerBean(groupContainer,pageResource.getStructureId(),locale);
  cms.lockResourceTemporary(groupContainerResource);
  CmsFile groupContainerFile=cms.readFile(groupContainerResource);
  CmsXmlGroupContainer xmlGroupContainer=CmsXmlGroupContainerFactory.unmarshal(cms,groupContainerFile);
  xmlGroupContainer.save(cms,groupContainerBean,new Locale(locale));
  cms.unlockResource(groupContainerResource);
  CmsContainerElement element=new CmsContainerElement();
  element.setClientId(groupContainerFile.getStructureId().toString());
  element.setSitePath(cms.getSitePath(groupContainerFile));
  element.setResourceType(CmsResourceTypeXmlContainerPage.GROUP_CONTAINER_TYPE_NAME);
  return element;
}
