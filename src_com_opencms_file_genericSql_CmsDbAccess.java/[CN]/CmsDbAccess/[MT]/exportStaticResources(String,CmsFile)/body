{
  if (exportTo.endsWith("/")) {
    exportTo=exportTo.substring(0,exportTo.length() - 1);
  }
  String path=file.getResourceName();
  File discFolder=new File(exportTo + "/");
  if (!discFolder.exists()) {
    throw new CmsException("[" + this.getClass().getName() + "] "+ "the export folder does not exist",CmsException.C_BAD_NAME);
  }
  String folder=path.substring(0,path.lastIndexOf('/'));
  discFolder=new File(exportTo + folder);
  if (!discFolder.exists()) {
    if (!discFolder.mkdirs()) {
      throw new CmsException("[" + this.getClass().getName() + "] "+ "couldnt create all Folders ",CmsException.C_UNKNOWN_EXCEPTION);
    }
  }
  File discFile=new File(exportTo + path);
  try {
    OutputStream outStream=new FileOutputStream(discFile);
    ((CmsDummyResponse)m_cmsForStaticExport.getRequestContext().getResponse()).putOutputStream(outStream);
  }
 catch (  Exception e) {
    throw new CmsException("[" + this.getClass().getName() + "] "+ "couldnt open file "+ exportTo+ path+ "  "+ e.getMessage(),CmsException.C_UNKNOWN_EXCEPTION);
  }
  int launcherId=file.getLauncherType();
  String startTemplateClass=file.getLauncherClassname();
  I_CmsLauncher launcher=m_cmsForStaticExport.getLauncherManager().getLauncher(launcherId);
  if (launcher == null) {
    String errorMessage="Could not launch file " + file.getName() + ". Launcher for requested launcher ID "+ launcherId+ " could not be found.";
    if (I_CmsLogChannels.C_PREPROCESSOR_IS_LOGGING && A_OpenCms.isLogging()) {
      A_OpenCms.log(I_CmsLogChannels.C_OPENCMS_INFO,"[CmsDbAccess] exportStaticResource() " + errorMessage);
    }
    throw new CmsException(errorMessage,CmsException.C_UNKNOWN_EXCEPTION);
  }
  ((CmsDummyRequest)m_cmsForStaticExport.getRequestContext().getRequest()).setRequestedResource(file.getResourceName());
  launcher.initlaunch(m_cmsForStaticExport,file,startTemplateClass,null);
}
