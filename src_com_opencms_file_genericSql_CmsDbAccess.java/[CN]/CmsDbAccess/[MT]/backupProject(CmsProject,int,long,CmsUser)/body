{
  Connection con=null;
  PreparedStatement statement=null;
  String ownerName=new String();
  String group=new String();
  String managerGroup=new String();
  try {
    CmsUser owner=m_ResourceBroker.getUserAccess().readUser(project.getOwnerId());
    ownerName=owner.getName() + " " + owner.getFirstname()+ " "+ owner.getLastname();
  }
 catch (  CmsException e) {
    ownerName="";
  }
  try {
    group=m_ResourceBroker.getUserAccess().readGroup(project.getGroupId()).getName();
  }
 catch (  CmsException e) {
    group="";
  }
  try {
    managerGroup=m_ResourceBroker.getUserAccess().readGroup(project.getManagerGroupId()).getName();
  }
 catch (  CmsException e) {
    managerGroup="";
  }
  Vector projectresources=readAllProjectResources(project.getId());
  try {
    con=DriverManager.getConnection(m_poolNameBackup);
    statement=con.prepareStatement(m_SqlQueries.get("C_PROJECTS_CREATE_BACKUP"));
    statement.setInt(1,versionId);
    statement.setInt(2,project.getId());
    statement.setString(3,project.getName());
    statement.setTimestamp(4,new Timestamp(publishDate));
    statement.setString(5,currentUser.getId().toString());
    statement.setString(6,currentUser.getName() + " " + currentUser.getFirstname()+ " "+ currentUser.getLastname());
    statement.setString(7,project.getOwnerId().toString());
    statement.setString(8,ownerName);
    statement.setString(9,project.getGroupId().toString());
    statement.setString(10,group);
    statement.setString(11,project.getManagerGroupId().toString());
    statement.setString(12,managerGroup);
    statement.setString(13,project.getDescription());
    statement.setTimestamp(14,new Timestamp(project.getCreateDate()));
    statement.setInt(15,project.getType());
    statement.setInt(16,project.getTaskId());
    statement.executeUpdate();
    statement.close();
    for (int i=0; i < projectresources.size(); i++) {
      statement=con.prepareStatement(m_SqlQueries.get("C_PROJECTRESOURCES_CREATE_BACKUP"));
      statement.setInt(1,versionId);
      statement.setInt(2,project.getId());
      statement.setString(3,(String)projectresources.get(i));
      statement.executeUpdate();
      statement.close();
    }
  }
 catch (  SQLException e) {
    throw new CmsException("[" + this.getClass().getName() + "] "+ e.getMessage(),CmsException.C_SQL_ERROR,e);
  }
 finally {
    if (statement != null) {
      try {
        statement.close();
      }
 catch (      SQLException exc) {
      }
    }
    if (con != null) {
      try {
        con.close();
      }
 catch (      SQLException exc) {
      }
    }
  }
}
