{
  PreparedStatement statement=null;
  Connection con=null;
  try {
    con=DriverManager.getConnection(m_poolName);
    statement=con.prepareStatement(m_cq.C_TASK_UPDATE);
    statement.setString(1,task.getName());
    statement.setInt(2,task.getState());
    statement.setInt(3,task.getTaskType());
    statement.setInt(4,task.getRoot());
    statement.setInt(5,task.getParent());
    statement.setInt(6,task.getInitiatorUser());
    statement.setInt(7,task.getRole());
    statement.setInt(8,task.getAgentUser());
    statement.setInt(9,task.getOriginalUser());
    statement.setTimestamp(10,task.getStartTime());
    statement.setTimestamp(11,task.getWakeupTime());
    statement.setTimestamp(12,task.getTimeOut());
    statement.setTimestamp(13,task.getEndTime());
    statement.setInt(14,task.getPercentage());
    statement.setString(15,task.getPermission());
    statement.setInt(16,task.getPriority());
    statement.setInt(17,task.getEscalationType());
    statement.setString(18,task.getHtmlLink());
    statement.setInt(19,task.getMilestone());
    statement.setInt(20,task.getAutoFinish());
    statement.setInt(21,task.getId());
    statement.executeUpdate();
  }
 catch (  SQLException exc) {
    throw new CmsException(exc.getMessage(),CmsException.C_SQL_ERROR,exc);
  }
 finally {
    if (statement != null) {
      try {
        statement.close();
      }
 catch (      SQLException exc) {
      }
    }
    if (con != null) {
      try {
        con.close();
      }
 catch (      SQLException exc) {
      }
    }
  }
  return (readTask(task.getId()));
}
