{
  CmsResource res=m_ResourceBroker.getVfsAccess().readFileHeader(projectId,resource,false);
  CmsUUID groupId=CmsUUID.getNullUUID();
  boolean noGroupCanReadThis=false;
  do {
    int flags=res.getAccessFlags();
    if (!((flags & C_ACCESS_PUBLIC_READ) == C_ACCESS_PUBLIC_READ)) {
      if ((flags & C_ACCESS_GROUP_READ) == C_ACCESS_GROUP_READ) {
        if ((groupId.isNullUUID()) || (groupId.equals(res.getGroupId()))) {
          groupId=res.getGroupId();
        }
 else {
          CmsUUID result=m_ResourceBroker.getUserAccess().checkGroupDependence(groupId,res.getGroupId());
          if (result.isNullUUID()) {
            noGroupCanReadThis=true;
          }
 else {
            groupId=result;
          }
        }
      }
 else {
        noGroupCanReadThis=true;
      }
    }
    res=m_ResourceBroker.getVfsAccess().readFileHeader(projectId,res.getParentId());
  }
 while (!(noGroupCanReadThis || C_ROOT.equals(res.getAbsolutePath())));
  if (noGroupCanReadThis) {
    return C_GROUP_ADMIN;
  }
  if (groupId.isNullUUID()) {
    return null;
  }
 else {
    return m_ResourceBroker.getUserAccess().readGroup(groupId).getName();
  }
}
