{
  Vector statements;
  Hashtable allStatements=m_pool.getAllPreparedStatement();
  Enumeration keys=allStatements.keys();
  Vector connections=m_pool.getAllConnections();
  if (A_OpenCms.isLogging()) {
    A_OpenCms.log(I_CmsLogChannels.C_OPENCMS_INIT,"[CmsDbAccess] closing all statements.");
  }
  while (keys.hasMoreElements()) {
    Object key=keys.nextElement();
    statements=(Vector)allStatements.get(key);
    for (int i=0; i < statements.size(); i++) {
      try {
        ((PreparedStatement)statements.elementAt(i)).close();
      }
 catch (      SQLException exc) {
        if (A_OpenCms.isLogging()) {
          A_OpenCms.log(I_CmsLogChannels.C_OPENCMS_INIT,"[CmsDbAccess] error closing statement: " + exc.getMessage());
        }
      }
    }
  }
  if (A_OpenCms.isLogging()) {
    A_OpenCms.log(I_CmsLogChannels.C_OPENCMS_INIT,"[CmsDbAccess] closing all connections.");
  }
  for (int i=0; i < connections.size(); i++) {
    try {
      ((Connection)connections.elementAt(i)).close();
    }
 catch (    SQLException exc) {
      if (A_OpenCms.isLogging()) {
        A_OpenCms.log(I_CmsLogChannels.C_OPENCMS_INIT,"[CmsDbAccess] error closing connection: " + exc.getMessage());
      }
    }
  }
  if (A_OpenCms.isLogging()) {
    A_OpenCms.log(I_CmsLogChannels.C_OPENCMS_INIT,"[CmsDbAccess] destroy complete.");
  }
  if (A_OpenCms.isLogging()) {
    A_OpenCms.log(I_CmsLogChannels.C_OPENCMS_INIT,"[CmsDbAccess] stop connection guard");
  }
  m_guard.destroy();
}
