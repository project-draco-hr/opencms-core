{
  ResultSet res=null;
  PreparedStatement statement=null;
  Connection con=null;
  int maxVersion=0;
  try {
    con=DriverManager.getConnection(m_poolNameBackup);
    statement=con.prepareStatement(m_SqlQueries.get("C_BACKUP_READ_MAXVERSION"));
    statement.setTimestamp(1,new Timestamp(maxdate));
    res=statement.executeQuery();
    if (res.next()) {
      maxVersion=res.getInt(1);
    }
    res.close();
    statement.close();
    if (maxVersion > 0) {
      statement=con.prepareStatement(m_SqlQueries.get("C_BACKUP_DELETE_PROJECT_BYVERSION"));
      statement.setInt(1,maxVersion);
      statement.executeUpdate();
      statement.close();
      statement=con.prepareStatement(m_SqlQueries.get("C_BACKUP_DELETE_PROJECTRESOURCES_BYVERSION"));
      statement.setInt(1,maxVersion);
      statement.executeUpdate();
      statement.close();
      statement=con.prepareStatement(m_SqlQueries.get("C_BACKUP_DELETE_RESOURCES_BYVERSION"));
      statement.setInt(1,maxVersion);
      statement.executeUpdate();
      statement.close();
      statement=con.prepareStatement(m_SqlQueries.get("C_BACKUP_DELETE_FILES_BYVERSION"));
      statement.setInt(1,maxVersion);
      statement.executeUpdate();
      statement.close();
      statement=con.prepareStatement(m_SqlQueries.get("C_BACKUP_DELETE_PROPERTIES_BYVERSION"));
      statement.setInt(1,maxVersion);
      statement.executeUpdate();
      statement.close();
      statement=con.prepareStatement(m_SqlQueries.get("C_BACKUP_DELETE_MODULEMASTER_BYVERSION"));
      statement.setInt(1,maxVersion);
      statement.executeUpdate();
      statement.close();
      statement=con.prepareStatement(m_SqlQueries.get("C_BACKUP_DELETE_MODULEMEDIA_BYVERSION"));
      statement.setInt(1,maxVersion);
      statement.executeUpdate();
      statement.close();
    }
  }
 catch (  SQLException e) {
    throw new CmsException("[" + this.getClass().getName() + "]"+ e.getMessage(),CmsException.C_SQL_ERROR,e);
  }
catch (  Exception ex) {
    throw new CmsException("[" + this.getClass().getName() + "]",ex);
  }
 finally {
    if (res != null) {
      try {
        res.close();
      }
 catch (      SQLException exc) {
      }
    }
    if (statement != null) {
      try {
        statement.close();
      }
 catch (      SQLException exc) {
      }
    }
    if (con != null) {
      try {
        con.close();
      }
 catch (      SQLException exc) {
      }
    }
  }
  return maxVersion;
}
