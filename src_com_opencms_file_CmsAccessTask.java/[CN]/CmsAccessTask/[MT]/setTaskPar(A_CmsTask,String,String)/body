{
  ResultSet recset;
  int result=0;
  try {
    String sqlstr="SELECT * FROM " + C_TABLE_TASKPAR + " WHERE "+ C_PAR_TASK+ "=? AND "+ C_PAR_NAME+ "=?";
    PreparedStatement statementTaskPar=m_Con.prepareStatement(sqlstr);
    statementTaskPar.setInt(1,task.getId());
    statementTaskPar.setString(2,parname);
    recset=statementTaskPar.executeQuery();
    if (recset.next()) {
      int parid=recset.getInt(C_PAR_ID);
      sqlstr="UPDATE " + C_TABLE_TASKPAR + " SET "+ C_PAR_VALUE+ "=? WHERE "+ C_PAR_ID+ "=?";
      statementTaskPar=m_Con.prepareStatement(sqlstr);
      statementTaskPar.setString(1,parvalue);
      statementTaskPar.setInt(2,parid);
      statementTaskPar.executeUpdate();
    }
 else {
      sqlstr="INSERT INTO " + C_TABLE_TASKPAR + "("+ C_PAR_TASK+ ", "+ C_PAR_NAME+ ", "+ C_PAR_VALUE+ ") VALUES (?,?,?)";
      statementTaskPar=m_Con.prepareStatement(sqlstr);
      statementTaskPar.setInt(1,task.getId());
      statementTaskPar.setString(2,parname);
      statementTaskPar.setString(3,parvalue);
      statementTaskPar.executeUpdate();
      result=getLastInsertId();
    }
  }
 catch (  SQLException exc) {
    throw new CmsException(exc.getMessage(),CmsException.C_SQL_ERROR,exc);
  }
  return result;
}
