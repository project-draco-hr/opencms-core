{
  int id=C_UNKNOWN_ID;
  CmsTask task=null;
  try {
    PreparedStatement statementCreateTask=m_Con.prepareStatement(C_TASK_TYPE_COPY);
    statementCreateTask.setInt(1,tasktype);
    statementCreateTask.executeUpdate();
    id=this.getLastInsertId();
    task=this.readTask(id);
    task.setRoot(rootId);
    task.setParent(parentId);
    task.setName(taskname);
    task.setTaskType(tasktype);
    task.setRole(roleId);
    if (agentId == C_UNKNOWN_ID) {
      agentId=findAgent(roleId);
    }
    task.setAgentUser(agentId);
    task.setOriginalUser(agentId);
    task.setWakeupTime(wakeuptime);
    task.setTimeOut(timeout);
    task.setPriority(priority);
    task.setPercentage(0);
    task.setState(C_TASK_STATE_STARTED);
    task.setInitiatorUser(ownerId);
    task.setStartTime(new java.sql.Timestamp(System.currentTimeMillis()));
    task.setMilestone(0);
    task=this.writeTask(task);
  }
 catch (  SQLException exc) {
    System.err.println(exc.getMessage());
    throw new CmsException(exc.getMessage(),CmsException.C_SQL_ERROR,exc);
  }
  return task;
}
