{
  System.err.println("= Start resolving variant " + variant);
  int len=variant.size();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  try {
    for (int i=0; i < len; i++) {
      System.err.print("= Part " + i + " is a ");
      Object o=variant.get(i);
      if (o instanceof String) {
        System.err.println("String");
        baos.write(((String)o).getBytes());
      }
 else       if (o instanceof byte[]) {
        System.err.println("byte array");
        baos.write((byte[])o);
      }
 else       if (o instanceof CmsElementLink) {
        System.err.println("Link");
        String lookupName=((CmsElementLink)o).getElementName();
        System.err.println("= Trying to resolve link \"" + lookupName + "\".");
        CmsElementDefinition elDef=getElementDefinition(lookupName);
        if (elDef != null) {
          A_CmsElement subEl=staging.getElementLocator().get(cms,elDef.getDescriptor(),parameters);
          System.err.println("= Element defintion for \"" + lookupName + "\" says: ");
          System.err.println("= -> Class    : " + elDef.getClassName());
          System.err.println("= -> Template : " + elDef.getTemplateName());
          if (subEl != null) {
            System.err.println("= Element object found for \"" + lookupName + "\". Calling getContent on this object. ");
            byte[] buffer=subEl.getContent(staging,cms,parameters);
            if (buffer != null) {
              baos.write(buffer);
            }
          }
 else {
            System.err.println("= Cannot find Element object for \"" + lookupName + "\". Ignoring this link. ");
          }
        }
 else {
          System.err.println("= No element definition found for \"" + lookupName + "\". Ignoring this link. ");
        }
      }
    }
  }
 catch (  Exception e) {
    System.err.println("Error while resolving element variant");
    e.printStackTrace();
  }
  return baos.toByteArray();
}
