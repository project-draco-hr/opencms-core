{
  try {
    I_CmsResponse resp=cms.getRequestContext().getResponse();
    if ((result != null) && !resp.isRedirected()) {
      OutputStream out=resp.getOutputStream();
      resp.setContentLength(result.length);
      resp.setHeader("Connection","keep-alive");
      out.write(result);
      out.close();
    }
  }
 catch (  IOException ioe) {
    if (OpenCms.isLogging(I_CmsLogChannels.C_OPENCMS_DEBUG)) {
      OpenCms.log(I_CmsLogChannels.C_OPENCMS_DEBUG,getClassName() + "IO error while writing to response stream for " + cms.getRequestContext().getFileUri());
      OpenCms.log(I_CmsLogChannels.C_OPENCMS_DEBUG,getClassName() + ioe);
    }
  }
catch (  Exception e) {
    String errorMessage="Cannot write output to HTTP response stream";
    handleException(cms,e,errorMessage);
  }
}
