{
  TermsFilter pathFilter=new TermsFilter();
  if ((roots != null) && (roots.size() > 0)) {
    for (int i=0; i < roots.size(); i++) {
      String searchRoot=roots.get(i);
      if (!searchRoot.startsWith(FOLDER_SYTEM_MODULES) && !searchRoot.startsWith(FOLDER_SYSTEM_GALLERIES) && !searchRoot.startsWith(OpenCms.getSiteManager().getSharedFolder())) {
        searchRoot=cms.getRequestContext().addSiteRoot(roots.get(i));
      }
      extendPathFilter(pathFilter,searchRoot);
    }
  }
 else {
    extendPathFilter(pathFilter,cms.getRequestContext().getSiteRoot());
    extendPathFilter(pathFilter,OpenCms.getSiteManager().getSharedFolder());
    extendPathFilter(pathFilter,FOLDER_SYTEM_MODULES);
    extendPathFilter(pathFilter,FOLDER_SYSTEM_GALLERIES);
  }
  filter.add(new FilterClause(pathFilter,BooleanClause.Occur.MUST));
  return filter;
}
