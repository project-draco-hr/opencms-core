{
  if (isAbsoluteUri(link) && !hasScheme(link)) {
    String serverPrefix;
    if (cms.getRequestContext().currentProject().isOnlineProject()) {
      CmsSite currentSite=OpenCms.getSiteManager().getSite(link,cms.getRequestContext().getSiteRoot());
      serverPrefix=currentSite.getServerPrefix(cms,link);
    }
 else {
      serverPrefix=OpenCms.getSiteManager().getWorkplaceServer();
    }
    link=serverPrefix + link;
  }
  return link;
}
