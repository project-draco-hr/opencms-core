{
  String onlineLink="";
  try {
    CmsSite currentSite=CmsSiteManager.getCurrentSite(cms);
    CmsProject currentProject=cms.getRequestContext().currentProject();
    try {
      cms.getRequestContext().setCurrentProject(cms.readProject(CmsProject.ONLINE_PROJECT_ID));
      onlineLink=OpenCms.getLinkManager().substituteLink(cms,resourceName,currentSite.getSiteRoot());
    }
  finally {
      cms.getRequestContext().setCurrentProject(currentProject);
    }
    String serverPrefix=currentSite.getServerPrefix(cms,resourceName);
    if (!onlineLink.startsWith(serverPrefix)) {
      onlineLink=serverPrefix + onlineLink;
    }
  }
 catch (  CmsException e) {
    onlineLink=e.getLocalizedMessage();
    if (LOG.isErrorEnabled()) {
      LOG.error(e.getLocalizedMessage(),e);
    }
  }
  return onlineLink;
}
