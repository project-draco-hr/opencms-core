{
  if (link == null || "".equals(link)) {
    return "";
  }
  String absoluteLink;
  if (!link.startsWith("/")) {
    absoluteLink=Utils.mergeAbsolutePath(cms.getRequestContext().getUri(),link);
  }
 else {
    absoluteLink=link;
  }
  String uri;
  int pos=absoluteLink.indexOf('?');
  if (pos >= 0) {
    uri=absoluteLink.substring(0,pos - 1);
  }
 else {
    uri=absoluteLink;
  }
  String exportProperty;
  if (A_OpenCms.getStaticExportProperties().isStaticExportEnabled() && cms.getRequestContext().currentProject().isOnlineProject()) {
    try {
      exportProperty=cms.readProperty(uri,I_CmsConstants.C_PROPERTY_EXPORT,true,"false");
    }
 catch (    Throwable t) {
      exportProperty="false";
    }
  }
 else {
    exportProperty="false";
  }
  String result;
  if ("true".equalsIgnoreCase(exportProperty)) {
    result=A_OpenCms.getStaticExportProperties().getRfsPrefix() + absoluteLink;
  }
 else {
    result=A_OpenCms.getStaticExportProperties().getVfsPrefix() + absoluteLink;
  }
  return result;
}
