{
  CmsResource res=getCmsObject().readResource(resource,CmsResourceFilter.ALL);
  CmsLock lock=getCmsObject().getLock(res);
  boolean lockable=lock.isLockableBy(getCmsObject().getRequestContext().currentUser());
  if (OpenCms.getWorkplaceManager().autoLockResources()) {
    if (lockable) {
      if (type == CmsLockType.TEMPORARY) {
        getCmsObject().lockResourceTemporary(resource);
      }
 else {
        getCmsObject().lockResource(resource);
      }
    }
 else {
      throw new CmsException(Messages.get().container(Messages.ERR_WORKPLACE_LOCK_RESOURCE_1,resource));
    }
  }
 else {
    if (!lockable) {
      throw new CmsException(Messages.get().container(Messages.ERR_WORKPLACE_LOCK_RESOURCE_1,resource));
    }
  }
}
