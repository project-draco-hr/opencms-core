{
  JSONObject result=new JSONObject();
  try {
    if (ex == null) {
      result.put(I_CmsUploadConstants.KEY_SUCCESS,Boolean.TRUE);
      result.put(I_CmsUploadConstants.KEY_MESSAGE,org.opencms.gwt.Messages.get().getBundle().key(org.opencms.gwt.Messages.INFO_UPLOAD_SUCCESS_0));
      result.put(I_CmsUploadConstants.KEY_STACKTRACE,"");
    }
 else {
      result.put(I_CmsUploadConstants.KEY_SUCCESS,Boolean.FALSE);
      result.put(I_CmsUploadConstants.KEY_MESSAGE,ex.getMessage());
      result.put(I_CmsUploadConstants.KEY_STACKTRACE,CmsException.getStackTraceAsString(ex));
    }
    if (info == null) {
      info=new CmsUploadProgessInfo(0,0,false,0,0);
    }
    result.put(I_CmsUploadConstants.KEY_CURRENT_FILE,info.getCurrentFile());
    result.put(I_CmsUploadConstants.KEY_BYTES_READ,info.getBytesRead());
    result.put(I_CmsUploadConstants.KEY_CONTENT_LENGTH,info.getContentLength());
    result.put(I_CmsUploadConstants.KEY_PERCENT,info.getPercent());
    result.put(I_CmsUploadConstants.KEY_RUNNING,info.isRunning());
  }
 catch (  JSONException e) {
    LOG.error(org.opencms.gwt.Messages.get().getBundle().key(org.opencms.gwt.Messages.ERR_UPLOAD_JSON_0),e);
  }
  return result;
}
