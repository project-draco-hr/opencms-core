{
  if ((DEBUG > 0) && CmsLog.getLog(this).isDebugEnabled()) {
    CmsLog.getLog(this).debug("Loader started for " + file.getName());
  }
  String errorMessage=null;
  if (file == null) {
    errorMessage="CmsFile missing";
  }
  if (cms == null) {
    errorMessage="CmsObject missing";
  }
  if (errorMessage != null) {
    if (CmsLog.getLog(this).isErrorEnabled()) {
      CmsLog.getLog(this).error(errorMessage);
    }
    throw new CmsLegacyException(errorMessage,CmsLegacyException.C_LOADER_GENERIC_ERROR);
  }
  String clearcache=getRequest(cms.getRequestContext()).getParameter("_clearcache");
  clearLoaderCache(((clearcache != null) && ("all".equals(clearcache) || "file".equals(clearcache))),((clearcache != null) && ("all".equals(clearcache) || "template".equals(clearcache))));
  I_CmsRequest req=getRequest(cms.getRequestContext());
  byte[] result=generateOutput(cms,file,req);
  if (result != null) {
    writeBytesToResponse(cms,result);
  }
}
