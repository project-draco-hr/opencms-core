{
  try {
    I_CmsResponse resp=getResponse(cms.getRequestContext());
    if ((result != null) && !resp.isRedirected()) {
      OutputStream out=resp.getOutputStream();
      resp.setContentLength(result.length);
      resp.setHeader("Connection","keep-alive");
      out.write(result);
      out.close();
    }
  }
 catch (  IOException ioe) {
    if (CmsLog.getLog(this).isDebugEnabled()) {
      CmsLog.getLog(this).debug("IO error while writing to response stream for " + cms.getRequestContext().getUri(),ioe);
    }
  }
catch (  Exception e) {
    String errorMessage="Cannot write output to HTTP response stream";
    handleException(cms,e,errorMessage);
  }
}
