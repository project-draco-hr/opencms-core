{
  if (cms.getRequestContext().getAttribute(I_CmsRequest.C_CMS_REQUEST) != null) {
    return;
  }
  try {
    CmsRequestHttpServlet cmsReq=new CmsRequestHttpServlet(req,cms.getRequestContext().getFileTranslator());
    CmsResponseHttpServlet cmsRes=new CmsResponseHttpServlet(req,res);
    cms.getRequestContext().setAttribute(I_CmsRequest.C_CMS_REQUEST,cmsReq);
    cms.getRequestContext().setAttribute(I_CmsResponse.C_CMS_RESPONSE,cmsRes);
  }
 catch (  IOException e) {
    throw new CmsLegacyException("Trouble setting up legacy request / response",e);
  }
}
