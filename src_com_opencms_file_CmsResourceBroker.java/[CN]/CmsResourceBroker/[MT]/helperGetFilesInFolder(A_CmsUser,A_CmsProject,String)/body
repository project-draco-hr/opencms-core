{
  CmsFolder cmsFolder=m_fileRb.readFolder(currentProject,foldername);
  if (accessRead(currentUser,currentProject,(A_CmsResource)cmsFolder)) {
    Vector files=m_fileRb.getFilesInFolder(currentProject,foldername);
    CmsFile file;
    for (int z=0; z < files.size(); z++) {
      file=(CmsFile)files.elementAt(z);
      if (!(accessOther(currentUser,currentProject,(A_CmsResource)file,C_ACCESS_PUBLIC_READ) || accessOwner(currentUser,currentProject,(A_CmsResource)file,C_ACCESS_OWNER_READ) || accessGroup(currentUser,currentProject,(A_CmsResource)file,C_ACCESS_GROUP_READ))) {
        files.removeElementAt(z);
        z--;
      }
    }
    return (files);
  }
 else {
    throw new CmsException("[" + this.getClass().getName() + "] "+ foldername,CmsException.C_ACCESS_DENIED);
  }
}
