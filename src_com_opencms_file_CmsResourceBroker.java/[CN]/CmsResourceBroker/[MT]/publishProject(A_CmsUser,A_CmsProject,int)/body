{
  A_CmsProject publishProject=m_projectRb.readProject(id);
  if ((isAdmin(currentUser,currentProject) || isManagerOfProject(currentUser,publishProject)) && (publishProject.getFlags() == C_PROJECT_STATE_UNLOCKED)) {
    Vector resources=m_fileRb.publishProject(publishProject,onlineProject(currentUser,currentProject));
    for (int i=0; i < resources.size(); i++) {
      try {
        A_CmsResource resource=m_fileRb.readFileHeader(onlineProject(currentUser,currentProject),(String)resources.elementAt(i));
        m_metadefRb.deleteAllMetainformations(resource);
        Hashtable metainfos=m_metadefRb.readAllMetainformations(publishProject.getId(),(String)resources.elementAt(i),resource.getType());
        m_metadefRb.writeMetainformations(resource,metainfos);
      }
 catch (      CmsException exc) {
      }
    }
    fileSystemChanged(publishProject.getName(),resources);
    publishProject.setFlags(C_PROJECT_STATE_ARCHIVE);
    publishProject.setPublishingDate(new Date().getTime());
    publishProject.setPublishedBy(currentUser.getId());
    m_projectRb.writeProject(publishProject);
    return (resources);
  }
 else {
    throw new CmsException("[" + this.getClass().getName() + "] "+ id,CmsException.C_NO_ACCESS);
  }
}
