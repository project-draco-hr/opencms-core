{
  A_CmsProject publishProject=m_projectRb.readProject(name);
  if (isAdmin(currentUser,currentProject) || isProjectLeader(currentUser,currentProject) || (currentProject.getFlags() == C_PROJECT_STATE_UNLOCKED)) {
    Vector resources=m_fileRb.publishProject(publishProject,onlineProject(currentUser,currentProject));
    publishProject.setFlags(C_PROJECT_STATE_ARCHIVE);
    m_projectRb.writeProject(publishProject);
    return (resources);
  }
 else {
    throw new CmsException(CmsException.C_EXTXT[CmsException.C_NO_ACCESS],CmsException.C_NO_ACCESS);
  }
}
