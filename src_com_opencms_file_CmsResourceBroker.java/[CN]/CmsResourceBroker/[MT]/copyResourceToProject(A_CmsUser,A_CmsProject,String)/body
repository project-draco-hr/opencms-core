{
  A_CmsProject online=onlineProject(currentUser,currentProject);
  if ((!currentProject.equals(online)) && (currentProject.getOwnerId() == currentUser.getId()) && (currentProject.getFlags() == C_PROJECT_STATE_UNLOCKED)) {
    helperCopyResourceToProject(online,currentProject,resource);
    A_CmsResource onlineRes=m_fileRb.readFileHeader(online,resource);
    A_CmsResource offlineRes=m_fileRb.readFileHeader(currentProject,resource);
    resource=onlineRes.getParent();
    try {
      while (resource != null) {
        onlineRes=m_fileRb.readFileHeader(online,resource);
        m_fileRb.copyResourceToProject(currentProject,online,resource);
        fileSystemChanged(currentProject.getName(),resource);
        offlineRes=m_fileRb.readFileHeader(currentProject,resource);
        m_metadefRb.writeMetainformations(offlineRes,m_metadefRb.readAllMetainformations(onlineRes));
        resource=onlineRes.getParent();
      }
    }
 catch (    CmsException exc) {
    }
  }
 else {
    throw new CmsException("[" + this.getClass().getName() + "] "+ currentProject.getName(),CmsException.C_NO_ACCESS);
  }
}
