{
  A_CmsProject online=onlineProject(currentUser,currentProject);
  if ((!currentProject.equals(online)) && (currentProject.getOwnerId() == currentUser.getId()) && (currentProject.getFlags() == C_PROJECT_STATE_UNLOCKED)) {
    A_CmsResource onlineRes=m_fileRb.readFileHeader(online,resource);
    A_CmsResource offlineRes=null;
    String parent=onlineRes.getParent();
    Stack resources=new Stack();
    while (parent != null) {
      onlineRes=m_fileRb.readFileHeader(online,parent);
      resources.push(onlineRes);
      parent=onlineRes.getParent();
    }
    while (resources.size() > 0) {
      onlineRes=(A_CmsResource)resources.pop();
      parent=onlineRes.getAbsolutePath();
      try {
        m_fileRb.copyResourceToProject(currentProject,online,parent);
        fileSystemChanged(currentProject.getName(),parent);
        offlineRes=m_fileRb.readFileHeader(currentProject,parent);
        m_metadefRb.writeMetainformations(offlineRes,m_metadefRb.readAllMetainformations(onlineRes));
      }
 catch (      CmsException exc) {
      }
    }
    helperCopyResourceToProject(online,currentProject,resource);
  }
 else {
    throw new CmsException("[" + this.getClass().getName() + "] "+ currentProject.getName(),CmsException.C_NO_ACCESS);
  }
}
