{
  Hashtable parameters=(Hashtable)userObject;
  Enumeration keys=parameters.keys();
  int select=-1;
  int n=-1;
  int id=-1;
  StringBuffer list=new StringBuffer();
  String ret="";
  Vector newsList=null;
  NewsChannelContentDefinition myChannel=null;
  CmsXmlTemplateFile template=(CmsXmlTemplateFile)doc;
  String elementName=(String)parameters.get("_ELEMENT_");
  String channelName=(String)parameters.get(elementName + ".channelname");
  String channelId=(String)parameters.get(elementName + ".channelid");
  if (channelId != null && channelName == null) {
    select=ID;
  }
 else   if (channelId == null && channelName != null) {
    select=NAME;
  }
 else   if (channelId != null && channelName != null) {
    select=ID;
  }
 else {
    System.err.println("[NewsTemplate.getNewsList] No channel selcted!");
    return "";
  }
  if (select == ID) {
    try {
      id=Integer.parseInt(channelId);
    }
 catch (    NumberFormatException e) {
      System.err.println("[NewsTemplate.getNewsList] NumberFormatException! " + e.getMessage());
      System.err.println("channelId: " + channelId);
      return "";
    }
  }
  try {
    if (select == NAME)     myChannel=new NewsChannelContentDefinition(channelName);
 else {
      myChannel=new NewsChannelContentDefinition(null,new Integer(id));
    }
  }
 catch (  CmsException e) {
    System.err.println("[NewsTemplate.getNewsList] CmsException! " + e.getMessage());
    return "";
  }
  if (tagcontent == null || tagcontent.equals("")) {
    newsList=NewsContentDefinition.getNewsList(new Integer(myChannel.getIntId()),"" + -1);
  }
 else {
    try {
      n=Integer.parseInt(tagcontent);
      newsList=NewsContentDefinition.getNewsList(new Integer(myChannel.getIntId()),"" + n);
    }
 catch (    NumberFormatException e) {
      newsList=NewsContentDefinition.getNewsList(new Integer(myChannel.getIntId()),"" + -1);
    }
  }
  for (int i=0; i < newsList.size(); i++) {
    template.setData("id",((NewsContentDefinition)newsList.elementAt(i)).getUniqueId(null));
    template.setData("headline",((NewsContentDefinition)newsList.elementAt(i)).getHeadline());
    template.setData("description",((NewsContentDefinition)newsList.elementAt(i)).getDescription());
    template.setData("author",((NewsContentDefinition)newsList.elementAt(i)).getAuthor());
    template.setData("date",((NewsContentDefinition)newsList.elementAt(i)).getDate());
    template.setData("link",((NewsContentDefinition)newsList.elementAt(i)).getLink());
    template.setData("linkText",((NewsContentDefinition)newsList.elementAt(i)).getLinkText());
    template.setData("text",((NewsContentDefinition)newsList.elementAt(i)).getText());
    template.setData("channel",((NewsContentDefinition)newsList.elementAt(i)).getChannel());
    template.setData("a_info1",((NewsContentDefinition)newsList.elementAt(i)).getA_info1());
    template.setData("a_info2",((NewsContentDefinition)newsList.elementAt(i)).getA_info2());
    template.setData("a_info3",((NewsContentDefinition)newsList.elementAt(i)).getA_info3());
    String temp=template.getProcessedDataValue("newsentry",this,userObject);
    list.append(temp);
  }
  ret=list.toString();
  return ret;
}
