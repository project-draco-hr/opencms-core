{
  if (resourceUtil[0].isInsideProject() && !cms.getRequestContext().currentProject().isOnlineProject()) {
    CmsLock lock=resourceUtil[0].getLock();
    boolean lockedForPublish=resourceUtil[0].getProjectState().isLockedForPublishing();
    if (lock.isNullLock()) {
      if (!lockedForPublish && OpenCms.getWorkplaceManager().autoLockResources() && !resourceUtil[0].getResource().getState().isDeleted()) {
        if (OpenCms.getRoleManager().hasRole(cms,CmsRole.DEVELOPER)) {
          return CmsMenuItemVisibilityMode.VISIBILITY_ACTIVE;
        }
      }
 else       if (OpenCms.getRoleManager().hasRole(cms,CmsRole.DEVELOPER)) {
        return CmsMenuItemVisibilityMode.VISIBILITY_INACTIVE;
      }
    }
    if (!lockedForPublish && !lock.isShared() && lock.isOwnedInProjectBy(cms.getRequestContext().currentUser(),cms.getRequestContext().currentProject())) {
      if (OpenCms.getRoleManager().hasRole(cms,CmsRole.DEVELOPER)) {
        if (!resourceUtil[0].getResource().getState().isDeleted()) {
          return CmsMenuItemVisibilityMode.VISIBILITY_ACTIVE;
        }
 else {
          return CmsMenuItemVisibilityMode.VISIBILITY_INACTIVE;
        }
      }
    }
  }
  return CmsMenuItemVisibilityMode.VISIBILITY_INVISIBLE;
}
