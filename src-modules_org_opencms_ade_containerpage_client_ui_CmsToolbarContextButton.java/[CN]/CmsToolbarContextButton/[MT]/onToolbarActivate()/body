{
  if (!m_initialized) {
    Command cmd=new Command(){
      public void execute(){
        Window.alert("Menu item has been selected");
      }
    }
;
    String imageClass=I_CmsLayoutBundle.INSTANCE.contextmenuCss().image() + " " + I_CmsLayoutBundle.INSTANCE.iconsCss().uiIcon()+ " "+ I_CmsButton.UiIcon.bookmark.name();
    String imagePath="/opencms/opencms/system/workplace/resources/filetypes/xmlcontent.gif";
    CmsContextMenu relations=new CmsContextMenu(true);
    relations.addItem(CmsContextMenuItem.createItemWithImageClass("Link relation to ...",cmd,imageClass));
    relations.addItem(CmsContextMenuItem.createItemWithoutImage("Link relation from ...",cmd));
    relations.addSeparator();
    relations.addItem(CmsContextMenuItem.createItemWithoutImage("Asign Categories",cmd));
    CmsContextMenu test=new CmsContextMenu(true);
    test.addItem(CmsContextMenuItem.createItemWithoutImage("Touch",cmd));
    test.addItem(CmsContextMenuItem.createItemWithoutImage("Availability",cmd));
    test.addSeparator();
    test.addItem(CmsContextMenuItem.createItemWithoutImage("Secure/Export",cmd));
    test.addItem(CmsContextMenuItem.createItemWithoutImage("Change type",cmd));
    test.addSeparator();
    test.addItem(CmsContextMenuItem.createItemWithoutImage("Restore deleted",cmd));
    CmsContextMenu advanced=new CmsContextMenu(true);
    advanced.addItem(CmsContextMenuItem.createItemWithoutImage("test",test));
    advanced.addSeparator();
    advanced.addItem(CmsContextMenuItem.createItemWithoutImage("Touch",cmd));
    advanced.addItem(CmsContextMenuItem.createItemWithoutImage("Availability",cmd));
    advanced.addSeparator();
    advanced.addItem(CmsContextMenuItem.createItemWithoutImage("Secure/Export",cmd));
    advanced.addItem(CmsContextMenuItem.createItemWithoutImage("Change type",cmd));
    advanced.addSeparator();
    advanced.addItem(CmsContextMenuItem.createItemWithoutImage("Restore deleted",cmd));
    CmsContextMenuItem item=CmsContextMenuItem.createItemWithoutImage("Lock",cmd);
    item.setEnabled(false,"can't touch this!");
    m_menu.addItem(item);
    m_menu.addItem(CmsContextMenuItem.createItemWithoutImage("Locked resources",cmd));
    m_menu.addSeparator();
    m_menu.addItem(CmsContextMenuItem.createItemWithoutImage("Publish directly",cmd));
    m_menu.addSeparator();
    m_menu.addItem(CmsContextMenuItem.createItemWithImagePath("Edit Metadata",cmd,imagePath));
    m_menu.addSeparator();
    m_menu.addItem(CmsContextMenuItem.createItemWithoutImage("Copy",cmd));
    m_menu.addItem(CmsContextMenuItem.createItemWithoutImage("Rename/Move",cmd));
    m_menu.addItem(CmsContextMenuItem.createItemWithoutImage("Delete",cmd));
    m_menu.addItem(CmsContextMenuItem.createItemWithoutImage("Undo changes",cmd));
    m_menu.addSeparator();
    m_menu.addItem(CmsContextMenuItem.createItemWithoutImage("Relations",relations));
    m_menu.addSeparator();
    m_menu.addItem(CmsContextMenuItem.createItemWithoutImage("Permissions",cmd));
    m_menu.addItem(CmsContextMenuItem.createItemWithoutImage("Change navigation",cmd));
    m_menu.addSeparator();
    m_menu.addItem(CmsContextMenuItem.createItemWithoutImage("Advanced",advanced));
    m_menu.addSeparator();
    m_menu.addItem(CmsContextMenuItem.createItemWithoutImage("History",cmd));
    m_menu.addItem(CmsContextMenuItem.createItemWithoutImage("Properties",cmd));
    getPopupContent().addCloseHandler(new CmsContextMenuHandler(m_menu));
    DOM.removeElementAttribute(getPopupContent().getWidget().getElement(),"style");
    m_menuPanel.getElement().addClassName(I_CmsLayoutBundle.INSTANCE.contextmenuCss().menuPanel());
    m_menuPanel.setWidget(0,0,m_menu);
    m_initialized=true;
  }
  m_resizeRegistration=Window.addResizeHandler(m_menu);
}
