{
  try {
    String templateOneDialog=MODULE_PATH + "dialogs/property.jsp";
    boolean dialogPresent=jsp.getCmsObject().existsResource(templateOneDialog);
    CmsResource res=jsp.getCmsObject().readResource(resource,CmsResourceFilter.ALL);
    String template=jsp.getCmsObject().readPropertyObject(res,CmsPropertyDefinition.PROPERTY_TEMPLATE,true).getValue("");
    if (!res.isFolder()) {
      int binaryId=OpenCms.getResourceManager().getResourceType(CmsResourceTypeBinary.getStaticTypeName()).getTypeId();
      int plainId=OpenCms.getResourceManager().getResourceType(CmsResourceTypePlain.getStaticTypeName()).getTypeId();
      int imageId=OpenCms.getResourceManager().getResourceType(CmsResourceTypeImage.getStaticTypeName()).getTypeId();
      if ((res.getTypeId() != binaryId) && (res.getTypeId() != plainId) && (res.getTypeId() != imageId)) {
        if (dialogPresent && TEMPLATE_ONE.equals(template)) {
          return templateOneDialog;
        }
 else         if (CmsResourceTypeXmlPage.isXmlPage(res)) {
          return PATH_WORKPLACE + "editors/dialogs/property.jsp";
        }
      }
    }
    if (dialogPresent && res.isFolder() && TEMPLATE_ONE.equals(template)&& !res.getRootPath().startsWith(CmsResource.VFS_FOLDER_SYSTEM)) {
      return templateOneDialog;
    }
    String resTypeName=OpenCms.getResourceManager().getResourceType(res.getTypeId()).getTypeName();
    CmsExplorerTypeSettings settings=getSettingsForType(resTypeName);
    if (settings.isPropertiesEnabled()) {
      return URI_PROPERTY_CUSTOM_DIALOG;
    }
  }
 catch (  CmsException e) {
    if (LOG.isErrorEnabled()) {
      LOG.error(e.getLocalizedMessage(),e);
    }
  }
  return URI_PROPERTY_DIALOG;
}
