{
  boolean captchaFieldIsOnInputPage=captchaFieldIsOnInputPage();
  boolean displayCheckPage=captchaFieldIsOnCheckPage() && isInputFormSubmitted();
  boolean submittedCheckPage=captchaFieldIsOnCheckPage() && isCheckPageSubmitted();
  if (captchaFieldIsOnInputPage || displayCheckPage || submittedCheckPage) {
    CmsObject cms=jsp.getCmsObject();
    I_CmsXmlContentValue xmlValueCaptcha=xmlContent.getValue(NODE_CAPTCHA,locale);
    if (xmlValueCaptcha != null) {
      String xPathCaptcha=xmlValueCaptcha.getPath() + "/";
      String stringValue=xmlContent.getStringValue(cms,xPathCaptcha + NODE_FIELDLABEL,locale);
      String fieldLabel=getConfigurationValue(stringValue,"");
      String fieldValue="";
      if (!initial) {
        fieldValue=jsp.getRequest().getParameter(CmsCaptchaField.C_PARAM_CAPTCHA_PHRASE);
        if (fieldValue == null) {
          fieldValue="";
        }
      }
      CmsCaptchaSettings captchaSettings=new CmsCaptchaSettings(cms,xmlContent,locale);
      m_captchaField=new CmsCaptchaField(captchaSettings,fieldLabel,fieldValue);
    }
  }
}
