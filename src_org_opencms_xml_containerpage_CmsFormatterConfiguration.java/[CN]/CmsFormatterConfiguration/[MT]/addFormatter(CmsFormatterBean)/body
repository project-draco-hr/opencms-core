{
  if (m_frozen) {
    throw new CmsConfigurationException(Messages.get().container(Messages.ERR_FORMATTER_CONFIG_FROZEN));
  }
  String oldUri=null;
  Object key;
  if (formatter.isTypeFormatter()) {
    String type=formatter.getType();
    key=type;
    if (m_typeFormatters.get(type) != null) {
      oldUri=m_typeFormatters.get(type).getJspRootPath();
    }
    m_typeFormatters.put(type,formatter);
  }
 else {
    Integer minWidth=Integer.valueOf(formatter.getMinWidth());
    key=minWidth;
    int old=m_widthFormatters.lastIndexOf(formatter);
    if (old >= 0) {
      oldUri=m_widthFormatters.remove(old).getJspRootPath();
    }
    m_widthFormatters.add(formatter);
  }
  if (oldUri != null) {
    LOG.warn(Messages.get().getBundle().key(Messages.LOG_CONTENT_DEFINITION_DUPLICATE_FORMATTER_4,new Object[]{key,oldUri,formatter.getJspRootPath(),formatter.getLocation()}));
  }
}
