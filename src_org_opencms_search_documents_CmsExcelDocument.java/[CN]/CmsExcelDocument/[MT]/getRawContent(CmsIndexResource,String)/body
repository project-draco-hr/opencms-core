{
  CmsResource resource=(CmsResource)indexResource.getData();
  String rawContent=null;
  try {
    CmsFile file=m_cms.readFile(m_cms.getRequestContext().removeSiteRoot(resource.getRootPath()));
    if (!(file.getLength() > 0)) {
      throw new CmsIndexException("Resource " + resource.getRootPath() + " has no content");
    }
    CmsExcelExtractor extractor=new CmsExcelExtractor();
    rawContent=extractor.extractText(new ByteArrayInputStream(file.getContents()));
  }
 catch (  FileNotFoundException exc) {
    if (exc.getMessage() != null && exc.getMessage().indexOf("Workbook") > 0) {
      throw new CmsIndexException("Reading resource " + resource.getRootPath() + " failed, not in Excel97 format",exc);
    }
 else {
      throw new CmsIndexException("Reading resource " + resource.getRootPath() + " failed",exc);
    }
  }
catch (  Exception exc) {
    throw new CmsIndexException("Reading resource " + resource.getRootPath() + " failed",exc);
  }
  return rawContent;
}
