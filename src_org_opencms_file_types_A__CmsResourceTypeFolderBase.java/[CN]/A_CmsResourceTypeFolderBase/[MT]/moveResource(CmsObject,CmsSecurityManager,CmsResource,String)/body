{
  String dest=cms.getRequestContext().addSiteRoot(destination);
  if (!CmsResource.isFolder(dest)) {
    dest=dest.concat("/");
  }
  if (resource.getRootPath().equals(dest)) {
    throw new CmsVfsException(org.opencms.file.Messages.get().container(org.opencms.file.Messages.ERR_MOVE_SAME_NAME_1,destination));
  }
  if (dest.startsWith(resource.getRootPath())) {
    throw new CmsVfsException(org.opencms.file.Messages.get().container(org.opencms.file.Messages.ERR_MOVE_SAME_FOLDER_2,cms.getSitePath(resource),destination));
  }
  securityManager.checkPermissions(cms.getRequestContext(),resource,CmsPermissionSet.ACCESS_WRITE,true,CmsResourceFilter.IGNORE_EXPIRATION);
  copyResource(cms,securityManager,resource,destination,I_CmsConstants.C_COPY_AS_SIBLING);
  deleteResource(cms,securityManager,resource,I_CmsConstants.C_DELETE_OPTION_PRESERVE_SIBLINGS);
}
