{
  if (m_attachments == null) {
    m_attachments=new ArrayList<CmsDocumentDependency>(4);
  }
  boolean exist=false;
  for (  CmsDocumentDependency att : m_attachments) {
    if (att.getAttachmentNumber() == dep.getAttachmentNumber()) {
      if (m_locale.equals(dep.getLocale())) {
        for (        CmsDocumentDependency langAtt : att.getAllLanguageVersions()) {
          dep.addLanguageVersion(langAtt);
        }
        dep.addLanguageVersion(att);
        m_attachments.remove(att);
      }
 else {
        exist=true;
        att.addLanguageVersion(dep);
      }
      break;
    }
  }
  if (!exist) {
    dep.setType(DependencyType.attachment);
    m_attachments.add(dep);
  }
 else {
    dep.setType(DependencyType.variant);
  }
  addDependency(dep);
}
