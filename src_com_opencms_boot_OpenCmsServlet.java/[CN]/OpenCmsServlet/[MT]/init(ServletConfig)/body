{
  m_config=config;
  String classname="com.opencms.core.OpenCmsHttpServlet";
  String base=config.getInitParameter("opencms.home");
  System.err.println("BASE: " + config.getServletContext().getRealPath("/"));
  System.err.println("BASE2: " + System.getProperty("user.dir"));
  if (base == null || "".equals(base)) {
    System.err.println("No OpenCms home folder given. Trying to guess...");
    base=CmsMain.searchBaseFolder(config.getServletContext().getRealPath("/"));
    if (base == null || "".equals(base)) {
      throw new ServletException("OpenCms base folder could not be guessed. Please define init parameter \"opencms.home\" in servlet engine configuration.");
    }
  }
  base=CmsBase.setBasePath(base);
  try {
    m_loader=new CmsClassLoader();
    CmsMain.collectRepositories(base,m_loader);
    Class c=m_loader.loadClass(classname);
    m_servlet=(HttpServlet)c.newInstance();
  }
 catch (  Exception e) {
    throw new ServletException(e);
  }
  m_servlet.init(config);
}
