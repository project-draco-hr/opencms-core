{
  int leftSpace=item.getAbsoluteLeft() - (Window.getScrollLeft() + 10);
  int rightSpace=Window.getClientWidth() - (item.getAbsoluteLeft() + item.getOffsetWidth() + 10);
  boolean showRight=item.getSubMenu().getOffsetWidth() < rightSpace;
  if (!showRight) {
    showRight=leftSpace < rightSpace;
  }
  int topSpace=item.getAbsoluteTop() - Window.getScrollTop() + 10;
  int bottomSpace=Window.getClientHeight() + Window.getScrollTop() - (item.getAbsoluteTop() + 10);
  boolean showBottom=item.getSubMenu().getOffsetHeight() < bottomSpace;
  if (!showBottom) {
    showBottom=topSpace < bottomSpace;
  }
  int left;
  int top;
  if (showRight && showBottom) {
    left=item.getAbsoluteLeft() + item.getOffsetWidth() - 4;
    top=item.getAbsoluteTop() - Window.getScrollTop() - 4;
  }
 else   if (!showRight && showBottom) {
    left=item.getAbsoluteLeft() - item.getSubMenu().getOffsetWidth() - Window.getScrollLeft()- 4;
    top=item.getAbsoluteTop() - Window.getScrollTop() - 4;
  }
 else   if (showRight && !showBottom) {
    left=item.getAbsoluteLeft() + item.getOffsetWidth() - 4;
    top=item.getAbsoluteTop() - Window.getScrollTop() - item.getSubMenu().getOffsetHeight() + item.getOffsetHeight() - 4;
  }
 else {
    left=item.getAbsoluteLeft() - Window.getScrollLeft() - item.getSubMenu().getOffsetWidth()- 4;
    top=item.getAbsoluteTop() - Window.getScrollTop() - item.getSubMenu().getOffsetHeight() + item.getOffsetHeight() - 4;
  }
  m_popup.setPosition(left,top);
}
