{
  try {
    ByteArrayOutputStream out=new ByteArrayOutputStream();
    OutputFormat format=OutputFormat.createPrettyPrint();
    format.setEncoding(encoding);
    XMLWriter writer=new XMLWriter(out,format);
    writer.write(m_document);
    writer.close();
    file.setContents(out.toByteArray());
  }
 catch (  Exception exc) {
    throw new CmsPageException("Marshalling xml page failed",exc);
  }
  return file;
}
