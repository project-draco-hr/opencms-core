{
  ByteArrayOutputStream bytes=new ByteArrayOutputStream();
  PrintStream out=new PrintStream(bytes);
  CmsObject cms=getCmsObject();
  CmsShell shell=new CmsShell(cms,"${user}@${project}:${siteroot}|${uri}>",null,out,out);
  shell.start("echo on\n pwd \n userName \n exit");
  String expected="\nWelcome to the OpenCms shell!\n" + "\n" + "\n"+ "This is OpenCms " + OpenCms.getSystemInfo().getVersionNumber() + ".\n"+ "\n"+ Messages.COPYRIGHT_BY_ALKACON[1]+ "\n"+ "OpenCms comes with ABSOLUTELY NO WARRANTY\n"+ "This is free software, and you are welcome to\n"+ "redistribute it under certain conditions.\n"+ "Please see the GNU Lesser General Public Licence for\n"+ "further details.\n"+ "\n"+ "\n"+ "help              Shows this text.\n"+ "help *            Shows the signatures of all available methods.\n"+ "help {string}     Shows the signatures of all methods containing this string.\n"+ "exit or quit      Leaves this OpenCms Shell.\n"+ "\n"+ "Admin@Offline:/sites/default|/>Echo is now on.\n"+ "Admin@Offline:/sites/default|/>pwd\n"+ "/\n"+ "Admin@Offline:/sites/default|/>userName\n"+ "Admin\n"+ "Admin@Offline:/sites/default|/>exit\n"+ "\n"+ "Goodbye!\n";
  String result=bytes.toString();
  assertEquals("Shell did not produce expected output",expected,result);
}
