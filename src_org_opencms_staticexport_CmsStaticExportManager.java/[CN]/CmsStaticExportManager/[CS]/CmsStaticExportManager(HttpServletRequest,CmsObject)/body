{
  if (!OpenCms.getStaticExportProperties().isStaticExportEnabled()) {
    return;
  }
  m_rfsName=request.getParameter(C_EXPORT_MARKER);
  if ((m_rfsName == null)) {
    m_rfsName=(String)request.getAttribute(C_EXPORT_ATTRIBUTE_ERROR_REQUEST_URI);
  }
  if ((m_rfsName == null) || !m_rfsName.startsWith(OpenCms.getStaticExportProperties().getRfsPrefix())) {
    return;
  }
  m_rfsName=m_rfsName.substring(OpenCms.getStaticExportProperties().getRfsPrefix().length());
  m_vfsName=OpenCms.getStaticExportProperties().getCachedExportUri(m_rfsName);
  if (m_vfsName != null) {
    if (!C_CACHEVALUE_404.equals(m_vfsName)) {
      try {
        m_resource=cms.readFileHeader(m_vfsName);
      }
 catch (      CmsException e) {
        m_rfsName=null;
        return;
      }
    }
 else {
      m_rfsName=null;
      return;
    }
  }
 else {
    boolean match=false;
    try {
      m_resource=cms.readFileHeader(m_rfsName);
      if (m_resource.isFolder() && !m_rfsName.endsWith("/")) {
        m_rfsName+="/";
      }
      m_vfsName=m_rfsName;
      match=true;
    }
 catch (    Throwable t) {
    }
    if (!match) {
      Map exportnameFolders=OpenCms.getStaticExportProperties().getExportnames();
      Iterator i=exportnameFolders.keySet().iterator();
      while (i.hasNext()) {
        String exportName=(String)i.next();
        if (m_rfsName.startsWith(exportName)) {
          match=true;
          m_vfsName=exportnameFolders.get(exportName) + m_rfsName.substring(exportName.length());
          try {
            m_resource=cms.readFileHeader(m_vfsName);
            if (m_resource.isFolder()) {
              if (!m_rfsName.endsWith("/")) {
                m_rfsName+="/";
              }
              if (!m_vfsName.endsWith("/")) {
                m_vfsName+="/";
              }
            }
          }
 catch (          CmsException e) {
            m_rfsName=null;
          }
          break;
        }
      }
    }
    if (!match) {
      OpenCms.getStaticExportProperties().cacheExportUri(m_rfsName,C_CACHEVALUE_404);
      m_rfsName=null;
    }
 else {
      OpenCms.getStaticExportProperties().cacheExportUri(m_rfsName,m_vfsName);
    }
  }
  m_cms=cms;
}
