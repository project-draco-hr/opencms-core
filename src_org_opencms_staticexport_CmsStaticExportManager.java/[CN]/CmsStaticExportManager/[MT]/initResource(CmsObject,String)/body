{
  CmsFile file=null;
  try {
    file=cms.readFile(resourceName);
  }
 catch (  CmsException e) {
    if (e.getType() == CmsException.C_NOT_FOUND) {
      try {
        CmsFolder folder=cms.readFolder(resourceName);
        String defaultFileName=cms.readProperty(CmsResource.getPath(cms.readAbsolutePath(folder)),I_CmsConstants.C_PROPERTY_DEFAULT_FILE);
        if (defaultFileName != null) {
          String tmpResourceName=CmsResource.getPath(cms.readAbsolutePath(folder)) + defaultFileName;
          try {
            file=cms.readFile(tmpResourceName);
            cms.getRequestContext().getRequest().setRequestedResource(tmpResourceName);
          }
 catch (          CmsSecurityException se) {
            throw se;
          }
catch (          CmsException exc) {
          }
        }
        if (file == null) {
          Iterator i=OpenCms.getDefaultFilenames().iterator();
          while (i.hasNext()) {
            String tmpResourceName=CmsResource.getPath(cms.readAbsolutePath(folder)) + (String)i.next();
            try {
              file=cms.readFile(tmpResourceName);
              cms.getRequestContext().getRequest().setRequestedResource(tmpResourceName);
              break;
            }
 catch (            CmsSecurityException se) {
              throw se;
            }
catch (            CmsException exc) {
            }
          }
        }
        if (file == null) {
          throw e;
        }
      }
 catch (      CmsException ex) {
        throw ex;
      }
    }
 else {
      throw e;
    }
  }
  if (file != null) {
    if ((file.getFlags() & I_CmsConstants.C_ACCESS_INTERNAL_READ) > 0) {
      throw new CmsException(CmsException.C_ERROR_DESCRIPTION[CmsException.C_INTERNAL_FILE] + cms.getRequestContext().getUri(),CmsException.C_INTERNAL_FILE);
    }
  }
  return file;
}
