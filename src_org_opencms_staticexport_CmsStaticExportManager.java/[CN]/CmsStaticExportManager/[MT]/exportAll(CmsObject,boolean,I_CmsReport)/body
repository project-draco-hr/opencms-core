{
  if (purgeFirst) {
    Map eventData=(Map)new HashMap();
    eventData.put("report",report);
    CmsEvent clearCacheEvent=new CmsEvent(cms,I_CmsEventListener.EVENT_CLEAR_CACHES,eventData,false);
    OpenCms.fireCmsEvent(clearCacheEvent);
    scrubExportFolder();
    cms.deleteAllStaticExportPublishedResources(C_EXPORT_LINK_WITHOUT_PARAMETER);
    cms.deleteAllStaticExportPublishedResources(C_EXPORT_LINK_WITH_PARAMETER);
  }
  CmsObject cmsExportObject=OpenCms.initCmsObject(OpenCms.getDefaultUsers().getUserExport());
  List publishedResources=getAllResources(cmsExportObject);
  doStaticExport(publishedResources,report);
}
