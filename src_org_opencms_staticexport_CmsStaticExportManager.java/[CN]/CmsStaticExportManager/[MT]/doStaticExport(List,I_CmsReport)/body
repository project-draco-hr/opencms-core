{
  boolean templatesFound;
  CmsObject cmsExportObject=OpenCms.initCmsObject(OpenCms.getDefaultUsers().getUserExport());
  CmsProject originalProject=cmsExportObject.getRequestContext().currentProject();
  CmsProject onlineProject=cmsExportObject.readProject(I_CmsConstants.C_PROJECT_ONLINE_ID);
  try {
    cmsExportObject.getRequestContext().setCurrentProject(onlineProject);
    templatesFound=exportNonTemplateResources(cmsExportObject,resources,report);
    if ((templatesFound) || (!getQuickPlainExport())) {
      exportTemplateResources(cmsExportObject,report);
    }
  }
  finally {
    cmsExportObject.getRequestContext().setCurrentProject(originalProject);
  }
}
