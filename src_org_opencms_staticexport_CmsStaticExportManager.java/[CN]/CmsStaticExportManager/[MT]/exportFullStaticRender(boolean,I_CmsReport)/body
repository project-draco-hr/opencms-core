{
  if (purgeFirst) {
    Map eventData=new HashMap();
    eventData.put(I_CmsEventListener.KEY_REPORT,report);
    CmsEvent clearCacheEvent=new CmsEvent(I_CmsEventListener.EVENT_CLEAR_CACHES,eventData);
    OpenCms.fireCmsEvent(clearCacheEvent);
    scrubExportFolder();
    CmsObject cms=OpenCms.initCmsObject(OpenCms.getDefaultUsers().getUserExport());
    cms.deleteAllStaticExportPublishedResources(C_EXPORT_LINK_WITHOUT_PARAMETER);
    cms.deleteAllStaticExportPublishedResources(C_EXPORT_LINK_WITH_PARAMETER);
  }
  CmsObject cmsExportObject=OpenCms.initCmsObject(OpenCms.getDefaultUsers().getUserExport());
  List publishedResources=getAllResources(cmsExportObject);
  CmsAfterPublishStaticExportHandler handler=new CmsAfterPublishStaticExportHandler();
  handler.doExportAfterPublish(publishedResources,report);
}
