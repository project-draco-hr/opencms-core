{
  if (siteRoot == null) {
    return isSecureLink(cms,vfsName);
  }
  try {
    cms.getRequestContext().saveSiteRoot();
    cms.getRequestContext().setSiteRoot(siteRoot);
    return isSecureLink(cms,vfsName);
  }
  finally {
    cms.getRequestContext().restoreSiteRoot();
  }
}
