{
  String vfsName=null;
  CmsResource resource;
  boolean match=false;
  try {
    resource=cms.readResource(cms.getRequestContext().removeSiteRoot(rfsName));
    if (resource.isFolder() && !CmsResource.isFolder(rfsName)) {
      rfsName+='/';
    }
    vfsName=rfsName;
    match=true;
  }
 catch (  Throwable t) {
  }
  if (!match) {
    Map exportnameFolders=getExportnames();
    Iterator i=exportnameFolders.keySet().iterator();
    while (i.hasNext()) {
      String exportName=(String)i.next();
      if (rfsName.startsWith(exportName)) {
        match=true;
        vfsName=exportnameFolders.get(exportName) + rfsName.substring(exportName.length());
        try {
          resource=cms.readResource(vfsName);
          if (resource.isFolder()) {
            if (!CmsResource.isFolder(rfsName)) {
              rfsName+='/';
            }
            if (!CmsResource.isFolder(vfsName)) {
              vfsName+='/';
            }
          }
          break;
        }
 catch (        CmsVfsResourceNotFoundException e) {
          match=false;
          continue;
        }
catch (        CmsException e) {
          rfsName=null;
          break;
        }
      }
    }
  }
  if (!match) {
    int extPos=rfsName.lastIndexOf('.');
    if (extPos >= 0) {
      String cutName=rfsName.substring(0,extPos);
      int pos=cutName.lastIndexOf('.');
      if (pos >= 0) {
        String extension=cutName.substring(pos).toLowerCase();
        if (".jsp".equals(extension)) {
          return getVfsNameInternal(cms,cutName);
        }
      }
    }
  }
  if (match) {
    return vfsName;
  }
 else {
    return null;
  }
}
