{
  if (!isVisible()) {
    return "";
  }
  String listId=list.getId();
  String sortedCol=list.getSortedColumn();
  CmsListOrderEnum order=list.getCurrentSortOrder();
  StringBuffer html=new StringBuffer(512);
  html.append("<th");
  if (CmsStringUtil.isNotEmptyOrWhitespaceOnly(getWidth())) {
    html.append(" width='");
    html.append(getWidth());
    html.append("'");
  }
  if (!isTextWrapping()) {
    html.append(" style='white-space: nowrap;'");
  }
  html.append(">\n");
  boolean isSorted=getId().equals(sortedCol);
  CmsListOrderEnum nextOrder=CmsListOrderEnum.ORDER_ASCENDING;
  if (isSorted && order == CmsListOrderEnum.ORDER_ASCENDING) {
    nextOrder=CmsListOrderEnum.ORDER_DESCENDING;
  }
  String id=listId + getId() + "Sort";
  String onClic="listSort('" + listId + "', '"+ getId()+ "');";
  String helpText=null;
  if (m_helpText != null) {
    helpText=new MessageFormat(m_helpText.key(wp.getLocale()),wp.getLocale()).format(new Object[]{getName().key(wp.getLocale())});
  }
 else {
    if (isSorteable()) {
      if (nextOrder.equals(CmsListOrderEnum.ORDER_ASCENDING)) {
        helpText=Messages.get().key(wp.getLocale(),Messages.GUI_LIST_COLUMN_ASC_SORT_1,new Object[]{getName().key(wp.getLocale())});
      }
 else {
        helpText=Messages.get().key(wp.getLocale(),Messages.GUI_LIST_COLUMN_DESC_SORT_1,new Object[]{getName().key(wp.getLocale())});
      }
    }
 else {
      helpText=Messages.get().key(wp.getLocale(),Messages.GUI_LIST_COLUMN_NO_SORT_1,new Object[]{getName().key(wp.getLocale())});
    }
  }
  if (CmsStringUtil.isNotEmptyOrWhitespaceOnly(getWidth()) && getWidth().indexOf('%') < 0) {
    html.append("\t<div style='display:block; width: ");
    html.append(getWidth());
    html.append("px;'>\n");
  }
  html.append(A_CmsHtmlIconButton.defaultButtonHtml(wp.getJsp(),CmsHtmlIconButtonStyleEnum.SMALL_ICON_TEXT,id,getName().key(wp.getLocale()),helpText,isSorteable(),null,null,onClic));
  if (isSorted) {
    if (nextOrder == CmsListOrderEnum.ORDER_ASCENDING) {
      html.append("\t\t<img src='");
      html.append(CmsWorkplace.getSkinUri());
      html.append(ICON_UP);
      html.append("' alt=''>\n");
    }
 else {
      html.append("\t\t<img src='");
      html.append(CmsWorkplace.getSkinUri());
      html.append(ICON_DOWN);
      html.append("' alt=''>\n");
    }
  }
  if (CmsStringUtil.isNotEmptyOrWhitespaceOnly(getWidth()) && getWidth().indexOf('%') < 0) {
    html.append("\t</div>\n");
  }
  html.append("</th>\n");
  return html.toString();
}
