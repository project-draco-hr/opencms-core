{
  if (((adminCms == null) && (OpenCms.getRunLevel() > OpenCms.RUNLEVEL_1_CORE_OBJECT)) || ((adminCms != null) && !adminCms.isAdmin())) {
    throw new RuntimeException("Admin permissions are required to initialize the module manager");
  }
  Iterator it;
  it=m_modules.keySet().iterator();
  while (it.hasNext()) {
    CmsModule module=(CmsModule)m_modules.get(it.next());
    if (module.getActionClass() != null) {
      I_CmsModuleAction moduleAction=null;
      try {
        moduleAction=(I_CmsModuleAction)Class.forName(module.getActionClass()).newInstance();
      }
 catch (      InstantiationException e) {
        OpenCms.getLog(CmsLog.CHANNEL_INIT).info(". Module configuration : could not create instance for module " + module.getName(),e);
      }
catch (      IllegalAccessException e) {
        OpenCms.getLog(CmsLog.CHANNEL_INIT).info(". Module configuration : could not create instance for module " + module.getName(),e);
      }
catch (      ClassNotFoundException e) {
        OpenCms.getLog(CmsLog.CHANNEL_INIT).info(". Module configuration : could not create instance for module " + module.getName(),e);
      }
catch (      ClassCastException e) {
        OpenCms.getLog(CmsLog.CHANNEL_INIT).info(". Module configuration : could not create instance for module " + module.getName(),e);
      }
      if (moduleAction != null) {
        m_moduleActionInstances.put(module.getName(),moduleAction);
        if (OpenCms.getLog(CmsLog.CHANNEL_INIT).isInfoEnabled()) {
          OpenCms.getLog(CmsLog.CHANNEL_INIT).info(". Module configuration : initializing module class " + moduleAction.getClass().getName());
        }
        try {
          CmsContextInfo contextInfo=new CmsContextInfo(adminCms.getRequestContext().currentUser(),adminCms.getRequestContext().currentProject(),adminCms.getRequestContext().getUri(),adminCms.getRequestContext().getSiteRoot(),adminCms.getRequestContext().getLocale(),adminCms.getRequestContext().getEncoding(),adminCms.getRequestContext().getRemoteAddress());
          CmsObject adminCmsCopy=OpenCms.initCmsObject(adminCms,contextInfo);
          moduleAction.initialize(adminCmsCopy,configurationManager,module);
        }
 catch (        Throwable t) {
          OpenCms.getLog(this).error("Error during module action instance initialize for class '" + moduleAction.getClass().getName() + "'",t);
        }
      }
    }
  }
  initModuleExportPoints();
  if (OpenCms.getLog(CmsLog.CHANNEL_INIT).isInfoEnabled()) {
    OpenCms.getLog(CmsLog.CHANNEL_INIT).info(". Module configuration : " + m_moduleActionInstances.size() + " module classes initialized");
  }
}
