{
  if ((adminCms == null) || (!adminCms.isAdmin())) {
    throw new CmsSecurityException(CmsSecurityException.C_SECURITY_ADMIN_PRIVILEGES_REQUIRED);
  }
  CmsModule oldModule=(CmsModule)m_modules.get(module.getName());
  if (oldModule == null) {
    throw new CmsConfigurationException(CmsConfigurationException.C_CONFIGURATION_ERROR);
  }
  if (OpenCms.getLog(this).isInfoEnabled()) {
    OpenCms.getLog(this).info("Updating module '" + module.getName() + "'");
  }
  if (oldModule.getVersion().compareTo(module.getVersion()) == 0) {
    module.getVersion().increment();
  }
  module.getVersion().setUpdated(true);
  m_modules.put(module.getName(),module);
  try {
    I_CmsModuleAction moduleAction=(I_CmsModuleAction)m_moduleActionInstances.get(module.getName());
    if (moduleAction != null) {
      moduleAction.moduleUpdate(module);
    }
  }
 catch (  Throwable t) {
    OpenCms.getLog(this).error("Error during module action instance update for module '" + module.getName() + "'",t);
  }
  initModuleExportPoints();
  updateModuleConfiguration();
}
