{
  super.onModuleLoad();
  I_CmsLayoutBundle.INSTANCE.rootCss().ensureInjected();
  I_CmsLayoutBundle.INSTANCE.pageCss().ensureInjected();
  I_CmsImageBundle.INSTANCE.buttonCss().ensureInjected();
  RootPanel.getBodyElement().addClassName(I_CmsLayoutBundle.INSTANCE.rootCss().root());
  final CmsSitemapController controller=new CmsSitemapController();
  final CmsSitemapTreeItemFactory factory=new CmsSitemapTreeItemFactory(controller);
  final CmsLazyTree<CmsSitemapTreeItem> tree=new CmsLazyTree<CmsSitemapTreeItem>(new A_CmsDeepLazyOpenHandler<CmsSitemapTreeItem>(){
    /** 
 * @see org.opencms.gwt.client.ui.tree.I_CmsLazyOpenHandler#load(org.opencms.gwt.client.ui.tree.CmsLazyTreeItem)
 */
    public void load(    final CmsSitemapTreeItem target){
      getChildren(target,factory);
    }
  }
);
  final CmsSitemapToolbar toolbar=new CmsSitemapToolbar();
  toolbar.setHandler(new CmsSitemapToolbarHandler(controller));
  controller.setHandler(new CmsSitemapControllerHandler(toolbar,tree,factory));
  RootPanel.get().add(toolbar);
  RootPanel.get().add(new CmsToolbarPlaceHolder());
  CmsHeader title=new CmsHeader(Messages.get().key(Messages.GUI_EDITOR_TITLE_0),CmsSitemapProvider.get().getUri());
  title.addStyleName(I_CmsLayoutBundle.INSTANCE.rootCss().pageCenter());
  RootPanel.get().add(title);
  final CmsPage page=new CmsPage();
  RootPanel.get().add(page);
  final Label loadingLabel=new Label(Messages.get().key(Messages.GUI_LOADING_0));
  page.add(loadingLabel);
  CmsRpcAction<List<CmsClientSitemapEntry>> getRootsAction=new CmsRpcAction<List<CmsClientSitemapEntry>>(){
    /** 
 * @see org.opencms.gwt.client.rpc.CmsRpcAction#execute()
 */
    @Override public void execute(){
      start(500);
      CmsSitemapProvider.getService().getRoots(CmsSitemapProvider.get().getUri(),this);
    }
    /** 
 * @see org.opencms.gwt.client.rpc.CmsRpcAction#onResponse(java.lang.Object)
 */
    @Override public void onResponse(    List<CmsClientSitemapEntry> roots){
      page.remove(loadingLabel);
      controller.setRoots(roots);
      List<CmsSitemapTreeItem> items=new ArrayList<CmsSitemapTreeItem>();
      for (      CmsClientSitemapEntry root : roots) {
        CmsSitemapTreeItem rootItem=factory.create(root);
        rootItem.clearChildren();
        for (        CmsClientSitemapEntry entry : root.getChildren()) {
          rootItem.addChild(factory.create(entry));
        }
        rootItem.onFinishLoading();
        rootItem.setOpen(true);
        items.add(rootItem);
      }
      page.add(tree);
      for (      CmsSitemapTreeItem item : items) {
        tree.addItem(item);
      }
      stop();
    }
  }
;
  getRootsAction.execute();
}
