{
  CmsJspStandardContextBean standardContext=getStandardContext(cms,req);
  CmsContainerPageBean containerPage=standardContext.getPage();
  Set<String> jsIncludes=new LinkedHashSet<String>();
  if (CmsStringUtil.isNotEmptyOrWhitespaceOnly(m_defaults)) {
    String[] defaults=m_defaults.split("\\|");
    for (int i=0; i < defaults.length; i++) {
      jsIncludes.add(defaults[i]);
    }
  }
  if ((containerPage != null) && (containerPage.getElements() != null)) {
    Map<CmsUUID,CmsFormatterBean> formatters=OpenCms.getADEManager().getCachedFormatters(standardContext.isOnline()).getFormatters();
    for (    CmsContainerBean container : containerPage.getContainers().values()) {
      for (      CmsContainerElementBean element : container.getElements()) {
        String formatterConfigId=element.getSettings().get(CmsFormatterConfig.FORMATTER_SETTINGS_KEY + container.getName());
        if (CmsUUID.isValidUUID(formatterConfigId) && formatters.containsKey(new CmsUUID(formatterConfigId))) {
          jsIncludes.addAll(formatters.get(new CmsUUID(formatterConfigId)).getJavascriptHeadIncludes());
        }
 else {
          try {
            element.initResource(cms);
            jsIncludes.addAll(getJSHeadIncludes(cms,element.getResource()));
          }
 catch (          CmsException e) {
            LOG.error(Messages.get().getBundle().key(Messages.ERR_READING_REQUIRED_RESOURCE_1,element.getSitePath()),e);
          }
        }
      }
    }
  }
  if (standardContext.getDetailContentId() != null) {
    try {
      CmsResource detailContent=cms.readResource(standardContext.getDetailContentId());
      CmsFormatterConfiguration config=OpenCms.getADEManager().lookupConfiguration(cms,cms.getRequestContext().getRootUri()).getFormatters(cms,detailContent);
      for (      I_CmsFormatterBean formatter : config.getAllFormatters()) {
        jsIncludes.addAll(formatter.getJavascriptHeadIncludes());
      }
    }
 catch (    CmsException e) {
      LOG.error(Messages.get().getBundle().key(Messages.ERR_READING_REQUIRED_RESOURCE_1,standardContext.getDetailContentId()),e);
    }
  }
  for (  String jsUri : jsIncludes) {
    pageContext.getOut().print("<script type=\"text/javascript\" src=\"" + CmsJspTagLink.linkTagAction(jsUri,req) + generateReqParams()+ "\"></script>");
  }
}
