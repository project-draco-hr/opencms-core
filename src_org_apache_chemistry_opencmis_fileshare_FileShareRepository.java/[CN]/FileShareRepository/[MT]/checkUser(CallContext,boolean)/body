{
  if (context == null) {
    throw new CmisPermissionDeniedException("No user context!");
  }
  Boolean readOnly=userMap.get(context.getUsername());
  if (readOnly == null) {
    throw new CmisPermissionDeniedException("Unknown user!");
  }
  if (readOnly.booleanValue() && writeRequired) {
    throw new CmisPermissionDeniedException("No write permission!");
  }
  return readOnly.booleanValue();
}
