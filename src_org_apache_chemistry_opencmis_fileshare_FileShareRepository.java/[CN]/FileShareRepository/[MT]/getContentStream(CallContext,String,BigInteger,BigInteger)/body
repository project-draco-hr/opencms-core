{
  debug("getContentStream");
  checkUser(context,false);
  if ((offset != null) || (length != null)) {
    throw new CmisInvalidArgumentException("Offset and Length are not supported!");
  }
  final File file=getFile(objectId);
  if (!file.isFile()) {
    throw new CmisStreamNotSupportedException("Not a file!");
  }
  if (file.length() == 0) {
    throw new CmisConstraintException("Document has no content!");
  }
  InputStream stream=null;
  try {
    stream=new BufferedInputStream(new FileInputStream(file),4 * 1024);
  }
 catch (  FileNotFoundException e) {
    throw new CmisObjectNotFoundException(e.getMessage(),e);
  }
  ContentStreamImpl result=new ContentStreamImpl();
  result.setFileName(file.getName());
  result.setLength(BigInteger.valueOf(file.length()));
  result.setMimeType(MimeTypes.getMIMEType(file));
  result.setStream(stream);
  return result;
}
