{
  debug("getDescendants or getFolderTree");
  boolean userReadOnly=checkUser(context,false);
  int d=(depth == null ? 2 : depth.intValue());
  if (d == 0) {
    throw new CmisInvalidArgumentException("Depth must not be 0!");
  }
  if (d < -1) {
    d=-1;
  }
  Set<String> filterCollection=splitFilter(filter);
  boolean iaa=(includeAllowableActions == null ? false : includeAllowableActions.booleanValue());
  boolean ips=(includePathSegment == null ? false : includePathSegment.booleanValue());
  File folder=getFile(folderId);
  if (!folder.isDirectory()) {
    throw new CmisObjectNotFoundException("Not a folder!");
  }
  if (context.isObjectInfoRequired()) {
    compileObjectType(context,folder,null,false,false,userReadOnly,objectInfos);
  }
  List<ObjectInFolderContainer> result=new ArrayList<ObjectInFolderContainer>();
  gatherDescendants(context,folder,result,foldersOnly,d,filterCollection,iaa,ips,userReadOnly,objectInfos);
  return result;
}
