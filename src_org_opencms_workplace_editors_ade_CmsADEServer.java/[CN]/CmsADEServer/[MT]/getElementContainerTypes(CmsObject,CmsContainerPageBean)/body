{
  Map<CmsUUID,Set<String>> result=new HashMap<CmsUUID,Set<String>>();
  for (  CmsContainerBean container : cntPage.getContainers().values()) {
    for (    CmsContainerElementBean element : container.getElements()) {
      addToMultiMap(result,element.getElementId(),container.getType());
      if (element.isSubcontainer(cms)) {
        CmsResource elementRes=cms.readResource(element.getElementId());
        CmsXmlSubContainer xmlSubContainer=CmsXmlSubContainerFactory.unmarshal(cms,elementRes,getRequest());
        CmsSubContainerBean subContainer=xmlSubContainer.getSubContainer(cms,cms.getRequestContext().getLocale());
        for (        CmsContainerElementBean subElement : subContainer.getElements()) {
          addToMultiMap(result,subElement.getElementId(),container.getType());
        }
      }
    }
  }
  return result;
}
