{
  CmsElementDefinitionCollection subtemplateDefinitions=new CmsElementDefinitionCollection();
  int variantCachesize=100;
  try {
    CmsElementCache elementCache=CmsXmlTemplateLoader.getElementCache(cms);
    variantCachesize=elementCache.getVariantCachesize();
    CmsXmlTemplateFile xmlTemplateDocument=getOwnTemplateFile(cms,templateFile,null,parameters,null);
    Vector subtemplates=xmlTemplateDocument.getAllSubElementDefinitions();
    int numSubtemplates=subtemplates.size();
    for (int i=0; i < numSubtemplates; i++) {
      String elName=(String)subtemplates.elementAt(i);
      String className=null;
      String templateName=null;
      String templateSelector=null;
      if (xmlTemplateDocument.hasSubtemplateClass(elName)) {
        className=xmlTemplateDocument.getSubtemplateClass(elName);
      }
      if (xmlTemplateDocument.hasSubtemplateFilename(elName)) {
        templateName=xmlTemplateDocument.getSubtemplateFilename(elName);
      }
      if (xmlTemplateDocument.hasSubtemplateSelector(elName)) {
        templateSelector=xmlTemplateDocument.getSubtemplateSelector(elName);
      }
      Hashtable templateParameters=xmlTemplateDocument.getParameters(elName);
      if (className != null || templateName != null || templateSelector != null || templateParameters.size() > 0) {
        if (className == null) {
          className=I_CmsConstants.C_XML_CONTROL_DEFAULT_CLASS;
        }
        if (templateName != null) {
          templateName=CmsLinkManager.getAbsoluteUri(templateName,templateFile);
        }
        CmsElementDefinition elDef=new CmsElementDefinition(elName,className,templateName,templateSelector,templateParameters);
        subtemplateDefinitions.add(elDef);
      }
    }
  }
 catch (  Exception e) {
    if (templateFile != null) {
      if (OpenCms.isLogging(CmsLog.CHANNEL_XMLTEMPLATE,CmsLog.LEVEL_WARN)) {
        OpenCms.log(CmsLog.CHANNEL_XMLTEMPLATE,CmsLog.LEVEL_WARN,getClassName() + "Could not generate my template cache element.");
        OpenCms.log(CmsLog.CHANNEL_XMLTEMPLATE,CmsLog.LEVEL_WARN,getClassName() + e);
      }
    }
  }
  CmsElementXml result=new CmsElementXml(getClass().getName(),templateFile,getCacheDirectives(cms,templateFile,null,parameters,null),subtemplateDefinitions,variantCachesize);
  return result;
}
