{
  CmsElementDefinitionCollection subtemplateDefinitions=new CmsElementDefinitionCollection();
  try {
    CmsXmlTemplateFile xmlTemplateDocument=getOwnTemplateFile(cms,templateFile,null,parameters,null);
    CmsElementCache elementCache=cms.getRequestContext().getElementCache();
    Vector subtemplates=xmlTemplateDocument.getAllSubElements();
    int numSubtemplates=subtemplates.size();
    for (int i=0; i < numSubtemplates; i++) {
      String elName=(String)subtemplates.elementAt(i);
      String className=null;
      String templateName=null;
      String templateSelector=null;
      if (xmlTemplateDocument.hasSubtemplateClass(elName)) {
        className=xmlTemplateDocument.getSubtemplateClass(elName);
      }
      if (xmlTemplateDocument.hasSubtemplateFilename(elName)) {
        templateName=xmlTemplateDocument.getSubtemplateFilename(elName);
      }
      if (xmlTemplateDocument.hasSubtemplateSelector(elName)) {
        templateSelector=xmlTemplateDocument.getSubtemplateSelector(elName);
      }
      Hashtable templateParameters=xmlTemplateDocument.getParameters(elName);
      if (className != null || templateName != null || templateSelector != null || templateParameters.size() > 0) {
        CmsElementDefinition elDef=new CmsElementDefinition(elName,className,templateName,templateSelector,templateParameters);
        subtemplateDefinitions.add(elDef);
      }
    }
  }
 catch (  Exception e) {
    if (A_OpenCms.isLogging()) {
      A_OpenCms.log(C_OPENCMS_ELEMENTCACHE,getClassName() + "Could not generate my template cache element.");
      A_OpenCms.log(C_OPENCMS_ELEMENTCACHE,getClassName() + e);
    }
  }
  CmsElementXml result=new CmsElementXml(getClass().getName(),templateFile,getCacheDirectives(cms,templateFile,null,parameters,null),subtemplateDefinitions);
  return result;
}
