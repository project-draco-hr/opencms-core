{
  CmsXmlTemplateFile tempTemplateFile=(CmsXmlTemplateFile)doc;
  CmsXmlTemplateFile templateFile=tempTemplateFile;
  if (templatename != null) {
    Object tempObj=CmsTemplateClassManager.getClassInstance(tempTemplateFile.getSubtemplateClass(templatename));
    CmsXmlTemplate frameTemplateClassObject=(CmsXmlTemplate)tempObj;
    templateFile=frameTemplateClassObject.getOwnTemplateFile(cms,tempTemplateFile.getSubtemplateFilename(templatename),null,null,null);
  }
  String styleIE=null;
  String styleNS=null;
  if (templateFile.hasData("stylesheet-ie")) {
    styleIE=templateFile.getDataValue("stylesheet-ie");
  }
 else {
    if (templateFile.hasData("stylesheet")) {
      styleIE=templateFile.getDataValue("stylesheet");
    }
 else {
      styleIE="";
    }
  }
  if (templateFile.hasData("stylesheet-ns")) {
    styleNS=templateFile.getDataValue("stylesheet-ns");
  }
 else {
    if (templateFile.hasData("stylesheet")) {
      styleNS=templateFile.getDataValue("stylesheet");
    }
 else {
      styleNS="";
    }
  }
  HttpServletRequest orgReq=(HttpServletRequest)CmsXmlTemplateLoader.getRequest(cms.getRequestContext()).getOriginalRequest();
  String servletPath=CmsXmlTemplateLoader.getRequest(cms.getRequestContext()).getServletUrl();
  if (!servletPath.endsWith("/")) {
    servletPath=CmsXmlTemplateLoader.getRequest(cms.getRequestContext()).getServletUrl() + "/";
  }
  if (styleIE.startsWith("/"))   styleIE=styleIE.substring(1);
  if (styleNS.startsWith("/"))   styleNS=styleNS.substring(1);
  String browser=orgReq.getHeader("user-agent");
  if ((browser != null) && (browser.indexOf("MSIE") > -1)) {
    return ("".equals(styleIE)) ? "" : servletPath + styleIE;
  }
 else {
    return ("".equals(styleNS)) ? "" : servletPath + styleNS;
  }
}
