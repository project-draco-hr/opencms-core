{
  Hashtable parameterHashtable=(Hashtable)((Hashtable)userObject).clone();
  CmsXmlTemplateFile templateFile=(CmsXmlTemplateFile)doc;
  String styleIE=(String)parameterHashtable.get(C_ROOT_TEMPLATE_NAME + ".stylesheet-ie");
  String styleNS=(String)parameterHashtable.get(C_ROOT_TEMPLATE_NAME + ".stylesheet-ns");
  if (styleIE == null) {
    styleIE=templateFile.getParameter(C_ROOT_TEMPLATE_NAME,"stylesheet-ie");
  }
  if (styleNS == null) {
    styleNS=templateFile.getParameter(C_ROOT_TEMPLATE_NAME,"stylesheet-ns");
  }
  HttpServletRequest req=(HttpServletRequest)cms.getRequestContext().getRequest().getOriginalRequest();
  String servletPath=req.getServletPath() + "/";
  String browser=req.getHeader("user-agent");
  if (browser.indexOf("MSIE") > -1) {
    return servletPath + styleIE;
  }
 else {
    return servletPath + styleNS;
  }
}
