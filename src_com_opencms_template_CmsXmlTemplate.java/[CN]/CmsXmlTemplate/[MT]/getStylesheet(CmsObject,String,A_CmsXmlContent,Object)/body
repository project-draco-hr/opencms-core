{
  CmsXmlTemplateFile templateFile=(CmsXmlTemplateFile)doc;
  String styleIE=null;
  String styleNS=null;
  if (templateFile.hasData("stylesheet-ie")) {
    styleIE=templateFile.getDataValue("stylesheet-ie");
  }
 else {
    if (templateFile.hasData("stylesheet")) {
      styleIE=templateFile.getDataValue("stylesheet");
    }
 else {
      styleIE="";
    }
  }
  if (templateFile.hasData("stylesheet-ns")) {
    styleNS=templateFile.getDataValue("stylesheet-ns");
  }
 else {
    if (templateFile.hasData("stylesheet")) {
      styleNS=templateFile.getDataValue("stylesheet");
    }
 else {
      styleNS="";
    }
  }
  HttpServletRequest orgReq=(HttpServletRequest)cms.getRequestContext().getRequest().getOriginalRequest();
  String servletPath=orgReq.getServletPath() + "/";
  String browser=orgReq.getHeader("user-agent");
  if (browser == null) {
    return styleNS;
  }
  if (browser.indexOf("MSIE") > -1) {
    return servletPath + styleIE;
  }
 else {
    return servletPath + styleNS;
  }
}
