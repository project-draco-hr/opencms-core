{
  CmsXmlTemplateFile templateFile=(CmsXmlTemplateFile)doc;
  String styleIE=null;
  String styleNS=null;
  try {
    styleIE=templateFile.getDataValue("stylesheet-ie");
  }
 catch (  Exception e1) {
    try {
      styleIE=templateFile.getDataValue("stylesheet");
    }
 catch (    Exception e2) {
      styleIE="";
    }
  }
  try {
    styleNS=templateFile.getDataValue("stylesheet-ns");
  }
 catch (  Exception e1) {
    try {
      styleNS=templateFile.getDataValue("stylesheet");
    }
 catch (    Exception e2) {
      styleNS="";
    }
  }
  HttpServletRequest orgReq=(HttpServletRequest)cms.getRequestContext().getRequest().getOriginalRequest();
  String servletPath=orgReq.getServletPath() + "/";
  String browser=orgReq.getHeader("user-agent");
  if (browser.indexOf("MSIE") > -1) {
    return servletPath + styleIE;
  }
 else {
    return servletPath + styleNS;
  }
}
