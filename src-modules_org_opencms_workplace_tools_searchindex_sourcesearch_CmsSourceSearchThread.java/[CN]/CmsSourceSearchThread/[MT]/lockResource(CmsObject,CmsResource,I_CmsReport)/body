{
  CmsLock lock=cmsObject.getLock(cmsObject.getSitePath(cmsResource));
  if ((lock != null) && lock.isOwnedBy(cmsObject.getRequestContext().getCurrentUser()) && lock.isOwnedInProjectBy(cmsObject.getRequestContext().getCurrentUser(),cmsObject.getRequestContext().getCurrentProject())) {
    return true;
  }
 else   if ((lock != null) && !lock.isUnlocked() && !lock.isOwnedBy(cmsObject.getRequestContext().getCurrentUser())) {
    m_lockedFiles+=1;
    return false;
  }
 else   if ((lock != null) && !lock.isUnlocked() && lock.isOwnedBy(cmsObject.getRequestContext().getCurrentUser())&& !lock.isOwnedInProjectBy(cmsObject.getRequestContext().getCurrentUser(),cmsObject.getRequestContext().getCurrentProject())) {
    cmsObject.changeLock(cmsObject.getSitePath(cmsResource));
  }
 else   if ((lock != null) && lock.isUnlocked()) {
    cmsObject.lockResource(cmsObject.getSitePath(cmsResource));
  }
  lock=cmsObject.getLock(cmsObject.getSitePath(cmsResource));
  if ((lock != null) && lock.isOwnedBy(cmsObject.getRequestContext().getCurrentUser()) && !lock.isOwnedInProjectBy(cmsObject.getRequestContext().getCurrentUser(),cmsObject.getRequestContext().getCurrentProject())) {
    m_lockedFiles+=1;
    return false;
  }
  return true;
}
