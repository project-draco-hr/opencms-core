{
  CmsObject cms=A_CmsUI.getCmsObject();
  String siteRoot=cms.getRequestContext().getSiteRoot();
  HttpServletRequest req=CmsVaadinUtils.getRequest();
  CmsADESessionCache cache=CmsADESessionCache.getCache(req,cms);
  LastPageBean lastPage=cache.getLastPage();
  if (lastPage != null) {
    if (cms.getRequestContext().getSiteRoot().equals(lastPage.getSiteRoot())) {
      String returncode=lastPage.getDetailId() != null ? lastPage.getPageId() + ":" + lastPage.getDetailId() : "" + lastPage.getPageId();
      try {
        CmsReturnLinkInfo linkInfo=CmsCoreService.internalGetLinkForReturnCode(cms,returncode);
        A_CmsUI.get().getPage().setLocation(linkInfo.getLink());
        return;
      }
 catch (      CmsException e) {
        LOG.error(e.getLocalizedMessage(),e);
        cache.clearLastPage();
      }
    }
 else {
      cache.clearLastPage();
    }
  }
  if (CmsStringUtil.isNotEmptyOrWhitespaceOnly(siteRoot) && !OpenCms.getSiteManager().getSharedFolder().equals(siteRoot)) {
    try {
      CmsResource res=cms.readDefaultFile("/");
      if (res != null) {
        String link=OpenCms.getLinkManager().substituteLink(cms,res);
        A_CmsUI.get().getPage().setLocation(link);
        return;
      }
    }
 catch (    CmsException e) {
      LOG.debug("Unable to open page editor for site " + siteRoot + ".",e);
    }
  }
  Notification.show("The page editor is not available for the current site.",Type.WARNING_MESSAGE);
}
