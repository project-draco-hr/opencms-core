{
  int end=0;
  int newend;
  while (true) {
    newend=source.indexOf(" ",end);
    if ((newend > length) && (end > 0)) {
      return source.substring(0,length - 3) + "...";
    }
 else     if (newend == -1) {
      if (length < source.length()) {
        return source.substring(0,length - 3) + "...";
      }
 else {
        return source;
      }
    }
 else {
      end=newend + 1;
    }
  }
}
